2025-09-17 08:21:26.341 +08:00 [INF] Checking database connection...
2025-09-17 08:21:28.756 +08:00 [INF] Database connection successful.
2025-09-17 08:21:28.758 +08:00 [INF] Attempting to apply migrations...
2025-09-17 08:21:28.952 +08:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-17 08:21:29.986 +08:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-09-17 08:21:30.039 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-09-17 08:21:30.046 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-17 08:21:30.058 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-09-17 08:21:30.134 +08:00 [INF] Migrations applied successfully.
2025-09-17 08:21:30.136 +08:00 [INF] Starting data seeding...
2025-09-17 08:21:30.183 +08:00 [INF] User profile is available. Using 'C:\Users\Win11\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-17 08:21:30.526 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM courses AS c)
2025-09-17 08:21:30.542 +08:00 [INF] Database already contains data. Checking if data cleanup is needed...
2025-09-17 08:21:30.544 +08:00 [INF] Checking for missing data components...
2025-09-17 08:21:30.557 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM subscriptions AS s)
2025-09-17 08:21:30.562 +08:00 [INF] Data seeding completed.
2025-09-17 08:21:30.715 +08:00 [INF] Now listening on: http://localhost:5296
2025-09-17 08:21:30.716 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-17 08:21:30.718 +08:00 [INF] Hosting environment: Development
2025-09-17 08:21:30.719 +08:00 [INF] Content root path: C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-09-17 08:21:42.028 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 08:21:42.028 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 08:21:42.088 +08:00 [WRN] Failed to determine the https port for redirect.
2025-09-17 08:21:42.092 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:42.092 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:42.108 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 81.6062ms
2025-09-17 08:21:42.108 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 81.578ms
2025-09-17 08:21:42.129 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 08:21:42.133 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:21:42.146 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:42.146 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:42.239 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:21:42.244 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 08:21:42.248 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 08:21:42.252 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 119.8392ms
2025-09-17 08:21:42.294 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:21:42.630 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-17 08:21:42.725 +08:00 [INF] Executed DbCommand (36ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:21:43.049 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:21:43.094 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 791.5981ms
2025-09-17 08:21:43.098 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:21:43.104 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 975.1431ms
2025-09-17 08:21:43.948 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 08:21:43.950 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:21:43.953 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:43.956 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:43.960 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:21:43.961 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 08:21:43.962 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:21:43.964 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 08:21:43.967 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 17.5993ms
2025-09-17 08:21:44.057 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:21:44.069 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:21:44.072 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 105.765ms
2025-09-17 08:21:44.075 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:21:44.077 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 129.4259ms
2025-09-17 08:21:47.126 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/login - null null
2025-09-17 08:21:47.130 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:47.131 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/login - 204 null null 5.1483ms
2025-09-17 08:21:47.137 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/login - application/json 51
2025-09-17 08:21:47.141 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:47.142 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-09-17 08:21:47.148 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-17 08:21:47.192 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-09-17 08:21:47.445 +08:00 [INF] Executed DbCommand (20ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-17 08:21:47.464 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-17 08:21:47.468 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 316.9054ms
2025-09-17 08:21:47.470 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-09-17 08:21:47.471 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/login - 200 null application/json; charset=utf-8 333.7121ms
2025-09-17 08:21:47.520 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 08:21:47.521 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 08:21:47.527 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:47.531 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:47.532 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 12.1139ms
2025-09-17 08:21:47.534 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 12.5936ms
2025-09-17 08:21:47.541 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 08:21:47.546 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:21:47.551 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:47.556 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:47.675 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:47.682 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:21:47.684 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:21:47.707 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:21:47.733 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:21:47.739 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 50.5542ms
2025-09-17 08:21:47.746 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:21:47.750 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 209.0661ms
2025-09-17 08:21:47.758 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:47.769 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:21:47.774 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 08:21:47.815 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:21:47.825 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-17 08:21:47.850 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-17 08:21:47.860 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-17 08:21:47.908 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-17 08:21:47.944 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-17 08:21:47.960 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-17 08:21:47.973 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-17 08:21:47.984 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-17 08:21:47.996 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-17 08:21:48.004 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:21:48.021 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 240.8694ms
2025-09-17 08:21:48.024 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:21:48.025 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 478.906ms
2025-09-17 08:21:48.912 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:21:48.917 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:48.921 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:48.927 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:21:48.930 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 08:21:48.936 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:21:48.943 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-17 08:21:48.949 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-17 08:21:48.954 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-17 08:21:48.965 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-17 08:21:48.970 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-17 08:21:48.975 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-17 08:21:48.980 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-17 08:21:48.984 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-17 08:21:48.987 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-17 08:21:48.992 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:21:48.994 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 61.072ms
2025-09-17 08:21:48.996 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:21:48.998 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 86.4546ms
2025-09-17 08:21:49.005 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - null null
2025-09-17 08:21:49.009 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:49.010 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - 204 null null 5.002ms
2025-09-17 08:21:49.015 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-17 08:21:49.023 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:49.028 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:49.031 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-17 08:21:49.038 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:49.065 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-17 08:21:49.069 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:21:49.072 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 31.5277ms
2025-09-17 08:21:49.074 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-17 08:21:49.076 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 60.5941ms
2025-09-17 08:21:54.072 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - null null
2025-09-17 08:21:54.072 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/subscription-plans - null null
2025-09-17 08:21:54.076 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.078 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.080 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - 204 null null 7.908ms
2025-09-17 08:21:54.080 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/subscription-plans - 204 null null 8.4457ms
2025-09-17 08:21:54.085 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/subscription-plans - application/json null
2025-09-17 08:21:54.090 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users - application/json null
2025-09-17 08:21:54.094 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.097 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.100 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:54.101 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:54.105 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-09-17 08:21:54.107 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-17 08:21:54.112 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:54.119 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:54.133 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:21:54.148 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-09-17 08:21:54.154 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:21:54.156 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price, s0.id, s0.billing_cycle, s0.created_at, s0.end_date, s0.next_billing_date, s0.plan_name, s0.price, s0.start_date, s0.status, s0.stripe_subscription_id, s0.subscription_plan_id, s0.updated_at, s0.user_id
FROM subscription_plans AS s
LEFT JOIN subscriptions AS s0 ON s.id = s0.subscription_plan_id
ORDER BY s.id
2025-09-17 08:21:54.178 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 55.4196ms
2025-09-17 08:21:54.181 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-17 08:21:54.183 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users - 200 null application/json; charset=utf-8 93.2126ms
2025-09-17 08:21:54.210 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - null null
2025-09-17 08:21:54.217 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - null null
2025-09-17 08:21:54.217 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - null null
2025-09-17 08:21:54.218 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.220 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - null null
2025-09-17 08:21:54.221 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - null null
2025-09-17 08:21:54.228 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.230 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.232 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - 204 null null 22.2049ms
2025-09-17 08:21:54.239 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.243 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.244 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - 204 null null 27.2763ms
2025-09-17 08:21:54.246 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - 204 null null 29.3781ms
2025-09-17 08:21:54.251 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - null null
2025-09-17 08:21:54.253 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - 204 null null 32.8656ms
2025-09-17 08:21:54.256 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - 204 null null 34.249ms
2025-09-17 08:21:54.258 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:21:54.262 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - null null
2025-09-17 08:21:54.266 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - null null
2025-09-17 08:21:54.270 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.276 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - null null
2025-09-17 08:21:54.281 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - null null
2025-09-17 08:21:54.291 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.294 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.295 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - 204 null null 43.9054ms
2025-09-17 08:21:54.297 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 181.7213ms
2025-09-17 08:21:54.299 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.306 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.320 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - 204 null null 38.5698ms
2025-09-17 08:21:54.308 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - 204 null null 42.0836ms
2025-09-17 08:21:54.314 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - null null
2025-09-17 08:21:54.316 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-09-17 08:21:54.317 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - 204 null null 40.7847ms
2025-09-17 08:21:54.307 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - 204 null null 45.3962ms
2025-09-17 08:21:54.326 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - application/json null
2025-09-17 08:21:54.330 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - application/json null
2025-09-17 08:21:54.334 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.335 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/subscription-plans - 200 null application/json; charset=utf-8 250.582ms
2025-09-17 08:21:54.342 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - application/json null
2025-09-17 08:21:54.346 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - application/json null
2025-09-17 08:21:54.351 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.357 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.358 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - 204 null null 43.9004ms
2025-09-17 08:21:54.363 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - application/json null
2025-09-17 08:21:54.367 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.371 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.375 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:54.377 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:54.378 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - application/json null
2025-09-17 08:21:54.383 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.391 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.398 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.405 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.414 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:54.429 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.429 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:54.429 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:54.433 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:54.434 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:54.446 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.458 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:54.470 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:54.474 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.478 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:21:54.478 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:21:54.478 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:54.481 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:21:54.531 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__subscription_SubscriptionPlanId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price
FROM subscription_plans AS s
WHERE s.id = @__subscription_SubscriptionPlanId_0
LIMIT 1
2025-09-17 08:21:54.561 +08:00 [INF] Executed DbCommand (34ms) [Parameters=[@__subscription_SubscriptionPlanId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price
FROM subscription_plans AS s
WHERE s.id = @__subscription_SubscriptionPlanId_0
LIMIT 1
2025-09-17 08:21:54.599 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:54.599 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:21:54.609 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType112`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:21:54.613 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType113`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType114`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[CeceLearningPortal.Api.Models.SubscriptionStatus, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:21:54.617 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType113`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType114`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[CeceLearningPortal.Api.Models.SubscriptionStatus, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:21:54.646 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.718 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType112`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:21:54.725 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:21:54.790 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 328.9497ms
2025-09-17 08:21:54.798 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:54.800 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 345.8936ms
2025-09-17 08:21:54.807 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.807 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__subscription_SubscriptionPlanId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price
FROM subscription_plans AS s
WHERE s.id = @__subscription_SubscriptionPlanId_0
LIMIT 1
2025-09-17 08:21:54.809 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 367.3735ms
2025-09-17 08:21:54.809 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 358.8011ms
2025-09-17 08:21:54.835 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.814 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:21:54.823 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - 200 null application/json; charset=utf-8 444.2971ms
2025-09-17 08:21:54.828 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType113`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType114`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[CeceLearningPortal.Api.Models.SubscriptionStatus, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:21:54.832 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.812 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.840 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - 200 null application/json; charset=utf-8 509.837ms
2025-09-17 08:21:54.845 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__subscription_SubscriptionPlanId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price
FROM subscription_plans AS s
WHERE s.id = @__subscription_SubscriptionPlanId_0
LIMIT 1
2025-09-17 08:21:54.848 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - application/json null
2025-09-17 08:21:54.850 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 247.0636ms
2025-09-17 08:21:54.852 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - 200 null application/json; charset=utf-8 526.0405ms
2025-09-17 08:21:54.855 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - 200 null application/json; charset=utf-8 491.9093ms
2025-09-17 08:21:54.860 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - application/json null
2025-09-17 08:21:54.863 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType113`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType114`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[CeceLearningPortal.Api.Models.SubscriptionStatus, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:21:54.865 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.867 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.872 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - application/json null
2025-09-17 08:21:54.876 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - application/json null
2025-09-17 08:21:54.879 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.882 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 71.6716ms
2025-09-17 08:21:54.885 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - 200 null application/json; charset=utf-8 542.5189ms
2025-09-17 08:21:54.887 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:54.891 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.894 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.897 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.899 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:54.901 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - application/json null
2025-09-17 08:21:54.904 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.908 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - 200 null application/json; charset=utf-8 561.5405ms
2025-09-17 08:21:54.908 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:54.909 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:54.911 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.914 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:54.915 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:54.923 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.925 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.927 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:54.930 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:54.931 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:54.932 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:21:54.933 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:54.940 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.942 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:21:54.944 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:21:54.945 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType112`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:21:54.949 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:54.950 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:21:54.955 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType112`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:21:54.958 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType112`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:21:54.960 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 29.5392ms
2025-09-17 08:21:54.964 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:21:54.965 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType112`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:21:54.967 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 31.4358ms
2025-09-17 08:21:54.970 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 27.3636ms
2025-09-17 08:21:54.972 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.976 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType112`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:21:54.977 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 29.6ms
2025-09-17 08:21:54.979 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.981 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.982 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - 200 null application/json; charset=utf-8 134.276ms
2025-09-17 08:21:54.985 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 22.4469ms
2025-09-17 08:21:54.987 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.988 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - 200 null application/json; charset=utf-8 128.7102ms
2025-09-17 08:21:54.990 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - 200 null application/json; charset=utf-8 113.3116ms
2025-09-17 08:21:54.996 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:21:54.997 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - 200 null application/json; charset=utf-8 125.4753ms
2025-09-17 08:21:55.007 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - 200 null application/json; charset=utf-8 106.5279ms
2025-09-17 08:21:58.419 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses - null null
2025-09-17 08:21:58.422 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:58.424 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses - 204 null null 4.5154ms
2025-09-17 08:21:58.428 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/courses - application/json null
2025-09-17 08:21:58.431 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:21:58.437 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:21:58.440 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api)'
2025-09-17 08:21:58.444 +08:00 [INF] Route matched with {action = "GetCoursesForManagement", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCoursesForManagement(CeceLearningPortal.Api.DTOs.CourseManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:21:58.485 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id AS "Id", c0.title AS "Title", c0.description AS "Description", c0.instructor_id AS "InstructorId", a."FullName" AS "InstructorName", c0.price AS "Price", c0.category AS "Category", c0.level AS "Level", c0.status AS "Status", (
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c0.id = e.course_id) AS "StudentsCount", CASE
    WHEN EXISTS (
        SELECT 1
        FROM course_reviews AS c1
        WHERE c0.id = c1.course_id) THEN (
        SELECT avg(c2.rating::double precision)
        FROM course_reviews AS c2
        WHERE c0.id = c2.course_id)
    ELSE 0.0
END AS "AverageRating", (
    SELECT count(*)::int
    FROM enrollments AS e0
    WHERE c0.id = e0.course_id)::numeric * c0.price * 0.8 AS "TotalRevenue", c0.created_at AS "CreatedAt", c0.updated_at AS "UpdatedAt", c0.status = 'Draft' AS "NeedsReview", NULL AS "AdminNotes"
FROM (
    SELECT c.id, c.category, c.created_at, c.description, c.instructor_id, c.level, c.price, c.status, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
ORDER BY c0.created_at DESC
2025-09-17 08:21:58.491 +08:00 [INF] Admin API returning course 34 'SprintCourse' with status: Active (raw value: 2)
2025-09-17 08:21:58.492 +08:00 [INF] Admin API returning course 33 'MarathonCourse' with status: Active (raw value: 2)
2025-09-17 08:21:58.494 +08:00 [INF] Admin API returning course 28 'Social Media Marketing Mastery' with status: Active (raw value: 2)
2025-09-17 08:21:58.495 +08:00 [INF] Admin API returning course 25 'React Native Development' with status: Active (raw value: 2)
2025-09-17 08:21:58.496 +08:00 [INF] Admin API returning course 21 'Computer Vision Fundamentals' with status: Active (raw value: 2)
2025-09-17 08:21:58.497 +08:00 [INF] Admin API returning course 27 'SEO & Content Marketing Strategy' with status: Active (raw value: 2)
2025-09-17 08:21:58.499 +08:00 [INF] Admin API returning course 24 'Flutter & Dart Complete Guide' with status: Active (raw value: 2)
2025-09-17 08:21:58.500 +08:00 [INF] Admin API returning course 20 'Full Stack JavaScript Developer Path' with status: Active (raw value: 2)
2025-09-17 08:21:58.502 +08:00 [INF] Admin API returning course 29 'Draft Course: Machine Learning Fundamentals' with status: Draft (raw value: 0)
2025-09-17 08:21:58.503 +08:00 [INF] Admin API returning course 26 'Digital Marketing Fundamentals' with status: Active (raw value: 2)
2025-09-17 08:21:58.504 +08:00 [INF] Admin API returning course 23 'Android Development Masterclass' with status: Active (raw value: 2)
2025-09-17 08:21:58.505 +08:00 [INF] Admin API returning course 19 'Machine Learning with Python & TensorFlow' with status: Active (raw value: 2)
2025-09-17 08:21:58.507 +08:00 [INF] Admin API returning course 22 'iOS Development with Swift' with status: Active (raw value: 2)
2025-09-17 08:21:58.508 +08:00 [INF] Admin API returning course 18 'Advanced React & Redux Masterclass' with status: Active (raw value: 2)
2025-09-17 08:21:58.509 +08:00 [INF] Admin API returning course 17 'Complete Web Development Bootcamp 2025' with status: Active (raw value: 2)
2025-09-17 08:21:58.510 +08:00 [INF] Admin API returning course 31 'Inactive Course: Legacy PHP Development' with status: Inactive (raw value: 3)
2025-09-17 08:21:58.511 +08:00 [INF] Admin API returning course 30 'Draft Course: Blockchain Development' with status: Draft (raw value: 0)
2025-09-17 08:21:58.512 +08:00 [INF] Admin API returning course 32 'Inactive Course: Flash Game Development' with status: Inactive (raw value: 3)
2025-09-17 08:21:58.528 +08:00 [INF] First course serialized: {
  "Id": 34,
  "Title": "SprintCourse",
  "Description": "SprintCourseSprintCourseSprintCourseSprintCourse",
  "InstructorId": "bee889a2-efca-471d-807c-a7674a945612",
  "InstructorName": "Dr. Sarah Johnson",
  "Price": 0,
  "Category": "Programming",
  "Level": "Beginner",
  "Status": "Active",
  "StudentsCount": 1,
  "AverageRating": 0,
  "TotalRevenue": 0.0,
  "CreatedAt": "2025-08-02T06:28:56.498833Z",
  "UpdatedAt": "2025-08-02T06:30:19.291458Z",
  "NeedsReview": false,
  "AdminNotes": null
}
2025-09-17 08:21:58.530 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.AdminCourseManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:21:58.534 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api) in 86.5288ms
2025-09-17 08:21:58.537 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api)'
2025-09-17 08:21:58.539 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/courses - 200 null application/json; charset=utf-8 111.2308ms
2025-09-17 08:22:01.133 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/subscription-plans - null null
2025-09-17 08:22:01.137 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:01.138 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/subscription-plans - 204 null null 4.4459ms
2025-09-17 08:22:01.142 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/subscription-plans - application/json null
2025-09-17 08:22:01.146 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:01.151 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:22:01.155 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-09-17 08:22:01.157 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:22:01.164 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price, s0.id, s0.billing_cycle, s0.created_at, s0.end_date, s0.next_billing_date, s0.plan_name, s0.price, s0.start_date, s0.status, s0.stripe_subscription_id, s0.subscription_plan_id, s0.updated_at, s0.user_id
FROM subscription_plans AS s
LEFT JOIN subscriptions AS s0 ON s.id = s0.subscription_plan_id
ORDER BY s.id
2025-09-17 08:22:01.168 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:22:01.170 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 10.6421ms
2025-09-17 08:22:01.172 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-09-17 08:22:01.174 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/subscription-plans - 200 null application/json; charset=utf-8 31.9534ms
2025-09-17 08:22:01.968 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/policies - null null
2025-09-17 08:22:01.972 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:01.973 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/policies - 204 null null 5.0668ms
2025-09-17 08:22:01.978 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/policies - application/json null
2025-09-17 08:22:01.983 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:01.987 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:22:01.990 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetPolicies (CeceLearningPortal.Api)'
2025-09-17 08:22:01.996 +08:00 [INF] Route matched with {action = "GetPolicies", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPolicies() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:22:02.001 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Object[]'.
2025-09-17 08:22:02.008 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetPolicies (CeceLearningPortal.Api) in 7.7522ms
2025-09-17 08:22:02.010 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetPolicies (CeceLearningPortal.Api)'
2025-09-17 08:22:02.012 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/policies - 200 null application/json; charset=utf-8 33.9057ms
2025-09-17 08:22:03.816 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/tasks - null null
2025-09-17 08:22:03.819 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:03.820 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/tasks - 204 null null 4.2613ms
2025-09-17 08:22:03.824 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/tasks - application/json null
2025-09-17 08:22:03.827 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:03.830 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:22:03.833 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetTasks (CeceLearningPortal.Api)'
2025-09-17 08:22:03.838 +08:00 [INF] Route matched with {action = "GetTasks", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTasks(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:22:03.841 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Object[]'.
2025-09-17 08:22:03.846 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetTasks (CeceLearningPortal.Api) in 6.4654ms
2025-09-17 08:22:03.848 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetTasks (CeceLearningPortal.Api)'
2025-09-17 08:22:03.850 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/tasks - 200 null application/json; charset=utf-8 26.1949ms
2025-09-17 08:22:04.660 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/onboarding-progress - null null
2025-09-17 08:22:04.663 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:04.664 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/onboarding-progress - 204 null null 4.2034ms
2025-09-17 08:22:04.667 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/onboarding-progress - application/json null
2025-09-17 08:22:04.670 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:04.674 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:22:04.677 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetOnboardingProgress (CeceLearningPortal.Api)'
2025-09-17 08:22:04.682 +08:00 [INF] Route matched with {action = "GetOnboardingProgress", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetOnboardingProgress() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:22:04.688 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:22:04.698 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
WHERE a."FullName" <> ''
2025-09-17 08:22:04.705 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
WHERE EXISTS (
    SELECT 1
    FROM enrollments AS e
    WHERE a."Id" = e.student_id)
2025-09-17 08:22:04.714 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
WHERE EXISTS (
    SELECT 1
    FROM enrollments AS e
    WHERE a."Id" = e.student_id AND e.certificate_issued)
2025-09-17 08:22:04.717 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`4[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]][]'.
2025-09-17 08:22:04.721 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetOnboardingProgress (CeceLearningPortal.Api) in 35.9627ms
2025-09-17 08:22:04.723 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetOnboardingProgress (CeceLearningPortal.Api)'
2025-09-17 08:22:04.725 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/onboarding-progress - 200 null application/json; charset=utf-8 57.4808ms
2025-09-17 08:22:07.184 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/team-members - null null
2025-09-17 08:22:07.188 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:07.189 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/team-members - 204 null null 5.389ms
2025-09-17 08:22:07.197 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/team-members - application/json null
2025-09-17 08:22:07.201 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:07.204 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:22:07.209 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetTeamMembers (CeceLearningPortal.Api)'
2025-09-17 08:22:07.214 +08:00 [INF] Route matched with {action = "GetTeamMembers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTeamMembers() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:22:07.235 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."FullName", a."Email", CASE
    WHEN a."LastLoginAt" > now() + INTERVAL '-30 mins' THEN 'Online'
    WHEN a."LastLoginAt" > now() + INTERVAL '-1 hours' THEN 'Away'
    ELSE 'Offline'
END, COALESCE(a."LastLoginAt", a."CreatedAt"), a."Avatar"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Admin'
2025-09-17 08:22:07.241 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType17`10[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String[], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:22:07.246 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetTeamMembers (CeceLearningPortal.Api) in 28.8133ms
2025-09-17 08:22:07.248 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetTeamMembers (CeceLearningPortal.Api)'
2025-09-17 08:22:07.250 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/team-members - 200 null application/json; charset=utf-8 52.7742ms
2025-09-17 08:22:13.573 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - null null
2025-09-17 08:22:13.576 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:13.578 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - 204 null null 5.0513ms
2025-09-17 08:22:13.583 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users - application/json null
2025-09-17 08:22:13.588 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:13.591 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:22:13.594 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-17 08:22:13.596 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:22:13.603 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:22:13.608 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-09-17 08:22:13.611 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:22:13.614 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 13.6048ms
2025-09-17 08:22:13.617 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-17 08:22:13.620 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users - 200 null application/json; charset=utf-8 37.0617ms
2025-09-17 08:22:13.626 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 08:22:13.629 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:13.631 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 5.2655ms
2025-09-17 08:22:13.636 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 08:22:13.640 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:13.642 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:22:13.646 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:22:13.648 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:22:13.664 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:22:13.672 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:22:13.675 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 23.6025ms
2025-09-17 08:22:13.678 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:22:13.680 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 43.6337ms
2025-09-17 08:22:13.688 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 08:22:13.692 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:13.694 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 5.5174ms
2025-09-17 08:22:13.698 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:22:13.703 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:13.706 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:22:13.710 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:22:13.712 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 08:22:13.717 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:22:13.724 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-17 08:22:13.731 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-17 08:22:13.738 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-17 08:22:13.750 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-17 08:22:13.759 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-17 08:22:13.766 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-17 08:22:13.773 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-17 08:22:13.778 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-17 08:22:13.784 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-17 08:22:13.789 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:22:13.792 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 77.7158ms
2025-09-17 08:22:13.794 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:22:13.796 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:22:13.802 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:13.805 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 106.4106ms
2025-09-17 08:22:13.808 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:22:13.814 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:22:13.815 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 08:22:13.823 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:22:13.828 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-17 08:22:13.837 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-17 08:22:13.841 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-17 08:22:13.876 +08:00 [INF] Executed DbCommand (18ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-17 08:22:13.888 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-17 08:22:13.898 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-17 08:22:13.906 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-17 08:22:13.913 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-17 08:22:13.921 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-17 08:22:13.925 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:22:13.929 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 107.1023ms
2025-09-17 08:22:13.932 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:22:13.935 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 140.9729ms
2025-09-17 08:22:13.956 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - null null
2025-09-17 08:22:13.957 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - null null
2025-09-17 08:22:13.957 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - null null
2025-09-17 08:22:13.958 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - null null
2025-09-17 08:22:13.958 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 08:22:13.989 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:13.967 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:13.976 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:13.983 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:13.962 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:13.991 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 32.1637ms
2025-09-17 08:22:13.992 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 204 null null 34.7805ms
2025-09-17 08:22:13.993 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 204 null null 36.3918ms
2025-09-17 08:22:13.995 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 204 null null 37.2969ms
2025-09-17 08:22:14.003 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 204 null null 46.6483ms
2025-09-17 08:22:14.008 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - application/json null
2025-09-17 08:22:14.012 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - application/json null
2025-09-17 08:22:14.018 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 08:22:14.022 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - application/json null
2025-09-17 08:22:14.026 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - application/json null
2025-09-17 08:22:14.051 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:14.121 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:14.126 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:14.130 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:14.137 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:22:14.149 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:22:14.155 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:22:14.156 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:22:14.158 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:22:14.159 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:22:14.161 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:22:14.164 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:22:14.168 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:22:14.171 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:22:14.175 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:22:14.176 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:22:14.178 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:22:14.180 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:22:14.182 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:22:14.202 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:22:14.184 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:22:14.202 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:22:14.202 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:22:14.209 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:22:14.211 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:22:14.221 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:22:14.226 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:22:14.231 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:22:14.235 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 44.9734ms
2025-09-17 08:22:14.237 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:22:14.242 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 47.8152ms
2025-09-17 08:22:14.244 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:22:14.245 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 57.5348ms
2025-09-17 08:22:14.247 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:22:14.250 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 47.311ms
2025-09-17 08:22:14.252 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:22:14.254 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 43.0256ms
2025-09-17 08:22:14.256 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:22:14.257 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 200 null application/json; charset=utf-8 245.3022ms
2025-09-17 08:22:14.259 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:22:14.261 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 243.5794ms
2025-09-17 08:22:14.263 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:22:14.265 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 200 null application/json; charset=utf-8 257.4634ms
2025-09-17 08:22:14.272 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 200 null application/json; charset=utf-8 250.062ms
2025-09-17 08:22:14.278 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 200 null application/json; charset=utf-8 252.1154ms
2025-09-17 08:22:49.441 +08:00 [INF] Application is shutting down...
2025-09-17 08:46:12.865 +08:00 [INF] Checking database connection...
2025-09-17 08:46:14.551 +08:00 [INF] Database connection successful.
2025-09-17 08:46:14.555 +08:00 [INF] Attempting to apply migrations...
2025-09-17 08:46:14.716 +08:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-17 08:46:15.136 +08:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-09-17 08:46:15.157 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-09-17 08:46:15.161 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-17 08:46:15.170 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-09-17 08:46:15.182 +08:00 [INF] Migrations applied successfully.
2025-09-17 08:46:15.184 +08:00 [INF] Starting data seeding...
2025-09-17 08:46:15.207 +08:00 [INF] User profile is available. Using 'C:\Users\Win11\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-17 08:46:15.433 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM courses AS c)
2025-09-17 08:46:15.445 +08:00 [INF] Database already contains data. Checking if data cleanup is needed...
2025-09-17 08:46:15.446 +08:00 [INF] Checking for missing data components...
2025-09-17 08:46:15.452 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM subscriptions AS s)
2025-09-17 08:46:15.456 +08:00 [INF] Data seeding completed.
2025-09-17 08:46:15.575 +08:00 [INF] Now listening on: http://localhost:5296
2025-09-17 08:46:15.577 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-17 08:46:15.578 +08:00 [INF] Hosting environment: Development
2025-09-17 08:46:15.580 +08:00 [INF] Content root path: C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-09-17 08:46:21.238 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - null null
2025-09-17 08:46:21.349 +08:00 [WRN] Failed to determine the https port for redirect.
2025-09-17 08:46:21.354 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:21.374 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - 204 null null 138.5924ms
2025-09-17 08:46:24.091 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 08:46:24.163 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:24.167 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 75.6429ms
2025-09-17 08:46:24.175 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 08:46:24.180 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users - application/json null
2025-09-17 08:46:24.198 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:24.201 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:24.465 +08:00 [INF] Executed DbCommand (15ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:24.472 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:24.493 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:24.501 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-17 08:46:24.503 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:46:24.517 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:46:24.625 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:46:24.663 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-09-17 08:46:24.686 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:24.753 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 229.2366ms
2025-09-17 08:46:24.756 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-17 08:46:24.766 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users - 200 null application/json; charset=utf-8 585.7173ms
2025-09-17 08:46:24.774 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-17 08:46:24.859 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:46:25.176 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:25.200 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 693.337ms
2025-09-17 08:46:25.202 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:25.203 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 08:46:25.204 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 1029.1948ms
2025-09-17 08:46:25.207 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.216 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 08:46:25.220 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.222 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 6.2999ms
2025-09-17 08:46:25.223 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:25.230 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:46:25.234 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:25.238 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.239 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:46:25.246 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:25.255 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:25.263 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:46:25.267 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 08:46:25.288 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:46:25.304 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:25.319 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-17 08:46:25.321 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 74.6872ms
2025-09-17 08:46:25.345 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:25.349 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 146.4232ms
2025-09-17 08:46:25.386 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-17 08:46:25.400 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-17 08:46:25.454 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-17 08:46:25.496 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-17 08:46:25.517 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-17 08:46:25.532 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-17 08:46:25.547 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-17 08:46:25.558 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-17 08:46:25.566 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:46:25.589 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 306.948ms
2025-09-17 08:46:25.591 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:46:25.592 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:25.596 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.598 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 368.4848ms
2025-09-17 08:46:25.603 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:25.610 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:25.612 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 08:46:25.618 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:46:25.622 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-17 08:46:25.627 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-17 08:46:25.635 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-17 08:46:25.644 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-17 08:46:25.650 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-17 08:46:25.655 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-17 08:46:25.661 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-17 08:46:25.666 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-17 08:46:25.671 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-17 08:46:25.675 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:46:25.679 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 63.3431ms
2025-09-17 08:46:25.680 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:46:25.681 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:25.686 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.688 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 97.6038ms
2025-09-17 08:46:25.739 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - null null
2025-09-17 08:46:25.739 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - null null
2025-09-17 08:46:25.740 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - null null
2025-09-17 08:46:25.740 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 08:46:25.742 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:25.743 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - null null
2025-09-17 08:46:25.748 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.752 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.757 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.760 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.764 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:25.767 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.768 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 204 null null 29.0147ms
2025-09-17 08:46:25.769 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 204 null null 30.0108ms
2025-09-17 08:46:25.771 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 204 null null 31.4862ms
2025-09-17 08:46:25.773 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 33.3289ms
2025-09-17 08:46:25.776 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 08:46:25.778 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 204 null null 34.9235ms
2025-09-17 08:46:25.783 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - application/json null
2025-09-17 08:46:25.789 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - application/json null
2025-09-17 08:46:25.794 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - application/json null
2025-09-17 08:46:25.798 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - application/json null
2025-09-17 08:46:25.803 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:46:25.806 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 08:46:25.809 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.813 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.816 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.820 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.824 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-17 08:46:25.826 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:25.835 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:25.836 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-17 08:46:25.839 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:25.845 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-17 08:46:25.847 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:46:25.856 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-17 08:46:25.927 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:25.928 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:46:25.966 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:25.982 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:25.987 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:25.998 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:25.998 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-17 08:46:26.019 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.022 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.026 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:26.027 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.028 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:46:26.033 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:46:26.034 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:46:26.035 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-17 08:46:26.037 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 123.9918ms
2025-09-17 08:46:26.038 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:46:26.051 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.053 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:46:26.057 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 200 null application/json; charset=utf-8 262.791ms
2025-09-17 08:46:26.072 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-17 08:46:26.072 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:46:26.078 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:46:26.087 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-17 08:46:26.088 +08:00 [INF] Executed DbCommand (43ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:46:26.089 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:26.101 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:26.103 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-17 08:46:26.105 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:26.106 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 60.5764ms
2025-09-17 08:46:26.111 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 70.4962ms
2025-09-17 08:46:26.114 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:46:26.116 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:26.117 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 62.1431ms
2025-09-17 08:46:26.118 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.120 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.123 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 321.8064ms
2025-09-17 08:46:26.124 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:46:26.128 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 84.3675ms
2025-09-17 08:46:26.129 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.131 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 325.5187ms
2025-09-17 08:46:26.133 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 200 null application/json; charset=utf-8 349.8965ms
2025-09-17 08:46:26.136 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:26.139 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:26.143 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.145 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 200 null application/json; charset=utf-8 355.3927ms
2025-09-17 08:46:26.155 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 475.1358ms
2025-09-17 08:46:26.160 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 200 null application/json; charset=utf-8 361.3295ms
2025-09-17 08:46:26.162 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:26.182 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:26.184 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 08:46:26.192 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:46:26.199 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-17 08:46:26.202 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-17 08:46:26.208 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-17 08:46:26.230 +08:00 [INF] Executed DbCommand (17ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-17 08:46:26.238 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-17 08:46:26.253 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-17 08:46:26.263 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-17 08:46:26.268 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-17 08:46:26.276 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-17 08:46:26.279 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:46:26.282 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 94.4442ms
2025-09-17 08:46:26.285 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:26.287 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 162.9537ms
2025-09-17 08:46:26.298 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - application/json null
2025-09-17 08:46:26.300 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - application/json null
2025-09-17 08:46:26.300 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - application/json null
2025-09-17 08:46:26.301 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - application/json null
2025-09-17 08:46:26.302 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 08:46:26.305 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:26.310 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:26.314 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:26.317 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:26.320 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:26.325 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:26.327 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:26.329 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:26.332 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:26.333 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:26.335 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.338 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.341 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.345 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.350 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.351 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:46:26.353 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:46:26.355 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:46:26.357 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:46:26.359 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:46:26.374 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:46:26.376 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:46:26.377 +08:00 [INF] Executed DbCommand (13ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:46:26.386 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:46:26.395 +08:00 [INF] Executed DbCommand (17ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:46:26.403 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:26.409 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:26.416 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:26.418 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 52.3686ms
2025-09-17 08:46:26.419 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:26.420 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 51.6107ms
2025-09-17 08:46:26.423 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 61.0416ms
2025-09-17 08:46:26.425 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:26.427 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.429 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 51.5337ms
2025-09-17 08:46:26.431 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.433 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.435 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 64.4988ms
2025-09-17 08:46:26.436 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 200 null application/json; charset=utf-8 136.8296ms
2025-09-17 08:46:26.438 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.440 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 200 null application/json; charset=utf-8 139.4299ms
2025-09-17 08:46:26.444 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 200 null application/json; charset=utf-8 145.7245ms
2025-09-17 08:46:26.446 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:26.452 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 149.8473ms
2025-09-17 08:46:26.462 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 200 null application/json; charset=utf-8 161.3754ms
2025-09-17 08:46:27.667 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 08:46:27.669 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:46:27.676 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:27.681 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:27.688 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:27.688 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:27.691 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:27.695 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:27.696 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:46:27.698 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 08:46:27.706 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:46:27.706 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:46:27.712 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-17 08:46:27.719 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-17 08:46:27.725 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-17 08:46:27.727 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:27.732 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 31.4333ms
2025-09-17 08:46:27.736 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-17 08:46:27.735 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:27.744 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 77.2897ms
2025-09-17 08:46:27.747 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-17 08:46:27.754 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-17 08:46:27.761 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-17 08:46:27.768 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-17 08:46:27.773 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-17 08:46:27.777 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:46:27.779 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 75.4487ms
2025-09-17 08:46:27.781 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:27.783 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 114.3424ms
2025-09-17 08:46:33.888 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 08:46:33.893 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:33.895 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 6.7552ms
2025-09-17 08:46:33.904 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:46:33.909 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:33.914 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:33.918 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:33.921 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 08:46:33.926 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:46:33.929 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-17 08:46:33.933 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-17 08:46:33.937 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-17 08:46:33.942 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-17 08:46:33.947 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-17 08:46:33.951 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-17 08:46:33.956 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-17 08:46:33.960 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-17 08:46:33.964 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-17 08:46:33.967 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:46:33.971 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 46.5653ms
2025-09-17 08:46:33.973 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:33.975 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 70.8243ms
2025-09-17 08:46:33.979 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - null null
2025-09-17 08:46:33.983 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:33.985 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - 204 null null 5.5827ms
2025-09-17 08:46:33.990 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-17 08:46:33.994 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:33.997 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:34.004 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-17 08:46:34.011 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:46:34.052 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-17 08:46:34.055 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:34.059 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 45.2512ms
2025-09-17 08:46:34.061 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-17 08:46:34.063 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 72.904ms
2025-09-17 08:46:38.787 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 08:46:38.787 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:46:38.807 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:38.810 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:38.813 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 25.4727ms
2025-09-17 08:46:38.821 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:38.822 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 08:46:38.825 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:38.828 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:38.830 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 08:46:38.834 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:38.835 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:46:38.837 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:38.841 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-17 08:46:38.842 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:46:38.846 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-17 08:46:38.853 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:46:38.853 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-17 08:46:38.865 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:38.866 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-17 08:46:38.868 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 21.5141ms
2025-09-17 08:46:38.875 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:46:38.875 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-17 08:46:38.877 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 54.3287ms
2025-09-17 08:46:38.884 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-17 08:46:38.893 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-17 08:46:38.910 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-17 08:46:38.922 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-17 08:46:38.934 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:46:38.940 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 106.1731ms
2025-09-17 08:46:38.942 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:38.943 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 155.9434ms
2025-09-17 08:46:54.236 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 08:46:54.240 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:54.241 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 4.734ms
2025-09-17 08:46:54.247 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:46:54.251 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:54.253 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:54.258 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:54.259 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 08:46:54.263 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:46:54.267 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-17 08:46:54.273 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-17 08:46:54.277 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-17 08:46:54.286 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-17 08:46:54.292 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-17 08:46:54.297 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-17 08:46:54.302 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-17 08:46:54.307 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-17 08:46:54.311 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-17 08:46:54.316 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:46:54.320 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 58.1545ms
2025-09-17 08:46:54.324 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:46:54.325 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 78.578ms
2025-09-17 08:46:54.334 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - null null
2025-09-17 08:46:54.338 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:54.339 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - 204 null null 4.4464ms
2025-09-17 08:46:54.346 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-17 08:46:54.353 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:46:54.356 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:46:54.358 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-17 08:46:54.360 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:46:54.369 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-17 08:46:54.372 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:46:54.374 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 11.5544ms
2025-09-17 08:46:54.376 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-17 08:46:54.377 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 31.7409ms
2025-09-17 08:47:40.989 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - null null
2025-09-17 08:47:40.990 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/subscription-plans - null null
2025-09-17 08:47:40.994 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:40.995 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:40.996 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - 204 null null 7.1733ms
2025-09-17 08:47:40.997 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/subscription-plans - 204 null null 7.6844ms
2025-09-17 08:47:41.002 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/subscription-plans - application/json null
2025-09-17 08:47:41.007 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users - application/json null
2025-09-17 08:47:41.010 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.013 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.015 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:41.015 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:41.017 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-09-17 08:47:41.019 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-17 08:47:41.022 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:41.025 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:41.027 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:47:41.031 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-09-17 08:47:41.033 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:47:41.034 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 8.1779ms
2025-09-17 08:47:41.038 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-17 08:47:41.040 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users - 200 null application/json; charset=utf-8 32.5912ms
2025-09-17 08:47:41.056 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price, s0.id, s0.billing_cycle, s0.created_at, s0.end_date, s0.next_billing_date, s0.plan_name, s0.price, s0.start_date, s0.status, s0.stripe_subscription_id, s0.subscription_plan_id, s0.updated_at, s0.user_id
FROM subscription_plans AS s
LEFT JOIN subscriptions AS s0 ON s.id = s0.subscription_plan_id
ORDER BY s.id
2025-09-17 08:47:41.061 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - null null
2025-09-17 08:47:41.064 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - null null
2025-09-17 08:47:41.064 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - null null
2025-09-17 08:47:41.064 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.065 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - null null
2025-09-17 08:47:41.065 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - null null
2025-09-17 08:47:41.085 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.074 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.076 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - 204 null null 14.8873ms
2025-09-17 08:47:41.081 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.072 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.087 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - 204 null null 21.2744ms
2025-09-17 08:47:41.088 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - 204 null null 23.6812ms
2025-09-17 08:47:41.094 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - null null
2025-09-17 08:47:41.095 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - 204 null null 29.9351ms
2025-09-17 08:47:41.096 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - 204 null null 32.8696ms
2025-09-17 08:47:41.103 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - null null
2025-09-17 08:47:41.107 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - null null
2025-09-17 08:47:41.110 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.113 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - null null
2025-09-17 08:47:41.126 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.119 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.122 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.123 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - 204 null null 29.3759ms
2025-09-17 08:47:41.116 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - null null
2025-09-17 08:47:41.129 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - 204 null null 15.2605ms
2025-09-17 08:47:41.129 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - 204 null null 26.7311ms
2025-09-17 08:47:41.131 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - 204 null null 22.9738ms
2025-09-17 08:47:41.138 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - null null
2025-09-17 08:47:41.140 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.144 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - application/json null
2025-09-17 08:47:41.146 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - application/json null
2025-09-17 08:47:41.149 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - application/json null
2025-09-17 08:47:41.150 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:47:41.153 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.154 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - 204 null null 38.7439ms
2025-09-17 08:47:41.157 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.161 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.163 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.165 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - 204 null null 27.2306ms
2025-09-17 08:47:41.171 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - application/json null
2025-09-17 08:47:41.174 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:41.174 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:41.175 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:41.176 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 147.5389ms
2025-09-17 08:47:41.177 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - application/json null
2025-09-17 08:47:41.180 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.181 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.183 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.186 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.187 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-09-17 08:47:41.189 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.193 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:41.196 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/subscription-plans - 200 null application/json; charset=utf-8 193.6493ms
2025-09-17 08:47:41.196 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:41.197 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:41.198 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:41.199 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:41.199 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.203 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - application/json null
2025-09-17 08:47:41.213 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.214 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:41.217 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.219 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:41.225 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:41.227 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.228 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:41.237 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:47:41.238 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:47:41.238 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:47:41.238 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:47:41.238 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:47:41.238 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:47:41.254 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__subscription_SubscriptionPlanId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price
FROM subscription_plans AS s
WHERE s.id = @__subscription_SubscriptionPlanId_0
LIMIT 1
2025-09-17 08:47:41.241 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType113`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:47:41.250 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType113`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:47:41.254 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__subscription_SubscriptionPlanId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price
FROM subscription_plans AS s
WHERE s.id = @__subscription_SubscriptionPlanId_0
LIMIT 1
2025-09-17 08:47:41.255 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__subscription_SubscriptionPlanId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price
FROM subscription_plans AS s
WHERE s.id = @__subscription_SubscriptionPlanId_0
LIMIT 1
2025-09-17 08:47:41.257 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__subscription_SubscriptionPlanId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price
FROM subscription_plans AS s
WHERE s.id = @__subscription_SubscriptionPlanId_0
LIMIT 1
2025-09-17 08:47:41.259 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType114`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType115`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[CeceLearningPortal.Api.Models.SubscriptionStatus, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:47:41.262 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 31.2778ms
2025-09-17 08:47:41.262 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 54.9794ms
2025-09-17 08:47:41.264 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType114`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType115`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[CeceLearningPortal.Api.Models.SubscriptionStatus, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:47:41.267 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType114`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType115`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[CeceLearningPortal.Api.Models.SubscriptionStatus, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:47:41.270 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType114`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType115`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[CeceLearningPortal.Api.Models.SubscriptionStatus, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:47:41.274 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.276 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.283 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - 200 null application/json; charset=utf-8 79.5944ms
2025-09-17 08:47:41.285 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 74.969ms
2025-09-17 08:47:41.285 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 80.616ms
2025-09-17 08:47:41.285 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 63.6958ms
2025-09-17 08:47:41.286 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 60.3167ms
2025-09-17 08:47:41.286 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - 200 null application/json; charset=utf-8 139.9625ms
2025-09-17 08:47:41.291 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - application/json null
2025-09-17 08:47:41.293 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.295 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.296 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.297 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.301 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - application/json null
2025-09-17 08:47:41.304 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.305 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - 200 null application/json; charset=utf-8 156.3263ms
2025-09-17 08:47:41.307 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - 200 null application/json; charset=utf-8 163.1163ms
2025-09-17 08:47:41.308 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - 200 null application/json; charset=utf-8 137.0876ms
2025-09-17 08:47:41.309 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - 200 null application/json; charset=utf-8 132.0981ms
2025-09-17 08:47:41.312 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.314 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:41.316 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - application/json null
2025-09-17 08:47:41.319 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - application/json null
2025-09-17 08:47:41.322 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - application/json null
2025-09-17 08:47:41.327 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:41.327 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.330 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.332 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.335 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:41.337 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.338 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:41.341 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:41.342 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:41.342 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:41.342 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:41.345 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:47:41.346 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.348 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.351 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:47:41.352 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.355 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType113`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:47:41.356 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:41.357 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:41.364 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:47:41.360 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:41.361 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 17.1443ms
2025-09-17 08:47:41.359 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType113`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:47:41.366 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:47:41.366 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType113`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:47:41.370 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.370 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-17 08:47:41.372 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 22.58ms
2025-09-17 08:47:41.375 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType113`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:47:41.376 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 13.4087ms
2025-09-17 08:47:41.377 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - 200 null application/json; charset=utf-8 85.9614ms
2025-09-17 08:47:41.379 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType113`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:47:41.381 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.382 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 17.5231ms
2025-09-17 08:47:41.383 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.388 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 19.8766ms
2025-09-17 08:47:41.389 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - 200 null application/json; charset=utf-8 88.2766ms
2025-09-17 08:47:41.391 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.392 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - 200 null application/json; charset=utf-8 76.1297ms
2025-09-17 08:47:41.394 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-17 08:47:41.397 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - 200 null application/json; charset=utf-8 77.7721ms
2025-09-17 08:47:41.401 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - 200 null application/json; charset=utf-8 78.8444ms
2025-09-17 08:47:43.108 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses - null null
2025-09-17 08:47:43.113 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:43.115 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses - 204 null null 6.884ms
2025-09-17 08:47:43.121 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/courses - application/json null
2025-09-17 08:47:43.124 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:43.126 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:43.128 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api)'
2025-09-17 08:47:43.132 +08:00 [INF] Route matched with {action = "GetCoursesForManagement", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCoursesForManagement(CeceLearningPortal.Api.DTOs.CourseManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:43.163 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id AS "Id", c0.title AS "Title", c0.description AS "Description", c0.instructor_id AS "InstructorId", a."FullName" AS "InstructorName", c0.price AS "Price", c0.category AS "Category", c0.level AS "Level", c0.status AS "Status", (
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c0.id = e.course_id) AS "StudentsCount", CASE
    WHEN EXISTS (
        SELECT 1
        FROM course_reviews AS c1
        WHERE c0.id = c1.course_id) THEN (
        SELECT avg(c2.rating::double precision)
        FROM course_reviews AS c2
        WHERE c0.id = c2.course_id)
    ELSE 0.0
END AS "AverageRating", (
    SELECT count(*)::int
    FROM enrollments AS e0
    WHERE c0.id = e0.course_id)::numeric * c0.price * 0.8 AS "TotalRevenue", c0.created_at AS "CreatedAt", c0.updated_at AS "UpdatedAt", c0.status = 'Draft' AS "NeedsReview", NULL AS "AdminNotes"
FROM (
    SELECT c.id, c.category, c.created_at, c.description, c.instructor_id, c.level, c.price, c.status, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
ORDER BY c0.created_at DESC
2025-09-17 08:47:43.172 +08:00 [INF] Admin API returning course 34 'SprintCourse' with status: Active (raw value: 2)
2025-09-17 08:47:43.173 +08:00 [INF] Admin API returning course 33 'MarathonCourse' with status: Active (raw value: 2)
2025-09-17 08:47:43.174 +08:00 [INF] Admin API returning course 28 'Social Media Marketing Mastery' with status: Active (raw value: 2)
2025-09-17 08:47:43.175 +08:00 [INF] Admin API returning course 25 'React Native Development' with status: Active (raw value: 2)
2025-09-17 08:47:43.175 +08:00 [INF] Admin API returning course 21 'Computer Vision Fundamentals' with status: Active (raw value: 2)
2025-09-17 08:47:43.176 +08:00 [INF] Admin API returning course 27 'SEO & Content Marketing Strategy' with status: Active (raw value: 2)
2025-09-17 08:47:43.177 +08:00 [INF] Admin API returning course 24 'Flutter & Dart Complete Guide' with status: Active (raw value: 2)
2025-09-17 08:47:43.177 +08:00 [INF] Admin API returning course 20 'Full Stack JavaScript Developer Path' with status: Active (raw value: 2)
2025-09-17 08:47:43.178 +08:00 [INF] Admin API returning course 29 'Draft Course: Machine Learning Fundamentals' with status: Draft (raw value: 0)
2025-09-17 08:47:43.178 +08:00 [INF] Admin API returning course 26 'Digital Marketing Fundamentals' with status: Active (raw value: 2)
2025-09-17 08:47:43.179 +08:00 [INF] Admin API returning course 23 'Android Development Masterclass' with status: Active (raw value: 2)
2025-09-17 08:47:43.179 +08:00 [INF] Admin API returning course 19 'Machine Learning with Python & TensorFlow' with status: Active (raw value: 2)
2025-09-17 08:47:43.180 +08:00 [INF] Admin API returning course 22 'iOS Development with Swift' with status: Active (raw value: 2)
2025-09-17 08:47:43.181 +08:00 [INF] Admin API returning course 18 'Advanced React & Redux Masterclass' with status: Active (raw value: 2)
2025-09-17 08:47:43.181 +08:00 [INF] Admin API returning course 17 'Complete Web Development Bootcamp 2025' with status: Active (raw value: 2)
2025-09-17 08:47:43.183 +08:00 [INF] Admin API returning course 31 'Inactive Course: Legacy PHP Development' with status: Inactive (raw value: 3)
2025-09-17 08:47:43.184 +08:00 [INF] Admin API returning course 30 'Draft Course: Blockchain Development' with status: Draft (raw value: 0)
2025-09-17 08:47:43.184 +08:00 [INF] Admin API returning course 32 'Inactive Course: Flash Game Development' with status: Inactive (raw value: 3)
2025-09-17 08:47:43.197 +08:00 [INF] First course serialized: {
  "Id": 34,
  "Title": "SprintCourse",
  "Description": "SprintCourseSprintCourseSprintCourseSprintCourse",
  "InstructorId": "bee889a2-efca-471d-807c-a7674a945612",
  "InstructorName": "Dr. Sarah Johnson",
  "Price": 0,
  "Category": "Programming",
  "Level": "Beginner",
  "Status": "Active",
  "StudentsCount": 1,
  "AverageRating": 0,
  "TotalRevenue": 0.0,
  "CreatedAt": "2025-08-02T06:28:56.498833Z",
  "UpdatedAt": "2025-08-02T06:30:19.291458Z",
  "NeedsReview": false,
  "AdminNotes": null
}
2025-09-17 08:47:43.200 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.AdminCourseManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:47:43.205 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api) in 69.6946ms
2025-09-17 08:47:43.207 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api)'
2025-09-17 08:47:43.208 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/courses - 200 null application/json; charset=utf-8 86.9339ms
2025-09-17 08:47:45.202 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/subscription-plans - application/json null
2025-09-17 08:47:45.205 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:45.207 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:45.209 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-09-17 08:47:45.210 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:45.217 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price, s0.id, s0.billing_cycle, s0.created_at, s0.end_date, s0.next_billing_date, s0.plan_name, s0.price, s0.start_date, s0.status, s0.stripe_subscription_id, s0.subscription_plan_id, s0.updated_at, s0.user_id
FROM subscription_plans AS s
LEFT JOIN subscriptions AS s0 ON s.id = s0.subscription_plan_id
ORDER BY s.id
2025-09-17 08:47:45.220 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:47:45.223 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 10.092ms
2025-09-17 08:47:45.225 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-09-17 08:47:45.226 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/subscription-plans - 200 null application/json; charset=utf-8 24.5371ms
2025-09-17 08:47:47.745 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 08:47:47.748 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:47.749 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 4.36ms
2025-09-17 08:47:47.754 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:47:47.758 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:47.764 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:47.768 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:47:47.769 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 08:47:47.773 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-17 08:47:47.778 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-17 08:47:47.783 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-17 08:47:47.882 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-17 08:47:47.890 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-17 08:47:47.918 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-17 08:47:47.923 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-17 08:47:47.927 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-17 08:47:47.933 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-17 08:47:47.939 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-17 08:47:47.942 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:47:47.945 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 172.8786ms
2025-09-17 08:47:47.948 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-17 08:47:47.950 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 195.7382ms
2025-09-17 08:47:47.957 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - null null
2025-09-17 08:47:47.960 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:47.964 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - 204 null null 7.037ms
2025-09-17 08:47:47.969 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-17 08:47:47.975 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:47.980 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:47.983 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-17 08:47:47.985 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-17 08:47:47.989 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-17 08:47:47.993 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:47:47.995 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 8.1985ms
2025-09-17 08:47:48.001 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-17 08:47:48.003 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 33.5117ms
2025-09-17 08:47:51.202 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/logout - null null
2025-09-17 08:47:51.204 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:51.205 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/logout - 204 null null 3.304ms
2025-09-17 08:47:51.210 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/logout - application/json 0
2025-09-17 08:47:51.216 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:51.218 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:51.221 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-09-17 08:47:51.223 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-17 08:47:51.248 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-17 08:47:51.337 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET revoked_at = @p0
WHERE id = @p1;
UPDATE refresh_tokens SET revoked_at = @p2
WHERE id = @p3;
2025-09-17 08:47:51.347 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 08:47:51.350 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 122.0804ms
2025-09-17 08:47:51.352 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-09-17 08:47:51.354 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/logout - 200 null application/json; charset=utf-8 144.003ms
2025-09-17 08:47:57.401 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/login - null null
2025-09-17 08:47:57.405 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:57.406 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/login - 204 null null 4.3494ms
2025-09-17 08:47:57.409 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/login - application/json 61
2025-09-17 08:47:57.413 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:57.415 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-09-17 08:47:57.420 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-17 08:47:57.447 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-09-17 08:47:57.568 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-17 08:47:57.584 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-17 08:47:57.588 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 165.4027ms
2025-09-17 08:47:57.590 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-09-17 08:47:57.591 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/login - 200 null application/json; charset=utf-8 181.7722ms
2025-09-17 08:47:57.654 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 08:47:57.658 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 08:47:57.661 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:57.664 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:57.665 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 11.1014ms
2025-09-17 08:47:57.667 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 8.9764ms
2025-09-17 08:47:57.684 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 08:47:57.689 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 08:47:57.692 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:57.696 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:57.700 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:57.705 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:47:57.700 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:57.708 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:47:57.716 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 08:47:57.723 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:47:57.727 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 08:47:57.730 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 41.2862ms
2025-09-17 08:47:57.732 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:47:57.737 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 22.5001ms
2025-09-17 08:47:57.739 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:47:57.740 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 56.6022ms
2025-09-17 08:47:57.749 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - null null
2025-09-17 08:47:57.754 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:57.755 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 204 null null 6.2497ms
2025-09-17 08:47:57.764 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - application/json null
2025-09-17 08:47:57.769 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:57.773 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:57.775 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 404 0 null 11.7886ms
2025-09-17 08:47:57.787 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats, Response status code: 404
2025-09-17 08:47:57.816 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 08:47:57.822 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:57.823 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 7.047ms
2025-09-17 08:47:57.829 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 08:47:57.832 +08:00 [INF] CORS policy execution successful.
2025-09-17 08:47:57.838 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 08:47:57.842 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:47:57.843 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 08:47:57.852 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 08:47:57.858 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 08:47:57.860 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 14.5993ms
2025-09-17 08:47:57.862 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 08:47:57.863 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 34.1888ms
2025-09-17 09:05:35.864 +08:00 [INF] Application is shutting down...
2025-09-17 09:14:35.688 +08:00 [INF] Checking database connection...
2025-09-17 09:14:37.503 +08:00 [INF] Database connection successful.
2025-09-17 09:14:37.504 +08:00 [INF] Attempting to apply migrations...
2025-09-17 09:14:37.667 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-17 09:14:38.231 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-09-17 09:14:38.253 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-09-17 09:14:38.259 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-17 09:14:38.270 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-09-17 09:14:38.288 +08:00 [INF] Migrations applied successfully.
2025-09-17 09:14:38.291 +08:00 [INF] Starting data seeding...
2025-09-17 09:14:38.313 +08:00 [INF] User profile is available. Using 'C:\Users\Win11\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-17 09:14:38.569 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM courses AS c)
2025-09-17 09:14:38.580 +08:00 [INF] Database already contains data. Checking if data cleanup is needed...
2025-09-17 09:14:38.582 +08:00 [INF] Checking for missing data components...
2025-09-17 09:14:38.591 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM subscriptions AS s)
2025-09-17 09:14:38.595 +08:00 [INF] Data seeding completed.
2025-09-17 09:14:38.684 +08:00 [INF] Now listening on: http://localhost:5296
2025-09-17 09:14:38.686 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-17 09:14:38.687 +08:00 [INF] Hosting environment: Development
2025-09-17 09:14:38.688 +08:00 [INF] Content root path: C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-09-17 09:14:43.845 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 09:14:43.848 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 09:14:43.965 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 09:14:43.996 +08:00 [WRN] Failed to determine the https port for redirect.
2025-09-17 09:14:44.001 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:44.001 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:44.001 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:44.013 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 171.0992ms
2025-09-17 09:14:44.013 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 48.4157ms
2025-09-17 09:14:44.013 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 171.0994ms
2025-09-17 09:14:44.030 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 09:14:44.032 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 09:14:44.043 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:44.043 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:44.083 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 09:14:44.085 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 09:14:44.090 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 09:14:44.093 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 62.7116ms
2025-09-17 09:14:44.104 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 09:14:44.295 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-17 09:14:44.377 +08:00 [INF] Executed DbCommand (18ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 09:14:44.702 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 09:14:44.749 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 09:14:44.751 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 641.0181ms
2025-09-17 09:14:44.753 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:44.756 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 09:14:44.763 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 731.2006ms
2025-09-17 09:14:44.902 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 09:14:44.905 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 09:14:44.908 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 09:14:44.919 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 09:14:44.933 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 09:14:44.936 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 25.2563ms
2025-09-17 09:14:44.939 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 09:14:44.941 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 192.0002ms
2025-09-17 09:14:44.948 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - null null
2025-09-17 09:14:44.952 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:44.954 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 204 null null 6.1254ms
2025-09-17 09:14:44.961 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - application/json null
2025-09-17 09:14:44.966 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:44.972 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 09:14:44.977 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 404 0 null 15.4818ms
2025-09-17 09:14:44.985 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats, Response status code: 404
2025-09-17 09:14:45.014 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 09:14:45.019 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:45.021 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 7.4691ms
2025-09-17 09:14:45.030 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 09:14:45.034 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:45.041 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 09:14:45.044 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 09:14:45.047 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 09:14:45.056 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 09:14:45.067 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 09:14:45.070 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 20.1901ms
2025-09-17 09:14:45.072 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 09:14:45.075 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 43.9829ms
2025-09-17 09:14:45.810 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 09:14:45.817 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:45.824 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 09:14:45.828 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 09:14:45.830 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 09:14:45.837 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 09:14:45.849 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 09:14:45.852 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 19.7793ms
2025-09-17 09:14:45.854 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 09:14:45.856 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 45.5369ms
2025-09-17 09:14:45.863 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 09:14:45.867 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:45.868 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 5.203ms
2025-09-17 09:14:45.873 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 09:14:45.878 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:45.882 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 09:14:45.887 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 09:14:45.892 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 09:14:45.895 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 22.1014ms
2025-09-17 09:14:45.896 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 09:14:45.904 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:45.919 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 09:14:45.921 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 09:14:45.922 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 09:14:45.930 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:45.941 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 09:14:45.944 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:45.946 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 26.8057ms
2025-09-17 09:14:45.951 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 09:14:45.955 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 32.6689ms
2025-09-17 09:14:45.966 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 09:14:45.968 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 71.3075ms
2025-09-17 09:14:45.974 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 09:14:45.977 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:45.988 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:45.992 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 09:14:45.996 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 09:14:46.012 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 09:14:46.044 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-17 09:14:46.052 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 09:14:46.055 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 09:14:46.062 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 09:14:46.084 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 09:14:46.100 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 09:14:46.160 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 09:14:46.173 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 09:14:46.180 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 09:14:46.200 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.213 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.220 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 09:14:46.226 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.232 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.233 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 09:14:46.238 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 09:14:46.246 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.252 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.258 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 09:14:46.259 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 09:14:46.264 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.269 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 09:14:46.271 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.275 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 09:14:46.278 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 09:14:46.284 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 09:14:46.288 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.293 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 09:14:46.297 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.300 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 09:14:46.303 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 09:14:46.307 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 09:14:46.312 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.315 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 09:14:46.319 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.322 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 09:14:46.328 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 09:14:46.335 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.342 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.347 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 09:14:46.352 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.358 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.363 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 09:14:46.368 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.371 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 09:14:46.373 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 09:14:46.379 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 09:14:46.388 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 322.7772ms
2025-09-17 09:14:46.390 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 09:14:46.392 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 09:14:46.397 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 422.7633ms
2025-09-17 09:14:46.399 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 09:14:46.421 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 405.0744ms
2025-09-17 09:14:46.424 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 09:14:46.426 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 459.5324ms
2025-09-17 09:14:46.861 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 09:14:46.861 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 09:14:46.866 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:46.869 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:46.876 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 09:14:46.877 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 09:14:46.880 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 09:14:46.882 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 09:14:46.884 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 09:14:46.886 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 09:14:46.888 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 27.7988ms
2025-09-17 09:14:46.911 +08:00 [INF] Executed DbCommand (18ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 09:14:46.924 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 09:14:46.927 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 36.4539ms
2025-09-17 09:14:46.930 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 09:14:46.933 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 71.4255ms
2025-09-17 09:14:46.943 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - application/json null
2025-09-17 09:14:46.947 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:46.951 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 09:14:46.956 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 404 0 null 13.6122ms
2025-09-17 09:14:46.962 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats, Response status code: 404
2025-09-17 09:14:46.997 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 09:14:47.004 +08:00 [INF] CORS policy execution successful.
2025-09-17 09:14:47.010 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 09:14:47.015 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 09:14:47.017 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 09:14:47.030 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 09:14:47.044 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 09:14:47.047 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 26.9577ms
2025-09-17 09:14:47.050 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 09:14:47.051 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 54.5935ms
2025-09-17 09:19:30.062 +08:00 [INF] Application is shutting down...
2025-09-17 13:44:08.711 +08:00 [INF] Checking database connection...
2025-09-17 13:44:11.206 +08:00 [INF] Database connection successful.
2025-09-17 13:44:11.208 +08:00 [INF] Attempting to apply migrations...
2025-09-17 13:44:11.391 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-17 13:44:11.951 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-09-17 13:44:11.979 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-09-17 13:44:11.986 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-17 13:44:11.997 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-09-17 13:44:12.019 +08:00 [INF] Migrations applied successfully.
2025-09-17 13:44:12.021 +08:00 [INF] Starting data seeding...
2025-09-17 13:44:12.050 +08:00 [INF] User profile is available. Using 'C:\Users\Win11\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-17 13:44:12.312 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM courses AS c)
2025-09-17 13:44:12.324 +08:00 [INF] Database already contains data. Checking if data cleanup is needed...
2025-09-17 13:44:12.326 +08:00 [INF] Checking for missing data components...
2025-09-17 13:44:12.334 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM subscriptions AS s)
2025-09-17 13:44:12.338 +08:00 [INF] Data seeding completed.
2025-09-17 13:44:12.482 +08:00 [INF] Now listening on: http://localhost:5296
2025-09-17 13:44:12.484 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-17 13:44:12.486 +08:00 [INF] Hosting environment: Development
2025-09-17 13:44:12.487 +08:00 [INF] Content root path: C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-09-17 13:45:09.033 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 13:45:09.034 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:45:09.075 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 13:45:09.115 +08:00 [WRN] Failed to determine the https port for redirect.
2025-09-17 13:45:09.119 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:09.119 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:09.119 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:09.131 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 55.5819ms
2025-09-17 13:45:09.131 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 100.3227ms
2025-09-17 13:45:09.131 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 100.3228ms
2025-09-17 13:45:09.144 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:45:09.147 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 13:45:09.168 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:09.168 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:09.262 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:45:09.266 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:45:09.274 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:45:09.278 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 133.8467ms
2025-09-17 13:45:09.300 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:45:09.534 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-17 13:45:09.648 +08:00 [INF] Executed DbCommand (22ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:45:10.030 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:45:10.073 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 13:45:10.076 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 768.3394ms
2025-09-17 13:45:10.079 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:10.081 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:45:10.089 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 941.3211ms
2025-09-17 13:45:10.140 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:10 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:45:10.156 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:10 AM'.
2025-09-17 13:45:10.158 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:10 AM'.
2025-09-17 13:45:10.254 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:45:10.260 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:45:10.262 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:45:10.273 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:45:10.288 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:45:10.292 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 27.2244ms
2025-09-17 13:45:10.295 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:45:10.298 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 224.4924ms
2025-09-17 13:45:10.307 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - null null
2025-09-17 13:45:10.313 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:10.315 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 204 null null 7.8853ms
2025-09-17 13:45:10.321 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - application/json null
2025-09-17 13:45:10.328 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:10.332 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:10 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:45:10.340 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:10 AM'.
2025-09-17 13:45:10.343 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:10 AM'.
2025-09-17 13:45:10.351 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:45:10.358 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 404 0 null 36.9162ms
2025-09-17 13:45:10.373 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats, Response status code: 404
2025-09-17 13:45:10.395 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:45:10.402 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:10.404 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 8.3038ms
2025-09-17 13:45:10.412 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:45:10.421 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:10.428 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:10 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:45:10.433 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:10 AM'.
2025-09-17 13:45:10.436 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:10 AM'.
2025-09-17 13:45:10.444 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:45:10.449 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:45:10.453 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:45:10.474 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:45:10.502 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:45:10.508 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 49.9974ms
2025-09-17 13:45:10.517 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:45:10.520 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 108.1579ms
2025-09-17 13:45:18.999 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 13:45:19.008 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:19.011 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 11.951ms
2025-09-17 13:45:19.022 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 13:45:19.027 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:19.030 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:45:19.038 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
2025-09-17 13:45:19.040 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
2025-09-17 13:45:19.048 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:45:19.052 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:45:19.055 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:45:19.069 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:45:19.094 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:45:19.097 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 38.944ms
2025-09-17 13:45:19.100 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:45:19.103 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 80.4646ms
2025-09-17 13:45:19.116 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:45:19.121 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:19.123 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 7.3003ms
2025-09-17 13:45:19.131 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:45:19.136 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:19.140 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:45:19.147 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
2025-09-17 13:45:19.150 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
2025-09-17 13:45:19.161 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:45:19.172 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:45:19.180 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:45:19.182 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 51.0714ms
2025-09-17 13:45:19.203 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:45:19.205 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:45:19.205 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:45:19.211 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:19.218 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:19.223 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:19.226 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 22.6268ms
2025-09-17 13:45:19.229 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:45:19.230 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 25.0865ms
2025-09-17 13:45:19.240 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:45:19.247 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
2025-09-17 13:45:19.253 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:45:19.259 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:19.263 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
2025-09-17 13:45:19.272 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:19.272 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:45:19.277 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:45:19.278 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:45:19.281 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
2025-09-17 13:45:19.287 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
2025-09-17 13:45:19.293 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
2025-09-17 13:45:19.295 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:45:19.296 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:19 AM'.
2025-09-17 13:45:19.302 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:45:19.304 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:45:19.307 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 102.7596ms
2025-09-17 13:45:19.315 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-17 13:45:19.327 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:45:19.330 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 401 0 null 89.4191ms
2025-09-17 13:45:19.419 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:45:19.427 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:45:19.445 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 13:45:19.559 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 13:45:19.622 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 13:45:19.695 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:19.742 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:19.764 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:19.777 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:19.788 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:19.798 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:19.806 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:19.816 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:19.826 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:19.833 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:19.843 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:19.853 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:19.864 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:19.873 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:19.883 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:19.892 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:19.903 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:19.915 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:19.927 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:19.940 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:20.340 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:20.498 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:20.523 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:20.560 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:20.581 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:20.599 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:20.614 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:20.628 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 13:45:20.654 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 1184.3967ms
2025-09-17 13:45:20.664 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:45:20.668 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 1414.685ms
2025-09-17 13:45:48.987 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 13:45:48.993 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:48.995 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 8.092ms
2025-09-17 13:45:49.004 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 13:45:49.007 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:49.009 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:45:49.012 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
2025-09-17 13:45:49.014 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
2025-09-17 13:45:49.018 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:45:49.020 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:45:49.022 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:45:49.028 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:45:49.035 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:45:49.038 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 14.7155ms
2025-09-17 13:45:49.041 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:45:49.043 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 39.2536ms
2025-09-17 13:45:49.051 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:45:49.058 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:49.059 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:45:49.060 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 8.5767ms
2025-09-17 13:45:49.064 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:49.067 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:45:49.069 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 9.8404ms
2025-09-17 13:45:49.073 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:49.080 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:45:49.082 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
2025-09-17 13:45:49.084 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
2025-09-17 13:45:49.087 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:45:49.090 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:45:49.092 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:45:49.093 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 25.6798ms
2025-09-17 13:45:49.098 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:45:49.102 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:45:49.102 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:45:49.103 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:49.107 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:49.110 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:49.111 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:45:49.112 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 9.7609ms
2025-09-17 13:45:49.113 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 10.6521ms
2025-09-17 13:45:49.118 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
2025-09-17 13:45:49.123 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:45:49.128 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:45:49.129 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
2025-09-17 13:45:49.132 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:49.134 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:45:49.137 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:45:49.138 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:45:49.138 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:45:49.141 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
2025-09-17 13:45:49.144 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:45:49.146 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
2025-09-17 13:45:49.148 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
2025-09-17 13:45:49.149 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:45:49.151 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:45:49 AM'.
2025-09-17 13:45:49.154 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 56.5837ms
2025-09-17 13:45:49.155 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:45:49.158 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:45:49.165 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:45:49.168 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-17 13:45:49.169 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 13:45:49.170 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:45:49.175 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 401 0 null 46.772ms
2025-09-17 13:45:49.180 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 13:45:49.186 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 13:45:49.194 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:49.200 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.206 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.214 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:49.220 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.228 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.233 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:49.238 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.245 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.251 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:49.256 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.262 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.267 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:49.272 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.279 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.284 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:49.290 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.296 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.302 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:49.307 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.312 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.318 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:49.323 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.329 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.338 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:45:49.344 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.350 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:45:49.353 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 13:45:49.356 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 182.9937ms
2025-09-17 13:45:49.359 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:45:49.361 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 238.4617ms
2025-09-17 13:46:18.989 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 13:46:18.993 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:18.994 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 5.5484ms
2025-09-17 13:46:18.998 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 13:46:19.001 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:19.003 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:19.006 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
2025-09-17 13:46:19.007 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
2025-09-17 13:46:19.011 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:19.014 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:46:19.017 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:46:19.026 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:46:19.034 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:46:19.037 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 17.6414ms
2025-09-17 13:46:19.040 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:46:19.042 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 44.2301ms
2025-09-17 13:46:19.052 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:46:19.060 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:19.063 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 10.3818ms
2025-09-17 13:46:19.063 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:46:19.072 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:19.073 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 10.0797ms
2025-09-17 13:46:19.087 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:46:19.092 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:19.094 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:19.098 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
2025-09-17 13:46:19.100 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
2025-09-17 13:46:19.104 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:19.108 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:46:19.110 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:46:19.111 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 23.8596ms
2025-09-17 13:46:19.116 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:46:19.121 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:19.122 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:46:19.122 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:46:19.124 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:19.128 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:19.131 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:19.135 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
2025-09-17 13:46:19.135 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 13.7454ms
2025-09-17 13:46:19.137 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 14.8502ms
2025-09-17 13:46:19.138 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
2025-09-17 13:46:19.144 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:46:19.148 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:46:19.151 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:19.153 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:19.156 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:19.158 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:46:19.159 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:19.160 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:19.161 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:46:19.163 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
2025-09-17 13:46:19.165 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
2025-09-17 13:46:19.167 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 50.4624ms
2025-09-17 13:46:19.168 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
2025-09-17 13:46:19.170 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:19 AM'.
2025-09-17 13:46:19.177 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:19.179 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:19.181 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-17 13:46:19.184 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:46:19.185 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:46:19.186 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 13:46:19.187 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 401 0 null 42.8787ms
2025-09-17 13:46:19.193 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 13:46:19.200 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 13:46:19.204 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:19.208 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.211 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.215 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:19.219 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.222 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.226 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:19.230 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.233 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.237 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:19.240 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.244 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.247 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:19.251 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.254 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.258 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:19.262 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.266 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.269 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:19.273 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.279 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.284 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:19.289 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.294 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.298 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:19.302 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.309 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:19.313 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 13:46:19.316 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 125.8841ms
2025-09-17 13:46:19.319 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:46:19.321 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 172.8114ms
2025-09-17 13:46:26.268 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 13:46:26.271 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:26.272 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 4.6083ms
2025-09-17 13:46:26.282 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/courses - application/json 712
2025-09-17 13:46:26.285 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:26.286 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:26 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:26.289 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:26 AM'.
2025-09-17 13:46:26.291 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:26 AM'.
2025-09-17 13:46:26.295 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:26.299 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Instructor|Admin)
2025-09-17 13:46:26.302 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:46:26.303 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/courses - 401 0 null 21.1791ms
2025-09-17 13:46:42.651 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 13:46:42.657 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:42.660 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 9.5117ms
2025-09-17 13:46:42.671 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 13:46:42.677 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:42.680 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:42.686 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
2025-09-17 13:46:42.688 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
2025-09-17 13:46:42.694 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:42.703 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:46:42.707 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:46:42.718 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:46:42.726 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:46:42.730 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 20.3479ms
2025-09-17 13:46:42.733 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:46:42.735 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 63.2979ms
2025-09-17 13:46:42.744 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:46:42.750 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:42.752 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:46:42.753 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 8.8297ms
2025-09-17 13:46:42.757 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:42.762 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:46:42.764 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 11.0745ms
2025-09-17 13:46:42.770 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:42.776 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:42.779 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
2025-09-17 13:46:42.781 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
2025-09-17 13:46:42.787 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:42.791 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:46:42.792 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:46:42.794 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 31.8935ms
2025-09-17 13:46:42.804 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:46:42.809 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:42.810 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:46:42.810 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:46:42.811 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:42.816 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:42.820 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:42.823 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
2025-09-17 13:46:42.824 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 14.5192ms
2025-09-17 13:46:42.826 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 15.1201ms
2025-09-17 13:46:42.833 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
2025-09-17 13:46:42.838 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:46:42.842 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:46:42.848 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:42.851 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:42.855 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:42.858 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:46:42.860 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:42.861 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:42.863 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:46:42.868 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
2025-09-17 13:46:42.871 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
2025-09-17 13:46:42.872 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 67.8306ms
2025-09-17 13:46:42.874 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
2025-09-17 13:46:42.876 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:42 AM'.
2025-09-17 13:46:42.887 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:42.888 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:42.890 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:46:42.894 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-17 13:46:42.895 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 13:46:42.898 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:46:42.902 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 401 0 null 60.0432ms
2025-09-17 13:46:42.903 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 13:46:42.914 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 13:46:42.919 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:42.924 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:42.930 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:42.934 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:42.939 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:42.945 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:42.950 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:42.955 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:42.960 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:42.965 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:42.971 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:42.975 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:42.981 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:42.986 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:42.993 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:43.000 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:43.005 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:43.010 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:43.015 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:43.020 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:43.026 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:43.031 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:43.037 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:43.042 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:43.048 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:43.053 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:43.059 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:43.062 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 13:46:43.065 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 164.733ms
2025-09-17 13:46:43.067 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:46:43.069 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 231.0967ms
2025-09-17 13:46:48.984 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 13:46:48.988 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:48.989 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 5.4377ms
2025-09-17 13:46:48.996 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 13:46:49.000 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:49.002 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:49.006 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
2025-09-17 13:46:49.008 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
2025-09-17 13:46:49.013 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:49.019 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:46:49.021 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:46:49.031 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:46:49.043 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:46:49.046 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 23.1933ms
2025-09-17 13:46:49.049 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:46:49.052 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 55.9666ms
2025-09-17 13:46:49.067 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:46:49.071 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:46:49.072 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:49.077 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:49.079 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 12.4327ms
2025-09-17 13:46:49.080 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 9.661ms
2025-09-17 13:46:49.093 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:46:49.097 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:49.099 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:49.105 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
2025-09-17 13:46:49.106 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
2025-09-17 13:46:49.111 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:49.114 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:46:49.117 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:46:49.121 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 28.5946ms
2025-09-17 13:46:49.130 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:46:49.134 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:46:49.134 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:46:49.138 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:49.142 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:49.146 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:49.147 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:49.148 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 15.1592ms
2025-09-17 13:46:49.151 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 16.837ms
2025-09-17 13:46:49.161 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
2025-09-17 13:46:49.167 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:46:49.173 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:46:49.175 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
2025-09-17 13:46:49.179 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:49.184 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:49.188 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:49.189 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:49.189 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:49.195 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
2025-09-17 13:46:49.198 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:46:49.203 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
2025-09-17 13:46:49.205 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
2025-09-17 13:46:49.206 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:46:49.208 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:49 AM'.
2025-09-17 13:46:49.213 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 83.5375ms
2025-09-17 13:46:49.213 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:49.220 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:49.229 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:46:49.232 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-17 13:46:49.236 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 13:46:49.239 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:46:49.244 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 401 0 null 70.7034ms
2025-09-17 13:46:49.244 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 13:46:49.255 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 13:46:49.264 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:49.271 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.279 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.283 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:49.289 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.294 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.299 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:49.305 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.312 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.318 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:49.326 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.331 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.339 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:49.345 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.352 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.357 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:49.363 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.370 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.375 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:49.381 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.387 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.393 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:49.398 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.403 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.409 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:49.414 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.419 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:49.423 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 13:46:49.425 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 183.5808ms
2025-09-17 13:46:49.429 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:46:49.431 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 263.9423ms
2025-09-17 13:46:57.634 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 13:46:57.655 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 13:46:57.663 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:57.670 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:57.673 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 39.1479ms
2025-09-17 13:46:57.711 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 55.5398ms
2025-09-17 13:46:57.734 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 13:46:57.748 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/courses - application/json 712
2025-09-17 13:46:57.756 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:57.763 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:57.765 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:57 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:57.769 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:57 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:57.792 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:57 AM'.
2025-09-17 13:46:57.780 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:57 AM'.
2025-09-17 13:46:57.803 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:57 AM'.
2025-09-17 13:46:57.800 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:57 AM'.
2025-09-17 13:46:57.812 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:57.816 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:57.820 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:46:57.832 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Instructor|Admin)
2025-09-17 13:46:57.839 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:46:57.848 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:46:57.865 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:46:57.866 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/courses - 401 0 null 118.3745ms
2025-09-17 13:46:57.890 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:46:57.921 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 69.1593ms
2025-09-17 13:46:57.931 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:46:57.936 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 201.9737ms
2025-09-17 13:46:57.966 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:46:57.974 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:46:57.978 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:57.987 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:57.991 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 24.9859ms
2025-09-17 13:46:58.001 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 27.1686ms
2025-09-17 13:46:58.036 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:46:58.052 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:58.054 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:58 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:58.068 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:58 AM'.
2025-09-17 13:46:58.071 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:58 AM'.
2025-09-17 13:46:58.081 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:58.093 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:46:58.098 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:46:58.103 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 67.0188ms
2025-09-17 13:46:58.127 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:46:58.133 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:46:58.134 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:46:58.144 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:58.153 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:58.163 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:58.170 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:58 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:58.172 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 38.3981ms
2025-09-17 13:46:58.179 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 45.0446ms
2025-09-17 13:46:58.252 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:58 AM'.
2025-09-17 13:46:58.268 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:46:58.282 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:46:58.285 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:58 AM'.
2025-09-17 13:46:58.293 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:58.303 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:46:58.310 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:58.313 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:58 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:58.316 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:58 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:46:58.322 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:46:58.332 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:58 AM'.
2025-09-17 13:46:58.387 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:58 AM'.
2025-09-17 13:46:58.390 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:46:58.411 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:58 AM'.
2025-09-17 13:46:58.422 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:46:58 AM'.
2025-09-17 13:46:58.431 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 303.7502ms
2025-09-17 13:46:58.464 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:58.474 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:46:58.515 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:46:58.509 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-17 13:46:58.520 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 13:46:58.524 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:46:58.533 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 401 0 null 264.7514ms
2025-09-17 13:46:58.533 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 13:46:58.560 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 13:46:58.604 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:58.621 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.631 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.640 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:58.651 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.667 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.717 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:58.731 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.749 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.760 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:58.769 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.779 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.790 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:58.800 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.809 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.818 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:58.826 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.834 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.845 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:58.854 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.862 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.869 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:58.878 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.887 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.895 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:46:58.905 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.927 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:46:58.936 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 13:46:58.940 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 410.167ms
2025-09-17 13:46:58.946 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:46:58.950 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 668.2892ms
2025-09-17 13:49:03.674 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 13:49:03.680 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:03.683 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 9.2991ms
2025-09-17 13:49:03.691 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 13:49:03.695 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:03.698 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:03 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:03.703 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:03 AM'.
2025-09-17 13:49:03.705 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:03 AM'.
2025-09-17 13:49:03.710 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:03.715 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:49:03.717 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:49:03.728 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:49:03.743 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:49:03.747 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 26.8218ms
2025-09-17 13:49:03.750 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:49:03.754 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 62.7803ms
2025-09-17 13:49:03.820 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 13:49:03.825 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:03.827 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:03 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:03.830 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:03 AM'.
2025-09-17 13:49:03.832 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:03 AM'.
2025-09-17 13:49:03.837 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:03.843 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:49:03.845 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:49:03.859 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:49:03.867 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:49:03.877 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:03.878 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:49:03.879 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 12.8918ms
2025-09-17 13:49:03.882 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 34.1054ms
2025-09-17 13:49:03.893 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:49:03.895 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:49:03.901 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:03.903 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 83.0346ms
2025-09-17 13:49:03.905 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:03 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:03.915 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:03 AM'.
2025-09-17 13:49:03.917 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:03 AM'.
2025-09-17 13:49:03.924 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:03.930 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:49:03.932 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:03.934 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 41.5335ms
2025-09-17 13:49:04.001 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:49:04.006 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:04.008 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:04.010 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:49:04.013 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
2025-09-17 13:49:04.017 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:49:04.021 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:04.023 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
2025-09-17 13:49:04.027 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:04.029 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 18.225ms
2025-09-17 13:49:04.032 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 15.323ms
2025-09-17 13:49:04.033 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:04.044 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:49:04.049 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:49:04.053 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:49:04.058 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:04.061 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:04.062 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:04.064 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:04.066 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:04.069 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 68.1435ms
2025-09-17 13:49:04.076 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
2025-09-17 13:49:04.079 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
2025-09-17 13:49:04.085 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:49:04.088 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
2025-09-17 13:49:04.090 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
2025-09-17 13:49:04.094 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:04.100 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:04.101 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:04.102 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:04.106 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-17 13:49:04.110 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
2025-09-17 13:49:04.113 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:49:04.115 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:04.117 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
2025-09-17 13:49:04.120 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 13:49:04.122 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 401 0 null 77.8186ms
2025-09-17 13:49:04.127 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:04.132 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 13:49:04.144 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:49:04.150 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:04.151 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 13:49:04.152 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 67.1899ms
2025-09-17 13:49:04.161 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.164 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:49:04.169 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.172 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:04.178 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.178 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:04.185 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.189 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
2025-09-17 13:49:04.189 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:49:04.195 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.196 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
2025-09-17 13:49:04.200 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:04.207 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.209 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:04.209 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:04.213 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.215 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
2025-09-17 13:49:04.219 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:49:04.226 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.226 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
2025-09-17 13:49:04.228 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:04.234 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.237 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:04.238 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 73.7087ms
2025-09-17 13:49:04.247 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.249 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-17 13:49:04.263 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:04.263 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.264 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 401 0 null 75.0596ms
2025-09-17 13:49:04.273 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.281 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.290 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.296 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.311 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.320 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.327 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.334 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.341 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.348 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.354 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.361 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.367 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.372 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.382 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.387 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.395 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 13:49:04.400 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 270.6934ms
2025-09-17 13:49:04.403 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:49:04.404 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:49:04.408 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:04.410 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 361.6254ms
2025-09-17 13:49:04.412 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:04.420 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
2025-09-17 13:49:04.422 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:04 AM'.
2025-09-17 13:49:04.427 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:04.432 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:49:04.435 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 13:49:04.444 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 13:49:04.452 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 13:49:04.461 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.468 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.475 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.481 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.489 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.495 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.502 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.509 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.516 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.522 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.529 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.543 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.550 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.557 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.563 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.570 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.580 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.590 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.603 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.610 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.617 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.622 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.628 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.634 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.643 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:04.649 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.657 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:04.662 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 13:49:04.665 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 224.1514ms
2025-09-17 13:49:04.670 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:49:04.673 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 269.3559ms
2025-09-17 13:49:24.832 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 13:49:24.840 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:24.842 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 10.2049ms
2025-09-17 13:49:24.859 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 13:49:24.870 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:24.873 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:24 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:24.881 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:24 AM'.
2025-09-17 13:49:24.887 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:24 AM'.
2025-09-17 13:49:25.075 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:25.086 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:49:25.090 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:49:25.140 +08:00 [INF] Executed DbCommand (36ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:49:25.165 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:49:25.175 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 74.9923ms
2025-09-17 13:49:25.192 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 13:49:25.203 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:49:25.208 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:25.210 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 350.6988ms
2025-09-17 13:49:25.213 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:25 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:25.231 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:25 AM'.
2025-09-17 13:49:25.234 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:25 AM'.
2025-09-17 13:49:25.244 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:25.251 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:49:25.258 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:49:25.307 +08:00 [INF] Executed DbCommand (15ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:49:25.389 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:49:25.437 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 151.3351ms
2025-09-17 13:49:25.502 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:49:25.509 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 316.5253ms
2025-09-17 13:49:25.737 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:49:25.749 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:25.751 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:49:25.752 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 14.8722ms
2025-09-17 13:49:25.766 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:49:25.808 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:25.816 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:25 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:25.758 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:25.826 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:25 AM'.
2025-09-17 13:49:25.828 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 77.046ms
2025-09-17 13:49:25.833 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:25 AM'.
2025-09-17 13:49:25.900 +08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:26.125 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:49:26.167 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:26.183 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 416.0449ms
2025-09-17 13:49:26.200 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:49:26.209 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:26.213 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:26 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:26.236 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:26 AM'.
2025-09-17 13:49:26.244 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:26 AM'.
2025-09-17 13:49:26.256 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:26.275 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:49:26.282 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:26.293 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 92.8049ms
2025-09-17 13:49:26.567 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:49:26.576 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:26.584 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:49:26.584 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:26 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:26.603 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:26.608 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:49:26.610 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:49:26.614 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:26 AM'.
2025-09-17 13:49:26.619 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 35.4172ms
2025-09-17 13:49:26.627 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:26.641 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:49:26.645 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:26.648 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:26 AM'.
2025-09-17 13:49:26.669 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:49:26.673 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 65.1715ms
2025-09-17 13:49:26.791 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:49:26.809 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:26.779 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:26.783 +08:00 [INF] Executed DbCommand (16ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:26.751 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:26.755 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 145.3244ms
2025-09-17 13:49:26.812 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:26 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:26.815 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:26 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:26.822 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:49:26.824 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 183.6317ms
2025-09-17 13:49:26.849 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:26 AM'.
2025-09-17 13:49:26.856 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:26 AM'.
2025-09-17 13:49:26.858 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:26.873 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:26 AM'.
2025-09-17 13:49:26.875 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:26 AM'.
2025-09-17 13:49:26.880 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 312.8047ms
2025-09-17 13:49:26.888 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:26.909 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:49:26.913 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 13:49:26.931 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 13:49:26.966 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 13:49:26.979 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:26.993 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.011 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.032 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:27.052 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.068 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:27.073 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.086 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-17 13:49:27.099 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:27.109 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:27.124 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.130 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 401 0 null 460.4385ms
2025-09-17 13:49:27.159 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.163 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:49:27.181 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:27.192 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:27.204 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.205 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:27 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:27.215 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.223 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:27 AM'.
2025-09-17 13:49:27.232 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:27.234 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:27 AM'.
2025-09-17 13:49:27.243 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.249 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:27.267 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.287 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-17 13:49:27.294 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:27.296 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:27.309 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.311 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 401 0 null 147.9037ms
2025-09-17 13:49:27.331 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.359 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:27.393 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.417 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.428 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:27.452 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.471 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.484 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:27.494 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.517 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.527 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 13:49:27.532 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 605.3866ms
2025-09-17 13:49:27.537 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:49:27.542 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:49:27.552 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:27.554 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 763.4647ms
2025-09-17 13:49:27.559 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:27 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:27.581 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:27 AM'.
2025-09-17 13:49:27.586 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:27 AM'.
2025-09-17 13:49:27.592 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:27.601 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:49:27.604 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 13:49:27.618 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 13:49:27.635 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 13:49:27.648 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:27.691 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.723 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.762 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:27.780 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.794 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.812 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:27.840 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.859 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.879 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:27.907 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:27.952 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:28.151 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:28.174 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:28.191 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:28.217 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:28.236 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:28.266 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:28.339 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:28.356 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:28.372 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:28.385 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:28.395 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:28.419 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:28.513 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:28.553 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:28.573 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:28.607 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 13:49:28.619 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 1008.6188ms
2025-09-17 13:49:28.663 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:49:28.704 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 1167.4999ms
2025-09-17 13:49:37.721 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 13:49:37.726 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:37.728 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 7.1221ms
2025-09-17 13:49:37.736 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 13:49:37.742 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:37.743 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:37 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:37.749 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:37 AM'.
2025-09-17 13:49:37.752 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:37 AM'.
2025-09-17 13:49:37.761 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:37.781 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:49:37.792 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:49:37.808 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:49:37.827 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:49:37.832 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 36.3316ms
2025-09-17 13:49:37.837 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 13:49:37.841 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:49:37.847 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:37.849 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 112.9571ms
2025-09-17 13:49:37.875 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:37 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:37.888 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:37 AM'.
2025-09-17 13:49:37.891 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:37 AM'.
2025-09-17 13:49:37.892 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 13:49:37.896 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:37.899 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:37.904 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:49:37.905 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 12.588ms
2025-09-17 13:49:37.907 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 13:49:37.915 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:49:37.929 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:37.930 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 13:49:37.930 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:37 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:37.950 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:37 AM'.
2025-09-17 13:49:37.954 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 13:49:37.961 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:37 AM'.
2025-09-17 13:49:37.965 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 43.9399ms
2025-09-17 13:49:37.973 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:37.977 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 13:49:37.982 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:49:37.985 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 148.5322ms
2025-09-17 13:49:37.987 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:37.998 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 83.7301ms
2025-09-17 13:49:38.135 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-17 13:49:38.143 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:49:38.145 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:38.148 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:38.149 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 14.5033ms
2025-09-17 13:49:38.153 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:38.161 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 557
2025-09-17 13:49:38.166 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
2025-09-17 13:49:38.175 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:38.176 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
2025-09-17 13:49:38.178 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-17 13:49:38.182 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:38.191 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-17 13:49:38.203 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:49:38.212 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:38.216 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 73.2606ms
2025-09-17 13:49:38.250 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:49:38.260 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:38.262 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:38.269 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
2025-09-17 13:49:38.271 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
2025-09-17 13:49:38.276 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:38.280 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:49:38.286 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:38.289 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 38.1927ms
2025-09-17 13:49:38.364 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-17 13:49:38.421 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:49:38.458 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:49:38.460 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 13:49:38.488 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:38.493 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:38.498 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:38.509 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 49.0987ms
2025-09-17 13:49:38.506 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 47.7852ms
2025-09-17 13:49:38.504 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:38.542 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
2025-09-17 13:49:38.532 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:49:38.527 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:49:38.545 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
2025-09-17 13:49:38.550 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:38.558 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:38.562 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:38.562 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:38.565 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 13:49:38.573 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
2025-09-17 13:49:38.577 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:49:38.581 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
2025-09-17 13:49:38.588 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
2025-09-17 13:49:38.586 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:38.582 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 1:47:57 AM', Current time (UTC): '9/17/2025 5:49:38 AM'.
2025-09-17 13:49:38.594 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 173.0918ms
2025-09-17 13:49:38.597 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:38.605 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:38.642 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:49:38.645 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-17 13:49:38.660 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 13:49:38.662 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 13:49:38.695 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 401 0 null 163.4396ms
2025-09-17 13:49:38.696 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 13:49:38.712 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 13:49:38.727 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:38.740 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.747 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.760 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:38.770 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.779 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.800 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:38.808 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.814 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.823 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:38.830 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.840 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.847 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:38.858 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.862 +08:00 [INF] Executed DbCommand (26ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-17 13:49:38.865 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.879 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:38.892 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.899 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.908 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:38.914 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.926 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.933 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:38.944 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.952 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.954 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-17 13:49:38.960 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:38.966 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 757.1168ms
2025-09-17 13:49:38.972 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-17 13:49:38.969 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.975 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 813.8889ms
2025-09-17 13:49:38.981 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:38.989 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 13:49:38.992 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 299.1925ms
2025-09-17 13:49:38.996 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:49:38.998 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 470.9721ms
2025-09-17 13:49:39.038 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 13:49:39.043 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:39.058 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:39.063 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 13:49:39.069 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 13:49:39.071 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 33.2193ms
2025-09-17 13:49:39.207 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:49:39.208 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 13:49:39.213 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:39.223 +08:00 [INF] CORS policy execution successful.
2025-09-17 13:49:39.228 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:39.228 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 13:49:39.235 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 13:49:39.239 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:49:39.244 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 13:49:39.249 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 13:49:39.252 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 13:49:39.262 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 13:49:39.273 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:39.282 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.282 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-17 13:49:39.293 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.301 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:39.326 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.334 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.343 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:39.349 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.364 +08:00 [INF] Executed DbCommand (15ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 13:49:39.369 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.381 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:39.388 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.395 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.403 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:39.410 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.420 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.427 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:39.436 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.443 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 13:49:39.444 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.457 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:39.624 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 13:49:39.661 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.678 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.703 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 13:49:39.720 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:39.733 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 13:49:39.733 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.741 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 13:49:39.757 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.762 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 13:49:39.765 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 13:49:39.769 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 13:49:39.775 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.779 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 13:49:39.784 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 13:49:39.787 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 13:49:39.791 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 13:49:39.796 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 13:49:39.797 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 547.7316ms
2025-09-17 13:49:39.806 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 13:49:39.807 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 13:49:39.822 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 614.1415ms
2025-09-17 13:49:39.907 +08:00 [INF] Executed DbCommand (13ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 13:49:39.928 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 13:49:39.941 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 13:49:39.990 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 737.8869ms
2025-09-17 13:49:39.993 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 13:49:39.996 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 789.2502ms
2025-09-17 15:35:09.177 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 15:35:09.177 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 15:35:09.199 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:09.199 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:09.206 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 30.0195ms
2025-09-17 15:35:09.225 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 49.0178ms
2025-09-17 15:35:09.233 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 15:35:09.238 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 15:35:09.246 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:09.249 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:09.261 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:35:09.264 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 15:35:09.267 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-17 15:35:09.270 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 15:35:09.270 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 37.2117ms
2025-09-17 15:35:09.296 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 15:35:09.303 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:09.305 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 10.5242ms
2025-09-17 15:35:09.454 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-17 15:35:09.471 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:09.480 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 26.166ms
2025-09-17 15:35:09.492 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 557
2025-09-17 15:35:09.498 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:09.502 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-17 15:35:09.510 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-17 15:35:09.558 +08:00 [INF] Executed DbCommand (128ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 15:35:09.610 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 15:35:09.615 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 339.9497ms
2025-09-17 15:35:09.625 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 15:35:09.625 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:35:09.629 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:09.632 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 393.4059ms
2025-09-17 15:35:09.635 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 6:49:38 AM', Current time (UTC): '9/17/2025 7:35:09 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 15:35:09.654 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 6:49:38 AM', Current time (UTC): '9/17/2025 7:35:09 AM'.
2025-09-17 15:35:09.656 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 6:49:38 AM', Current time (UTC): '9/17/2025 7:35:09 AM'.
2025-09-17 15:35:09.679 +08:00 [INF] Executed DbCommand (15ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:35:09.686 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:35:09.689 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 15:35:09.703 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 15:35:09.704 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-17 15:35:09.733 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 15:35:09.740 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 48.6808ms
2025-09-17 15:35:09.751 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:35:09.758 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 132.3429ms
2025-09-17 15:35:09.784 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - null null
2025-09-17 15:35:09.793 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:09.794 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 204 null null 10.8434ms
2025-09-17 15:35:09.803 +08:00 [INF] Executed DbCommand (19ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-17 15:35:09.810 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - application/json null
2025-09-17 15:35:09.846 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:09.849 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-17 15:35:09.849 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 6:49:38 AM', Current time (UTC): '9/17/2025 7:35:09 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-17 15:35:09.853 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 336.4782ms
2025-09-17 15:35:09.864 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 6:49:38 AM', Current time (UTC): '9/17/2025 7:35:09 AM'.
2025-09-17 15:35:09.866 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-17 15:35:09.869 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/17/2025 6:49:38 AM', Current time (UTC): '9/17/2025 7:35:09 AM'.
2025-09-17 15:35:09.871 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 379.3148ms
2025-09-17 15:35:09.879 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:35:09.881 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 15:35:09.885 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 404 0 null 75.2328ms
2025-09-17 15:35:09.889 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:09.899 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 17.8811ms
2025-09-17 15:35:09.899 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5296/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats, Response status code: 404
2025-09-17 15:35:09.907 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 15:35:09.911 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:09.914 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 7.3941ms
2025-09-17 15:35:09.926 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 15:35:09.934 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 15:35:09.940 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:09.945 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:09.953 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:35:09.958 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 15:35:09.961 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:35:09.961 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 15:35:09.965 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:35:09.967 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 32.9856ms
2025-09-17 15:35:09.970 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 15:35:09.991 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 15:35:10.010 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 15:35:10.019 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 38.8953ms
2025-09-17 15:35:10.023 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:35:10.026 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 99.9184ms
2025-09-17 15:35:13.633 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 15:35:13.638 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:13.645 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:35:13.650 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:35:13.653 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 15:35:13.664 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 15:35:13.677 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 15:35:13.681 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 23.9159ms
2025-09-17 15:35:13.684 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:35:13.686 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 53.0893ms
2025-09-17 15:35:13.694 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 15:35:13.700 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:13.704 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:35:13.707 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 15:35:13.718 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 15:35:13.720 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 26.0965ms
2025-09-17 15:35:13.747 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 15:35:13.751 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:13.755 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:35:13.759 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 15:35:13.760 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 15:35:13.762 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 14.5253ms
2025-09-17 15:35:13.781 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 15:35:13.782 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 15:35:13.788 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:13.791 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:13.792 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 11.4297ms
2025-09-17 15:35:13.794 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 11.5773ms
2025-09-17 15:35:13.800 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 15:35:13.806 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 15:35:13.810 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:13.814 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:13.819 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:35:13.821 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:35:13.823 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 15:35:13.826 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 15:35:13.829 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 15:35:13.829 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 15:35:13.853 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 15:35:13.866 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 15:35:13.876 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 15:35:13.894 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:13.897 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 15:35:13.905 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:13.908 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 15:35:13.910 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:13.913 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:13.918 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:13.921 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:13.924 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:13.927 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:13.930 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:13.933 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:13.936 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:13.939 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:13.943 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:13.945 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:13.948 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:13.951 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:13.954 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:13.957 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:13.961 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:13.963 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:13.967 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:13.972 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:13.972 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 15:35:13.977 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:13.982 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 15:35:13.983 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:13.985 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 15:35:13.989 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:13.991 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 159.4133ms
2025-09-17 15:35:13.996 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:13.996 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 15:35:14.000 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 199.9156ms
2025-09-17 15:35:14.002 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:14.009 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:14.014 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:14.018 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:14.023 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:14.029 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:14.034 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:14.041 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:14.047 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:14.052 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:14.056 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 15:35:14.059 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 223.9236ms
2025-09-17 15:35:14.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 15:35:14.064 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 258.3304ms
2025-09-17 15:35:43.621 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 15:35:43.626 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:43.627 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 5.9014ms
2025-09-17 15:35:43.634 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 15:35:43.638 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:43.646 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:35:43.650 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:35:43.652 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 15:35:43.661 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 15:35:43.670 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 15:35:43.672 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 16.7506ms
2025-09-17 15:35:43.675 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:35:43.678 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 43.8799ms
2025-09-17 15:35:43.685 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 15:35:43.689 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:43.691 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 15:35:43.691 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 6.9957ms
2025-09-17 15:35:43.696 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:43.702 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 15:35:43.704 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 12.8634ms
2025-09-17 15:35:43.709 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:43.718 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:35:43.722 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 15:35:43.724 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 15:35:43.726 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 23.5358ms
2025-09-17 15:35:43.727 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 15:35:43.736 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:43.737 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 15:35:43.738 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 15:35:43.740 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:35:43.744 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:43.748 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:43.752 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 15:35:43.753 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 16.4879ms
2025-09-17 15:35:43.755 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 16.7046ms
2025-09-17 15:35:43.756 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 15:35:43.762 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 15:35:43.768 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 15:35:43.770 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 43.3554ms
2025-09-17 15:35:43.776 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:43.782 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:35:43.792 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:35:43.794 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:35:43.797 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 15:35:43.801 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 15:35:43.803 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 15:35:43.805 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 15:35:43.811 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 15:35:43.817 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 15:35:43.819 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 15:35:43.830 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 15:35:43.831 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:43.839 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 15:35:43.839 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:43.845 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:43.850 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:43.853 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:43.858 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:43.863 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:43.867 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:43.871 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:43.876 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:43.881 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:43.885 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:43.891 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:43.897 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:43.900 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:43.906 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:43.909 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:43.913 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:43.917 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:35:43.921 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:43.925 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 15:35:43.928 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:43.932 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 15:35:43.936 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:43.940 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 15:35:43.944 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:43.946 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 133.6819ms
2025-09-17 15:35:43.952 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 15:35:43.951 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:43.957 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 188.21ms
2025-09-17 15:35:43.961 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:43.971 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:43.975 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:43.980 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:43.985 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:43.989 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:43.994 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:43.998 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:44.004 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:44.009 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:35:44.013 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:44.018 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:35:44.021 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 15:35:44.023 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 215.4947ms
2025-09-17 15:35:44.026 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 15:35:44.027 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 265.7285ms
2025-09-17 15:36:06.210 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 15:36:06.214 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:06.215 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 4.8845ms
2025-09-17 15:36:06.220 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/courses - application/json 711
2025-09-17 15:36:06.223 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:06.227 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:06.231 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse (CeceLearningPortal.Api)'
2025-09-17 15:36:06.238 +08:00 [INF] Route matched with {action = "CreateCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCourse(CeceLearningPortal.Api.DTOs.CreateCourseDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 15:36:06.289 +08:00 [ERR] Error creating course
System.ArgumentException: Requested value 'one-time' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at System.Enum.Parse[TEnum](String value, Boolean ignoreCase)
   at CeceLearningPortal.Api.Services.CourseService.CreateCourseAsync(CreateCourseDto courseDto, String instructorId) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 232
   at CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse(CreateCourseDto courseDto) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 140
2025-09-17 15:36:06.306 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 15:36:06.311 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse (CeceLearningPortal.Api) in 68.7573ms
2025-09-17 15:36:06.313 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse (CeceLearningPortal.Api)'
2025-09-17 15:36:06.316 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/courses - 500 null application/json; charset=utf-8 96.0361ms
2025-09-17 15:36:13.629 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 15:36:13.632 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:13.633 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 3.4936ms
2025-09-17 15:36:13.636 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 15:36:13.639 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:13.642 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:13.644 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:36:13.646 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 15:36:13.652 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 15:36:13.658 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 15:36:13.661 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 12.5175ms
2025-09-17 15:36:13.663 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:36:13.665 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 29.0645ms
2025-09-17 15:36:13.675 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 15:36:13.679 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 15:36:13.679 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:13.684 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:13.685 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 10.4593ms
2025-09-17 15:36:13.687 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 8.237ms
2025-09-17 15:36:13.699 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 15:36:13.703 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:13.707 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:13.711 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 15:36:13.713 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 15:36:13.715 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 16.4592ms
2025-09-17 15:36:13.716 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 15:36:13.725 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 15:36:13.725 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:13.726 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 15:36:13.730 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:13.735 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:13.736 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:13.738 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 12.4091ms
2025-09-17 15:36:13.741 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 15:36:13.743 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 16.5272ms
2025-09-17 15:36:13.748 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 15:36:13.750 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 15:36:13.755 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 15:36:13.760 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:13.762 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 45.3066ms
2025-09-17 15:36:13.767 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:13.770 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:13.778 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:13.780 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 15:36:13.784 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 15:36:13.786 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 15:36:13.788 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 15:36:13.795 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 15:36:13.797 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 15:36:13.803 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 15:36:13.806 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 15:36:13.810 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 15:36:13.814 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:13.818 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:13.821 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.825 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:13.829 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.832 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:13.836 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:13.839 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:13.843 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.846 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:13.850 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.853 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:13.857 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:13.861 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:13.864 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.868 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:13.873 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.877 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:13.881 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:13.886 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 15:36:13.889 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.894 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 15:36:13.897 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.899 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 15:36:13.904 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:13.907 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 115.7565ms
2025-09-17 15:36:13.911 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.912 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 15:36:13.917 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.919 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 170.5401ms
2025-09-17 15:36:13.924 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:13.933 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.939 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.944 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:13.949 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.955 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.959 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:13.963 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.968 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.972 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:13.977 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.982 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:13.986 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 15:36:13.987 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 192.9097ms
2025-09-17 15:36:13.990 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 15:36:13.992 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 237.2445ms
2025-09-17 15:36:22.693 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 15:36:22.718 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:22.720 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 26.9152ms
2025-09-17 15:36:22.740 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 15:36:22.744 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:22.754 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:22.758 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:36:22.760 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 15:36:22.777 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 15:36:22.792 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 15:36:22.795 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 31.3921ms
2025-09-17 15:36:22.799 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:36:22.801 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 61.1916ms
2025-09-17 15:36:22.820 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 15:36:22.825 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:22.827 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 6.79ms
2025-09-17 15:36:22.828 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 15:36:22.839 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 15:36:22.843 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:22.853 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:22.857 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 29.5127ms
2025-09-17 15:36:22.865 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:22.871 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 15:36:22.873 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 15:36:22.876 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 37.3174ms
2025-09-17 15:36:22.878 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 15:36:22.887 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:22.890 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 15:36:22.891 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:22.893 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 15:36:22.895 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:22.899 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 15:36:22.903 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:22.904 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 14.1196ms
2025-09-17 15:36:22.905 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 15:36:22.907 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 14.3606ms
2025-09-17 15:36:22.914 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 15:36:22.916 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 37.8256ms
2025-09-17 15:36:22.921 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 15:36:22.925 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:22.933 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:22.937 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:22.937 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:22.940 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 15:36:22.943 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 15:36:22.944 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 15:36:22.946 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 15:36:22.953 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 15:36:22.954 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 15:36:22.960 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 15:36:22.969 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 15:36:22.972 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:22.978 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 15:36:22.983 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:22.987 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:22.991 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:22.994 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:22.998 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:23.001 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:23.005 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.009 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:23.013 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.019 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:23.023 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:23.026 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:23.037 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.041 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:23.045 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.049 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:23.053 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:23.056 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:23.060 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.066 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 15:36:23.068 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.072 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 15:36:23.075 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:23.077 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 15:36:23.084 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.086 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 137.365ms
2025-09-17 15:36:23.091 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.092 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 15:36:23.100 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:23.100 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 186.928ms
2025-09-17 15:36:23.105 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.114 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.119 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:23.123 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.128 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.134 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:23.139 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.144 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.150 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:23.154 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.161 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:23.165 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 15:36:23.167 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 216.0075ms
2025-09-17 15:36:23.169 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 15:36:23.171 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 249.2509ms
2025-09-17 15:36:23.589 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/courses - application/json 711
2025-09-17 15:36:23.593 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:23.597 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:23.601 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse (CeceLearningPortal.Api)'
2025-09-17 15:36:23.604 +08:00 [INF] Route matched with {action = "CreateCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCourse(CeceLearningPortal.Api.DTOs.CreateCourseDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 15:36:23.609 +08:00 [ERR] Error creating course
System.ArgumentException: Requested value 'one-time' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at System.Enum.Parse[TEnum](String value, Boolean ignoreCase)
   at CeceLearningPortal.Api.Services.CourseService.CreateCourseAsync(CreateCourseDto courseDto, String instructorId) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 232
   at CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse(CreateCourseDto courseDto) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 140
2025-09-17 15:36:23.616 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 15:36:23.619 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse (CeceLearningPortal.Api) in 10.6793ms
2025-09-17 15:36:23.622 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse (CeceLearningPortal.Api)'
2025-09-17 15:36:23.625 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/courses - 500 null application/json; charset=utf-8 36.1206ms
2025-09-17 15:36:43.632 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 15:36:43.637 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:43.638 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 5.9207ms
2025-09-17 15:36:43.651 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 15:36:43.656 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:43.660 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:43.665 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:36:43.667 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 15:36:43.678 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 15:36:43.686 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 15:36:43.690 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 18.9582ms
2025-09-17 15:36:43.699 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 15:36:43.703 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 51.7185ms
2025-09-17 15:36:43.717 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 15:36:43.721 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:43.722 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 15:36:43.723 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 6.0721ms
2025-09-17 15:36:43.727 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:43.733 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 15:36:43.734 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 11.9984ms
2025-09-17 15:36:43.739 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:43.750 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:43.753 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 15:36:43.755 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 15:36:43.757 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 23.5765ms
2025-09-17 15:36:43.758 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 15:36:43.769 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:43.773 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 15:36:43.773 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:43.774 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 15:36:43.781 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:43.784 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 15:36:43.788 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:43.789 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 16.2266ms
2025-09-17 15:36:43.791 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 15:36:43.794 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 19.5766ms
2025-09-17 15:36:43.801 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 15:36:43.802 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 43.9421ms
2025-09-17 15:36:43.812 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 15:36:43.819 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:43.828 +08:00 [INF] CORS policy execution successful.
2025-09-17 15:36:43.832 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:43.833 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 15:36:43.836 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 15:36:43.839 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 15:36:43.841 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 15:36:43.843 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 15:36:43.851 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 15:36:43.851 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 15:36:43.859 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 15:36:43.862 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 15:36:43.866 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 15:36:43.870 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:43.872 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:43.878 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:43.883 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:43.888 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:43.891 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:43.896 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:43.902 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:43.905 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:43.909 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:43.916 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:43.919 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:43.922 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:43.926 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:43.933 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:43.936 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:43.941 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:43.946 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 15:36:43.952 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:43.957 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 15:36:43.960 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:43.968 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 15:36:43.971 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:43.973 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 15:36:43.982 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:43.983 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 136.9836ms
2025-09-17 15:36:43.990 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:43.991 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 15:36:44.002 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:44.002 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 201.9614ms
2025-09-17 15:36:44.013 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:44.026 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:44.034 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:44.039 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:44.046 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:44.051 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:44.056 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:44.063 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:44.069 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:44.074 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 15:36:44.079 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:44.085 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 15:36:44.090 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 15:36:44.093 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 243.76ms
2025-09-17 15:36:44.098 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 15:36:44.100 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 288.0696ms
2025-09-17 15:37:40.172 +08:00 [INF] Application is shutting down...
2025-09-17 16:08:42.442 +08:00 [INF] Checking database connection...
2025-09-17 16:08:46.351 +08:00 [INF] Database connection successful.
2025-09-17 16:08:46.356 +08:00 [INF] Attempting to apply migrations...
2025-09-17 16:08:46.773 +08:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-17 16:08:48.135 +08:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-09-17 16:08:48.186 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-09-17 16:08:48.235 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-17 16:08:48.271 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-09-17 16:08:48.309 +08:00 [INF] Migrations applied successfully.
2025-09-17 16:08:48.320 +08:00 [INF] Starting data seeding...
2025-09-17 16:08:48.397 +08:00 [INF] User profile is available. Using 'C:\Users\Win11\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-17 16:08:49.113 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM courses AS c)
2025-09-17 16:08:49.130 +08:00 [INF] Database already contains data. Checking if data cleanup is needed...
2025-09-17 16:08:49.135 +08:00 [INF] Checking for missing data components...
2025-09-17 16:08:49.169 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM subscriptions AS s)
2025-09-17 16:08:49.181 +08:00 [INF] Data seeding completed.
2025-09-17 16:08:49.479 +08:00 [INF] Now listening on: http://localhost:5296
2025-09-17 16:08:49.482 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-17 16:08:49.484 +08:00 [INF] Hosting environment: Development
2025-09-17 16:08:49.486 +08:00 [INF] Content root path: C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-09-17 16:21:57.048 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 16:21:57.125 +08:00 [WRN] Failed to determine the https port for redirect.
2025-09-17 16:21:57.128 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:57.140 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 94.6595ms
2025-09-17 16:21:57.153 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:21:57.169 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:57.522 +08:00 [INF] Executed DbCommand (24ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:21:57.529 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:21:57.571 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:21:57.874 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-17 16:21:57.983 +08:00 [INF] Executed DbCommand (35ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:21:58.407 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:21:58.482 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 904.0022ms
2025-09-17 16:21:58.486 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:21:58.498 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 1345.3461ms
2025-09-17 16:21:58.509 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:21:58.514 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:58.516 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 7.0537ms
2025-09-17 16:21:58.524 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:21:58.536 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:58.557 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:21:58.580 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:21:58.589 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:21:58.592 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 67.7003ms
2025-09-17 16:21:58.595 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:21:58.605 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:58.623 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:21:58.627 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:21:58.627 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:21:58.668 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:21:58.681 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:58.747 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:58.767 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:21:58.772 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 145.3733ms
2025-09-17 16:21:58.774 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 147.7444ms
2025-09-17 16:21:58.780 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 499 null null 185.7212ms
2025-09-17 16:21:59.532 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:21:59.536 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:59.540 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:21:59.543 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:21:59.545 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:21:59.556 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:21:59.570 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:21:59.578 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 29.6493ms
2025-09-17 16:21:59.586 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:21:59.588 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 55.1503ms
2025-09-17 16:21:59.605 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:21:59.609 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:59.623 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:21:59.626 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:21:59.629 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:21:59.643 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:21:59.659 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:21:59.660 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:21:59.663 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:59.667 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 32.1149ms
2025-09-17 16:21:59.669 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:21:59.671 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:21:59.672 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 66.8268ms
2025-09-17 16:21:59.676 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:21:59.679 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:21:59.680 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 21.146ms
2025-09-17 16:21:59.706 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:21:59.711 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:59.718 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:21:59.721 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:21:59.723 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:21:59.725 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 18.8032ms
2025-09-17 16:21:59.734 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:21:59.738 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:59.743 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:21:59.752 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:21:59.754 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:21:59.755 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 20.5684ms
2025-09-17 16:21:59.773 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:21:59.779 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:59.793 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:21:59.800 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:21:59.805 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:21:59.808 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 34.1791ms
2025-09-17 16:21:59.809 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:21:59.822 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:21:59.826 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:59.837 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:21:59.840 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:21:59.845 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:21:59.861 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:21:59.940 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-17 16:22:00.006 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:00.022 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:22:00.059 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:22:00.068 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:22:00.120 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:22:00.141 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:22:00.159 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:22:00.167 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:00.184 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.196 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.205 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:00.209 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.213 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.218 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:00.221 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.225 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:22:00.225 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.232 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:00.236 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.241 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.244 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:00.245 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:00.249 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.253 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:00.253 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.257 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:00.259 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:00.262 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:00.268 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.270 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:00.274 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.278 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:00.282 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:00.285 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:00.287 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.289 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:00.293 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.295 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:00.298 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:00.303 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.309 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.312 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:00.318 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.322 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:00.325 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:22:00.334 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 271.4604ms
2025-09-17 16:22:00.337 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:22:00.338 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 516.0551ms
2025-09-17 16:22:00.339 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:22:00.356 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:22:00.360 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:22:00.379 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 504.47ms
2025-09-17 16:22:00.384 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:22:00.385 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 576.1479ms
2025-09-17 16:22:12.444 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 16:22:12.448 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:12.450 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 5.1285ms
2025-09-17 16:22:12.458 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:22:12.462 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:12.471 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:12.476 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:22:12.479 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:22:12.494 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:22:12.509 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:22:12.512 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 29.5923ms
2025-09-17 16:22:12.515 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:22:12.518 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 60.5016ms
2025-09-17 16:22:12.527 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:22:12.531 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:12.534 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 6.8195ms
2025-09-17 16:22:12.540 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:22:12.540 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:22:12.544 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:12.547 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:12.549 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 8.2671ms
2025-09-17 16:22:12.550 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:12.557 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:22:12.558 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:22:12.559 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 18.4298ms
2025-09-17 16:22:12.560 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:22:12.566 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:12.568 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:22:12.568 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:22:12.572 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:12.573 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:12.576 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:12.578 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:22:12.578 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 10.0482ms
2025-09-17 16:22:12.580 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 10.9766ms
2025-09-17 16:22:12.582 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:22:12.586 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:22:12.590 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:22:12.591 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 31.5961ms
2025-09-17 16:22:12.595 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:12.598 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:12.607 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:12.607 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:12.609 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:22:12.612 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:22:12.612 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:22:12.613 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:22:12.621 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:22:12.622 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:22:12.628 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:22:12.628 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:22:12.634 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:22:12.637 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:12.639 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:12.642 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.644 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:12.647 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.649 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:12.652 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:12.655 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:12.657 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.659 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:12.662 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.665 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:12.667 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:12.670 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:12.673 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.675 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:12.677 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.679 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:12.683 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:12.686 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:22:12.688 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.691 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:22:12.692 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.694 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:22:12.697 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:12.698 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 82.3341ms
2025-09-17 16:22:12.703 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:22:12.703 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.704 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 113.9417ms
2025-09-17 16:22:12.708 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.713 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:12.718 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.721 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.724 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:12.728 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.733 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.736 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:12.740 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.743 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.746 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:12.750 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.754 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:12.756 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:22:12.758 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 139.4851ms
2025-09-17 16:22:12.759 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:22:12.761 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 174.287ms
2025-09-17 16:22:20.642 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 16:22:20.676 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:20.689 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 42.494ms
2025-09-17 16:22:20.741 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:22:20.832 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:20.886 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:20.896 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:22:20.899 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:22:20.966 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:22:21.456 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:22:21.465 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 511.1477ms
2025-09-17 16:22:21.564 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:22:21.874 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 1132.9192ms
2025-09-17 16:22:21.906 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:22:23.436 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:22:23.886 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:23.893 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:23.901 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 1994.5857ms
2025-09-17 16:22:23.946 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 510.4202ms
2025-09-17 16:22:23.973 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:22:24.001 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:24.006 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:24.016 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:22:24.017 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:22:24.019 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 45.8995ms
2025-09-17 16:22:24.021 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:22:24.060 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:24.067 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:24.077 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:22:24.078 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:22:24.080 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 58.8948ms
2025-09-17 16:22:24.092 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:22:24.092 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:22:24.098 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:24.100 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:24.102 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 10.1826ms
2025-09-17 16:22:24.101 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 9.4991ms
2025-09-17 16:22:24.115 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:22:24.121 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:22:24.153 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:24.128 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:24.166 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:24.167 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:24.414 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:22:24.477 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:22:24.489 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:22:24.532 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:22:24.694 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:22:24.712 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:22:24.734 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:22:24.735 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:22:24.749 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:24.754 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:22:24.759 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:24.761 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:24.767 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:24.776 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:24.782 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:24.798 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:24.846 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:24.851 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:24.865 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:24.867 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:24.892 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:24.903 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:24.949 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:24.986 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:25.004 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:25.014 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:25.048 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:25.062 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:25.080 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:25.096 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:22:25.103 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:25.109 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:22:25.139 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:22:25.133 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:25.145 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 458.195ms
2025-09-17 16:22:25.149 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:25.152 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:22:25.160 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:25.161 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 1039.6827ms
2025-09-17 16:22:25.168 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:25.176 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:25.185 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:25.194 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:25.219 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:25.225 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:25.231 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:25.240 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:25.246 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:25.253 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:25.262 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:25.267 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:25.270 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:22:25.322 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 618.4107ms
2025-09-17 16:22:25.457 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:22:25.462 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 1347.6553ms
2025-09-17 16:22:29.618 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 16:22:29.623 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:29.625 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 7.226ms
2025-09-17 16:22:29.630 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:22:29.634 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:29.638 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:29.642 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:22:29.644 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:22:29.653 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:22:29.661 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:22:29.664 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 17.1864ms
2025-09-17 16:22:29.666 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:22:29.668 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 38.3114ms
2025-09-17 16:22:29.677 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:22:29.681 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:29.682 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 5.4615ms
2025-09-17 16:22:29.691 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:22:29.695 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:29.699 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:29.705 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:22:29.707 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:22:29.709 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 17.824ms
2025-09-17 16:22:29.710 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:22:29.723 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:29.724 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:22:29.724 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:22:29.727 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:29.729 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:29.732 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:29.738 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:22:29.739 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 15.2704ms
2025-09-17 16:22:29.740 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 16.0325ms
2025-09-17 16:22:29.742 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:22:29.746 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:22:29.752 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:22:29.753 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 43.0984ms
2025-09-17 16:22:29.758 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:29.762 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:29.774 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:29.776 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:29.777 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:22:29.780 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:22:29.782 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:22:29.783 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:22:29.790 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:22:29.796 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:22:29.796 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:22:29.806 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:22:29.809 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:29.813 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:22:29.816 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:29.820 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:29.823 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:29.826 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:29.829 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:29.832 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:29.839 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:29.840 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:29.844 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:29.846 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:29.849 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:29.852 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:29.858 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:29.860 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:29.864 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:29.866 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:29.873 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:29.876 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:29.880 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:29.883 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:22:29.888 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:29.893 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:22:29.895 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:29.896 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:22:29.901 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:29.904 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 112.3391ms
2025-09-17 16:22:29.914 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:29.914 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:22:29.922 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:29.931 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 178.4253ms
2025-09-17 16:22:29.943 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:29.960 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:29.966 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:29.977 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:29.982 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:29.995 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:30.007 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:30.015 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:30.023 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:30.029 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:30.035 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:30.039 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:22:30.042 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 253.4933ms
2025-09-17 16:22:30.045 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:22:30.047 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 300.5416ms
2025-09-17 16:22:57.561 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 16:22:57.564 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:57.565 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 4.3845ms
2025-09-17 16:22:57.569 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/courses - application/json 729
2025-09-17 16:22:57.573 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:57.577 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:57.581 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse (CeceLearningPortal.Api)'
2025-09-17 16:22:57.586 +08:00 [INF] Route matched with {action = "CreateCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCourse(CeceLearningPortal.Api.DTOs.CreateCourseDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:22:57.632 +08:00 [ERR] Error creating course
System.ArgumentException: Requested value 'one-time' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at System.Enum.Parse[TEnum](String value, Boolean ignoreCase)
   at CeceLearningPortal.Api.Services.CourseService.CreateCourseAsync(CreateCourseDto courseDto, String instructorId) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 232
   at CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse(CreateCourseDto courseDto) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 140
2025-09-17 16:22:57.650 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:22:57.653 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse (CeceLearningPortal.Api) in 64.311ms
2025-09-17 16:22:57.655 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse (CeceLearningPortal.Api)'
2025-09-17 16:22:57.658 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/courses - 500 null application/json; charset=utf-8 88.3457ms
2025-09-17 16:22:59.606 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:22:59.611 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:59.615 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:59.619 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:22:59.621 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:22:59.632 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:22:59.640 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:22:59.644 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 19.3718ms
2025-09-17 16:22:59.646 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:22:59.648 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 41.9517ms
2025-09-17 16:22:59.664 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:22:59.669 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:59.671 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:22:59.671 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 7.4526ms
2025-09-17 16:22:59.679 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:59.682 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:22:59.683 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 11.6649ms
2025-09-17 16:22:59.687 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:59.697 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:59.700 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:22:59.701 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:22:59.703 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 20.6536ms
2025-09-17 16:22:59.704 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:22:59.717 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:59.719 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:22:59.721 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:22:59.725 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:59.727 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:59.730 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:59.733 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:22:59.734 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 14.5464ms
2025-09-17 16:22:59.735 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 14.2298ms
2025-09-17 16:22:59.737 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:22:59.744 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:22:59.748 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:22:59.749 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 45.3697ms
2025-09-17 16:22:59.759 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:59.762 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:22:59.770 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:59.771 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:22:59.775 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:22:59.778 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:22:59.779 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:22:59.781 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:22:59.788 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:22:59.794 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:22:59.795 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:22:59.800 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:22:59.802 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:59.806 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:22:59.809 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.811 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:59.815 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.819 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:59.832 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:59.835 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:59.840 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.845 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:59.848 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.851 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:59.853 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:59.856 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:59.860 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.862 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:59.864 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.867 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:59.869 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:59.873 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:22:59.877 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.880 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:22:59.883 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.886 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:22:59.888 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:59.894 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:22:59.898 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.899 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 109.8783ms
2025-09-17 16:22:59.903 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.903 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:22:59.907 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:59.909 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 161.3041ms
2025-09-17 16:22:59.914 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.921 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.927 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:59.931 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.936 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.945 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:59.949 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.953 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.958 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:22:59.963 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.967 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:22:59.974 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:22:59.976 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 193.0314ms
2025-09-17 16:22:59.978 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:22:59.980 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 235.8118ms
2025-09-17 16:23:07.910 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 16:23:07.913 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:23:07.914 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 4.389ms
2025-09-17 16:23:07.918 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:23:07.922 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:23:07.925 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:23:07.927 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:23:07.929 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:23:07.939 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:23:07.948 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:23:07.953 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 18.9334ms
2025-09-17 16:23:07.954 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:23:07.956 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 37.5008ms
2025-09-17 16:23:07.967 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:23:07.971 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:23:07.971 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:23:07.975 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:23:07.976 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 9.519ms
2025-09-17 16:23:07.987 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 15.9157ms
2025-09-17 16:23:07.992 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:23:08.003 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:23:08.006 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:23:08.009 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:23:08.011 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:23:08.014 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 22.7401ms
2025-09-17 16:23:08.016 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:23:08.024 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:23:08.025 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:23:08.027 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:23:08.027 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:23:08.029 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:23:08.032 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:23:08.035 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:23:08.036 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 11.0007ms
2025-09-17 16:23:08.037 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 10.4187ms
2025-09-17 16:23:08.038 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:23:08.043 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:23:08.047 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:23:08.049 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 32.7873ms
2025-09-17 16:23:08.052 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:23:08.055 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:23:08.064 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:23:08.065 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:23:08.068 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:23:08.071 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:23:08.072 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:23:08.074 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:23:08.078 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/courses - application/json 729
2025-09-17 16:23:08.080 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:23:08.088 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:23:08.089 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:23:08.092 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:23:08.098 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:23:08.103 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:23:08.105 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:23:08.108 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.113 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:23:08.119 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.122 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:23:08.125 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:23:08.128 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:23:08.133 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.138 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:23:08.141 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.143 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:23:08.146 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:23:08.151 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:23:08.157 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.159 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:23:08.162 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.168 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:23:08.172 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:23:08.172 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:23:08.176 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:23:08.177 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse (CeceLearningPortal.Api)'
2025-09-17 16:23:08.186 +08:00 [INF] Route matched with {action = "CreateCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCourse(CeceLearningPortal.Api.DTOs.CreateCourseDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:23:08.187 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:23:08.187 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.193 +08:00 [ERR] Error creating course
System.ArgumentException: Requested value 'one-time' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at System.Enum.Parse[TEnum](String value, Boolean ignoreCase)
   at CeceLearningPortal.Api.Services.CourseService.CreateCourseAsync(CreateCourseDto courseDto, String instructorId) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 232
   at CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse(CreateCourseDto courseDto) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 140
2025-09-17 16:23:08.196 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:23:08.200 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.203 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:23:08.206 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:23:08.209 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:23:08.210 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse (CeceLearningPortal.Api) in 20.9204ms
2025-09-17 16:23:08.213 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 127.87ms
2025-09-17 16:23:08.220 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.220 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.CreateCourse (CeceLearningPortal.Api)'
2025-09-17 16:23:08.222 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:23:08.226 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.226 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/courses - 500 null application/json; charset=utf-8 147.9736ms
2025-09-17 16:23:08.228 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 180.3514ms
2025-09-17 16:23:08.234 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:23:08.296 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.326 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.329 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:23:08.335 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.343 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.360 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:23:08.364 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.372 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.375 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:23:08.378 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.384 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:23:08.386 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:23:08.388 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 310.8362ms
2025-09-17 16:23:08.390 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:23:08.391 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 348.3395ms
2025-09-17 16:24:23.985 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 16:24:23.992 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:24:23.995 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 9.4234ms
2025-09-17 16:24:24.000 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:24:24.005 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:24:24.012 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:24:24.016 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:24:24.019 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:24:24.028 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:24:24.034 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:24:24.038 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 16.3317ms
2025-09-17 16:24:24.045 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:24:24.047 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 46.9215ms
2025-09-17 16:24:24.068 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:24:24.069 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:24:24.076 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:24:24.071 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:24:24.078 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 9.0044ms
2025-09-17 16:24:24.079 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 10.2794ms
2025-09-17 16:24:24.089 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:24:24.095 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:24:24.120 +08:00 [INF] Executed DbCommand (23ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:24:24.127 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:24:24.128 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:24:24.130 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 40.2949ms
2025-09-17 16:24:24.131 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:24:24.140 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:24:24.146 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:24:24.146 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:24:24.148 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:24:24.152 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:24:24.155 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:24:24.162 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:24:24.164 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 18.0799ms
2025-09-17 16:24:24.164 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 17.8516ms
2025-09-17 16:24:24.165 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:24:24.183 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:24:24.186 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:24:24.187 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 56.3798ms
2025-09-17 16:24:24.199 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:24:24.202 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:24:24.213 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:24:24.215 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:24:24.216 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:24:24.219 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:24:24.220 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:24:24.221 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:24:24.233 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:24:24.235 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:24:24.237 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:24:24.245 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:24:24.246 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:24:24.249 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.254 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:24:24.257 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.261 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:24:24.263 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:24:24.266 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:24:24.269 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.271 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:24:24.275 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.278 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:24:24.280 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:24:24.283 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:24:24.286 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.288 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:24:24.294 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.296 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:24:24.298 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:24:24.301 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:24:24.304 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.308 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:24:24.318 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.320 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:24:24.323 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:24:24.328 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:24:24.328 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.331 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:24:24.334 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.336 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 104.9986ms
2025-09-17 16:24:24.341 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:24:24.342 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:24:24.346 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 159.0234ms
2025-09-17 16:24:24.346 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.356 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.363 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:24:24.368 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.371 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.378 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:24:24.383 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.386 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.403 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:24:24.413 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.417 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:24:24.425 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:24:24.429 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 200.2027ms
2025-09-17 16:24:24.432 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:24:24.434 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 250.5845ms
2025-09-17 16:29:35.072 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:29:35.075 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.076 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 4.5611ms
2025-09-17 16:29:35.085 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 16:29:35.085 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:29:35.091 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.095 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.098 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 16:29:35.099 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 13.7701ms
2025-09-17 16:29:35.111 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.123 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:29:35.124 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 25.4365ms
2025-09-17 16:29:35.140 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.188 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:35.195 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:29:35.196 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:29:35.197 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 111.8781ms
2025-09-17 16:29:35.258 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:35.327 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:29:35.353 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:29:35.374 +08:00 [INF] Executed DbCommand (16ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:29:35.382 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:29:35.392 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 35.9316ms
2025-09-17 16:29:35.393 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:29:35.393 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:29:35.397 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.398 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 275.096ms
2025-09-17 16:29:35.401 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:35.407 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:29:35.410 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:29:35.417 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:29:35.419 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:29:35.424 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.431 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:29:35.433 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:35.437 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:29:35.440 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:29:35.434 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 21.7627ms
2025-09-17 16:29:35.445 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:29:35.442 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 24.7132ms
2025-09-17 16:29:35.449 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 55.7859ms
2025-09-17 16:29:35.461 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:29:35.464 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.465 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:29:35.466 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:29:35.467 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:35.470 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.473 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.475 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:29:35.478 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:29:35.477 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 10.314ms
2025-09-17 16:29:35.476 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 10.8056ms
2025-09-17 16:29:35.491 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 30.111ms
2025-09-17 16:29:35.493 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:29:35.496 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:29:35.503 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:29:35.510 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.513 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.519 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.522 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:35.523 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:35.527 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:29:35.533 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:29:35.529 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:29:35.536 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 43.334ms
2025-09-17 16:29:35.540 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:29:35.560 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:29:35.572 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:29:35.579 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:29:35.584 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.589 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.593 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.596 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.601 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.606 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.608 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:35.610 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.612 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:29:35.616 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.616 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:29:35.625 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.628 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:29:35.639 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:29:35.645 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:29:35.647 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:29:35.653 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:35.657 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:29:35.658 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:29:35.665 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.665 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.675 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 128.6476ms
2025-09-17 16:29:35.676 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:29:35.678 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:35.680 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:29:35.682 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.688 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.692 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:29:35.693 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 197.1335ms
2025-09-17 16:29:35.697 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:35.700 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:35.703 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:29:35.716 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.718 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:29:35.723 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 65.7197ms
2025-09-17 16:29:35.729 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.732 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:29:35.744 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:35.750 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:29:35.752 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.760 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:29:35.761 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.766 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:29:35.771 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:35.774 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.777 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.780 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.784 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.788 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.794 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:35.796 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.799 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.804 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.807 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.811 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.815 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:35.819 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.822 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.825 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.828 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.832 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:35.838 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:35.841 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:29:35.844 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.849 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:29:35.851 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.858 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:29:35.862 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:35.864 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 118.1394ms
2025-09-17 16:29:35.872 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:29:35.873 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 196.7234ms
2025-09-17 16:29:35.873 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.881 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.886 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:35.890 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.895 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:35.898 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:29:35.903 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 277.4642ms
2025-09-17 16:29:35.904 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:29:35.907 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:29:35.910 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:35.911 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 408.5347ms
2025-09-17 16:29:35.916 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:35.925 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:29:35.927 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:29:35.937 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:29:35.967 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:29:35.980 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:36.003 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.011 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.025 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:36.031 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.045 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.060 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:36.073 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.081 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.104 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:36.111 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.122 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.140 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:36.145 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.156 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.160 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:36.165 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.175 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.178 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:36.185 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.192 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.196 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:36.202 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.208 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.215 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:36.221 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.227 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:36.230 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:29:36.240 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 308.5485ms
2025-09-17 16:29:36.243 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:29:36.245 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 340.7792ms
2025-09-17 16:29:38.685 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:29:38.691 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:38.695 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:38.704 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:29:38.706 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:29:38.716 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:29:38.724 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:29:38.727 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 17.3011ms
2025-09-17 16:29:38.732 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:29:38.734 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 49.4266ms
2025-09-17 16:29:38.746 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:29:38.756 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:38.759 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:38.762 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:29:38.764 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:29:38.766 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 19.8347ms
2025-09-17 16:29:38.769 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:29:38.779 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:29:38.779 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:29:38.780 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:38.784 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:38.787 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:29:38.791 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:38.792 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:38.795 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:29:38.797 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:29:38.800 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:29:38.803 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:29:38.804 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:29:38.806 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:29:38.807 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:29:38.808 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 39.3249ms
2025-09-17 16:29:38.819 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:29:38.820 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:29:38.823 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:29:38.827 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:29:38.828 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:38.832 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:29:38.835 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.838 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:38.840 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.842 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:38.844 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:38.847 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:38.851 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.853 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:38.855 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.857 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:38.859 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:38.862 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:38.866 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.869 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:38.897 +08:00 [INF] Executed DbCommand (27ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.902 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:38.904 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:38.907 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:29:38.910 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.914 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:29:38.917 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.923 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:38.923 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:29:38.939 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.942 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:29:38.948 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.951 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 140.9234ms
2025-09-17 16:29:38.955 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:38.955 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:29:38.959 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 180.3028ms
2025-09-17 16:29:38.959 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.968 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.972 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:38.976 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.981 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.984 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:38.987 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.993 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:38.999 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:29:39.003 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:39.009 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:29:39.053 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:29:39.124 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 311.399ms
2025-09-17 16:29:39.129 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:29:39.132 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 352.6331ms
2025-09-17 16:30:05.076 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 16:30:05.079 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:05.080 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 3.8931ms
2025-09-17 16:30:05.083 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:30:05.086 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:05.091 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:05.094 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:30:05.096 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:30:05.105 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:30:05.110 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:30:05.113 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 15.3975ms
2025-09-17 16:30:05.115 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:30:05.116 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 33.1685ms
2025-09-17 16:30:05.124 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:30:05.128 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:05.128 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:30:05.132 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:05.129 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 4.6483ms
2025-09-17 16:30:05.133 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 5.2338ms
2025-09-17 16:30:05.137 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:30:05.145 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:05.149 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:05.152 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:30:05.154 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:30:05.156 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 18.6379ms
2025-09-17 16:30:05.157 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:30:05.164 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:05.166 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:30:05.167 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:30:05.167 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:05.171 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:05.174 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:05.177 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:30:05.178 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 11.9954ms
2025-09-17 16:30:05.179 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 11.9633ms
2025-09-17 16:30:05.183 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:30:05.187 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:30:05.191 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:30:05.192 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 34.6293ms
2025-09-17 16:30:05.196 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:05.201 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:05.208 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:05.208 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:05.211 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:30:05.214 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:30:05.215 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:30:05.216 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:30:05.219 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:30:05.225 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:30:05.225 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:30:05.230 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:30:05.232 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:05.235 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:30:05.237 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.241 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:05.245 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.247 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:05.250 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:05.252 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:05.255 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.259 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:05.262 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.264 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:05.266 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:05.268 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:05.273 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.276 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:05.279 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.281 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:05.284 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:05.288 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:05.294 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.297 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:30:05.298 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.303 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:30:05.303 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:05.307 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:30:05.311 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.312 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 92.0902ms
2025-09-17 16:30:05.316 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.319 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:30:05.327 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:05.329 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 137.8284ms
2025-09-17 16:30:05.334 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.344 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.348 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:05.353 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.359 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.362 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:05.367 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.398 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.410 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:05.415 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.419 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:05.422 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:30:05.424 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 206.6081ms
2025-09-17 16:30:05.426 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:30:05.428 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 241.5434ms
2025-09-17 16:30:52.107 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 16:30:52.116 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:52.117 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 9.9272ms
2025-09-17 16:30:52.315 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:30:52.320 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:52.330 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:52.354 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:30:52.355 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:30:52.368 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:30:52.386 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:30:52.388 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 25.6215ms
2025-09-17 16:30:52.390 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:30:52.395 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 80.3771ms
2025-09-17 16:30:52.417 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:30:52.423 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:52.420 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:30:52.426 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 9.2173ms
2025-09-17 16:30:52.435 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:52.451 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 31.6033ms
2025-09-17 16:30:52.450 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:30:52.468 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:52.473 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:52.481 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:30:52.482 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:30:52.484 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 34.1274ms
2025-09-17 16:30:52.485 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:30:52.496 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:52.499 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:52.501 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:30:52.502 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:30:52.504 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 18.4637ms
2025-09-17 16:30:52.517 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:30:52.518 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:30:52.520 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:52.524 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:52.526 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 8.6382ms
2025-09-17 16:30:52.529 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 11.2304ms
2025-09-17 16:30:52.544 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:30:52.535 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:30:52.550 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:52.556 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:52.561 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:52.563 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:52.565 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:30:52.567 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:30:52.568 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:30:52.569 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:30:52.575 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:30:52.576 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:30:52.582 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:30:52.584 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:30:52.590 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:30:52.595 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:52.598 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:52.602 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.605 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:52.610 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.612 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:52.615 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:52.617 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:52.620 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.622 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:52.628 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.630 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:52.634 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:52.637 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:52.640 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.645 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:52.700 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.701 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:52.715 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:52.721 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:30:52.725 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.732 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:30:52.737 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.739 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:30:52.747 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:52.750 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 178.9478ms
2025-09-17 16:30:52.756 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.764 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:30:52.770 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.771 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 226.2964ms
2025-09-17 16:30:52.777 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:52.788 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.799 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.803 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:52.811 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.816 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.820 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:52.828 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.833 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.837 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:52.841 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.851 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:52.855 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:30:52.863 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 289.7971ms
2025-09-17 16:30:52.871 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:30:52.879 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 343.5305ms
2025-09-17 16:30:57.979 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:30:57.981 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 16:30:57.982 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:57.988 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:57.989 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 9.8699ms
2025-09-17 16:30:57.990 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 9.2935ms
2025-09-17 16:30:57.997 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:30:58.015 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:30:58.032 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:58.035 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:58.041 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:58.043 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:58.047 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:30:58.059 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:30:58.062 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:30:58.064 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:30:58.068 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 53.8221ms
2025-09-17 16:30:58.076 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:30:58.111 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:30:58.117 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 50.0539ms
2025-09-17 16:30:58.140 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:30:58.151 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:30:58.165 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:30:58.177 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:58.180 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:58.182 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 185.7075ms
2025-09-17 16:30:58.187 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:58.190 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:58.200 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:30:58.214 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:30:58.238 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:30:58.244 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 103.7573ms
2025-09-17 16:30:58.242 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:30:58.251 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:30:58.384 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:30:58.416 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:58.520 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:58.521 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:30:58.536 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:30:58.568 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 191.2219ms
2025-09-17 16:30:58.578 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:30:58.597 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:30:58.599 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 347.7353ms
2025-09-17 16:30:58.601 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 449.951ms
2025-09-17 16:30:58.635 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:30:58.643 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:30:58.654 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:30:58.660 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:58.666 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:58.696 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:58.699 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 63.8936ms
2025-09-17 16:30:58.709 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:58.724 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 69.7989ms
2025-09-17 16:30:58.993 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:30:59.017 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:30:59.082 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:30:59.063 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:30:59.084 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:59.095 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 451.7214ms
2025-09-17 16:30:59.108 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:59.133 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:59.216 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:59.229 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:30:59.243 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:30:59.275 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:30:59.278 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:30:59.346 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:30:59.392 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:30:59.399 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:30:59.447 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:30:59.487 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:30:59.505 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:30:59.524 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:30:59.543 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:30:59.563 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:30:59.579 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:30:59.584 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:59.602 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:59.614 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:30:59.626 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 279.9175ms
2025-09-17 16:30:59.621 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:30:59.626 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:30:59.814 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:00.048 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:00.665 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:01.431 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:01.446 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:01.446 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:01.461 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:01.467 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:01.479 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:01.494 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:01.497 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:01.513 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:01.514 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:01.573 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:01.578 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:31:01.591 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:01.599 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:31:01.608 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:01.657 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:31:01.895 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:01.961 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:31:01.961 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 2580.1282ms
2025-09-17 16:31:01.967 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:31:01.978 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:01.995 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:01.997 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:31:02.014 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:02.029 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:02.033 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:02.035 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 3041.7309ms
2025-09-17 16:31:02.044 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:02.047 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:31:02.061 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:02.130 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:31:02.179 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:31:02.176 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:02.143 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:31:02.215 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:31:02.235 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:02.246 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 284.9444ms
2025-09-17 16:31:02.286 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:31:02.314 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:02.360 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:31:02.368 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:02.395 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:02.415 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:02.427 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:02.446 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:02.458 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:02.462 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:02.465 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:02.482 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:02.488 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:02.518 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:02.527 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:02.547 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:02.547 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:02.625 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:02.633 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:02.646 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:31:02.661 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:02.693 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 3305.3752ms
2025-09-17 16:31:02.701 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:31:02.701 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:31:02.723 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:31:02.741 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:02.747 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 3684.2461ms
2025-09-17 16:31:02.748 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:31:02.757 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:02.771 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:31:02.777 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:31:02.780 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 569.5738ms
2025-09-17 16:31:02.793 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:31:02.796 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:31:02.812 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:31:02.822 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 854.5583ms
2025-09-17 16:31:02.830 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:31:02.851 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:02.860 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:02.877 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:02.893 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:02.907 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:02.924 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:02.946 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:02.958 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:02.972 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:03.009 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:03.026 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:03.041 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:03.056 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:03.062 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:03.075 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:03.080 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:03.090 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:03.099 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:03.107 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:03.115 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:03.124 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:03.137 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:03.147 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:03.179 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:03.190 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:03.206 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:03.221 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:03.226 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:31:03.230 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 420.3773ms
2025-09-17 16:31:03.243 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:31:03.251 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 550.1459ms
2025-09-17 16:31:47.991 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-17 16:31:47.995 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-17 16:31:47.998 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.002 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.003 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 12.0706ms
2025-09-17 16:31:48.004 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 9.706ms
2025-09-17 16:31:48.016 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:31:48.022 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:31:48.027 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.032 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.035 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:48.036 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:48.044 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:31:48.047 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:31:48.051 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:31:48.052 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:31:48.081 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:31:48.082 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 59.7657ms
2025-09-17 16:31:48.101 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:31:48.107 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 38.3823ms
2025-09-17 16:31:48.116 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:31:48.117 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 101.4019ms
2025-09-17 16:31:48.151 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:31:48.156 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-17 16:31:48.161 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.165 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.170 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:48.180 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:48.184 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:31:48.196 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:31:48.199 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:31:48.200 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-17 16:31:48.202 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 50.8424ms
2025-09-17 16:31:48.204 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:31:48.221 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-17 16:31:48.235 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.251 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:48.251 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-17 16:31:48.266 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:31:48.269 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:31:48.268 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 62.8798ms
2025-09-17 16:31:48.282 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 77.9124ms
2025-09-17 16:31:48.284 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:31:48.321 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.318 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:31:48.338 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.333 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:48.337 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-17 16:31:48.287 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-17 16:31:48.340 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 22.2942ms
2025-09-17 16:31:48.354 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:31:48.364 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.366 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 209.5207ms
2025-09-17 16:31:48.381 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:31:48.383 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:31:48.384 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 47.3543ms
2025-09-17 16:31:48.398 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.400 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 116.3165ms
2025-09-17 16:31:48.411 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:31:48.415 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:48.434 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.440 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:31:48.445 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:31:48.445 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:48.449 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:31:48.454 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:31:48.460 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:31:48.463 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.471 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:31:48.471 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:31:48.475 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:48.479 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:31:48.484 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:31:48.493 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:31:48.498 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:31:48.502 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.502 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:31:48.509 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:48.515 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.516 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 66.3928ms
2025-09-17 16:31:48.526 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.529 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.549 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.553 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.559 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:48.562 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.566 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.569 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.576 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.581 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.584 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:48.586 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-17 16:31:48.595 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.598 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.601 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.608 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.613 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.615 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:48.619 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:31:48.623 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:48.628 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-17 16:31:48.634 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:31:48.636 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.636 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-09-17 16:31:48.640 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:31:48.646 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.646 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 403 0 null 60.3708ms
2025-09-17 16:31:48.663 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:31:48.660 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:48.652 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 201.9479ms
2025-09-17 16:31:48.667 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.679 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.681 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:31:48.684 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:48.694 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.694 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 313.8612ms
2025-09-17 16:31:48.698 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:31:48.702 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:48.717 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-17 16:31:48.724 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.733 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-09-17 16:31:48.734 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.746 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-09-17 16:31:48.748 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:48.755 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-09-17 16:31:48.762 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.768 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.779 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.782 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.785 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:48.795 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.798 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.800 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.807 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.812 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.815 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:48.819 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.826 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.829 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.833 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.837 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.842 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:31:48.847 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-09-17 16:31:48.848 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 372.0606ms
2025-09-17 16:31:48.850 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-17 16:31:48.860 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:31:48.861 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-09-17 16:31:48.865 +08:00 [INF] CORS policy execution successful.
2025-09-17 16:31:48.866 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 455.1022ms
2025-09-17 16:31:48.876 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-09-17 16:31:48.878 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-17 16:31:48.884 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-17 16:31:48.892 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:31:48.895 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 167.9996ms
2025-09-17 16:31:48.897 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-09-17 16:31:48.900 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-09-17 16:31:48.905 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 242.3267ms
2025-09-17 16:31:48.906 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-09-17 16:31:48.919 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-09-17 16:31:48.927 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:48.932 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.939 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.948 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:48.953 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.960 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.964 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:48.969 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.977 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.981 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:48.986 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:48.996 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:49.000 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:49.009 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:49.015 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:49.021 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:49.028 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:49.033 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:49.039 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:49.044 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:49.051 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:49.064 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:49.068 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:49.077 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:49.081 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-09-17 16:31:49.086 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:49.094 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-09-17 16:31:49.097 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-09-17 16:31:49.099 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 196.132ms
2025-09-17 16:31:49.101 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-09-17 16:31:49.105 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 255.2326ms
