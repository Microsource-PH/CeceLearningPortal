2025-09-25 08:08:06.097 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 08:08:06.097 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 08:08:06.166 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:08:06.167 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:08:06.181 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 84.1706ms
2025-09-25 08:08:06.189 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 92.4058ms
2025-09-25 08:08:06.212 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 08:08:06.219 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 08:08:06.245 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:08:06.250 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:08:06.258 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 08:08:06.259 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 08:08:06.264 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 08:08:06.266 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 08:08:06.276 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 64.3999ms
2025-09-25 08:08:06.367 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 08:08:06.383 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 08:08:06.394 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:08:06.413 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:08:06.415 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 47.168ms
2025-09-25 08:08:06.428 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 44.9047ms
2025-09-25 08:08:06.447 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 08:08:06.519 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 08:08:06.534 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:08:06.541 +08:00 [INF] Executed DbCommand (110ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 08:08:06.560 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:08:06.564 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/24/2025 11:09:16 AM', Current time (UTC): '9/25/2025 12:08:06 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-25 08:08:06.593 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 73.99ms
2025-09-25 08:08:06.626 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/24/2025 11:09:16 AM', Current time (UTC): '9/25/2025 12:08:06 AM'.
2025-09-25 08:08:06.644 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 08:08:06.661 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 08:08:06.668 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 399.4096ms
2025-09-25 08:08:06.663 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/24/2025 11:09:16 AM', Current time (UTC): '9/25/2025 12:08:06 AM'.
2025-09-25 08:08:06.679 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 08:08:06.691 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:08:06.693 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 08:08:06.709 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:08:06.731 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:08:06.733 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 08:08:06.735 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 515.6493ms
2025-09-25 08:08:06.752 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 08:08:06.760 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/24/2025 11:09:16 AM', Current time (UTC): '9/25/2025 12:08:06 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-25 08:08:06.763 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 08:08:06.793 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 08:08:06.800 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/24/2025 11:09:16 AM', Current time (UTC): '9/25/2025 12:08:06 AM'.
2025-09-25 08:08:06.814 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 366.5652ms
2025-09-25 08:08:06.836 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 08:08:06.845 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/24/2025 11:09:16 AM', Current time (UTC): '9/25/2025 12:08:06 AM'.
2025-09-25 08:08:06.878 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:08:06.900 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 08:08:06.910 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 08:08:06.934 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 08:08:06.949 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 08:08:06.959 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 31.2281ms
2025-09-25 08:08:06.964 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 08:08:06.966 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 286.6904ms
2025-09-25 08:08:07.000 +08:00 [INF] Executed DbCommand (21ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 08:08:07.025 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 08:08:07.030 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 218.0051ms
2025-09-25 08:08:07.042 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 08:08:07.048 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 386.633ms
2025-09-25 08:08:07.064 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 08:08:07.068 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:08:07.079 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:08:07.084 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 08:08:07.096 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 08:08:07.111 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 08:08:07.123 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 08:08:07.156 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 08:08:07.169 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 08:08:07.205 +08:00 [INF] Executed DbCommand (16ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 08:08:07.232 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 08:08:07.257 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 08:08:07.268 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 08:08:07.286 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 08:08:07.320 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 08:08:07.331 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 08:08:07.334 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 235.5883ms
2025-09-25 08:08:07.344 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 08:08:07.348 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 283.8566ms
2025-09-25 08:15:18.088 +08:00 [INF] Application is shutting down...
2025-09-25 08:24:34.794 +08:00 [INF] Checking database connection...
2025-09-25 08:24:37.239 +08:00 [INF] Database connection successful.
2025-09-25 08:24:37.242 +08:00 [INF] Attempting to apply migrations...
2025-09-25 08:24:37.467 +08:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-25 08:24:38.314 +08:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-09-25 08:24:38.350 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-09-25 08:24:38.360 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-25 08:24:38.380 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-09-25 08:24:38.404 +08:00 [INF] Migrations applied successfully.
2025-09-25 08:24:38.406 +08:00 [INF] Starting data seeding...
2025-09-25 08:24:38.442 +08:00 [INF] User profile is available. Using 'C:\Users\Win11\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-25 08:24:38.824 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM courses AS c)
2025-09-25 08:24:38.841 +08:00 [INF] Database already contains data. Checking if data cleanup is needed...
2025-09-25 08:24:38.843 +08:00 [INF] Checking for missing data components...
2025-09-25 08:24:38.855 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM subscriptions AS s)
2025-09-25 08:24:38.859 +08:00 [INF] Data seeding completed.
2025-09-25 08:24:39.006 +08:00 [INF] Now listening on: http://localhost:5296
2025-09-25 08:24:39.008 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-25 08:24:39.010 +08:00 [INF] Hosting environment: Development
2025-09-25 08:24:39.012 +08:00 [INF] Content root path: C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-09-25 08:31:06.671 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 08:31:06.671 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 08:31:06.685 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 08:31:06.685 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 08:31:06.798 +08:00 [WRN] Failed to determine the https port for redirect.
2025-09-25 08:31:06.803 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:06.803 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:06.803 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:06.803 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:06.815 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 147.3696ms
2025-09-25 08:31:06.816 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 129.2578ms
2025-09-25 08:31:06.816 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 129.266ms
2025-09-25 08:31:06.816 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 148.7998ms
2025-09-25 08:31:06.835 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 08:31:06.850 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 08:31:06.867 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:06.867 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:07.308 +08:00 [INF] Executed DbCommand (17ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:31:07.308 +08:00 [INF] Executed DbCommand (18ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:31:07.318 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 08:31:07.325 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 08:31:07.342 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 08:31:07.349 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 08:31:07.484 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 08:31:07.500 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 08:31:07.533 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 08:31:07.556 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 08:31:07.653 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 08:31:07.707 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-25 08:31:07.734 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 08:31:07.773 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 08:31:07.797 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 08:31:07.819 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 08:31:07.825 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 08:31:07.846 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 08:31:07.866 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 08:31:07.950 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 08:31:07.956 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:07.956 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 603.4172ms
2025-09-25 08:31:07.961 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 08:31:07.974 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 08:31:07.979 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 1129.1351ms
2025-09-25 08:31:07.991 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 08:31:08.007 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 56.7877ms
2025-09-25 08:31:08.041 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 08:31:08.056 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:08.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 16.6052ms
2025-09-25 08:31:08.071 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 08:31:08.078 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:08.080 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 08:31:08.090 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 08:31:08.178 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 08:31:08.474 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 08:31:08.544 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 1190.7689ms
2025-09-25 08:31:08.548 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 08:31:08.550 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 08:31:08.554 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:08.556 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 1721.0022ms
2025-09-25 08:31:08.566 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 08:31:08.578 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 08:31:08.604 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 08:31:08.641 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 08:31:08.645 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 56.8244ms
2025-09-25 08:31:08.651 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 08:31:08.654 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 105.5835ms
2025-09-25 08:31:08.664 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 08:31:08.718 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 08:31:08.724 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 630.7475ms
2025-09-25 08:31:08.727 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 08:31:08.730 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 658.2319ms
2025-09-25 08:31:08.740 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 08:31:08.744 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:08.746 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 5.9772ms
2025-09-25 08:31:08.753 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 08:31:08.757 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:08.763 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:31:08.771 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 08:31:08.773 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 08:31:08.778 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 08:31:08.785 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 08:31:08.791 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 08:31:08.797 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 08:31:08.808 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 08:31:08.816 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 08:31:08.823 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 08:31:08.831 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 08:31:08.838 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 08:31:08.845 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 08:31:08.851 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 08:31:08.854 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 78.294ms
2025-09-25 08:31:08.861 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 08:31:08.864 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 110.9681ms
2025-09-25 08:31:11.064 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/hub-about - null null
2025-09-25 08:31:11.066 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - null null
2025-09-25 08:31:11.119 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:11.143 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:11.155 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/hub-about - 204 null null 91.2593ms
2025-09-25 08:31:11.156 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - 204 null null 90.5211ms
2025-09-25 08:31:11.171 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - application/json null
2025-09-25 08:31:11.176 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/hub-about - application/json null
2025-09-25 08:31:11.184 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:11.188 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:11.190 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AboutController.Get (CeceLearningPortal.Api)'
2025-09-25 08:31:11.195 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 08:31:11.202 +08:00 [INF] Route matched with {action = "Get", controller = "About"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get() on controller CeceLearningPortal.Api.Controllers.AboutController (CeceLearningPortal.Api).
2025-09-25 08:31:11.203 +08:00 [INF] Route matched with {action = "GetAll", controller = "Sections"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Boolean) on controller CeceLearningPortal.Api.Controllers.SectionsController (CeceLearningPortal.Api).
2025-09-25 08:31:11.217 +08:00 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-09-25 08:31:11.236 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.body, r.created_at, r.cta_buttons_json, r.hero_image_url, r.last_edited_by_id, r.title, r.updated_at
FROM resource_hub_about AS r
LIMIT 1
2025-09-25 08:31:11.245 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.ResourceHubAboutDto'.
2025-09-25 08:31:11.252 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.name AS "Name", r.slug AS "Slug", r.description AS "Description", r.sort_order AS "SortOrder", r.is_featured AS "IsFeatured", r.access AS "Access", r.icon_url AS "IconUrl", r.color AS "Color", (
    SELECT count(*)::int
    FROM resources AS r0
    WHERE r.id = r0.section_id AND r0.status = 'published') AS "ResourceCount", r.created_at AS "CreatedAt", r.updated_at AS "UpdatedAt"
FROM resource_sections AS r
WHERE r.is_featured
ORDER BY r.sort_order
2025-09-25 08:31:11.255 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AboutController.Get (CeceLearningPortal.Api) in 49.3677ms
2025-09-25 08:31:11.257 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.ResourceSectionDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 08:31:11.259 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AboutController.Get (CeceLearningPortal.Api)'
2025-09-25 08:31:11.265 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/hub-about - 200 null application/json; charset=utf-8 88.9783ms
2025-09-25 08:31:11.271 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api) in 62.1591ms
2025-09-25 08:31:11.276 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 08:31:11.280 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - 200 null application/json; charset=utf-8 108.6802ms
2025-09-25 08:31:15.929 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/directory/search - null null
2025-09-25 08:31:15.937 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:15.945 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/directory/search - 204 null null 16.228ms
2025-09-25 08:31:15.954 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/directory/search - application/json 35
2025-09-25 08:31:15.962 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:15.969 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:31:15.974 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 08:31:15.986 +08:00 [INF] Route matched with {action = "Search", controller = "Directory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.StudentProfileSearchDto) on controller CeceLearningPortal.Api.Controllers.DirectoryController (CeceLearningPortal.Api).
2025-09-25 08:31:16.012 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 08:31:16.035 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api) in 43.7574ms
2025-09-25 08:31:16.038 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 08:31:16.044 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/directory/search - 400 null application/problem+json; charset=utf-8 90.2371ms
2025-09-25 08:31:18.370 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/directory/search - application/json 36
2025-09-25 08:31:18.375 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:18.382 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:31:18.386 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 08:31:18.389 +08:00 [INF] Route matched with {action = "Search", controller = "Directory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.StudentProfileSearchDto) on controller CeceLearningPortal.Api.Controllers.DirectoryController (CeceLearningPortal.Api).
2025-09-25 08:31:18.394 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 08:31:18.398 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api) in 4.6408ms
2025-09-25 08:31:18.401 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 08:31:18.403 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/directory/search - 400 null application/problem+json; charset=utf-8 32.7602ms
2025-09-25 08:31:18.562 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/directory/search - application/json 37
2025-09-25 08:31:18.567 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:18.572 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:31:18.577 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 08:31:18.580 +08:00 [INF] Route matched with {action = "Search", controller = "Directory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.StudentProfileSearchDto) on controller CeceLearningPortal.Api.Controllers.DirectoryController (CeceLearningPortal.Api).
2025-09-25 08:31:18.586 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 08:31:18.589 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api) in 3.9374ms
2025-09-25 08:31:18.592 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 08:31:18.594 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/directory/search - 400 null application/problem+json; charset=utf-8 31.2082ms
2025-09-25 08:31:18.651 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/directory/search - application/json 38
2025-09-25 08:31:18.656 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:18.661 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:31:18.666 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 08:31:18.667 +08:00 [INF] Route matched with {action = "Search", controller = "Directory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.StudentProfileSearchDto) on controller CeceLearningPortal.Api.Controllers.DirectoryController (CeceLearningPortal.Api).
2025-09-25 08:31:18.679 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 08:31:18.682 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api) in 3.8046ms
2025-09-25 08:31:18.685 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 08:31:18.687 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/directory/search - 400 null application/problem+json; charset=utf-8 35.602ms
2025-09-25 08:31:18.795 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/directory/search - application/json 39
2025-09-25 08:31:18.800 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:18.805 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:31:18.810 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 08:31:18.813 +08:00 [INF] Route matched with {action = "Search", controller = "Directory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.StudentProfileSearchDto) on controller CeceLearningPortal.Api.Controllers.DirectoryController (CeceLearningPortal.Api).
2025-09-25 08:31:18.817 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 08:31:18.820 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api) in 3.6319ms
2025-09-25 08:31:18.824 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 08:31:18.826 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/directory/search - 400 null application/problem+json; charset=utf-8 30.7597ms
2025-09-25 08:31:19.026 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/directory/search - application/json 39
2025-09-25 08:31:19.031 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:19.037 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:31:19.047 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 08:31:19.049 +08:00 [INF] Route matched with {action = "Search", controller = "Directory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.StudentProfileSearchDto) on controller CeceLearningPortal.Api.Controllers.DirectoryController (CeceLearningPortal.Api).
2025-09-25 08:31:19.056 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 08:31:19.059 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api) in 4.1361ms
2025-09-25 08:31:19.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 08:31:19.064 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/directory/search - 400 null application/problem+json; charset=utf-8 37.9597ms
2025-09-25 08:31:21.816 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/hub-about - null null
2025-09-25 08:31:21.816 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - null null
2025-09-25 08:31:21.823 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:21.831 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:21.832 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/hub-about - 204 null null 16.489ms
2025-09-25 08:31:21.835 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - 204 null null 19.5308ms
2025-09-25 08:31:21.846 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/hub-about - application/json null
2025-09-25 08:31:21.853 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - application/json null
2025-09-25 08:31:21.859 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:21.863 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:21.868 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:31:21.869 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:31:21.875 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AboutController.Get (CeceLearningPortal.Api)'
2025-09-25 08:31:21.879 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 08:31:21.881 +08:00 [INF] Route matched with {action = "Get", controller = "About"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get() on controller CeceLearningPortal.Api.Controllers.AboutController (CeceLearningPortal.Api).
2025-09-25 08:31:21.883 +08:00 [INF] Route matched with {action = "GetAll", controller = "Sections"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Boolean) on controller CeceLearningPortal.Api.Controllers.SectionsController (CeceLearningPortal.Api).
2025-09-25 08:31:21.890 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.body, r.created_at, r.cta_buttons_json, r.hero_image_url, r.last_edited_by_id, r.title, r.updated_at
FROM resource_hub_about AS r
LIMIT 1
2025-09-25 08:31:21.894 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.ResourceHubAboutDto'.
2025-09-25 08:31:21.894 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.name AS "Name", r.slug AS "Slug", r.description AS "Description", r.sort_order AS "SortOrder", r.is_featured AS "IsFeatured", r.access AS "Access", r.icon_url AS "IconUrl", r.color AS "Color", (
    SELECT count(*)::int
    FROM resources AS r0
    WHERE r.id = r0.section_id AND r0.status = 'published') AS "ResourceCount", r.created_at AS "CreatedAt", r.updated_at AS "UpdatedAt"
FROM resource_sections AS r
WHERE r.is_featured
ORDER BY r.sort_order
2025-09-25 08:31:21.897 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AboutController.Get (CeceLearningPortal.Api) in 9.6593ms
2025-09-25 08:31:21.901 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.ResourceSectionDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 08:31:21.903 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AboutController.Get (CeceLearningPortal.Api)'
2025-09-25 08:31:21.907 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api) in 16.4735ms
2025-09-25 08:31:21.909 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/hub-about - 200 null application/json; charset=utf-8 62.9527ms
2025-09-25 08:31:21.911 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 08:31:21.918 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - 200 null application/json; charset=utf-8 65.517ms
2025-09-25 08:31:25.588 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/sections - null null
2025-09-25 08:31:25.593 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:25.597 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/sections - 204 null null 8.8325ms
2025-09-25 08:31:25.609 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/sections - application/json null
2025-09-25 08:31:25.616 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:25.620 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:31:25.625 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 08:31:25.628 +08:00 [INF] Route matched with {action = "GetAll", controller = "Sections"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Boolean) on controller CeceLearningPortal.Api.Controllers.SectionsController (CeceLearningPortal.Api).
2025-09-25 08:31:25.645 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.name AS "Name", r.slug AS "Slug", r.description AS "Description", r.sort_order AS "SortOrder", r.is_featured AS "IsFeatured", r.access AS "Access", r.icon_url AS "IconUrl", r.color AS "Color", (
    SELECT count(*)::int
    FROM resources AS r0
    WHERE r.id = r0.section_id AND r0.status = 'published') AS "ResourceCount", r.created_at AS "CreatedAt", r.updated_at AS "UpdatedAt"
FROM resource_sections AS r
ORDER BY r.sort_order
2025-09-25 08:31:25.649 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.ResourceSectionDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 08:31:25.652 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api) in 18.8837ms
2025-09-25 08:31:25.655 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 08:31:25.658 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/sections - 200 null application/json; charset=utf-8 48.7885ms
2025-09-25 08:31:28.745 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/directory/search - null null
2025-09-25 08:31:28.751 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:28.754 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/directory/search - 204 null null 8.9293ms
2025-09-25 08:31:28.767 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/directory/search - application/json 35
2025-09-25 08:31:28.772 +08:00 [INF] CORS policy execution successful.
2025-09-25 08:31:28.778 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 08:31:28.783 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 08:31:28.785 +08:00 [INF] Route matched with {action = "Search", controller = "Directory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.StudentProfileSearchDto) on controller CeceLearningPortal.Api.Controllers.DirectoryController (CeceLearningPortal.Api).
2025-09-25 08:31:28.790 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 08:31:28.795 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api) in 6.6328ms
2025-09-25 08:31:28.798 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 08:31:28.801 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/directory/search - 400 null application/problem+json; charset=utf-8 33.6939ms
2025-09-25 08:34:59.032 +08:00 [INF] Application is shutting down...
2025-09-25 08:57:46.380 +08:00 [INF] Checking database connection...
2025-09-25 08:57:49.449 +08:00 [INF] Database connection successful.
2025-09-25 08:57:49.452 +08:00 [INF] Attempting to apply migrations...
2025-09-25 08:57:49.784 +08:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-25 08:57:50.860 +08:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-09-25 08:57:50.910 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-09-25 08:57:50.926 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-25 08:57:50.955 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-09-25 08:57:50.993 +08:00 [INF] Migrations applied successfully.
2025-09-25 08:57:50.999 +08:00 [INF] Starting data seeding...
2025-09-25 08:57:51.042 +08:00 [INF] User profile is available. Using 'C:\Users\Win11\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-25 08:57:51.616 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM courses AS c)
2025-09-25 08:57:51.629 +08:00 [INF] Database already contains data. Checking if data cleanup is needed...
2025-09-25 08:57:51.632 +08:00 [INF] Checking for missing data components...
2025-09-25 08:57:51.646 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM subscriptions AS s)
2025-09-25 08:57:51.653 +08:00 [INF] Data seeding completed.
2025-09-25 08:57:51.823 +08:00 [INF] Now listening on: http://localhost:5296
2025-09-25 08:57:51.825 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-25 08:57:51.828 +08:00 [INF] Hosting environment: Development
2025-09-25 08:57:51.830 +08:00 [INF] Content root path: C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-09-25 09:07:04.050 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/directory/search - null null
2025-09-25 09:07:04.616 +08:00 [WRN] Failed to determine the https port for redirect.
2025-09-25 09:07:04.622 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:07:04.640 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/directory/search - 204 null null 593.7862ms
2025-09-25 09:07:10.467 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/directory/search - null null
2025-09-25 09:07:10.521 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:07:10.526 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/directory/search - 204 null null 58.5729ms
2025-09-25 09:07:10.597 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/directory/search - application/json 35
2025-09-25 09:07:10.639 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:07:10.741 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 09:07:10.781 +08:00 [INF] Route matched with {action = "Search", controller = "Directory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.StudentProfileSearchDto) on controller CeceLearningPortal.Api.Controllers.DirectoryController (CeceLearningPortal.Api).
2025-09-25 09:07:10.890 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 09:07:10.952 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api) in 158.7717ms
2025-09-25 09:07:10.957 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.DirectoryController.Search (CeceLearningPortal.Api)'
2025-09-25 09:07:10.964 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/directory/search - 400 null application/problem+json; charset=utf-8 367.3809ms
2025-09-25 09:09:27.268 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 09:09:27.268 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 09:09:27.383 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 09:09:27.383 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 09:09:27.387 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:27.403 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:27.417 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:27.452 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:27.452 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 184.1426ms
2025-09-25 09:09:27.462 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 193.4ms
2025-09-25 09:09:27.464 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 81.7254ms
2025-09-25 09:09:27.466 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 83.2032ms
2025-09-25 09:09:27.478 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 09:09:27.482 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 09:09:27.509 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:27.510 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:27.515 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 09:09:27.528 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 09:09:27.537 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 09:09:27.540 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 09:09:27.541 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 58.2879ms
2025-09-25 09:09:27.552 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 09:09:27.552 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 09:09:27.564 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:27.568 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:27.570 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 17.3469ms
2025-09-25 09:09:27.585 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 09:09:27.595 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:27.597 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 09:09:27.611 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 09:09:27.901 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-25 09:09:27.912 +08:00 [INF] Executed DbCommand (18ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:09:27.921 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 09:09:27.944 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 09:09:28.002 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 09:09:28.009 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 09:09:28.024 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 09:09:28.090 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 09:09:28.127 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 09:09:28.156 +08:00 [INF] Executed DbCommand (24ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 09:09:28.255 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 09:09:28.348 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 09:09:28.382 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 09:09:28.411 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 09:09:28.449 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 09:09:28.489 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 09:09:28.527 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 09:09:28.657 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 706.0532ms
2025-09-25 09:09:28.661 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 09:09:28.670 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 1117.6526ms
2025-09-25 09:09:28.720 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:09:28.756 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 1209.3695ms
2025-09-25 09:09:28.758 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 09:09:28.759 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 09:09:28.762 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 1284.6863ms
2025-09-25 09:09:28.769 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:28.786 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:09:28.791 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 09:09:28.794 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 09:09:28.798 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 09:09:28.810 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 09:09:28.842 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:09:28.848 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 48.5438ms
2025-09-25 09:09:28.859 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 09:09:28.862 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 103.202ms
2025-09-25 09:09:28.893 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 09:09:28.907 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 1290.6238ms
2025-09-25 09:09:28.911 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 09:09:28.914 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 1328.7906ms
2025-09-25 09:09:28.925 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 09:09:28.930 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:28.936 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:09:28.944 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 09:09:28.946 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 09:09:28.951 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 09:09:28.959 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 09:09:28.966 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 09:09:28.970 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 09:09:28.983 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 09:09:28.996 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 09:09:29.003 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 09:09:29.010 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 09:09:29.016 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 09:09:29.022 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 09:09:29.026 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 09:09:29.031 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 81.788ms
2025-09-25 09:09:29.033 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 09:09:29.036 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 110.5186ms
2025-09-25 09:09:29.118 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - null null
2025-09-25 09:09:29.120 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 09:09:29.127 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:29.143 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:29.144 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - 204 null null 26.3835ms
2025-09-25 09:09:29.147 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 26.7031ms
2025-09-25 09:09:29.157 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 41
2025-09-25 09:09:29.163 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - application/json null
2025-09-25 09:09:29.168 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:29.177 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:09:29.185 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:09:29.191 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:09:29.191 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 09:09:29.195 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:09:29.204 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 09:09:29.206 +08:00 [INF] Route matched with {action = "GetAll", controller = "Sections"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Boolean) on controller CeceLearningPortal.Api.Controllers.SectionsController (CeceLearningPortal.Api).
2025-09-25 09:09:29.228 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 09:09:29.231 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 22.8684ms
2025-09-25 09:09:29.234 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 09:09:29.237 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 79.8224ms
2025-09-25 09:09:29.256 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.name AS "Name", r.slug AS "Slug", r.description AS "Description", r.sort_order AS "SortOrder", r.is_featured AS "IsFeatured", r.access AS "Access", r.icon_url AS "IconUrl", r.color AS "Color", (
    SELECT count(*)::int
    FROM resources AS r0
    WHERE r.id = r0.section_id AND r0.status = 'published') AS "ResourceCount", r.created_at AS "CreatedAt", r.updated_at AS "UpdatedAt"
FROM resource_sections AS r
WHERE r.is_featured
ORDER BY r.sort_order
2025-09-25 09:09:29.264 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.ResourceSectionDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:09:29.276 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api) in 64.1135ms
2025-09-25 09:09:29.279 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:09:29.281 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - 200 null application/json; charset=utf-8 117.892ms
2025-09-25 09:14:24.022 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - null null
2025-09-25 09:14:24.038 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 09:14:24.041 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:14:24.050 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:14:24.053 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - 204 null null 30.6706ms
2025-09-25 09:14:24.060 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 22.4964ms
2025-09-25 09:14:24.075 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - application/json null
2025-09-25 09:14:24.088 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 41
2025-09-25 09:14:24.101 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:14:24.119 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:14:24.127 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:14:24.128 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:14:24.140 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:14:24.144 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 09:14:24.145 +08:00 [INF] Route matched with {action = "GetAll", controller = "Sections"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Boolean) on controller CeceLearningPortal.Api.Controllers.SectionsController (CeceLearningPortal.Api).
2025-09-25 09:14:24.155 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 09:14:24.186 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.name AS "Name", r.slug AS "Slug", r.description AS "Description", r.sort_order AS "SortOrder", r.is_featured AS "IsFeatured", r.access AS "Access", r.icon_url AS "IconUrl", r.color AS "Color", (
    SELECT count(*)::int
    FROM resources AS r0
    WHERE r.id = r0.section_id AND r0.status = 'published') AS "ResourceCount", r.created_at AS "CreatedAt", r.updated_at AS "UpdatedAt"
FROM resource_sections AS r
WHERE r.is_featured
ORDER BY r.sort_order
2025-09-25 09:14:24.190 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 09:14:24.193 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.ResourceSectionDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:14:24.203 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 14.2691ms
2025-09-25 09:14:24.205 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api) in 29.4677ms
2025-09-25 09:14:24.208 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 09:14:24.211 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:14:24.213 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 125.2623ms
2025-09-25 09:14:24.218 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - 200 null application/json; charset=utf-8 142.194ms
2025-09-25 09:16:14.306 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - null null
2025-09-25 09:16:14.316 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 09:16:14.325 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:16:14.336 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:16:14.337 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - 204 null null 30.9516ms
2025-09-25 09:16:14.345 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 29.5705ms
2025-09-25 09:16:14.356 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - application/json null
2025-09-25 09:16:14.361 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 41
2025-09-25 09:16:14.365 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:16:14.369 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:16:14.580 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:16:14.598 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:16:14.676 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:16:14.761 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 09:16:14.764 +08:00 [INF] Route matched with {action = "GetAll", controller = "Sections"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Boolean) on controller CeceLearningPortal.Api.Controllers.SectionsController (CeceLearningPortal.Api).
2025-09-25 09:16:14.771 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 09:16:14.800 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.name AS "Name", r.slug AS "Slug", r.description AS "Description", r.sort_order AS "SortOrder", r.is_featured AS "IsFeatured", r.access AS "Access", r.icon_url AS "IconUrl", r.color AS "Color", (
    SELECT count(*)::int
    FROM resources AS r0
    WHERE r.id = r0.section_id AND r0.status = 'published') AS "ResourceCount", r.created_at AS "CreatedAt", r.updated_at AS "UpdatedAt"
FROM resource_sections AS r
WHERE r.is_featured
ORDER BY r.sort_order
2025-09-25 09:16:14.811 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 09:16:14.816 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.ResourceSectionDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:16:14.820 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 9.9887ms
2025-09-25 09:16:14.828 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api) in 42.1072ms
2025-09-25 09:16:14.834 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 09:16:14.837 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:16:14.843 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 481.4484ms
2025-09-25 09:16:14.846 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - 200 null application/json; charset=utf-8 490.6125ms
2025-09-25 09:16:32.858 +08:00 [INF] Application is shutting down...
2025-09-25 09:28:35.520 +08:00 [INF] Checking database connection...
2025-09-25 09:28:37.776 +08:00 [INF] Database connection successful.
2025-09-25 09:28:37.778 +08:00 [INF] Attempting to apply migrations...
2025-09-25 09:28:37.993 +08:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-25 09:28:38.701 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-09-25 09:28:38.728 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-09-25 09:28:38.741 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-25 09:28:38.757 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-09-25 09:28:38.784 +08:00 [INF] Migrations applied successfully.
2025-09-25 09:28:38.786 +08:00 [INF] Starting data seeding...
2025-09-25 09:28:38.824 +08:00 [INF] User profile is available. Using 'C:\Users\Win11\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-25 09:28:39.234 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM courses AS c)
2025-09-25 09:28:39.252 +08:00 [INF] Database already contains data. Checking if data cleanup is needed...
2025-09-25 09:28:39.254 +08:00 [INF] Checking for missing data components...
2025-09-25 09:28:39.265 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM subscriptions AS s)
2025-09-25 09:28:39.271 +08:00 [INF] Data seeding completed.
2025-09-25 09:28:39.430 +08:00 [INF] Now listening on: http://localhost:5296
2025-09-25 09:28:39.432 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-25 09:28:39.433 +08:00 [INF] Hosting environment: Development
2025-09-25 09:28:39.436 +08:00 [INF] Content root path: C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-09-25 09:34:39.729 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - null null
2025-09-25 09:34:39.729 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 09:34:39.937 +08:00 [WRN] Failed to determine the https port for redirect.
2025-09-25 09:34:39.945 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:39.947 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:40.018 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 294.2921ms
2025-09-25 09:34:40.018 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - 204 null null 294.198ms
2025-09-25 09:34:45.285 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 09:34:45.285 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - null null
2025-09-25 09:34:45.352 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:45.352 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:45.359 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 74.1068ms
2025-09-25 09:34:45.361 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - 204 null null 78.3658ms
2025-09-25 09:34:45.383 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 41
2025-09-25 09:34:45.398 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - application/json null
2025-09-25 09:34:45.409 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:45.426 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:45.490 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:34:45.490 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 09:34:45.519 +08:00 [INF] Route matched with {action = "GetAll", controller = "Sections"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Boolean) on controller CeceLearningPortal.Api.Controllers.SectionsController (CeceLearningPortal.Api).
2025-09-25 09:34:45.519 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 09:34:45.612 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 09:34:45.656 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 120.3925ms
2025-09-25 09:34:45.659 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 09:34:45.664 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 280.8288ms
2025-09-25 09:34:45.849 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.name AS "Name", r.slug AS "Slug", r.description AS "Description", r.sort_order AS "SortOrder", r.is_featured AS "IsFeatured", r.access AS "Access", r.icon_url AS "IconUrl", r.color AS "Color", (
    SELECT count(*)::int
    FROM resources AS r0
    WHERE r.id = r0.section_id AND r0.status = 'published') AS "ResourceCount", r.created_at AS "CreatedAt", r.updated_at AS "UpdatedAt"
FROM resource_sections AS r
WHERE r.is_featured
ORDER BY r.sort_order
2025-09-25 09:34:45.858 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.ResourceSectionDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:34:45.874 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api) in 351.3584ms
2025-09-25 09:34:45.879 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:34:45.889 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - 200 null application/json; charset=utf-8 490.5766ms
2025-09-25 09:34:51.155 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/sections - null null
2025-09-25 09:34:51.161 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:51.163 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/sections - 204 null null 8.408ms
2025-09-25 09:34:51.177 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/sections - application/json null
2025-09-25 09:34:51.183 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:51.462 +08:00 [INF] Executed DbCommand (17ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:34:51.467 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:34:51.470 +08:00 [INF] Route matched with {action = "GetAll", controller = "Sections"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Boolean) on controller CeceLearningPortal.Api.Controllers.SectionsController (CeceLearningPortal.Api).
2025-09-25 09:34:51.498 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.name AS "Name", r.slug AS "Slug", r.description AS "Description", r.sort_order AS "SortOrder", r.is_featured AS "IsFeatured", r.access AS "Access", r.icon_url AS "IconUrl", r.color AS "Color", (
    SELECT count(*)::int
    FROM resources AS r0
    WHERE r.id = r0.section_id AND r0.status = 'published') AS "ResourceCount", r.created_at AS "CreatedAt", r.updated_at AS "UpdatedAt"
FROM resource_sections AS r
ORDER BY r.sort_order
2025-09-25 09:34:51.503 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.ResourceSectionDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:34:51.506 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api) in 32.4675ms
2025-09-25 09:34:51.512 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:34:51.516 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/sections - 200 null application/json; charset=utf-8 337.7419ms
2025-09-25 09:34:53.526 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - null null
2025-09-25 09:34:53.526 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 09:34:53.538 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:53.552 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:53.555 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - 204 null null 28.3001ms
2025-09-25 09:34:53.559 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 33.4051ms
2025-09-25 09:34:53.571 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - application/json null
2025-09-25 09:34:53.585 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 41
2025-09-25 09:34:53.604 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:53.591 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:53.627 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:34:53.636 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 09:34:53.639 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 09:34:53.661 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 09:34:53.666 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 13.2222ms
2025-09-25 09:34:53.671 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 09:34:53.678 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 92.8908ms
2025-09-25 09:34:53.732 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:34:53.737 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:34:53.739 +08:00 [INF] Route matched with {action = "GetAll", controller = "Sections"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Boolean) on controller CeceLearningPortal.Api.Controllers.SectionsController (CeceLearningPortal.Api).
2025-09-25 09:34:53.751 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.name AS "Name", r.slug AS "Slug", r.description AS "Description", r.sort_order AS "SortOrder", r.is_featured AS "IsFeatured", r.access AS "Access", r.icon_url AS "IconUrl", r.color AS "Color", (
    SELECT count(*)::int
    FROM resources AS r0
    WHERE r.id = r0.section_id AND r0.status = 'published') AS "ResourceCount", r.created_at AS "CreatedAt", r.updated_at AS "UpdatedAt"
FROM resource_sections AS r
WHERE r.is_featured
ORDER BY r.sort_order
2025-09-25 09:34:53.756 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.ResourceSectionDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:34:53.760 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api) in 15.5537ms
2025-09-25 09:34:53.766 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:34:53.768 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - 200 null application/json; charset=utf-8 196.9349ms
2025-09-25 09:34:58.783 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - null null
2025-09-25 09:34:58.784 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 09:34:58.796 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:58.803 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:58.805 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - 204 null null 21.7622ms
2025-09-25 09:34:58.806 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 21.6617ms
2025-09-25 09:34:58.820 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 41
2025-09-25 09:34:58.826 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - application/json null
2025-09-25 09:34:58.832 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:58.836 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:34:58.841 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:34:58.843 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:34:58.850 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 09:34:58.854 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:34:58.856 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 09:34:58.860 +08:00 [INF] Route matched with {action = "GetAll", controller = "Sections"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Boolean) on controller CeceLearningPortal.Api.Controllers.SectionsController (CeceLearningPortal.Api).
2025-09-25 09:34:58.865 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 09:34:58.875 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 11.1172ms
2025-09-25 09:34:58.879 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 09:34:58.880 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.name AS "Name", r.slug AS "Slug", r.description AS "Description", r.sort_order AS "SortOrder", r.is_featured AS "IsFeatured", r.access AS "Access", r.icon_url AS "IconUrl", r.color AS "Color", (
    SELECT count(*)::int
    FROM resources AS r0
    WHERE r.id = r0.section_id AND r0.status = 'published') AS "ResourceCount", r.created_at AS "CreatedAt", r.updated_at AS "UpdatedAt"
FROM resource_sections AS r
WHERE r.is_featured
ORDER BY r.sort_order
2025-09-25 09:34:58.882 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 61.2504ms
2025-09-25 09:34:58.886 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.ResourceSectionDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:34:58.899 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api) in 29.2893ms
2025-09-25 09:34:58.903 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:34:58.908 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - 200 null application/json; charset=utf-8 81.4944ms
2025-09-25 09:35:02.331 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 09:35:02.332 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 09:35:02.353 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:35:02.359 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:35:02.362 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 30.5511ms
2025-09-25 09:35:02.364 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 32.3329ms
2025-09-25 09:35:02.452 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 09:35:02.487 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 09:35:02.542 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:35:02.552 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:35:02.559 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 09:35:02.580 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 09:35:02.584 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 09:35:02.597 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 09:35:02.654 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 09:35:02.692 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:35:02.700 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:35:02.714 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 09:35:02.732 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 151.9848ms
2025-09-25 09:35:02.744 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 160.1244ms
2025-09-25 09:35:02.753 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 266.7345ms
2025-09-25 09:35:02.802 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 09:35:02.816 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 09:35:02.827 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:35:02.838 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:35:02.840 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 37.9405ms
2025-09-25 09:35:02.852 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:35:02.861 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 09:35:02.877 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 09:35:02.888 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:35:02.895 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 09:35:02.897 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 09:35:02.911 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 09:35:02.950 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 09:35:02.986 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 09:35:03.037 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 09:35:03.078 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-25 09:35:03.111 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 09:35:03.113 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 09:35:03.296 +08:00 [INF] Executed DbCommand (25ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 09:35:03.446 +08:00 [INF] Executed DbCommand (28ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 09:35:03.624 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 09:35:03.727 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 09:35:03.785 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 09:35:03.856 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 09:35:03.901 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 09:35:03.922 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 09:35:04.153 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 1247.8682ms
2025-09-25 09:35:04.188 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 09:35:04.228 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 1411.8675ms
2025-09-25 09:35:04.459 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:35:04.538 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 1825.3943ms
2025-09-25 09:35:04.543 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 09:35:04.554 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 09:35:04.563 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:35:04.567 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 2114.7459ms
2025-09-25 09:35:04.583 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:35:04.602 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 09:35:04.607 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 09:35:04.648 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 09:35:04.667 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 09:35:04.761 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:35:04.784 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 09:35:05.106 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 453.7908ms
2025-09-25 09:35:05.127 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 2201.2065ms
2025-09-25 09:35:05.136 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 09:35:05.141 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 09:35:05.152 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 609.3615ms
2025-09-25 09:35:05.192 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 2330.3324ms
2025-09-25 09:35:05.226 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 09:35:05.759 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:35:05.808 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:35:05.917 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 09:35:05.925 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 09:35:05.962 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 09:35:06.022 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 09:35:06.067 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 09:35:06.135 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 09:35:06.173 +08:00 [INF] Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 09:35:06.219 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 09:35:06.307 +08:00 [INF] Executed DbCommand (27ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 09:35:07.250 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 09:35:07.904 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 09:35:07.997 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 09:35:08.126 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 09:35:08.160 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 2206.2619ms
2025-09-25 09:35:08.172 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 09:35:08.175 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 2949.276ms
2025-09-25 09:47:57.143 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 09:47:57.147 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 09:47:57.159 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:47:57.169 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:47:57.191 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 47.6641ms
2025-09-25 09:47:57.199 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 52.1532ms
2025-09-25 09:47:57.217 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 09:47:57.222 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 09:47:57.229 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:47:57.233 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:47:57.235 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 09:47:57.241 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 09:47:57.244 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 09:47:57.244 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 09:47:57.247 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 09:47:57.249 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 09:47:57.267 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 45.3636ms
2025-09-25 09:47:57.259 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:47:57.253 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:47:57.297 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 53.8366ms
2025-09-25 09:47:57.328 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 84.2155ms
2025-09-25 09:47:57.348 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 09:47:57.356 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 09:47:57.362 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:47:57.369 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:47:57.370 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 21.97ms
2025-09-25 09:47:57.383 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 09:47:57.402 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:47:57.403 +08:00 [INF] Executed DbCommand (19ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 09:47:57.409 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 09:47:57.425 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 09:47:57.438 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:47:57.448 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 184.5361ms
2025-09-25 09:47:57.450 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 09:47:57.453 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 09:47:57.464 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:47:57.469 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:47:57.474 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 256.888ms
2025-09-25 09:47:57.479 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 09:47:57.485 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:47:57.488 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 09:47:57.492 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 09:47:57.498 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 09:47:57.499 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 09:47:57.514 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 09:47:57.517 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 09:47:57.537 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 09:47:57.545 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 09:47:57.548 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:47:57.555 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 09:47:57.558 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 55.4998ms
2025-09-25 09:47:57.567 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 09:47:57.568 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 09:47:57.572 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 09:47:57.582 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 132.7129ms
2025-09-25 09:47:57.583 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 09:47:57.607 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 09:47:57.625 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 193.314ms
2025-09-25 09:47:57.639 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 09:47:57.641 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 09:47:57.644 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 260.8118ms
2025-09-25 09:47:57.652 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 09:47:57.670 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 09:47:57.685 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 09:47:57.695 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 09:47:57.700 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 204.8217ms
2025-09-25 09:47:57.701 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 09:47:57.708 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 09:47:57.713 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 357.649ms
2025-09-25 09:47:57.712 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:47:57.730 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:47:57.733 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 09:47:57.734 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 09:47:57.748 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 09:47:57.759 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 09:47:57.764 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 09:47:57.769 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 09:47:57.783 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 09:47:57.793 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 09:47:57.800 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 09:47:57.807 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 09:47:57.816 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 09:47:57.829 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 09:47:57.833 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 09:47:57.837 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 91.9109ms
2025-09-25 09:47:57.842 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 09:47:57.847 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 145.7614ms
2025-09-25 09:56:36.506 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - null null
2025-09-25 09:56:36.506 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 09:56:36.511 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:56:36.519 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:56:36.520 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - 204 null null 14.2404ms
2025-09-25 09:56:36.522 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 15.3556ms
2025-09-25 09:56:36.538 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 41
2025-09-25 09:56:36.543 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - application/json null
2025-09-25 09:56:36.550 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:56:36.553 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:56:36.648 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:56:36.650 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:56:36.655 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:56:36.657 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 09:56:36.659 +08:00 [INF] Route matched with {action = "GetAll", controller = "Sections"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Boolean) on controller CeceLearningPortal.Api.Controllers.SectionsController (CeceLearningPortal.Api).
2025-09-25 09:56:36.661 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 09:56:36.674 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.name AS "Name", r.slug AS "Slug", r.description AS "Description", r.sort_order AS "SortOrder", r.is_featured AS "IsFeatured", r.access AS "Access", r.icon_url AS "IconUrl", r.color AS "Color", (
    SELECT count(*)::int
    FROM resources AS r0
    WHERE r.id = r0.section_id AND r0.status = 'published') AS "ResourceCount", r.created_at AS "CreatedAt", r.updated_at AS "UpdatedAt"
FROM resource_sections AS r
WHERE r.is_featured
ORDER BY r.sort_order
2025-09-25 09:56:36.675 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 09:56:36.685 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.ResourceSectionDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:56:36.687 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 12.8795ms
2025-09-25 09:56:36.690 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api) in 22.9973ms
2025-09-25 09:56:36.692 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 09:56:36.694 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 09:56:36.698 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 159.5877ms
2025-09-25 09:56:36.702 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - 200 null application/json; charset=utf-8 158.7546ms
2025-09-25 09:56:39.453 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 09:56:39.454 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 09:56:39.460 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:56:39.468 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:56:39.470 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 17.0113ms
2025-09-25 09:56:39.472 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 18.7909ms
2025-09-25 09:56:39.486 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 09:56:39.491 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 09:56:39.498 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:56:39.502 +08:00 [INF] CORS policy execution successful.
2025-09-25 09:56:39.506 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:56:39.506 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 09:56:39.511 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 09:56:39.517 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 09:56:39.519 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 09:56:39.520 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 09:56:39.528 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 09:56:39.534 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 09:56:39.543 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 09:56:39.545 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 09:56:39.591 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 09:56:39.600 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 09:56:39.607 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 80.1112ms
2025-09-25 09:56:39.614 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 09:56:39.614 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 09:56:39.621 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 130.4563ms
2025-09-25 09:56:39.623 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 09:56:39.651 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 09:56:39.656 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 09:56:39.666 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 09:56:39.673 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 09:56:39.680 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 09:56:39.683 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 160.3249ms
2025-09-25 09:56:39.686 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 09:56:39.688 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 202.5106ms
2025-09-25 09:56:50.443 +08:00 [INF] Application is shutting down...
2025-09-25 10:03:57.857 +08:00 [INF] Checking database connection...
2025-09-25 10:04:00.147 +08:00 [INF] Database connection successful.
2025-09-25 10:04:00.149 +08:00 [INF] Attempting to apply migrations...
2025-09-25 10:04:00.351 +08:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-25 10:04:01.052 +08:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-09-25 10:04:01.084 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-09-25 10:04:01.094 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-09-25 10:04:01.109 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-09-25 10:04:01.125 +08:00 [INF] Migrations applied successfully.
2025-09-25 10:04:01.126 +08:00 [INF] Starting data seeding...
2025-09-25 10:04:01.156 +08:00 [INF] User profile is available. Using 'C:\Users\Win11\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-25 10:04:01.508 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM courses AS c)
2025-09-25 10:04:01.528 +08:00 [INF] Database already contains data. Checking if data cleanup is needed...
2025-09-25 10:04:01.530 +08:00 [INF] Checking for missing data components...
2025-09-25 10:04:01.540 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM subscriptions AS s)
2025-09-25 10:04:01.547 +08:00 [INF] Data seeding completed.
2025-09-25 10:04:01.680 +08:00 [INF] Now listening on: http://localhost:5296
2025-09-25 10:04:01.683 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-25 10:04:01.685 +08:00 [INF] Hosting environment: Development
2025-09-25 10:04:01.687 +08:00 [INF] Content root path: C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-09-25 10:08:45.706 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:08:45.705 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:08:45.710 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:08:45.710 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:08:45.830 +08:00 [WRN] Failed to determine the https port for redirect.
2025-09-25 10:08:45.833 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:45.833 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:45.834 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:45.833 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:45.844 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 133.7087ms
2025-09-25 10:08:45.844 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 142.4203ms
2025-09-25 10:08:45.844 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 133.8968ms
2025-09-25 10:08:45.846 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 142.3201ms
2025-09-25 10:08:45.866 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:08:45.881 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:08:45.896 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:45.896 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:45.959 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:08:45.990 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:08:46.188 +08:00 [INF] Executed DbCommand (17ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:08:46.200 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:08:46.210 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:08:46.350 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:08:46.360 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-25 10:08:46.368 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:08:46.401 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:08:46.421 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:08:46.484 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:08:46.601 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:08:46.673 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:08:46.703 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:08:46.724 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:08:46.749 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:08:46.768 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:08:46.784 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:08:46.835 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:08:46.840 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:46.840 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 620.6898ms
2025-09-25 10:08:46.844 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:08:46.848 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 10:08:46.853 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 986.8999ms
2025-09-25 10:08:46.855 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 10:08:46.860 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 24.8815ms
2025-09-25 10:08:46.870 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 10:08:46.875 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:46.877 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 6.5946ms
2025-09-25 10:08:46.883 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 10:08:46.889 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:46.891 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 10:08:46.898 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 10:08:46.980 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 10:08:47.103 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:08:47.195 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 1198.5358ms
2025-09-25 10:08:47.197 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:08:47.197 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:08:47.200 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 1318.8263ms
2025-09-25 10:08:47.205 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:47.217 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:08:47.222 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:08:47.224 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:08:47.236 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:08:47.256 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:08:47.259 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 31.6958ms
2025-09-25 10:08:47.263 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:08:47.265 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 67.2569ms
2025-09-25 10:08:47.280 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 10:08:47.332 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 10:08:47.337 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 435.2727ms
2025-09-25 10:08:47.340 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 10:08:47.344 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 460.3006ms
2025-09-25 10:08:47.349 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:08:47.353 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:47.355 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 5.7035ms
2025-09-25 10:08:47.361 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:08:47.365 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:47.370 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:08:47.376 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:08:47.378 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:08:47.383 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:08:47.389 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:08:47.394 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:08:47.400 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:08:47.410 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:08:47.418 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:08:47.425 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:08:47.431 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:08:47.436 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:08:47.442 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:08:47.446 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:08:47.450 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 68.6945ms
2025-09-25 10:08:47.452 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:08:47.455 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 93.8356ms
2025-09-25 10:08:48.890 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - null null
2025-09-25 10:08:48.893 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 10:08:48.900 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:48.909 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:48.909 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - 204 null null 19.5066ms
2025-09-25 10:08:48.911 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 18.3942ms
2025-09-25 10:08:48.924 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 41
2025-09-25 10:08:48.930 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - application/json null
2025-09-25 10:08:48.934 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:48.939 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:08:48.948 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:08:48.952 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:08:48.956 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:08:48.960 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 10:08:48.968 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 10:08:48.968 +08:00 [INF] Route matched with {action = "GetAll", controller = "Sections"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Boolean) on controller CeceLearningPortal.Api.Controllers.SectionsController (CeceLearningPortal.Api).
2025-09-25 10:08:48.997 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 10:08:49.017 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.name AS "Name", r.slug AS "Slug", r.description AS "Description", r.sort_order AS "SortOrder", r.is_featured AS "IsFeatured", r.access AS "Access", r.icon_url AS "IconUrl", r.color AS "Color", (
    SELECT count(*)::int
    FROM resources AS r0
    WHERE r.id = r0.section_id AND r0.status = 'published') AS "ResourceCount", r.created_at AS "CreatedAt", r.updated_at AS "UpdatedAt"
FROM resource_sections AS r
WHERE r.is_featured
ORDER BY r.sort_order
2025-09-25 10:08:49.032 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 60.7137ms
2025-09-25 10:08:49.039 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.ResourceSectionDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:08:49.040 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:08:49.049 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 124.9995ms
2025-09-25 10:08:49.053 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api) in 78.5096ms
2025-09-25 10:08:49.062 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 10:08:49.065 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - 200 null application/json; charset=utf-8 134.4352ms
2025-09-25 10:09:00.503 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:09:00.503 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:09:00.508 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:09:00.512 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:09:00.515 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 11.7503ms
2025-09-25 10:09:00.516 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 13.0569ms
2025-09-25 10:09:00.525 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:09:00.530 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:09:00.534 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:09:00.539 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:09:00.545 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:09:00.550 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:09:00.552 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:09:00.557 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:09:00.570 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:09:00.576 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:09:00.581 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:09:00.589 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:09:00.595 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:09:00.602 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:09:00.608 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:09:00.608 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:09:00.612 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:09:00.615 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:09:00.620 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:09:00.622 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:09:00.626 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:09:00.629 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 73.7632ms
2025-09-25 10:09:00.634 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:09:00.634 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:09:00.641 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 115.6016ms
2025-09-25 10:09:00.654 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:09:00.658 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 35.5675ms
2025-09-25 10:09:00.661 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:09:00.665 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 135.2859ms
2025-09-25 10:15:21.902 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:15:21.903 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:15:21.967 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:21.978 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:22.223 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:15:22.226 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 322.452ms
2025-09-25 10:15:22.227 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:15:22.227 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 322.7924ms
2025-09-25 10:15:22.263 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:22.266 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:15:22.270 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:22.275 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:15:22.277 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 54.5179ms
2025-09-25 10:15:22.283 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:22.284 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 56.8467ms
2025-09-25 10:15:22.305 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:22.312 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 10:15:22.316 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:15:22.317 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 10:15:22.319 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:15:22.321 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 54.8379ms
2025-09-25 10:15:22.334 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:15:22.341 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 10:15:22.342 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:22.346 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:22.348 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 7.3777ms
2025-09-25 10:15:22.356 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 10:15:22.436 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:22.445 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 10:15:22.467 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 10:15:22.499 +08:00 [INF] Executed DbCommand (24ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:15:22.514 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:15:22.584 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:15:22.601 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:15:22.603 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:15:22.618 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:15:22.620 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 295.4832ms
2025-09-25 10:15:22.627 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 10:15:22.627 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:15:22.667 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:22.634 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:15:22.659 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 10:15:22.634 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:15:22.682 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:15:22.692 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 416.6608ms
2025-09-25 10:15:22.711 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 10:15:22.741 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:15:22.757 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:15:22.803 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 318.1703ms
2025-09-25 10:15:22.851 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:15:22.854 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:15:22.867 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 10:15:22.965 +08:00 [INF] Executed DbCommand (16ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:15:22.984 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 628.6499ms
2025-09-25 10:15:22.989 +08:00 [INF] Executed DbCommand (22ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:15:23.094 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:15:23.210 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:15:23.267 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:15:23.275 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 309.6449ms
2025-09-25 10:15:23.319 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:15:23.309 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:15:23.338 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 710.9774ms
2025-09-25 10:15:23.394 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:15:23.511 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:15:23.603 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:15:23.621 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 1008.2099ms
2025-09-25 10:15:23.624 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:15:23.644 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:15:23.680 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:23.682 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 1347.9078ms
2025-09-25 10:15:23.700 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:15:23.791 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:15:23.852 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:15:23.893 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:15:23.961 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:15:24.001 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:15:24.065 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:15:24.090 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:15:24.126 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:15:24.368 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:15:24.377 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:15:24.388 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:15:24.399 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:15:24.410 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:15:24.416 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 527.6089ms
2025-09-25 10:15:24.425 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:15:24.429 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 805.669ms
2025-09-25 10:15:38.554 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - null null
2025-09-25 10:15:38.560 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 10:15:38.564 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:38.567 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:38.569 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/sections?featuredOnly=true - 204 null null 14.7273ms
2025-09-25 10:15:38.570 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 10.257ms
2025-09-25 10:15:38.583 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 41
2025-09-25 10:15:38.590 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - application/json null
2025-09-25 10:15:38.593 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:38.597 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:38.602 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:15:38.602 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:15:38.605 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:15:38.608 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 10:15:38.609 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 10:15:38.611 +08:00 [INF] Route matched with {action = "GetAll", controller = "Sections"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Boolean) on controller CeceLearningPortal.Api.Controllers.SectionsController (CeceLearningPortal.Api).
2025-09-25 10:15:38.614 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 10:15:38.618 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 4.3384ms
2025-09-25 10:15:38.622 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:15:38.624 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.name AS "Name", r.slug AS "Slug", r.description AS "Description", r.sort_order AS "SortOrder", r.is_featured AS "IsFeatured", r.access AS "Access", r.icon_url AS "IconUrl", r.color AS "Color", (
    SELECT count(*)::int
    FROM resources AS r0
    WHERE r.id = r0.section_id AND r0.status = 'published') AS "ResourceCount", r.created_at AS "CreatedAt", r.updated_at AS "UpdatedAt"
FROM resource_sections AS r
WHERE r.is_featured
ORDER BY r.sort_order
2025-09-25 10:15:38.624 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 40.9362ms
2025-09-25 10:15:38.628 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.ResourceSectionDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:15:38.635 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api) in 18.9028ms
2025-09-25 10:15:38.637 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.SectionsController.GetAll (CeceLearningPortal.Api)'
2025-09-25 10:15:38.638 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/sections?featuredOnly=true - 200 null application/json; charset=utf-8 48.8636ms
2025-09-25 10:15:43.187 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:15:43.187 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:15:43.194 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:43.203 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:43.204 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 17.2216ms
2025-09-25 10:15:43.209 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 20.8902ms
2025-09-25 10:15:43.224 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:15:43.233 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:15:43.237 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:43.243 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:43.248 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:15:43.255 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:15:43.255 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:15:43.259 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:15:43.262 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:15:43.264 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:15:43.273 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:15:43.273 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:15:43.278 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:15:43.286 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:15:43.288 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:15:43.295 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:15:43.298 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 32.1844ms
2025-09-25 10:15:43.311 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:15:43.312 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:15:43.314 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 89.428ms
2025-09-25 10:15:43.322 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:15:43.331 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:15:43.338 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:15:43.345 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:15:43.351 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:15:43.357 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:15:43.361 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 89.9605ms
2025-09-25 10:15:43.364 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:15:43.366 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 133.6749ms
2025-09-25 10:15:46.783 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 10:15:46.790 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:46.792 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 8.406ms
2025-09-25 10:15:46.812 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 57
2025-09-25 10:15:46.816 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:15:46.818 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:15:46.820 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 10:15:46.824 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 10:15:46.826 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 3.2721ms
2025-09-25 10:15:46.829 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:15:46.830 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 18.7733ms
2025-09-25 10:16:36.310 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 10:16:36.314 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:16:36.315 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 5.3018ms
2025-09-25 10:16:36.327 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 57
2025-09-25 10:16:36.331 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:16:36.339 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:16:36.344 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:16:36.346 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 10:16:36.352 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 10:16:36.354 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 3.2639ms
2025-09-25 10:16:36.356 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:16:36.358 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 31.82ms
2025-09-25 10:19:19.038 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 10:19:19.039 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - null null
2025-09-25 10:19:19.044 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:19:19.047 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:19:19.048 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 9.9907ms
2025-09-25 10:19:19.059 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 78
2025-09-25 10:19:19.051 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - 204 null null 12.5207ms
2025-09-25 10:19:19.065 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:19:19.069 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - application/json null
2025-09-25 10:19:19.075 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:19:19.077 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:19:19.082 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:19:19.085 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 10:19:19.086 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:19:19.090 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 10:19:19.093 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:19:19.096 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 7.6724ms
2025-09-25 10:19:19.097 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:19:19.099 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:19:19.104 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 44.7624ms
2025-09-25 10:19:19.120 +08:00 [ERR] Error retrieving courses
System.InvalidOperationException: An exception was thrown while attempting to evaluate a LINQ query parameter expression. See the inner exception for more information. To show additional information call 'DbContextOptionsBuilder.EnableSensitiveDataLogging'.
 ---> System.ArgumentException: Requested value 'active' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at System.Enum.Parse[TEnum](String value, Boolean ignoreCase)
   at System.Enum.Parse[TEnum](String value)
   at System.Linq.Expressions.Interpreter.FuncCallInstruction`2.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.Interpreter.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.LightLambda.Run(Object[] arguments)
   at System.Dynamic.Utils.DelegateHelpers.FuncThunk[TReturn](Func`2 handler)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Evaluate(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<VisitUnary>g__EvaluateOperand|53_0(UnaryExpression unary, Expression operand, State operandState)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<>c__DisplayClass53_0.<VisitUnary>b__1()
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitBinary(BinaryExpression binary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitLambda[T](Expression`1 lambda)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitUnary(UnaryExpression unary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 208
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 33
2025-09-25 10:19:19.167 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:19:19.174 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 71.8702ms
2025-09-25 10:19:19.178 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:19:19.180 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - 500 null application/json; charset=utf-8 110.8251ms
2025-09-25 10:19:43.022 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 10:19:43.030 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - null null
2025-09-25 10:19:43.035 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:19:43.038 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:19:43.040 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 17.2855ms
2025-09-25 10:19:43.042 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - 204 null null 12.224ms
2025-09-25 10:19:43.053 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - application/json null
2025-09-25 10:19:43.062 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 78
2025-09-25 10:19:43.067 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:19:43.073 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:19:43.077 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:19:43.078 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:19:43.085 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:19:43.089 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:19:43.091 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:19:43.093 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 10:19:43.098 +08:00 [ERR] Error retrieving courses
System.InvalidOperationException: An exception was thrown while attempting to evaluate a LINQ query parameter expression. See the inner exception for more information. To show additional information call 'DbContextOptionsBuilder.EnableSensitiveDataLogging'.
 ---> System.ArgumentException: Requested value 'active' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at System.Enum.Parse[TEnum](String value, Boolean ignoreCase)
   at System.Enum.Parse[TEnum](String value)
   at System.Linq.Expressions.Interpreter.FuncCallInstruction`2.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.Interpreter.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.LightLambda.Run(Object[] arguments)
   at System.Dynamic.Utils.DelegateHelpers.FuncThunk[TReturn](Func`2 handler)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Evaluate(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<VisitUnary>g__EvaluateOperand|53_0(UnaryExpression unary, Expression operand, State operandState)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<>c__DisplayClass53_0.<VisitUnary>b__1()
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitBinary(BinaryExpression binary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitLambda[T](Expression`1 lambda)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitUnary(UnaryExpression unary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 208
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 33
2025-09-25 10:19:43.103 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 10:19:43.127 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:19:43.128 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 25.8469ms
2025-09-25 10:19:43.130 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 34.6633ms
2025-09-25 10:19:43.135 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:19:43.137 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:19:43.139 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 77.2608ms
2025-09-25 10:19:43.141 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - 500 null application/json; charset=utf-8 88.2222ms
2025-09-25 10:20:18.026 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 10:20:18.028 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - null null
2025-09-25 10:20:18.035 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:20:18.040 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:20:18.041 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 15.1367ms
2025-09-25 10:20:18.043 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - 204 null null 15.1428ms
2025-09-25 10:20:18.052 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - application/json null
2025-09-25 10:20:18.057 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 78
2025-09-25 10:20:18.060 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:20:18.064 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:20:18.069 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:20:18.071 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:20:18.074 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:20:18.077 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:20:18.079 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:20:18.080 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 10:20:18.087 +08:00 [ERR] Error retrieving courses
System.InvalidOperationException: An exception was thrown while attempting to evaluate a LINQ query parameter expression. See the inner exception for more information. To show additional information call 'DbContextOptionsBuilder.EnableSensitiveDataLogging'.
 ---> System.ArgumentException: Requested value 'active' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at System.Enum.Parse[TEnum](String value, Boolean ignoreCase)
   at System.Enum.Parse[TEnum](String value)
   at System.Linq.Expressions.Interpreter.FuncCallInstruction`2.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.Interpreter.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.LightLambda.Run(Object[] arguments)
   at System.Dynamic.Utils.DelegateHelpers.FuncThunk[TReturn](Func`2 handler)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Evaluate(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<VisitUnary>g__EvaluateOperand|53_0(UnaryExpression unary, Expression operand, State operandState)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<>c__DisplayClass53_0.<VisitUnary>b__1()
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitBinary(BinaryExpression binary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitLambda[T](Expression`1 lambda)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitUnary(UnaryExpression unary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 208
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 33
2025-09-25 10:20:18.089 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 10:20:18.110 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:20:18.112 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 23.1733ms
2025-09-25 10:20:18.114 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 27.7225ms
2025-09-25 10:20:18.121 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:20:18.124 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:20:18.125 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 68.7999ms
2025-09-25 10:20:18.128 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - 500 null application/json; charset=utf-8 76.3504ms
2025-09-25 10:20:27.686 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 10:20:27.686 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - null null
2025-09-25 10:20:27.693 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:20:27.697 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:20:27.698 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 12.3208ms
2025-09-25 10:20:27.700 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - 204 null null 13.8726ms
2025-09-25 10:20:27.713 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - application/json null
2025-09-25 10:20:27.717 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 78
2025-09-25 10:20:27.725 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:20:27.730 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:20:27.826 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:20:27.826 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:20:27.831 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:20:27.834 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:20:27.835 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 10:20:27.837 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:20:27.842 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 10:20:27.845 +08:00 [ERR] Error retrieving courses
System.InvalidOperationException: An exception was thrown while attempting to evaluate a LINQ query parameter expression. See the inner exception for more information. To show additional information call 'DbContextOptionsBuilder.EnableSensitiveDataLogging'.
 ---> System.ArgumentException: Requested value 'active' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at System.Enum.Parse[TEnum](String value, Boolean ignoreCase)
   at System.Enum.Parse[TEnum](String value)
   at System.Linq.Expressions.Interpreter.FuncCallInstruction`2.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.Interpreter.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.LightLambda.Run(Object[] arguments)
   at System.Dynamic.Utils.DelegateHelpers.FuncThunk[TReturn](Func`2 handler)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Evaluate(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<VisitUnary>g__EvaluateOperand|53_0(UnaryExpression unary, Expression operand, State operandState)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<>c__DisplayClass53_0.<VisitUnary>b__1()
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitBinary(BinaryExpression binary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitLambda[T](Expression`1 lambda)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitUnary(UnaryExpression unary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 208
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 33
2025-09-25 10:20:27.846 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 5.7184ms
2025-09-25 10:20:27.865 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:20:27.866 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:20:27.871 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 153.4124ms
2025-09-25 10:20:27.869 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 24.4903ms
2025-09-25 10:20:27.881 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:20:27.883 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - 500 null application/json; charset=utf-8 169.6309ms
2025-09-25 10:20:31.228 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 78
2025-09-25 10:20:31.229 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - application/json null
2025-09-25 10:20:31.244 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:20:31.252 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:20:31.257 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:20:31.260 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:20:31.264 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 10:20:31.266 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:20:31.273 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 10:20:31.278 +08:00 [ERR] Error retrieving courses
System.InvalidOperationException: An exception was thrown while attempting to evaluate a LINQ query parameter expression. See the inner exception for more information. To show additional information call 'DbContextOptionsBuilder.EnableSensitiveDataLogging'.
 ---> System.ArgumentException: Requested value 'active' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at System.Enum.Parse[TEnum](String value, Boolean ignoreCase)
   at System.Enum.Parse[TEnum](String value)
   at System.Linq.Expressions.Interpreter.FuncCallInstruction`2.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.Interpreter.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.LightLambda.Run(Object[] arguments)
   at System.Dynamic.Utils.DelegateHelpers.FuncThunk[TReturn](Func`2 handler)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Evaluate(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<VisitUnary>g__EvaluateOperand|53_0(UnaryExpression unary, Expression operand, State operandState)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<>c__DisplayClass53_0.<VisitUnary>b__1()
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitBinary(BinaryExpression binary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitLambda[T](Expression`1 lambda)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitUnary(UnaryExpression unary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 208
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 33
2025-09-25 10:20:31.283 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 10.3995ms
2025-09-25 10:20:31.375 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:20:31.377 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:20:31.383 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 106.6558ms
2025-09-25 10:20:31.391 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 163.084ms
2025-09-25 10:20:31.395 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:20:31.406 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - 500 null application/json; charset=utf-8 176.8229ms
2025-09-25 10:22:00.678 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 10:22:00.685 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:22:00.738 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - null null
2025-09-25 10:22:00.763 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 84.9789ms
2025-09-25 10:22:00.772 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:22:00.776 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 78
2025-09-25 10:22:00.777 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - 204 null null 38.3133ms
2025-09-25 10:22:00.787 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:22:00.792 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - application/json null
2025-09-25 10:22:00.795 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:22:00.796 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:22:00.805 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:22:00.810 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 10:22:00.811 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:22:00.825 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 10:22:00.828 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:22:00.835 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 11.2936ms
2025-09-25 10:22:00.843 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:22:00.845 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:22:00.851 +08:00 [ERR] Error retrieving courses
System.InvalidOperationException: An exception was thrown while attempting to evaluate a LINQ query parameter expression. See the inner exception for more information. To show additional information call 'DbContextOptionsBuilder.EnableSensitiveDataLogging'.
 ---> System.ArgumentException: Requested value 'active' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at System.Enum.Parse[TEnum](String value, Boolean ignoreCase)
   at System.Enum.Parse[TEnum](String value)
   at System.Linq.Expressions.Interpreter.FuncCallInstruction`2.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.Interpreter.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.LightLambda.Run(Object[] arguments)
   at System.Dynamic.Utils.DelegateHelpers.FuncThunk[TReturn](Func`2 handler)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Evaluate(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<VisitUnary>g__EvaluateOperand|53_0(UnaryExpression unary, Expression operand, State operandState)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<>c__DisplayClass53_0.<VisitUnary>b__1()
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitBinary(BinaryExpression binary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitLambda[T](Expression`1 lambda)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitUnary(UnaryExpression unary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 208
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 33
2025-09-25 10:22:00.851 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 75.6783ms
2025-09-25 10:22:00.869 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:22:00.874 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 25.9891ms
2025-09-25 10:22:00.876 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:22:00.878 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - 500 null application/json; charset=utf-8 86.6086ms
2025-09-25 10:27:40.022 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 10:27:40.022 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - null null
2025-09-25 10:27:40.026 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:27:40.030 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:27:40.032 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 9.6724ms
2025-09-25 10:27:40.034 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - 204 null null 12.1585ms
2025-09-25 10:27:40.043 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - application/json null
2025-09-25 10:27:40.048 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 78
2025-09-25 10:27:40.055 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:27:40.058 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:27:40.147 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:27:40.153 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:27:40.155 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:27:40.157 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:27:40.160 +08:00 [ERR] Error retrieving courses
System.InvalidOperationException: An exception was thrown while attempting to evaluate a LINQ query parameter expression. See the inner exception for more information. To show additional information call 'DbContextOptionsBuilder.EnableSensitiveDataLogging'.
 ---> System.ArgumentException: Requested value 'active' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at System.Enum.Parse[TEnum](String value, Boolean ignoreCase)
   at System.Enum.Parse[TEnum](String value)
   at System.Linq.Expressions.Interpreter.FuncCallInstruction`2.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.Interpreter.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.LightLambda.Run(Object[] arguments)
   at System.Dynamic.Utils.DelegateHelpers.FuncThunk[TReturn](Func`2 handler)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Evaluate(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<VisitUnary>g__EvaluateOperand|53_0(UnaryExpression unary, Expression operand, State operandState)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<>c__DisplayClass53_0.<VisitUnary>b__1()
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitBinary(BinaryExpression binary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitLambda[T](Expression`1 lambda)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitUnary(UnaryExpression unary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 208
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 33
2025-09-25 10:27:40.161 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:27:40.176 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:27:40.176 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 10:27:40.179 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 21.4472ms
2025-09-25 10:27:40.189 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:27:40.186 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 10:27:40.195 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - 500 null application/json; charset=utf-8 151.7312ms
2025-09-25 10:27:40.202 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 17.075ms
2025-09-25 10:27:40.214 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:27:40.219 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 170.7183ms
2025-09-25 10:28:33.031 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 10:28:33.032 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - null null
2025-09-25 10:28:33.036 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:28:33.042 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:28:33.043 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 12.8091ms
2025-09-25 10:28:33.045 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - 204 null null 13.1768ms
2025-09-25 10:28:33.052 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - application/json null
2025-09-25 10:28:33.057 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 78
2025-09-25 10:28:33.061 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:28:33.065 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:28:33.069 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:28:33.070 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:28:33.073 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:28:33.076 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:28:33.077 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:28:33.079 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 10:28:33.084 +08:00 [ERR] Error retrieving courses
System.InvalidOperationException: An exception was thrown while attempting to evaluate a LINQ query parameter expression. See the inner exception for more information. To show additional information call 'DbContextOptionsBuilder.EnableSensitiveDataLogging'.
 ---> System.ArgumentException: Requested value 'active' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at System.Enum.Parse[TEnum](String value, Boolean ignoreCase)
   at System.Enum.Parse[TEnum](String value)
   at System.Linq.Expressions.Interpreter.FuncCallInstruction`2.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.Interpreter.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.LightLambda.Run(Object[] arguments)
   at System.Dynamic.Utils.DelegateHelpers.FuncThunk[TReturn](Func`2 handler)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Evaluate(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<VisitUnary>g__EvaluateOperand|53_0(UnaryExpression unary, Expression operand, State operandState)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<>c__DisplayClass53_0.<VisitUnary>b__1()
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitBinary(BinaryExpression binary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitLambda[T](Expression`1 lambda)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitUnary(UnaryExpression unary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 208
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 33
2025-09-25 10:28:33.086 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 10:28:33.106 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 20.5698ms
2025-09-25 10:28:33.108 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:28:33.104 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:28:33.110 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 52.8076ms
2025-09-25 10:28:33.113 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 30.6072ms
2025-09-25 10:28:33.122 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:28:33.124 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - 500 null application/json; charset=utf-8 71.2013ms
2025-09-25 10:32:40.081 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 10:32:40.083 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - null null
2025-09-25 10:32:40.092 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:40.096 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:40.099 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 18.2556ms
2025-09-25 10:32:40.102 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - 204 null null 18.8099ms
2025-09-25 10:32:40.141 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 78
2025-09-25 10:32:40.142 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - application/json null
2025-09-25 10:32:40.148 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:40.152 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:40.160 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:32:40.163 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:32:40.167 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:32:40.171 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:32:40.174 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 10:32:40.176 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:32:40.181 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 10:32:40.184 +08:00 [ERR] Error retrieving courses
System.InvalidOperationException: An exception was thrown while attempting to evaluate a LINQ query parameter expression. See the inner exception for more information. To show additional information call 'DbContextOptionsBuilder.EnableSensitiveDataLogging'.
 ---> System.ArgumentException: Requested value 'active' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at System.Enum.Parse[TEnum](String value, Boolean ignoreCase)
   at System.Enum.Parse[TEnum](String value)
   at System.Linq.Expressions.Interpreter.FuncCallInstruction`2.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.Interpreter.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.LightLambda.Run(Object[] arguments)
   at System.Dynamic.Utils.DelegateHelpers.FuncThunk[TReturn](Func`2 handler)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Evaluate(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<VisitUnary>g__EvaluateOperand|53_0(UnaryExpression unary, Expression operand, State operandState)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<>c__DisplayClass53_0.<VisitUnary>b__1()
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitBinary(BinaryExpression binary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitLambda[T](Expression`1 lambda)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitUnary(UnaryExpression unary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 208
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 33
2025-09-25 10:32:40.185 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 5.0698ms
2025-09-25 10:32:40.202 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:32:40.204 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:32:40.207 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 23.7724ms
2025-09-25 10:32:40.212 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:32:40.209 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 67.2166ms
2025-09-25 10:32:40.214 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - 500 null application/json; charset=utf-8 71.7417ms
2025-09-25 10:32:45.346 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - null null
2025-09-25 10:32:45.347 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - null null
2025-09-25 10:32:45.378 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:45.383 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:45.384 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/resources/search - 204 null null 37.8644ms
2025-09-25 10:32:45.387 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?search=Test&status=active - 204 null null 40.0035ms
2025-09-25 10:32:45.393 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - application/json null
2025-09-25 10:32:45.397 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/resources/search - application/json 78
2025-09-25 10:32:45.402 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:45.406 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:45.407 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:32:45.408 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:32:45.410 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:32:45.412 +08:00 [INF] Route matched with {action = "Search", controller = "ResourcesHub"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(CeceLearningPortal.Api.DTOs.ResourceSearchDto) on controller CeceLearningPortal.Api.Controllers.ResourcesHubController (CeceLearningPortal.Api).
2025-09-25 10:32:45.423 +08:00 [ERR] Error retrieving courses
System.InvalidOperationException: An exception was thrown while attempting to evaluate a LINQ query parameter expression. See the inner exception for more information. To show additional information call 'DbContextOptionsBuilder.EnableSensitiveDataLogging'.
 ---> System.ArgumentException: Requested value 'active' was not found.
   at System.Enum.TryParseByName[TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TStorage& result)
   at System.Enum.TryParseByValueOrName[TUnderlying,TStorage](RuntimeType enumType, ReadOnlySpan`1 value, Boolean ignoreCase, Boolean throwOnFailure, TUnderlying& result)
   at System.Enum.Parse[TEnum](String value, Boolean ignoreCase)
   at System.Enum.Parse[TEnum](String value)
   at System.Linq.Expressions.Interpreter.FuncCallInstruction`2.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.Interpreter.Run(InterpretedFrame frame)
   at System.Linq.Expressions.Interpreter.LightLambda.Run(Object[] arguments)
   at System.Dynamic.Utils.DelegateHelpers.FuncThunk[TReturn](Func`2 handler)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<Evaluate>g__EvaluateCore|75_0(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Evaluate(Expression expression, String& parameterName, Boolean& isContextAccessor)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<VisitUnary>g__EvaluateOperand|53_0(UnaryExpression unary, Expression operand, State operandState)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.<>c__DisplayClass53_0.<VisitUnary>b__1()
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.ProcessEvaluatableRoot(Expression evaluatableRoot, State& state, Boolean forceEvaluation)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitBinary(BinaryExpression binary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitLambda[T](Expression`1 lambda)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitUnary(UnaryExpression unary)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.Visit[T](ReadOnlyCollection`1 expressions, Func`2 elementVisitor, StateType& aggregateStateType, State[]& expressionStates, Boolean poolExpressionStates)
   at Microsoft.EntityFrameworkCore.Query.Internal.ExpressionTreeFuncletizer.VisitMethodCall(MethodCallExpression methodCall)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.CourseService.GetAllCoursesAsync(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\CourseService.cs:line 208
   at CeceLearningPortal.Api.Controllers.CoursesController.GetCourses(CourseFilterDto filter) in C:\Users\Win11\Downloads\Cece-20250805T084305Z-1-001\Cece\Cece-master\Cece-master\CeceLearningPortal.Backend\CeceLearningPortal.Api\Controllers\CoursesController.cs:line 33
2025-09-25 10:32:45.424 +08:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-25 10:32:45.453 +08:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:32:45.454 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api) in 30.5814ms
2025-09-25 10:32:45.458 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.ResourcesHubController.Search (CeceLearningPortal.Api)'
2025-09-25 10:32:45.456 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 36.3241ms
2025-09-25 10:32:45.460 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/resources/search - 400 null application/problem+json; charset=utf-8 62.883ms
2025-09-25 10:32:45.462 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:32:45.469 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?search=Test&status=active - 500 null application/json; charset=utf-8 75.9707ms
2025-09-25 10:32:55.610 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:32:55.611 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:32:55.660 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:55.666 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:55.668 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 57.8098ms
2025-09-25 10:32:55.685 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 73.6909ms
2025-09-25 10:32:55.693 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:32:55.699 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:32:55.704 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:55.712 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:55.715 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:32:55.715 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:32:55.716 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:32:55.718 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 10:32:55.721 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:32:55.727 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:55.732 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:55.734 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 10:32:55.742 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 26.9775ms
2025-09-25 10:32:55.744 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 27.9063ms
2025-09-25 10:32:55.745 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 46.03ms
2025-09-25 10:32:55.801 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:32:55.796 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 10:32:55.805 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:55.809 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:55.812 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 15.9243ms
2025-09-25 10:32:55.821 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 10:32:55.826 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:55.828 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 10:32:55.832 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 10:32:55.859 +08:00 [INF] Executed DbCommand (19ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:32:55.870 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:32:55.874 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 134.092ms
2025-09-25 10:32:55.875 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:32:55.879 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:32:55.884 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:55.890 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:32:55.890 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 197.2671ms
2025-09-25 10:32:55.897 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:32:55.897 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:32:55.906 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:32:55.908 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:32:55.909 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:32:55.917 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:32:55.923 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:32:55.924 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:32:55.933 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:32:55.936 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:32:55.937 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 19.6614ms
2025-09-25 10:32:55.941 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:32:55.943 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:32:55.943 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 10:32:55.948 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 72.6018ms
2025-09-25 10:32:55.957 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:32:55.960 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 10:32:55.974 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 10:32:55.982 +08:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:32:55.986 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 144.9313ms
2025-09-25 10:32:55.993 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 10:32:55.993 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:32:55.995 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 174.2177ms
2025-09-25 10:32:56.001 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:32:56.010 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:32:56.017 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:32:56.021 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:32:56.025 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 111.891ms
2025-09-25 10:32:56.026 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:32:56.027 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:32:56.031 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:32:56.033 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 231.7165ms
2025-09-25 10:32:56.036 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:32:56.044 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:32:56.046 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:32:56.050 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:32:56.055 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:32:56.061 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:32:56.065 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:32:56.073 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:32:56.079 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:32:56.085 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:32:56.090 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:32:56.096 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:32:56.100 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:32:56.104 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:32:56.107 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 57.9555ms
2025-09-25 10:32:56.109 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:32:56.111 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 85.0843ms
2025-09-25 10:35:22.319 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:35:22.320 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:35:22.326 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:35:22.335 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:35:22.338 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 18.6043ms
2025-09-25 10:35:22.341 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 21.0578ms
2025-09-25 10:35:22.354 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:35:22.364 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:35:22.369 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:35:22.373 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:35:22.378 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:35:22.383 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:35:22.385 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:35:22.388 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:35:22.390 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:35:22.392 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:35:22.401 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:35:22.409 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:35:22.414 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:35:22.420 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:35:22.429 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:35:22.432 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:35:22.433 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 31.035ms
2025-09-25 10:35:22.449 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:35:22.453 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:35:22.462 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:35:22.462 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 98.0609ms
2025-09-25 10:35:22.468 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:35:22.482 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:35:22.497 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:35:22.507 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:35:22.513 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:35:22.519 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 119.8476ms
2025-09-25 10:35:22.523 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:35:22.526 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 171.2346ms
2025-09-25 10:46:11.055 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:46:11.055 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:46:11.062 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:46:11.069 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:46:11.070 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 15.2482ms
2025-09-25 10:46:11.071 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 16.1767ms
2025-09-25 10:46:11.081 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:46:11.086 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:46:11.100 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:46:11.091 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:46:11.216 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:46:11.234 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:46:11.234 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:46:11.245 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:46:11.247 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:46:11.249 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:46:11.256 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:46:11.267 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:46:11.279 +08:00 [INF] Executed DbCommand (23ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:46:11.296 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:46:11.305 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:46:11.308 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:46:11.310 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 55.13ms
2025-09-25 10:46:11.320 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:46:11.324 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 238.3768ms
2025-09-25 10:46:11.327 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:46:11.340 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:46:11.353 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:46:11.365 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:46:11.383 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:46:11.396 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:46:11.403 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:46:11.409 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 157.1299ms
2025-09-25 10:46:11.413 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:46:11.416 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 334.7754ms
2025-09-25 10:48:34.209 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:48:34.210 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:48:34.221 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:48:34.225 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:48:34.228 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 19.7798ms
2025-09-25 10:48:34.237 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 26.666ms
2025-09-25 10:48:34.267 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:48:34.274 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:48:34.278 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:48:34.282 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:48:34.289 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:48:34.290 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:48:34.297 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:48:34.308 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:48:34.302 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:48:34.315 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:48:34.315 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:48:34.323 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:48:34.335 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:48:34.336 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:48:34.374 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:48:34.377 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:48:34.386 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:48:34.387 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 62.5352ms
2025-09-25 10:48:34.395 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:48:34.395 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:48:34.398 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 123.3818ms
2025-09-25 10:48:34.411 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:48:34.426 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:48:34.446 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:48:34.459 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:48:34.465 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:48:34.472 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 159.5726ms
2025-09-25 10:48:34.477 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:48:34.479 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 212.6009ms
2025-09-25 10:50:51.880 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:50:51.884 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:50:51.896 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:50:51.903 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:50:51.904 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 23.794ms
2025-09-25 10:50:51.906 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 21.7781ms
2025-09-25 10:50:51.920 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:50:51.926 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:50:51.939 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:50:51.944 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:50:51.946 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 10:50:51.948 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:50:51.950 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 10:50:51.951 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:50:51.953 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 32.6468ms
2025-09-25 10:50:51.964 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:50:51.986 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:50:51.986 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:50:52.003 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:50:51.999 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:50:52.005 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 19.1305ms
2025-09-25 10:50:52.004 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 17.3828ms
2025-09-25 10:50:51.990 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:50:52.022 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:50:52.030 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 73.8046ms
2025-09-25 10:50:52.043 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 10:50:52.059 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:50:52.063 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:50:52.067 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:50:52.071 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:50:52.078 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:50:52.079 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 152.8871ms
2025-09-25 10:50:52.082 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:50:52.086 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 43.678ms
2025-09-25 10:50:52.098 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:50:52.111 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:50:52.112 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 10:50:52.115 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:50:52.118 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:50:52.122 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:50:52.126 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:50:52.126 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:50:52.128 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 10:50:52.135 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:50:52.139 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 10:50:52.144 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:50:52.149 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:50:52.152 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:50:52.160 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:50:52.164 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:50:52.167 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 29.8348ms
2025-09-25 10:50:52.174 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:50:52.176 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:50:52.202 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:50:52.202 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 135.5677ms
2025-09-25 10:50:52.216 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:50:52.231 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:50:52.237 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:50:52.241 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:50:52.244 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 119.5642ms
2025-09-25 10:50:52.249 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:50:52.264 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 242.4533ms
2025-09-25 10:50:52.304 +08:00 [INF] Executed DbCommand (13ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 10:50:52.329 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 10:50:52.338 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 10:50:52.340 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 193.7047ms
2025-09-25 10:50:52.344 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 10:50:52.346 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 233.6581ms
2025-09-25 10:50:52.356 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:50:52.360 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:50:52.364 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:50:52.369 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:50:52.371 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:50:52.377 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:50:52.383 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:50:52.388 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:50:52.395 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:50:52.407 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:50:52.416 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:50:52.424 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:50:52.431 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:50:52.436 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:50:52.446 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:50:52.458 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:50:52.461 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 86.3084ms
2025-09-25 10:50:52.465 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:50:52.467 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 111.5689ms
2025-09-25 10:51:18.594 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:51:18.595 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:51:18.632 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:51:18.622 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:51:18.637 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 42.2163ms
2025-09-25 10:51:18.636 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 41.3906ms
2025-09-25 10:51:18.645 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:51:18.651 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:51:18.655 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:51:18.660 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:51:18.661 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 10:51:18.662 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:51:18.665 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 10:51:18.666 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:51:18.668 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 22.9551ms
2025-09-25 10:51:18.691 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:51:18.697 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:51:18.698 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:51:18.703 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:51:18.705 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:51:18.709 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:51:18.711 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 32.4482ms
2025-09-25 10:51:18.714 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 16.6242ms
2025-09-25 10:51:18.716 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 18.7043ms
2025-09-25 10:51:18.718 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:51:18.725 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:51:18.730 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:51:18.735 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 84.0052ms
2025-09-25 10:51:18.744 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:51:18.747 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:51:18.753 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 10:51:18.759 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:51:18.762 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:51:18.766 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:51:18.767 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 13.4786ms
2025-09-25 10:51:18.770 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:51:18.775 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 10:51:18.781 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:51:18.784 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:51:18.788 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 10:51:18.788 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:51:18.790 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 10:51:18.794 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:51:18.801 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:51:18.810 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:51:18.824 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:51:18.830 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:51:18.836 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:51:18.836 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:51:18.840 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:51:18.845 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:51:18.847 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:51:18.854 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:51:18.856 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:51:18.858 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:51:18.866 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 86.7992ms
2025-09-25 10:51:18.868 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:51:18.869 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:51:18.872 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 24.0893ms
2025-09-25 10:51:18.874 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 10:51:18.876 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 150.6294ms
2025-09-25 10:51:18.878 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:51:18.887 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 10:51:18.888 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 157.2169ms
2025-09-25 10:51:18.896 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 10:51:18.898 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 101.6394ms
2025-09-25 10:51:18.900 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 10:51:18.902 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 126.4602ms
2025-09-25 10:51:18.909 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:51:18.913 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:51:18.918 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:51:18.924 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:51:18.925 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:51:18.929 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:51:18.935 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:51:18.939 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:51:18.944 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:51:18.956 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:51:18.962 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:51:18.969 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:51:18.974 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:51:18.978 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:51:18.984 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:51:18.987 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:51:18.989 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 61.7952ms
2025-09-25 10:51:18.991 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:51:18.993 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 84.2009ms
2025-09-25 10:54:20.184 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 10:54:20.189 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 10:54:20.197 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:54:20.204 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:54:20.209 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 24.4901ms
2025-09-25 10:54:20.250 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 10:54:20.219 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 30.08ms
2025-09-25 10:54:20.284 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 10:54:20.291 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:54:20.275 +08:00 [INF] CORS policy execution successful.
2025-09-25 10:54:20.305 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:54:20.316 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 10:54:20.337 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:54:20.347 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:54:20.351 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 10:54:20.354 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 10:54:20.362 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 10:54:20.375 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 10:54:20.375 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 10:54:20.449 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 10:54:20.463 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 10:54:20.513 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 149.9074ms
2025-09-25 10:54:20.537 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 10:54:20.550 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 10:54:20.583 +08:00 [INF] Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 10:54:20.618 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 368.5442ms
2025-09-25 10:54:20.635 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 10:54:20.656 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 10:54:20.701 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 10:54:20.723 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 10:54:20.749 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 10:54:20.802 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 10:54:20.811 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 452.5198ms
2025-09-25 10:54:20.824 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 10:54:20.838 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 554.2534ms
2025-09-25 11:06:18.245 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 11:06:18.253 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:06:18.279 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:18.284 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:18.304 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 50.8198ms
2025-09-25 11:06:18.297 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 51.784ms
2025-09-25 11:06:18.315 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:06:18.329 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:06:18.338 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:18.333 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:18.340 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:06:18.342 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 11:06:18.343 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:06:18.345 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 11:06:18.352 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 36.2762ms
2025-09-25 11:06:18.367 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:06:18.368 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 11:06:18.387 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:18.395 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:18.397 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 29.4392ms
2025-09-25 11:06:18.399 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 30.425ms
2025-09-25 11:06:18.413 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:06:18.417 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:18.446 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 11:06:18.479 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:18.482 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 35.2117ms
2025-09-25 11:06:18.486 +08:00 [INF] Executed DbCommand (20ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:06:18.492 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 11:06:18.501 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:18.502 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:06:18.504 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 11:06:18.506 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 158.3345ms
2025-09-25 11:06:18.509 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 11:06:18.510 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:06:18.512 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:06:18.520 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:18.522 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 11:06:18.522 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 193.738ms
2025-09-25 11:06:18.526 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:06:18.537 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 11:06:18.541 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:06:18.549 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 11:06:18.554 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:06:18.556 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 41.1045ms
2025-09-25 11:06:18.563 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 11:06:18.568 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:06:18.569 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 76.5597ms
2025-09-25 11:06:18.580 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:06:18.594 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:06:18.599 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:06:18.615 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:06:18.617 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:06:18.623 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:06:18.625 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:06:18.625 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:06:18.633 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:06:18.639 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:06:18.647 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:06:18.651 +08:00 [INF] Executed DbCommand (17ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:06:18.655 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:06:18.662 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:06:18.663 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:06:18.665 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 103.9056ms
2025-09-25 11:06:18.666 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:06:18.668 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 34.0124ms
2025-09-25 11:06:18.670 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:06:18.675 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:18.677 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:06:18.679 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 266.3285ms
2025-09-25 11:06:18.684 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 173.5721ms
2025-09-25 11:06:18.684 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:06:18.700 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:06:18.702 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:06:18.711 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:06:18.716 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:06:18.722 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:06:18.727 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:06:18.739 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:06:18.748 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:06:18.755 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:06:18.761 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:06:18.767 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:06:18.774 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:06:18.777 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:06:18.781 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 71.6441ms
2025-09-25 11:06:18.785 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:06:18.787 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 121.4124ms
2025-09-25 11:06:27.957 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:06:27.968 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:27.970 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 12.5471ms
2025-09-25 11:06:27.977 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:06:27.985 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:27.995 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:06:28.004 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:06:28.007 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:06:28.029 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:06:28.038 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:06:28.044 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:06:28.053 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:06:28.116 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:06:28.126 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:06:28.133 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:06:28.138 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:06:28.144 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:06:28.149 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:06:28.153 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:06:28.156 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 128.5598ms
2025-09-25 11:06:28.158 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:06:28.160 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 182.6321ms
2025-09-25 11:06:28.171 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - null null
2025-09-25 11:06:28.176 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:28.177 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - 204 null null 6.4367ms
2025-09-25 11:06:28.186 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-25 11:06:28.201 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:06:28.212 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:06:28.217 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:06:28.227 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:06:28.274 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-25 11:06:28.278 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:06:28.283 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 52.6352ms
2025-09-25 11:06:28.286 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:06:28.288 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 102.3994ms
2025-09-25 11:08:41.063 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:08:41.069 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:08:41.071 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 8.4432ms
2025-09-25 11:08:41.078 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:08:41.084 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:08:41.088 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:08:41.094 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:08:41.096 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:08:41.105 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:08:41.113 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:08:41.123 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:08:41.129 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:08:41.147 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:08:41.164 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:08:41.173 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:08:41.178 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:08:41.185 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:08:41.190 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:08:41.194 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:08:41.197 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 94.4947ms
2025-09-25 11:08:41.203 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:08:41.204 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 126.794ms
2025-09-25 11:08:41.213 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - null null
2025-09-25 11:08:41.218 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:08:41.220 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - 204 null null 7.1548ms
2025-09-25 11:08:41.225 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-25 11:08:41.231 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:08:41.237 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:08:41.240 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:08:41.242 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:08:41.254 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-25 11:08:41.259 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:08:41.261 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 15.69ms
2025-09-25 11:08:41.263 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:08:41.266 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 40.4988ms
2025-09-25 11:23:31.443 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:23:31.449 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:23:31.452 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 8.7045ms
2025-09-25 11:23:31.463 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:23:31.472 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:23:31.606 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:23:31.611 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:23:31.613 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:23:31.620 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:23:31.627 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:23:31.634 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:23:31.640 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:23:31.653 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:23:31.662 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:23:31.670 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:23:31.677 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:23:31.687 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:23:31.693 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:23:31.697 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:23:31.701 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 84.8846ms
2025-09-25 11:23:31.704 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:23:31.706 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 242.3771ms
2025-09-25 11:23:31.716 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - null null
2025-09-25 11:23:31.721 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:23:31.723 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - 204 null null 7.2296ms
2025-09-25 11:23:31.743 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-25 11:23:31.750 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:23:31.755 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:23:31.762 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:23:31.764 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:23:31.778 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-25 11:23:31.782 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:23:31.785 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 16.8092ms
2025-09-25 11:23:31.789 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:23:31.792 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 48.5759ms
2025-09-25 11:23:35.901 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:23:35.901 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 11:23:35.910 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:23:35.914 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:23:35.920 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 19.2598ms
2025-09-25 11:23:35.919 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:23:35.950 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:23:35.976 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:23:35.981 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:23:35.979 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:23:35.985 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:23:35.998 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:23:36.013 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:23:36.032 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:23:36.049 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:23:36.064 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:23:36.077 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:23:36.084 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:23:36.096 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:23:36.096 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:23:36.101 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:23:36.108 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:23:36.109 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:23:36.115 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:23:36.119 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 135.7248ms
2025-09-25 11:23:36.120 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:23:36.124 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:23:36.131 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 230.2458ms
2025-09-25 11:23:36.134 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:23:36.143 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 32.1926ms
2025-09-25 11:23:36.145 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:23:36.149 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 198.9996ms
2025-09-25 11:27:46.377 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 11:27:46.384 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:27:46.416 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:27:46.434 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:27:46.436 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 58.7758ms
2025-09-25 11:27:46.439 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 55.1973ms
2025-09-25 11:27:46.448 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:27:46.464 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:27:46.453 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:27:46.464 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 11:27:46.465 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:27:46.467 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:27:46.490 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:27:46.482 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:27:46.487 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:27:46.496 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 31.3604ms
2025-09-25 11:27:46.495 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 30.9149ms
2025-09-25 11:27:46.479 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:27:46.520 +08:00 [INF] Executed DbCommand (22ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:27:46.534 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 11:27:46.539 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 11:27:46.542 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 89.5815ms
2025-09-25 11:27:46.547 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:27:46.553 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 11:27:46.554 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:27:46.556 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 62.3624ms
2025-09-25 11:27:46.559 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:27:46.564 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:27:46.568 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:27:46.570 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:27:46.574 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:27:46.578 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 24.4653ms
2025-09-25 11:27:46.584 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:27:46.583 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 135.572ms
2025-09-25 11:27:46.587 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:27:46.591 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 11:27:46.596 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:27:46.604 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:27:46.610 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:27:46.612 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:27:46.614 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:27:46.615 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 11:27:46.620 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:27:46.624 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 11:27:46.628 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:27:46.630 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:27:46.652 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:27:46.654 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:27:46.662 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:27:46.673 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 52.3455ms
2025-09-25 11:27:46.680 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:27:46.682 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 122.7158ms
2025-09-25 11:27:46.683 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:27:46.709 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:27:46.715 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:27:46.732 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:27:46.739 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 11:27:46.748 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:27:46.767 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 11:27:46.771 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:27:46.777 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 11:27:46.780 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:27:46.782 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 149.3957ms
2025-09-25 11:27:46.786 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 168.0867ms
2025-09-25 11:27:46.789 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 11:27:46.794 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:27:46.796 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 204.9324ms
2025-09-25 11:27:46.798 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 243.9086ms
2025-09-25 11:27:46.813 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:27:46.817 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:27:46.821 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:27:46.828 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:27:46.830 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:27:46.834 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:27:46.843 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:27:46.848 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:27:46.852 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:27:46.868 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:27:46.877 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:27:46.882 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:27:46.890 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:27:46.896 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:27:46.900 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:27:46.904 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:27:46.909 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 76.7684ms
2025-09-25 11:27:46.912 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:27:46.914 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 100.8076ms
2025-09-25 11:29:13.231 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 11:29:13.232 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:29:13.292 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:29:13.284 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:29:13.298 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 64.5611ms
2025-09-25 11:29:13.315 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:29:13.299 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 67.6881ms
2025-09-25 11:29:13.333 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:29:13.323 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:29:13.325 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:29:13.323 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 11:29:13.339 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:29:13.347 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:29:13.348 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:29:13.369 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:29:13.354 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 11:29:13.359 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 35.8535ms
2025-09-25 11:29:13.352 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:29:13.395 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 11:29:13.397 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:29:13.402 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 78.6094ms
2025-09-25 11:29:13.404 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 70.083ms
2025-09-25 11:29:13.418 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:29:13.419 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 11:29:13.425 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:29:13.427 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 38.553ms
2025-09-25 11:29:13.429 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:29:13.431 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:29:13.435 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:29:13.437 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:29:13.441 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:29:13.443 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 23.7539ms
2025-09-25 11:29:13.446 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:29:13.448 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 132.7827ms
2025-09-25 11:29:13.455 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 11:29:13.469 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:29:13.460 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:29:13.473 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 11:29:13.476 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:29:13.478 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 11:29:13.483 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:29:13.490 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:29:13.496 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:29:13.503 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:29:13.527 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:29:13.535 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:29:13.537 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:29:13.541 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:29:13.543 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:29:13.548 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:29:13.550 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:29:13.558 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:29:13.559 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:29:13.578 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:29:13.583 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:29:13.589 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 11:29:13.590 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:29:13.593 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 42.0625ms
2025-09-25 11:29:13.600 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 118.9147ms
2025-09-25 11:29:13.606 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:29:13.602 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:29:13.601 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 11:29:13.608 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 183.5496ms
2025-09-25 11:29:13.611 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 182.4062ms
2025-09-25 11:29:13.618 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 11:29:13.631 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 146.1208ms
2025-09-25 11:29:13.635 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 11:29:13.637 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 181.1177ms
2025-09-25 11:29:13.644 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:29:13.652 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:29:13.661 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:29:13.666 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:29:13.669 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:29:13.675 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:29:13.680 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:29:13.689 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:29:13.695 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:29:13.703 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:29:13.716 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:29:13.725 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:29:13.730 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:29:13.735 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:29:13.742 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:29:13.747 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:29:13.750 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 76.3025ms
2025-09-25 11:29:13.753 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:29:13.755 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 110.4789ms
2025-09-25 11:29:15.120 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:29:15.140 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:29:15.152 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:29:15.159 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:29:15.161 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:29:15.169 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:29:15.176 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:29:15.181 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:29:15.187 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:29:15.198 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:29:15.208 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:29:15.214 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:29:15.219 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:29:15.225 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:29:15.231 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:29:15.234 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:29:15.238 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 71.3126ms
2025-09-25 11:29:15.242 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:29:15.244 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 123.6547ms
2025-09-25 11:29:15.251 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - null null
2025-09-25 11:29:15.255 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:29:15.257 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - 204 null null 6.0906ms
2025-09-25 11:29:15.264 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-25 11:29:15.269 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:29:15.274 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:29:15.279 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:29:15.281 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:29:15.288 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-25 11:29:15.294 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:29:15.298 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 14.0252ms
2025-09-25 11:29:15.301 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:29:15.304 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 40.1097ms
2025-09-25 11:30:54.450 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:30:54.571 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:30:54.576 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 126.2529ms
2025-09-25 11:30:54.594 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:30:54.602 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:30:54.609 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:30:54.627 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:30:54.642 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:30:54.649 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:30:54.654 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:30:54.664 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:30:54.673 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:30:54.703 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:30:54.720 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:30:54.734 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:30:54.750 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:30:54.760 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:30:54.771 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:30:54.776 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:30:54.778 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 131.0782ms
2025-09-25 11:30:54.782 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:30:54.788 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 193.191ms
2025-09-25 11:30:54.803 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - null null
2025-09-25 11:30:54.810 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:30:54.811 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - 204 null null 8.3225ms
2025-09-25 11:30:54.818 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-25 11:30:54.827 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:30:54.832 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:30:54.836 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:30:54.841 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:30:54.851 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-25 11:30:54.858 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:30:54.862 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 14.7626ms
2025-09-25 11:30:54.866 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:30:54.868 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 50.2568ms
2025-09-25 11:31:04.494 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:31:04.501 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:04.504 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 9.4144ms
2025-09-25 11:31:04.512 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:31:04.520 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:04.525 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:04.530 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:04.533 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:31:04.538 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:31:04.547 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:31:04.552 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:31:04.557 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:31:04.577 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:31:04.587 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:31:04.591 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:31:04.595 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:31:04.600 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:31:04.604 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:31:04.608 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:04.611 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 73.6564ms
2025-09-25 11:31:04.616 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:04.618 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 106.0653ms
2025-09-25 11:31:04.626 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - null null
2025-09-25 11:31:04.633 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:04.636 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - 204 null null 9.3879ms
2025-09-25 11:31:04.642 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-25 11:31:04.648 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:04.654 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:04.659 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:31:04.661 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:04.669 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-25 11:31:04.673 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:04.676 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 9.4081ms
2025-09-25 11:31:04.680 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:31:04.683 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 40.1658ms
2025-09-25 11:31:07.908 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - null null
2025-09-25 11:31:07.908 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/subscription-plans - null null
2025-09-25 11:31:07.914 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:07.919 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:07.920 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - 204 null null 12.7912ms
2025-09-25 11:31:07.923 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/subscription-plans - 204 null null 14.6441ms
2025-09-25 11:31:07.934 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/subscription-plans - application/json null
2025-09-25 11:31:07.939 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users - application/json null
2025-09-25 11:31:07.947 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:07.951 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:07.956 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:07.956 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:07.962 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-25 11:31:07.966 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-09-25 11:31:07.977 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:07.986 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:08.004 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:31:08.021 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-09-25 11:31:08.028 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:08.033 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price, s0.id, s0.billing_cycle, s0.created_at, s0.end_date, s0.next_billing_date, s0.plan_name, s0.price, s0.start_date, s0.status, s0.stripe_subscription_id, s0.subscription_plan_id, s0.updated_at, s0.user_id
FROM subscription_plans AS s
LEFT JOIN subscriptions AS s0 ON s.id = s0.subscription_plan_id
ORDER BY s.id
2025-09-25 11:31:08.072 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 82.2777ms
2025-09-25 11:31:08.078 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-25 11:31:08.080 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users - 200 null application/json; charset=utf-8 140.4858ms
2025-09-25 11:31:08.116 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - null null
2025-09-25 11:31:08.119 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - null null
2025-09-25 11:31:08.134 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - null null
2025-09-25 11:31:08.149 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - null null
2025-09-25 11:31:08.149 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - null null
2025-09-25 11:31:08.218 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:08.295 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.323 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.329 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.334 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.339 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.346 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - 204 null null 230.4448ms
2025-09-25 11:31:08.349 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - 204 null null 229.5614ms
2025-09-25 11:31:08.351 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - 204 null null 217.3573ms
2025-09-25 11:31:08.355 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - 204 null null 206.4233ms
2025-09-25 11:31:08.361 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 378.9317ms
2025-09-25 11:31:08.363 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - 204 null null 213.786ms
2025-09-25 11:31:08.370 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - null null
2025-09-25 11:31:08.377 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - null null
2025-09-25 11:31:08.382 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - null null
2025-09-25 11:31:08.387 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - null null
2025-09-25 11:31:08.389 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-09-25 11:31:08.395 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - null null
2025-09-25 11:31:08.399 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.404 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.408 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.413 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.415 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/subscription-plans - 200 null application/json; charset=utf-8 480.6309ms
2025-09-25 11:31:08.435 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - null null
2025-09-25 11:31:08.420 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - 204 null null 50.495ms
2025-09-25 11:31:08.422 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - 204 null null 45.2095ms
2025-09-25 11:31:08.423 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - 204 null null 40.9302ms
2025-09-25 11:31:08.428 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - 204 null null 41.2539ms
2025-09-25 11:31:08.419 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.440 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.448 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - application/json null
2025-09-25 11:31:08.453 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - application/json null
2025-09-25 11:31:08.457 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - application/json null
2025-09-25 11:31:08.463 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - application/json null
2025-09-25 11:31:08.465 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - 204 null null 69.2543ms
2025-09-25 11:31:08.477 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - 204 null null 41.8833ms
2025-09-25 11:31:08.535 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.547 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.550 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.554 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.559 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - application/json null
2025-09-25 11:31:08.582 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - application/json null
2025-09-25 11:31:08.896 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.628 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:08.635 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:08.888 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:08.888 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:08.620 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:08.913 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:08.918 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:08.922 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:08.931 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:08.935 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:08.942 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:08.943 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:08.947 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:08.949 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:08.951 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:08.964 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:08.993 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-25 11:31:08.993 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-25 11:31:08.993 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-25 11:31:08.996 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-25 11:31:08.997 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:09.029 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__subscription_SubscriptionPlanId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price
FROM subscription_plans AS s
WHERE s.id = @__subscription_SubscriptionPlanId_0
LIMIT 1
2025-09-25 11:31:09.029 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__subscription_SubscriptionPlanId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price
FROM subscription_plans AS s
WHERE s.id = @__subscription_SubscriptionPlanId_0
LIMIT 1
2025-09-25 11:31:09.036 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__subscription_SubscriptionPlanId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price
FROM subscription_plans AS s
WHERE s.id = @__subscription_SubscriptionPlanId_0
LIMIT 1
2025-09-25 11:31:09.037 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.064 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:09.073 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-25 11:31:09.087 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType116`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:09.087 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType116`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:09.087 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType117`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType118`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[CeceLearningPortal.Api.Models.SubscriptionStatus, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:09.087 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType117`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType118`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[CeceLearningPortal.Api.Models.SubscriptionStatus, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:09.087 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType117`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType118`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[CeceLearningPortal.Api.Models.SubscriptionStatus, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:09.097 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 27.6419ms
2025-09-25 11:31:09.097 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 123.8328ms
2025-09-25 11:31:09.122 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.128 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-25 11:31:09.128 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.131 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - 200 null application/json; charset=utf-8 548.9169ms
2025-09-25 11:31:09.131 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 170.9098ms
2025-09-25 11:31:09.131 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 163.8472ms
2025-09-25 11:31:09.131 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 160.4334ms
2025-09-25 11:31:09.140 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - 200 null application/json; charset=utf-8 580.9219ms
2025-09-25 11:31:09.143 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__subscription_SubscriptionPlanId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price
FROM subscription_plans AS s
WHERE s.id = @__subscription_SubscriptionPlanId_0
LIMIT 1
2025-09-25 11:31:09.148 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - application/json null
2025-09-25 11:31:09.150 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.152 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.154 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.161 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - application/json null
2025-09-25 11:31:09.165 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType117`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType118`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[CeceLearningPortal.Api.Models.SubscriptionStatus, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:09.170 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:09.171 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - 200 null application/json; charset=utf-8 714.0778ms
2025-09-25 11:31:09.173 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - 200 null application/json; charset=utf-8 709.6674ms
2025-09-25 11:31:09.176 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - 200 null application/json; charset=utf-8 728.3418ms
2025-09-25 11:31:09.182 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:09.185 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 230.7032ms
2025-09-25 11:31:09.190 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:09.195 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - application/json null
2025-09-25 11:31:09.201 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - application/json null
2025-09-25 11:31:09.206 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - application/json null
2025-09-25 11:31:09.213 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:09.214 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.218 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.222 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:09.229 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:09.234 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:09.238 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.240 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - 200 null application/json; charset=utf-8 786.9189ms
2025-09-25 11:31:09.248 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:09.256 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:09.257 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:09.261 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:09.263 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:09.283 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.284 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-25 11:31:09.287 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.299 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-25 11:31:09.301 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.301 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:09.315 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType116`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:09.317 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:09.322 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType116`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:09.324 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:09.337 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 64.2847ms
2025-09-25 11:31:09.337 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-25 11:31:09.347 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 53.3293ms
2025-09-25 11:31:09.347 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-25 11:31:09.354 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-09-25 11:31:09.354 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.375 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - 200 null application/json; charset=utf-8 226.3522ms
2025-09-25 11:31:09.363 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.367 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType116`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:09.372 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType116`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:09.360 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType116`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:09.388 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - 200 null application/json; charset=utf-8 226.8735ms
2025-09-25 11:31:09.390 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 47.2169ms
2025-09-25 11:31:09.395 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 43.6772ms
2025-09-25 11:31:09.398 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 63.8866ms
2025-09-25 11:31:09.406 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.408 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.411 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-09-25 11:31:09.414 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - 200 null application/json; charset=utf-8 212.6554ms
2025-09-25 11:31:09.416 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - 200 null application/json; charset=utf-8 209.8206ms
2025-09-25 11:31:09.418 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - 200 null application/json; charset=utf-8 223.5769ms
2025-09-25 11:31:10.473 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses - null null
2025-09-25 11:31:10.485 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:10.488 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses - 204 null null 15.1823ms
2025-09-25 11:31:10.499 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/courses - application/json null
2025-09-25 11:31:10.503 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:10.514 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:10.518 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api)'
2025-09-25 11:31:10.532 +08:00 [INF] Route matched with {action = "GetCoursesForManagement", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCoursesForManagement(CeceLearningPortal.Api.DTOs.CourseManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:10.612 +08:00 [INF] Executed DbCommand (13ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id AS "Id", c0.title AS "Title", c0.description AS "Description", c0.instructor_id AS "InstructorId", a."FullName" AS "InstructorName", c0.price AS "Price", c0.category AS "Category", c0.level AS "Level", c0.status AS "Status", (
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c0.id = e.course_id) AS "StudentsCount", CASE
    WHEN EXISTS (
        SELECT 1
        FROM course_reviews AS c1
        WHERE c0.id = c1.course_id) THEN (
        SELECT avg(c2.rating::double precision)
        FROM course_reviews AS c2
        WHERE c0.id = c2.course_id)
    ELSE 0.0
END AS "AverageRating", (
    SELECT count(*)::int
    FROM enrollments AS e0
    WHERE c0.id = e0.course_id)::numeric * c0.price * 0.8 AS "TotalRevenue", c0.created_at AS "CreatedAt", c0.updated_at AS "UpdatedAt", c0.status = 'Draft' AS "NeedsReview", NULL AS "AdminNotes"
FROM (
    SELECT c.id, c.category, c.created_at, c.description, c.instructor_id, c.level, c.price, c.status, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
ORDER BY c0.created_at DESC
2025-09-25 11:31:10.622 +08:00 [INF] Admin API returning course 35 'Test' with status: Draft (raw value: 0)
2025-09-25 11:31:10.626 +08:00 [INF] Admin API returning course 34 'SprintCourse' with status: Active (raw value: 2)
2025-09-25 11:31:10.628 +08:00 [INF] Admin API returning course 33 'MarathonCourse' with status: Active (raw value: 2)
2025-09-25 11:31:10.629 +08:00 [INF] Admin API returning course 28 'Social Media Marketing Mastery' with status: Active (raw value: 2)
2025-09-25 11:31:10.631 +08:00 [INF] Admin API returning course 25 'React Native Development' with status: Active (raw value: 2)
2025-09-25 11:31:10.633 +08:00 [INF] Admin API returning course 21 'Computer Vision Fundamentals' with status: Active (raw value: 2)
2025-09-25 11:31:10.634 +08:00 [INF] Admin API returning course 27 'SEO & Content Marketing Strategy' with status: Active (raw value: 2)
2025-09-25 11:31:10.636 +08:00 [INF] Admin API returning course 24 'Flutter & Dart Complete Guide' with status: Active (raw value: 2)
2025-09-25 11:31:10.637 +08:00 [INF] Admin API returning course 20 'Full Stack JavaScript Developer Path' with status: Active (raw value: 2)
2025-09-25 11:31:10.639 +08:00 [INF] Admin API returning course 29 'Draft Course: Machine Learning Fundamentals' with status: Draft (raw value: 0)
2025-09-25 11:31:10.644 +08:00 [INF] Admin API returning course 26 'Digital Marketing Fundamentals' with status: Active (raw value: 2)
2025-09-25 11:31:10.646 +08:00 [INF] Admin API returning course 23 'Android Development Masterclass' with status: Active (raw value: 2)
2025-09-25 11:31:10.647 +08:00 [INF] Admin API returning course 19 'Machine Learning with Python & TensorFlow' with status: Active (raw value: 2)
2025-09-25 11:31:10.649 +08:00 [INF] Admin API returning course 22 'iOS Development with Swift' with status: Active (raw value: 2)
2025-09-25 11:31:10.650 +08:00 [INF] Admin API returning course 18 'Advanced React & Redux Masterclass' with status: Active (raw value: 2)
2025-09-25 11:31:10.651 +08:00 [INF] Admin API returning course 17 'Complete Web Development Bootcamp 2025' with status: Active (raw value: 2)
2025-09-25 11:31:10.653 +08:00 [INF] Admin API returning course 31 'Inactive Course: Legacy PHP Development' with status: Inactive (raw value: 3)
2025-09-25 11:31:10.654 +08:00 [INF] Admin API returning course 30 'Draft Course: Blockchain Development' with status: Draft (raw value: 0)
2025-09-25 11:31:10.655 +08:00 [INF] Admin API returning course 32 'Inactive Course: Flash Game Development' with status: Inactive (raw value: 3)
2025-09-25 11:31:10.689 +08:00 [INF] First course serialized: {
  "Id": 35,
  "Title": "Test",
  "Description": "Test",
  "InstructorId": "bee889a2-efca-471d-807c-a7674a945612",
  "InstructorName": "Dr. Sarah Johnson",
  "Price": 10,
  "Category": "Test",
  "Level": "Beginner",
  "Status": "Draft",
  "StudentsCount": 0,
  "AverageRating": 0,
  "TotalRevenue": 0.0,
  "CreatedAt": "2025-09-24T01:02:07.311815Z",
  "UpdatedAt": "2025-09-24T01:02:07.311881Z",
  "NeedsReview": true,
  "AdminNotes": null
}
2025-09-25 11:31:10.692 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.AdminCourseManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:10.696 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api) in 161.4274ms
2025-09-25 11:31:10.699 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api)'
2025-09-25 11:31:10.701 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/courses - 200 null application/json; charset=utf-8 201.5959ms
2025-09-25 11:31:13.778 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/courses - application/json null
2025-09-25 11:31:13.783 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:13.789 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:13.792 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api)'
2025-09-25 11:31:13.794 +08:00 [INF] Route matched with {action = "GetCoursesForManagement", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCoursesForManagement(CeceLearningPortal.Api.DTOs.CourseManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:13.802 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id AS "Id", c0.title AS "Title", c0.description AS "Description", c0.instructor_id AS "InstructorId", a."FullName" AS "InstructorName", c0.price AS "Price", c0.category AS "Category", c0.level AS "Level", c0.status AS "Status", (
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c0.id = e.course_id) AS "StudentsCount", CASE
    WHEN EXISTS (
        SELECT 1
        FROM course_reviews AS c1
        WHERE c0.id = c1.course_id) THEN (
        SELECT avg(c2.rating::double precision)
        FROM course_reviews AS c2
        WHERE c0.id = c2.course_id)
    ELSE 0.0
END AS "AverageRating", (
    SELECT count(*)::int
    FROM enrollments AS e0
    WHERE c0.id = e0.course_id)::numeric * c0.price * 0.8 AS "TotalRevenue", c0.created_at AS "CreatedAt", c0.updated_at AS "UpdatedAt", c0.status = 'Draft' AS "NeedsReview", NULL AS "AdminNotes"
FROM (
    SELECT c.id, c.category, c.created_at, c.description, c.instructor_id, c.level, c.price, c.status, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
ORDER BY c0.created_at DESC
2025-09-25 11:31:13.809 +08:00 [INF] Admin API returning course 35 'Test' with status: Draft (raw value: 0)
2025-09-25 11:31:13.810 +08:00 [INF] Admin API returning course 34 'SprintCourse' with status: Active (raw value: 2)
2025-09-25 11:31:13.812 +08:00 [INF] Admin API returning course 33 'MarathonCourse' with status: Active (raw value: 2)
2025-09-25 11:31:13.813 +08:00 [INF] Admin API returning course 28 'Social Media Marketing Mastery' with status: Active (raw value: 2)
2025-09-25 11:31:13.815 +08:00 [INF] Admin API returning course 25 'React Native Development' with status: Active (raw value: 2)
2025-09-25 11:31:13.817 +08:00 [INF] Admin API returning course 21 'Computer Vision Fundamentals' with status: Active (raw value: 2)
2025-09-25 11:31:13.819 +08:00 [INF] Admin API returning course 27 'SEO & Content Marketing Strategy' with status: Active (raw value: 2)
2025-09-25 11:31:13.822 +08:00 [INF] Admin API returning course 24 'Flutter & Dart Complete Guide' with status: Active (raw value: 2)
2025-09-25 11:31:13.824 +08:00 [INF] Admin API returning course 20 'Full Stack JavaScript Developer Path' with status: Active (raw value: 2)
2025-09-25 11:31:13.826 +08:00 [INF] Admin API returning course 29 'Draft Course: Machine Learning Fundamentals' with status: Draft (raw value: 0)
2025-09-25 11:31:13.827 +08:00 [INF] Admin API returning course 26 'Digital Marketing Fundamentals' with status: Active (raw value: 2)
2025-09-25 11:31:13.828 +08:00 [INF] Admin API returning course 23 'Android Development Masterclass' with status: Active (raw value: 2)
2025-09-25 11:31:13.830 +08:00 [INF] Admin API returning course 19 'Machine Learning with Python & TensorFlow' with status: Active (raw value: 2)
2025-09-25 11:31:13.832 +08:00 [INF] Admin API returning course 22 'iOS Development with Swift' with status: Active (raw value: 2)
2025-09-25 11:31:13.833 +08:00 [INF] Admin API returning course 18 'Advanced React & Redux Masterclass' with status: Active (raw value: 2)
2025-09-25 11:31:13.835 +08:00 [INF] Admin API returning course 17 'Complete Web Development Bootcamp 2025' with status: Active (raw value: 2)
2025-09-25 11:31:13.836 +08:00 [INF] Admin API returning course 31 'Inactive Course: Legacy PHP Development' with status: Inactive (raw value: 3)
2025-09-25 11:31:13.839 +08:00 [INF] Admin API returning course 30 'Draft Course: Blockchain Development' with status: Draft (raw value: 0)
2025-09-25 11:31:13.841 +08:00 [INF] Admin API returning course 32 'Inactive Course: Flash Game Development' with status: Inactive (raw value: 3)
2025-09-25 11:31:13.845 +08:00 [INF] First course serialized: {
  "Id": 35,
  "Title": "Test",
  "Description": "Test",
  "InstructorId": "bee889a2-efca-471d-807c-a7674a945612",
  "InstructorName": "Dr. Sarah Johnson",
  "Price": 10,
  "Category": "Test",
  "Level": "Beginner",
  "Status": "Draft",
  "StudentsCount": 0,
  "AverageRating": 0,
  "TotalRevenue": 0.0,
  "CreatedAt": "2025-09-24T01:02:07.311815Z",
  "UpdatedAt": "2025-09-24T01:02:07.311881Z",
  "NeedsReview": true,
  "AdminNotes": null
}
2025-09-25 11:31:13.848 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.AdminCourseManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:13.851 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api) in 53.2519ms
2025-09-25 11:31:13.855 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api)'
2025-09-25 11:31:13.857 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/courses - 200 null application/json; charset=utf-8 78.8111ms
2025-09-25 11:31:35.070 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses/33 - null null
2025-09-25 11:31:35.074 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:35.076 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses/33 - 204 null null 5.8575ms
2025-09-25 11:31:35.081 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5296/api/admin/courses/33 - application/json 186
2025-09-25 11:31:35.086 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:35.089 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:35.094 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.UpdateCourse (CeceLearningPortal.Api)'
2025-09-25 11:31:35.102 +08:00 [INF] Route matched with {action = "UpdateCourse", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCourse(Int32, CeceLearningPortal.Api.DTOs.UpdateCourseDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:35.222 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.id = @__p_0
LIMIT 1
2025-09-25 11:31:35.423 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE courses SET price = @p0, updated_at = @p1
WHERE id = @p2;
2025-09-25 11:31:35.441 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-09-25 11:31:35.443 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.UpdateCourse (CeceLearningPortal.Api) in 337.6376ms
2025-09-25 11:31:35.446 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.UpdateCourse (CeceLearningPortal.Api)'
2025-09-25 11:31:35.448 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5296/api/admin/courses/33 - 200 null application/json; charset=utf-8 366.9453ms
2025-09-25 11:31:35.456 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses - null null
2025-09-25 11:31:35.460 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:35.462 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses - 204 null null 5.5484ms
2025-09-25 11:31:35.472 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/courses - application/json null
2025-09-25 11:31:35.477 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:35.480 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:35.488 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api)'
2025-09-25 11:31:35.490 +08:00 [INF] Route matched with {action = "GetCoursesForManagement", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCoursesForManagement(CeceLearningPortal.Api.DTOs.CourseManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:35.501 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id AS "Id", c0.title AS "Title", c0.description AS "Description", c0.instructor_id AS "InstructorId", a."FullName" AS "InstructorName", c0.price AS "Price", c0.category AS "Category", c0.level AS "Level", c0.status AS "Status", (
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c0.id = e.course_id) AS "StudentsCount", CASE
    WHEN EXISTS (
        SELECT 1
        FROM course_reviews AS c1
        WHERE c0.id = c1.course_id) THEN (
        SELECT avg(c2.rating::double precision)
        FROM course_reviews AS c2
        WHERE c0.id = c2.course_id)
    ELSE 0.0
END AS "AverageRating", (
    SELECT count(*)::int
    FROM enrollments AS e0
    WHERE c0.id = e0.course_id)::numeric * c0.price * 0.8 AS "TotalRevenue", c0.created_at AS "CreatedAt", c0.updated_at AS "UpdatedAt", c0.status = 'Draft' AS "NeedsReview", NULL AS "AdminNotes"
FROM (
    SELECT c.id, c.category, c.created_at, c.description, c.instructor_id, c.level, c.price, c.status, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
ORDER BY c0.created_at DESC
2025-09-25 11:31:35.507 +08:00 [INF] Admin API returning course 35 'Test' with status: Draft (raw value: 0)
2025-09-25 11:31:35.508 +08:00 [INF] Admin API returning course 34 'SprintCourse' with status: Active (raw value: 2)
2025-09-25 11:31:35.509 +08:00 [INF] Admin API returning course 33 'MarathonCourse' with status: Active (raw value: 2)
2025-09-25 11:31:35.513 +08:00 [INF] Admin API returning course 28 'Social Media Marketing Mastery' with status: Active (raw value: 2)
2025-09-25 11:31:35.516 +08:00 [INF] Admin API returning course 25 'React Native Development' with status: Active (raw value: 2)
2025-09-25 11:31:35.519 +08:00 [INF] Admin API returning course 21 'Computer Vision Fundamentals' with status: Active (raw value: 2)
2025-09-25 11:31:35.520 +08:00 [INF] Admin API returning course 27 'SEO & Content Marketing Strategy' with status: Active (raw value: 2)
2025-09-25 11:31:35.523 +08:00 [INF] Admin API returning course 24 'Flutter & Dart Complete Guide' with status: Active (raw value: 2)
2025-09-25 11:31:35.524 +08:00 [INF] Admin API returning course 20 'Full Stack JavaScript Developer Path' with status: Active (raw value: 2)
2025-09-25 11:31:35.526 +08:00 [INF] Admin API returning course 29 'Draft Course: Machine Learning Fundamentals' with status: Draft (raw value: 0)
2025-09-25 11:31:35.528 +08:00 [INF] Admin API returning course 26 'Digital Marketing Fundamentals' with status: Active (raw value: 2)
2025-09-25 11:31:35.529 +08:00 [INF] Admin API returning course 23 'Android Development Masterclass' with status: Active (raw value: 2)
2025-09-25 11:31:35.530 +08:00 [INF] Admin API returning course 19 'Machine Learning with Python & TensorFlow' with status: Active (raw value: 2)
2025-09-25 11:31:35.532 +08:00 [INF] Admin API returning course 22 'iOS Development with Swift' with status: Active (raw value: 2)
2025-09-25 11:31:35.535 +08:00 [INF] Admin API returning course 18 'Advanced React & Redux Masterclass' with status: Active (raw value: 2)
2025-09-25 11:31:35.537 +08:00 [INF] Admin API returning course 17 'Complete Web Development Bootcamp 2025' with status: Active (raw value: 2)
2025-09-25 11:31:35.538 +08:00 [INF] Admin API returning course 31 'Inactive Course: Legacy PHP Development' with status: Inactive (raw value: 3)
2025-09-25 11:31:35.539 +08:00 [INF] Admin API returning course 30 'Draft Course: Blockchain Development' with status: Draft (raw value: 0)
2025-09-25 11:31:35.541 +08:00 [INF] Admin API returning course 32 'Inactive Course: Flash Game Development' with status: Inactive (raw value: 3)
2025-09-25 11:31:35.546 +08:00 [INF] First course serialized: {
  "Id": 35,
  "Title": "Test",
  "Description": "Test",
  "InstructorId": "bee889a2-efca-471d-807c-a7674a945612",
  "InstructorName": "Dr. Sarah Johnson",
  "Price": 10,
  "Category": "Test",
  "Level": "Beginner",
  "Status": "Draft",
  "StudentsCount": 0,
  "AverageRating": 0,
  "TotalRevenue": 0.0,
  "CreatedAt": "2025-09-24T01:02:07.311815Z",
  "UpdatedAt": "2025-09-24T01:02:07.311881Z",
  "NeedsReview": true,
  "AdminNotes": null
}
2025-09-25 11:31:35.548 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.AdminCourseManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:35.551 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api) in 57.2329ms
2025-09-25 11:31:35.553 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api)'
2025-09-25 11:31:35.555 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/courses - 200 null application/json; charset=utf-8 83.2151ms
2025-09-25 11:31:38.167 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - null null
2025-09-25 11:31:38.178 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:38.182 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - 204 null null 15.4486ms
2025-09-25 11:31:38.195 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users - application/json null
2025-09-25 11:31:38.203 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:38.211 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:38.219 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-25 11:31:38.223 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:38.236 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:31:38.242 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-09-25 11:31:38.252 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:38.256 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 23.0131ms
2025-09-25 11:31:38.260 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-25 11:31:38.265 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users - 200 null application/json; charset=utf-8 70.1192ms
2025-09-25 11:31:38.273 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 11:31:38.286 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:38.291 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 17.7458ms
2025-09-25 11:31:38.311 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:31:38.319 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:38.324 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:38.332 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:38.336 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:38.361 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:38.380 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:38.393 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 43.7313ms
2025-09-25 11:31:38.402 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:38.409 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 97.1368ms
2025-09-25 11:31:38.437 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:31:38.453 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:38.455 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 17.6312ms
2025-09-25 11:31:38.470 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:31:38.474 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:38.480 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:38.488 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:38.491 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:31:38.508 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:31:38.522 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:31:38.549 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:31:38.573 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:31:38.601 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:31:38.614 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:31:38.623 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:31:38.632 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:31:38.653 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:31:38.660 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:31:38.668 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:38.674 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 168.968ms
2025-09-25 11:31:38.676 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:31:38.686 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:38.682 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:38.690 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 220.1725ms
2025-09-25 11:31:38.692 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:38.707 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:38.710 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:31:38.762 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:31:38.783 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:31:38.792 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:31:38.804 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:31:38.882 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:31:39.002 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:31:39.021 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:31:39.035 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:31:39.043 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:31:39.057 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:31:39.070 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:39.073 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 316.2702ms
2025-09-25 11:31:39.077 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:39.085 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 409.0113ms
2025-09-25 11:31:39.109 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - null null
2025-09-25 11:31:39.111 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - null null
2025-09-25 11:31:39.111 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - null null
2025-09-25 11:31:39.115 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - null null
2025-09-25 11:31:39.116 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-25 11:31:39.121 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:39.126 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:39.136 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:39.192 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:39.201 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:39.203 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 204 null null 93.4177ms
2025-09-25 11:31:39.206 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 204 null null 94.5125ms
2025-09-25 11:31:39.241 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 204 null null 130.2354ms
2025-09-25 11:31:39.277 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 204 null null 161.4068ms
2025-09-25 11:31:39.304 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 187.9866ms
2025-09-25 11:31:39.448 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - application/json null
2025-09-25 11:31:39.487 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - application/json null
2025-09-25 11:31:39.503 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - application/json null
2025-09-25 11:31:39.519 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - application/json null
2025-09-25 11:31:39.534 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-25 11:31:39.541 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:39.551 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:39.556 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:39.564 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:39.569 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:39.577 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:39.587 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:39.595 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:39.598 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:39.605 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:39.607 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:39.616 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:39.623 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:39.637 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:39.650 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:39.652 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:39.656 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:39.659 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:39.668 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:39.673 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:39.703 +08:00 [INF] Executed DbCommand (23ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:39.703 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:39.703 +08:00 [INF] Executed DbCommand (15ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:39.714 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:39.719 +08:00 [INF] Executed DbCommand (15ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:39.733 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:39.744 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:39.758 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:39.771 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:39.780 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 104.064ms
2025-09-25 11:31:39.784 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:39.790 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 99.5882ms
2025-09-25 11:31:39.793 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 108.2128ms
2025-09-25 11:31:39.807 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 103.6115ms
2025-09-25 11:31:39.815 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:39.819 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 126.7166ms
2025-09-25 11:31:39.831 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:39.838 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:39.841 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:39.843 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 200 null application/json; charset=utf-8 395.5254ms
2025-09-25 11:31:39.851 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:39.854 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 200 null application/json; charset=utf-8 335.2573ms
2025-09-25 11:31:39.858 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 200 null application/json; charset=utf-8 370.7656ms
2025-09-25 11:31:39.865 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 330.8802ms
2025-09-25 11:31:39.882 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 200 null application/json; charset=utf-8 378.878ms
2025-09-25 11:31:42.796 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:31:42.801 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:42.811 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:42.817 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:42.832 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:42.854 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:42.884 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:42.888 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 48.1173ms
2025-09-25 11:31:42.894 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:42.899 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users - application/json null
2025-09-25 11:31:42.899 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 103.1995ms
2025-09-25 11:31:42.904 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:42.946 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:31:42.952 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.007 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-25 11:31:42.995 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.028 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:43.035 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.055 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:31:43.062 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:43.069 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-09-25 11:31:43.099 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:31:43.105 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:43.117 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:31:43.120 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 70.6308ms
2025-09-25 11:31:43.132 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-25 11:31:43.132 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:31:43.135 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users - 200 null application/json; charset=utf-8 235.5271ms
2025-09-25 11:31:43.141 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:31:43.150 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:31:43.155 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:31:43.162 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.173 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.174 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:31:43.182 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.189 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:43.190 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:31:43.203 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:31:43.204 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:43.217 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:31:43.230 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:43.231 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:31:43.233 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 37.9966ms
2025-09-25 11:31:43.241 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:31:43.245 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.249 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:43.252 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 101.2868ms
2025-09-25 11:31:43.262 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 146.9514ms
2025-09-25 11:31:43.269 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:31:43.274 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:43.280 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.283 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 336.4044ms
2025-09-25 11:31:43.288 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.298 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:43.300 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:31:43.308 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:31:43.314 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:31:43.320 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:31:43.326 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:31:43.338 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:31:43.351 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:31:43.356 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:31:43.364 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:31:43.370 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:31:43.375 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:31:43.380 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:43.384 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 78.9935ms
2025-09-25 11:31:43.386 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:31:43.388 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:43.393 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.395 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 125.8543ms
2025-09-25 11:31:43.399 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.407 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - application/json null
2025-09-25 11:31:43.410 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - application/json null
2025-09-25 11:31:43.410 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - application/json null
2025-09-25 11:31:43.411 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - application/json null
2025-09-25 11:31:43.411 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-25 11:31:43.414 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:43.419 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.426 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.430 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.434 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.439 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.442 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:31:43.445 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.447 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.449 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.450 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.453 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.457 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:31:43.459 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.463 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.467 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.471 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.474 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.479 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:31:43.481 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:43.482 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:43.484 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:43.486 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:43.488 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:43.494 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:31:43.503 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:43.506 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:43.511 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:43.514 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:43.518 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:31:43.523 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:43.528 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:43.531 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:43.537 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:43.544 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:43.548 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:31:43.551 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 55.6444ms
2025-09-25 11:31:43.555 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 55.77ms
2025-09-25 11:31:43.555 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:43.558 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 55.0232ms
2025-09-25 11:31:43.562 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 55.7308ms
2025-09-25 11:31:43.571 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.572 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:31:43.573 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.577 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 65.4442ms
2025-09-25 11:31:43.581 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.583 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.584 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 200 null application/json; charset=utf-8 177.4078ms
2025-09-25 11:31:43.591 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:31:43.594 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 200 null application/json; charset=utf-8 183.8252ms
2025-09-25 11:31:43.597 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.598 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 200 null application/json; charset=utf-8 188.1757ms
2025-09-25 11:31:43.600 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 200 null application/json; charset=utf-8 188.8948ms
2025-09-25 11:31:43.613 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:31:43.619 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 207.8783ms
2025-09-25 11:31:43.642 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:31:43.652 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:31:43.660 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:43.664 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 209.2177ms
2025-09-25 11:31:43.665 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:31:43.669 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:43.673 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.675 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 289.3201ms
2025-09-25 11:31:43.679 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.686 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:43.688 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:31:43.694 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:31:43.699 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:31:43.704 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:31:43.709 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:31:43.720 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:31:43.732 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:31:43.738 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:31:43.744 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:31:43.749 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:31:43.754 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:31:43.759 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:43.762 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 69.5456ms
2025-09-25 11:31:43.766 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:43.768 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 102.6216ms
2025-09-25 11:31:43.779 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - application/json null
2025-09-25 11:31:43.781 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - application/json null
2025-09-25 11:31:43.782 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - application/json null
2025-09-25 11:31:43.783 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - application/json null
2025-09-25 11:31:43.783 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-25 11:31:43.786 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.790 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.794 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.799 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.803 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:43.808 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.811 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.813 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.815 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.816 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:43.819 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.822 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.827 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.830 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.834 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.836 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:43.838 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:43.840 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:43.842 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:43.846 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:43.855 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:43.858 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:43.862 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:43.867 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:43.876 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:43.888 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:43.896 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:43.902 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:43.908 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:43.912 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 64.207ms
2025-09-25 11:31:43.914 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:43.916 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 64.4751ms
2025-09-25 11:31:43.919 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 63.7978ms
2025-09-25 11:31:43.923 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 62.4134ms
2025-09-25 11:31:43.927 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.930 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 60.3843ms
2025-09-25 11:31:43.932 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.935 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.937 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.939 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 200 null application/json; charset=utf-8 159.9662ms
2025-09-25 11:31:43.943 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:43.945 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 200 null application/json; charset=utf-8 163.6021ms
2025-09-25 11:31:43.948 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 200 null application/json; charset=utf-8 166.0698ms
2025-09-25 11:31:43.951 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 200 null application/json; charset=utf-8 168.0436ms
2025-09-25 11:31:43.959 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 175.7196ms
2025-09-25 11:31:48.845 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - null null
2025-09-25 11:31:48.864 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:48.876 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - 204 null null 31.3004ms
2025-09-25 11:31:48.892 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users - application/json null
2025-09-25 11:31:48.897 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:48.901 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:48.910 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-25 11:31:48.912 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:31:48.918 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:31:48.926 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-09-25 11:31:48.932 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:48.935 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 19.3378ms
2025-09-25 11:31:48.942 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-25 11:31:48.945 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users - 200 null application/json; charset=utf-8 53.263ms
2025-09-25 11:31:48.958 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 11:31:48.963 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:48.964 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 6.0816ms
2025-09-25 11:31:48.972 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:31:48.976 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:48.979 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:48.983 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:48.987 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:48.996 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:49.009 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:49.012 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 21.4298ms
2025-09-25 11:31:49.014 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:49.017 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 44.6607ms
2025-09-25 11:31:49.029 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:31:49.034 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:49.038 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 8.9518ms
2025-09-25 11:31:49.050 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:31:49.056 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:49.061 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:49.067 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:49.070 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:31:49.076 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:31:49.080 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:31:49.085 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:31:49.091 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:31:49.101 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:31:49.110 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:31:49.121 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:31:49.134 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:31:49.148 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:31:49.160 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:31:49.173 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:49.182 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 107.7811ms
2025-09-25 11:31:49.189 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:31:49.205 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:49.198 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:49.210 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 159.8375ms
2025-09-25 11:31:49.210 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:49.234 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:49.239 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:31:49.254 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:31:49.264 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:31:49.274 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:31:49.282 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:31:49.295 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:31:49.311 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:31:49.318 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:31:49.326 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:31:49.331 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:31:49.337 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:31:49.346 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:31:49.361 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 110.7244ms
2025-09-25 11:31:49.367 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:31:49.380 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 190.5217ms
2025-09-25 11:31:49.407 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - null null
2025-09-25 11:31:49.407 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - null null
2025-09-25 11:31:49.408 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - null null
2025-09-25 11:31:49.409 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-25 11:31:49.429 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - null null
2025-09-25 11:31:49.434 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:49.444 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:49.450 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:49.458 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:49.464 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:49.466 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 204 null null 59.026ms
2025-09-25 11:31:49.475 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 204 null null 67.6325ms
2025-09-25 11:31:49.476 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 204 null null 68.9238ms
2025-09-25 11:31:49.480 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 71.9496ms
2025-09-25 11:31:49.488 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 204 null null 59.1848ms
2025-09-25 11:31:49.497 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - application/json null
2025-09-25 11:31:49.515 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - application/json null
2025-09-25 11:31:49.524 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - application/json null
2025-09-25 11:31:49.530 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-25 11:31:49.538 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - application/json null
2025-09-25 11:31:49.542 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:49.548 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:49.556 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:49.561 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:49.566 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:31:49.570 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:49.574 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:49.578 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:49.582 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:49.588 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:31:49.592 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:49.597 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:49.600 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:49.608 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:49.612 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:49.614 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:49.616 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:49.621 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:49.624 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:49.627 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:31:49.638 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:49.644 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:49.650 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:49.659 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:49.665 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:31:49.671 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:49.679 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:49.691 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:49.696 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:49.701 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 71.1258ms
2025-09-25 11:31:49.709 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 75.4737ms
2025-09-25 11:31:49.709 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:31:49.712 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 70.0324ms
2025-09-25 11:31:49.716 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 64.327ms
2025-09-25 11:31:49.719 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:49.722 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:49.725 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 67.1416ms
2025-09-25 11:31:49.728 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:49.730 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:49.732 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 200 null application/json; charset=utf-8 235.0674ms
2025-09-25 11:31:49.735 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 200 null application/json; charset=utf-8 220.025ms
2025-09-25 11:31:49.738 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:31:49.740 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 200 null application/json; charset=utf-8 216.0581ms
2025-09-25 11:31:49.743 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 212.9145ms
2025-09-25 11:31:49.757 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 200 null application/json; charset=utf-8 219.3165ms
2025-09-25 11:33:05.077 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - null null
2025-09-25 11:33:05.092 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.096 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/users - 204 null null 19.3381ms
2025-09-25 11:33:05.106 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/users - application/json null
2025-09-25 11:33:05.113 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.118 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:05.122 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-25 11:33:05.126 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:33:05.136 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:33:05.141 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-09-25 11:33:05.148 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:33:05.150 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 16.978ms
2025-09-25 11:33:05.153 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-09-25 11:33:05.155 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/users - 200 null application/json; charset=utf-8 49.2114ms
2025-09-25 11:33:05.166 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 11:33:05.170 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.171 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 5.6159ms
2025-09-25 11:33:05.180 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:33:05.184 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.188 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:05.192 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:05.194 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:33:05.204 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:33:05.214 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:33:05.217 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 18.369ms
2025-09-25 11:33:05.219 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:05.221 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 41.2571ms
2025-09-25 11:33:05.232 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:33:05.237 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.238 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 6.1643ms
2025-09-25 11:33:05.251 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:33:05.256 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.259 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:05.263 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:33:05.265 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:33:05.270 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:33:05.293 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:33:05.299 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:33:05.304 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:33:05.312 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:33:05.319 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:33:05.325 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:33:05.332 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:33:05.337 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:33:05.342 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:33:05.348 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:33:05.351 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 82.24ms
2025-09-25 11:33:05.353 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:33:05.353 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:33:05.358 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.359 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 108.1359ms
2025-09-25 11:33:05.365 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:05.373 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:33:05.375 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:33:05.381 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:33:05.387 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:33:05.392 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:33:05.402 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:33:05.412 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:33:05.419 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:33:05.424 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:33:05.433 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:33:05.438 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:33:05.446 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:33:05.450 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:33:05.453 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 73.0002ms
2025-09-25 11:33:05.456 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:33:05.458 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 105.5251ms
2025-09-25 11:33:05.475 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - null null
2025-09-25 11:33:05.478 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - null null
2025-09-25 11:33:05.479 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - null null
2025-09-25 11:33:05.480 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-09-25 11:33:05.480 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - null null
2025-09-25 11:33:05.483 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.488 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.493 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.511 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 204 null null 31.5928ms
2025-09-25 11:33:05.503 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.506 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 204 null null 31.2326ms
2025-09-25 11:33:05.508 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 204 null null 29.7985ms
2025-09-25 11:33:05.499 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.521 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - application/json null
2025-09-25 11:33:05.522 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 204 null null 41.6136ms
2025-09-25 11:33:05.529 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - application/json null
2025-09-25 11:33:05.535 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - application/json null
2025-09-25 11:33:05.537 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 56.788ms
2025-09-25 11:33:05.566 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-09-25 11:33:05.550 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - application/json null
2025-09-25 11:33:05.554 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.558 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.542 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.570 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.575 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:05.579 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:05.581 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:05.585 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:05.588 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:05.589 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:05.591 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:05.597 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:05.600 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:05.604 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:05.607 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:05.609 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:33:05.612 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:33:05.613 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:33:05.615 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:33:05.617 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:33:05.627 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:33:05.630 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:33:05.637 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:33:05.639 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:33:05.646 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:33:05.650 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:33:05.655 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:33:05.660 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:33:05.666 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:33:05.670 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 50.5142ms
2025-09-25 11:33:05.683 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:05.673 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 49.9411ms
2025-09-25 11:33:05.678 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 48.3626ms
2025-09-25 11:33:05.681 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 48.5657ms
2025-09-25 11:33:05.671 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:33:05.686 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 200 null application/json; charset=utf-8 156.2443ms
2025-09-25 11:33:05.688 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:05.690 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:05.692 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:05.695 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 57.3409ms
2025-09-25 11:33:05.709 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:05.703 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 200 null application/json; charset=utf-8 182.1426ms
2025-09-25 11:33:05.707 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 141.0736ms
2025-09-25 11:33:05.702 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 200 null application/json; charset=utf-8 166.0726ms
2025-09-25 11:33:05.711 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 200 null application/json; charset=utf-8 161.2208ms
2025-09-25 11:33:08.336 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:33:08.341 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:33:08.364 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:08.372 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:08.378 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:08.381 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:08.402 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:33:08.397 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:08.406 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:33:08.411 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:33:08.421 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:33:08.431 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:33:08.432 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:33:08.445 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:33:08.448 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:33:08.449 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 26.9479ms
2025-09-25 11:33:08.459 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:08.455 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:33:08.467 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 130.8171ms
2025-09-25 11:33:08.480 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:33:08.499 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:33:08.517 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:33:08.531 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:33:08.540 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:33:08.551 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:33:08.557 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:33:08.562 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 144.587ms
2025-09-25 11:33:08.569 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:33:08.571 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 230.0965ms
2025-09-25 11:33:35.175 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 11:33:35.176 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:33:35.183 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:35.186 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:35.189 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 13.8049ms
2025-09-25 11:33:35.190 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 13.4079ms
2025-09-25 11:33:35.198 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:33:35.209 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:33:35.220 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:35.214 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:35.222 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:35.224 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 11:33:35.227 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:33:35.228 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 11:33:35.236 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 38.1181ms
2025-09-25 11:33:35.240 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:33:35.255 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/courses - null null
2025-09-25 11:33:35.256 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:33:35.259 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:33:35.262 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:35.275 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/courses - 204 null null 19.7179ms
2025-09-25 11:33:35.273 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 39.5864ms
2025-09-25 11:33:35.285 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:35.282 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/courses - application/json null
2025-09-25 11:33:35.270 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:35.293 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 37.5911ms
2025-09-25 11:33:35.291 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:35.287 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 78.3568ms
2025-09-25 11:33:35.320 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:33:35.325 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:35.329 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 11:33:35.333 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:35.337 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:35.354 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-09-25 11:33:35.350 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:35.342 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:35.377 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-09-25 11:33:35.378 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:33:35.380 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 51.0185ms
2025-09-25 11:33:35.393 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:33:35.395 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:33:35.399 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 11:33:35.404 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:33:35.406 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 36.8986ms
2025-09-25 11:33:35.410 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:35.414 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:33:35.416 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-09-25 11:33:35.417 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 11:33:35.425 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 11:33:35.422 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/courses - 200 null application/json; charset=utf-8 140.0805ms
2025-09-25 11:33:35.421 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:33:35.432 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 11:33:35.439 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:33:35.451 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 11:33:35.453 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:33:35.461 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 11:33:35.466 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:33:35.468 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 40.5335ms
2025-09-25 11:33:35.474 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:33:35.475 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 11:33:35.480 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:33:35.482 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 82.7655ms
2025-09-25 11:33:35.488 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:33:35.497 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:33:35.503 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:33:35.508 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 105.0558ms
2025-09-25 11:33:35.509 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:33:35.512 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:33:35.735 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:35.737 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 417.0716ms
2025-09-25 11:33:35.741 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:35.751 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:33:35.753 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:33:35.757 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:33:35.761 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:33:35.767 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:33:35.772 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:33:35.812 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:33:35.819 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:33:35.824 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:33:35.829 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:33:35.834 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:33:35.839 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:33:35.842 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:33:35.846 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 90.105ms
2025-09-25 11:33:35.849 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:33:35.851 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 341.7575ms
2025-09-25 11:33:36.957 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:33:36.966 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:36.970 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:36.975 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:33:36.977 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:33:36.985 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:33:36.989 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:33:36.993 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:33:37.001 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:33:37.010 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:33:37.019 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:33:37.024 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:33:37.031 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:33:37.036 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:33:37.040 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:33:37.044 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:33:37.049 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 66.4671ms
2025-09-25 11:33:37.052 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:33:37.054 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 96.5834ms
2025-09-25 11:33:37.064 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - null null
2025-09-25 11:33:37.070 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:37.071 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - 204 null null 6.836ms
2025-09-25 11:33:37.076 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-25 11:33:37.083 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:37.088 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:37.092 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:33:37.093 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:33:37.102 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-25 11:33:37.106 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:33:37.109 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 9.4005ms
2025-09-25 11:33:37.114 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:33:37.117 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 40.7049ms
2025-09-25 11:33:38.951 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses - null null
2025-09-25 11:33:39.041 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:39.042 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses - 204 null null 90.9063ms
2025-09-25 11:33:39.053 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/courses - application/json null
2025-09-25 11:33:39.059 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:39.092 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:39.098 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api)'
2025-09-25 11:33:39.100 +08:00 [INF] Route matched with {action = "GetCoursesForManagement", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCoursesForManagement(CeceLearningPortal.Api.DTOs.CourseManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:33:39.108 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id AS "Id", c0.title AS "Title", c0.description AS "Description", c0.instructor_id AS "InstructorId", a."FullName" AS "InstructorName", c0.price AS "Price", c0.category AS "Category", c0.level AS "Level", c0.status AS "Status", (
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c0.id = e.course_id) AS "StudentsCount", CASE
    WHEN EXISTS (
        SELECT 1
        FROM course_reviews AS c1
        WHERE c0.id = c1.course_id) THEN (
        SELECT avg(c2.rating::double precision)
        FROM course_reviews AS c2
        WHERE c0.id = c2.course_id)
    ELSE 0.0
END AS "AverageRating", (
    SELECT count(*)::int
    FROM enrollments AS e0
    WHERE c0.id = e0.course_id)::numeric * c0.price * 0.8 AS "TotalRevenue", c0.created_at AS "CreatedAt", c0.updated_at AS "UpdatedAt", c0.status = 'Draft' AS "NeedsReview", NULL AS "AdminNotes"
FROM (
    SELECT c.id, c.category, c.created_at, c.description, c.instructor_id, c.level, c.price, c.status, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
ORDER BY c0.created_at DESC
2025-09-25 11:33:39.115 +08:00 [INF] Admin API returning course 35 'Test' with status: Draft (raw value: 0)
2025-09-25 11:33:39.117 +08:00 [INF] Admin API returning course 34 'SprintCourse' with status: Active (raw value: 2)
2025-09-25 11:33:39.119 +08:00 [INF] Admin API returning course 33 'MarathonCourse' with status: Active (raw value: 2)
2025-09-25 11:33:39.120 +08:00 [INF] Admin API returning course 28 'Social Media Marketing Mastery' with status: Active (raw value: 2)
2025-09-25 11:33:39.122 +08:00 [INF] Admin API returning course 25 'React Native Development' with status: Active (raw value: 2)
2025-09-25 11:33:39.123 +08:00 [INF] Admin API returning course 21 'Computer Vision Fundamentals' with status: Active (raw value: 2)
2025-09-25 11:33:39.125 +08:00 [INF] Admin API returning course 27 'SEO & Content Marketing Strategy' with status: Active (raw value: 2)
2025-09-25 11:33:39.129 +08:00 [INF] Admin API returning course 24 'Flutter & Dart Complete Guide' with status: Active (raw value: 2)
2025-09-25 11:33:39.131 +08:00 [INF] Admin API returning course 20 'Full Stack JavaScript Developer Path' with status: Active (raw value: 2)
2025-09-25 11:33:39.133 +08:00 [INF] Admin API returning course 29 'Draft Course: Machine Learning Fundamentals' with status: Draft (raw value: 0)
2025-09-25 11:33:39.135 +08:00 [INF] Admin API returning course 26 'Digital Marketing Fundamentals' with status: Active (raw value: 2)
2025-09-25 11:33:39.136 +08:00 [INF] Admin API returning course 23 'Android Development Masterclass' with status: Active (raw value: 2)
2025-09-25 11:33:39.138 +08:00 [INF] Admin API returning course 19 'Machine Learning with Python & TensorFlow' with status: Active (raw value: 2)
2025-09-25 11:33:39.140 +08:00 [INF] Admin API returning course 22 'iOS Development with Swift' with status: Active (raw value: 2)
2025-09-25 11:33:39.142 +08:00 [INF] Admin API returning course 18 'Advanced React & Redux Masterclass' with status: Active (raw value: 2)
2025-09-25 11:33:39.147 +08:00 [INF] Admin API returning course 17 'Complete Web Development Bootcamp 2025' with status: Active (raw value: 2)
2025-09-25 11:33:39.149 +08:00 [INF] Admin API returning course 31 'Inactive Course: Legacy PHP Development' with status: Inactive (raw value: 3)
2025-09-25 11:33:39.150 +08:00 [INF] Admin API returning course 30 'Draft Course: Blockchain Development' with status: Draft (raw value: 0)
2025-09-25 11:33:39.152 +08:00 [INF] Admin API returning course 32 'Inactive Course: Flash Game Development' with status: Inactive (raw value: 3)
2025-09-25 11:33:39.159 +08:00 [INF] First course serialized: {
  "Id": 35,
  "Title": "Test",
  "Description": "Test",
  "InstructorId": "bee889a2-efca-471d-807c-a7674a945612",
  "InstructorName": "Dr. Sarah Johnson",
  "Price": 10,
  "Category": "Test",
  "Level": "Beginner",
  "Status": "Draft",
  "StudentsCount": 0,
  "AverageRating": 0,
  "TotalRevenue": 0.0,
  "CreatedAt": "2025-09-24T01:02:07.311815Z",
  "UpdatedAt": "2025-09-24T01:02:07.311881Z",
  "NeedsReview": true,
  "AdminNotes": null
}
2025-09-25 11:33:39.166 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.AdminCourseManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:33:39.169 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api) in 66.4069ms
2025-09-25 11:33:39.173 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api)'
2025-09-25 11:33:39.176 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/courses - 200 null application/json; charset=utf-8 123.0602ms
2025-09-25 11:33:47.333 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses/35 - null null
2025-09-25 11:33:47.339 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:47.340 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses/35 - 204 null null 6.9206ms
2025-09-25 11:33:47.349 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5296/api/admin/courses/35 - application/json 117
2025-09-25 11:33:47.355 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:47.359 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:47.362 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.UpdateCourse (CeceLearningPortal.Api)'
2025-09-25 11:33:47.364 +08:00 [INF] Route matched with {action = "UpdateCourse", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCourse(Int32, CeceLearningPortal.Api.DTOs.UpdateCourseDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:33:47.372 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.id = @__p_0
LIMIT 1
2025-09-25 11:33:47.379 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE courses SET price = @p0, updated_at = @p1
WHERE id = @p2;
2025-09-25 11:33:47.384 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-09-25 11:33:47.387 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.UpdateCourse (CeceLearningPortal.Api) in 19.7303ms
2025-09-25 11:33:47.390 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.UpdateCourse (CeceLearningPortal.Api)'
2025-09-25 11:33:47.392 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5296/api/admin/courses/35 - 200 null application/json; charset=utf-8 43.1579ms
2025-09-25 11:33:47.400 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses - null null
2025-09-25 11:33:47.405 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:47.407 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/courses - 204 null null 6.9831ms
2025-09-25 11:33:47.413 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/courses - application/json null
2025-09-25 11:33:47.418 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:47.424 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:47.443 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api)'
2025-09-25 11:33:47.449 +08:00 [INF] Route matched with {action = "GetCoursesForManagement", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCoursesForManagement(CeceLearningPortal.Api.DTOs.CourseManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:33:47.460 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id AS "Id", c0.title AS "Title", c0.description AS "Description", c0.instructor_id AS "InstructorId", a."FullName" AS "InstructorName", c0.price AS "Price", c0.category AS "Category", c0.level AS "Level", c0.status AS "Status", (
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c0.id = e.course_id) AS "StudentsCount", CASE
    WHEN EXISTS (
        SELECT 1
        FROM course_reviews AS c1
        WHERE c0.id = c1.course_id) THEN (
        SELECT avg(c2.rating::double precision)
        FROM course_reviews AS c2
        WHERE c0.id = c2.course_id)
    ELSE 0.0
END AS "AverageRating", (
    SELECT count(*)::int
    FROM enrollments AS e0
    WHERE c0.id = e0.course_id)::numeric * c0.price * 0.8 AS "TotalRevenue", c0.created_at AS "CreatedAt", c0.updated_at AS "UpdatedAt", c0.status = 'Draft' AS "NeedsReview", NULL AS "AdminNotes"
FROM (
    SELECT c.id, c.category, c.created_at, c.description, c.instructor_id, c.level, c.price, c.status, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
ORDER BY c0.created_at DESC
2025-09-25 11:33:47.465 +08:00 [INF] Admin API returning course 35 'Test' with status: Draft (raw value: 0)
2025-09-25 11:33:47.466 +08:00 [INF] Admin API returning course 34 'SprintCourse' with status: Active (raw value: 2)
2025-09-25 11:33:47.468 +08:00 [INF] Admin API returning course 33 'MarathonCourse' with status: Active (raw value: 2)
2025-09-25 11:33:47.470 +08:00 [INF] Admin API returning course 28 'Social Media Marketing Mastery' with status: Active (raw value: 2)
2025-09-25 11:33:47.472 +08:00 [INF] Admin API returning course 25 'React Native Development' with status: Active (raw value: 2)
2025-09-25 11:33:47.474 +08:00 [INF] Admin API returning course 21 'Computer Vision Fundamentals' with status: Active (raw value: 2)
2025-09-25 11:33:47.475 +08:00 [INF] Admin API returning course 27 'SEO & Content Marketing Strategy' with status: Active (raw value: 2)
2025-09-25 11:33:47.477 +08:00 [INF] Admin API returning course 24 'Flutter & Dart Complete Guide' with status: Active (raw value: 2)
2025-09-25 11:33:47.478 +08:00 [INF] Admin API returning course 20 'Full Stack JavaScript Developer Path' with status: Active (raw value: 2)
2025-09-25 11:33:47.479 +08:00 [INF] Admin API returning course 29 'Draft Course: Machine Learning Fundamentals' with status: Draft (raw value: 0)
2025-09-25 11:33:47.481 +08:00 [INF] Admin API returning course 26 'Digital Marketing Fundamentals' with status: Active (raw value: 2)
2025-09-25 11:33:47.482 +08:00 [INF] Admin API returning course 23 'Android Development Masterclass' with status: Active (raw value: 2)
2025-09-25 11:33:47.483 +08:00 [INF] Admin API returning course 19 'Machine Learning with Python & TensorFlow' with status: Active (raw value: 2)
2025-09-25 11:33:47.485 +08:00 [INF] Admin API returning course 22 'iOS Development with Swift' with status: Active (raw value: 2)
2025-09-25 11:33:47.488 +08:00 [INF] Admin API returning course 18 'Advanced React & Redux Masterclass' with status: Active (raw value: 2)
2025-09-25 11:33:47.490 +08:00 [INF] Admin API returning course 17 'Complete Web Development Bootcamp 2025' with status: Active (raw value: 2)
2025-09-25 11:33:47.491 +08:00 [INF] Admin API returning course 31 'Inactive Course: Legacy PHP Development' with status: Inactive (raw value: 3)
2025-09-25 11:33:47.493 +08:00 [INF] Admin API returning course 30 'Draft Course: Blockchain Development' with status: Draft (raw value: 0)
2025-09-25 11:33:47.494 +08:00 [INF] Admin API returning course 32 'Inactive Course: Flash Game Development' with status: Inactive (raw value: 3)
2025-09-25 11:33:47.499 +08:00 [INF] First course serialized: {
  "Id": 35,
  "Title": "Test",
  "Description": "Test",
  "InstructorId": "bee889a2-efca-471d-807c-a7674a945612",
  "InstructorName": "Dr. Sarah Johnson",
  "Price": 10000,
  "Category": "Test",
  "Level": "Beginner",
  "Status": "Draft",
  "StudentsCount": 0,
  "AverageRating": 0,
  "TotalRevenue": 0.0,
  "CreatedAt": "2025-09-24T01:02:07.311815Z",
  "UpdatedAt": "2025-09-25T03:33:47.376607Z",
  "NeedsReview": true,
  "AdminNotes": null
}
2025-09-25 11:33:47.501 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.AdminCourseManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:33:47.505 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api) in 48.7086ms
2025-09-25 11:33:47.510 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCoursesForManagement (CeceLearningPortal.Api)'
2025-09-25 11:33:47.512 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/courses - 200 null application/json; charset=utf-8 98.4421ms
2025-09-25 11:33:50.858 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 11:33:50.867 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:50.872 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 13.8158ms
2025-09-25 11:33:50.884 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 11:33:50.892 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:50.898 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:50.907 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:33:50.911 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 11:33:50.926 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 11:33:50.941 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 11:33:50.956 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 11:33:50.975 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 11:33:50.991 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 11:33:51.003 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 11:33:51.011 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 11:33:51.024 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 11:33:51.032 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 11:33:51.039 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 11:33:51.045 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 11:33:51.049 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 125.3341ms
2025-09-25 11:33:51.054 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 11:33:51.056 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 172.3499ms
2025-09-25 11:33:51.069 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - null null
2025-09-25 11:33:51.076 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:51.079 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - 204 null null 9.3793ms
2025-09-25 11:33:51.091 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-25 11:33:51.096 +08:00 [INF] CORS policy execution successful.
2025-09-25 11:33:51.101 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 11:33:51.107 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:33:51.109 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 11:33:51.117 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-25 11:33:51.122 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 11:33:51.126 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 13.6356ms
2025-09-25 11:33:51.129 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 11:33:51.131 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 40.3635ms
2025-09-25 12:00:20.584 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 12:00:20.816 +08:00 [INF] CORS policy execution successful.
2025-09-25 12:00:20.885 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 301.0584ms
2025-09-25 12:00:21.002 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 12:00:21.018 +08:00 [INF] CORS policy execution successful.
2025-09-25 12:00:21.375 +08:00 [INF] Executed DbCommand (132ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 12:00:21.415 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 12:00:21.444 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 12:00:21.513 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 12:00:21.630 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 12:00:21.678 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 12:00:21.702 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 12:00:21.726 +08:00 [INF] Executed DbCommand (16ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 12:00:21.769 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 12:00:21.804 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 12:00:21.855 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 12:00:21.878 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 12:00:21.891 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 12:00:21.896 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 12:00:21.900 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 398.8734ms
2025-09-25 12:00:21.904 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 12:00:21.906 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 903.51ms
2025-09-25 12:00:21.939 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - null null
2025-09-25 12:00:21.944 +08:00 [INF] CORS policy execution successful.
2025-09-25 12:00:21.947 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - 204 null null 7.8005ms
2025-09-25 12:00:21.957 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-25 12:00:21.961 +08:00 [INF] CORS policy execution successful.
2025-09-25 12:00:21.965 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 12:00:21.969 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 12:00:21.971 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 12:00:21.979 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-25 12:00:21.983 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 12:00:21.987 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 12.9969ms
2025-09-25 12:00:21.990 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 12:00:21.993 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 35.836ms
2025-09-25 13:29:49.814 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - null null
2025-09-25 13:29:50.128 +08:00 [INF] CORS policy execution successful.
2025-09-25 13:29:50.131 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/analytics/platform - 204 null null 317.6114ms
2025-09-25 13:29:50.195 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 13:29:50.407 +08:00 [INF] CORS policy execution successful.
2025-09-25 13:29:50.442 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/25/2025 4:33:35 AM', Current time (UTC): '9/25/2025 5:29:50 AM'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2025-09-25 13:29:50.517 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/25/2025 4:33:35 AM', Current time (UTC): '9/25/2025 5:29:50 AM'.
2025-09-25 13:29:50.543 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '9/25/2025 4:33:35 AM', Current time (UTC): '9/25/2025 5:29:50 AM'.
2025-09-25 13:29:50.698 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 13:29:50.751 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-09-25 13:29:50.764 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-25 13:29:50.770 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 401 0 null 575.7698ms
2025-09-25 13:29:50.780 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - null null
2025-09-25 13:29:50.787 +08:00 [INF] CORS policy execution successful.
2025-09-25 13:29:50.788 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/auth/refresh - 204 null null 8.3859ms
2025-09-25 13:29:50.794 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5296/api/auth/refresh - application/json 535
2025-09-25 13:29:50.798 +08:00 [INF] CORS policy execution successful.
2025-09-25 13:29:50.803 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 13:29:50.805 +08:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(CeceLearningPortal.Api.DTOs.RefreshTokenDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-09-25 13:29:50.824 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-09-25 13:29:50.860 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?', @p1='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET replaced_by_token = @p0, revoked_at = @p1
WHERE id = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-09-25 13:29:50.898 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-09-25 13:29:50.908 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api) in 99.725ms
2025-09-25 13:29:50.913 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.RefreshToken (CeceLearningPortal.Api)'
2025-09-25 13:29:50.926 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5296/api/auth/refresh - 200 null application/json; charset=utf-8 132.6969ms
2025-09-25 13:29:51.157 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 13:29:51.257 +08:00 [INF] CORS policy execution successful.
2025-09-25 13:29:51.275 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 13:29:51.295 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 13:29:51.307 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 13:29:51.330 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 13:29:51.346 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 13:29:51.384 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 13:29:51.441 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 13:29:51.462 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 13:29:51.473 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 13:29:51.484 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 13:29:51.493 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 13:29:51.508 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 13:29:51.517 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 13:29:51.524 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 13:29:51.534 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 206.2653ms
2025-09-25 13:29:51.540 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 13:29:51.548 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 390.5512ms
2025-09-25 13:29:51.562 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - null null
2025-09-25 13:29:51.570 +08:00 [INF] CORS policy execution successful.
2025-09-25 13:29:51.575 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5296/api/admin/course-completions - 204 null null 12.6572ms
2025-09-25 13:29:51.593 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-25 13:29:51.604 +08:00 [INF] CORS policy execution successful.
2025-09-25 13:29:51.609 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 13:29:51.613 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 13:29:51.616 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 13:29:51.626 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-25 13:29:51.634 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 13:29:51.638 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 18.3255ms
2025-09-25 13:29:51.643 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 13:29:51.645 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 51.9157ms
2025-09-25 13:29:53.542 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/analytics/platform - application/json null
2025-09-25 13:29:53.643 +08:00 [INF] CORS policy execution successful.
2025-09-25 13:29:53.653 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 13:29:53.660 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 13:29:53.671 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-09-25 13:29:53.705 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-09-25 13:29:53.718 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-09-25 13:29:53.727 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-09-25 13:29:53.740 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-09-25 13:29:53.754 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-09-25 13:29:53.772 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-09-25 13:29:53.781 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-09-25 13:29:53.791 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-09-25 13:29:53.800 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-09-25 13:29:53.810 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-09-25 13:29:53.824 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType22`6[[<>f__AnonymousType23`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-25 13:29:53.832 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 132.7137ms
2025-09-25 13:29:53.835 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-09-25 13:29:53.838 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/analytics/platform - 200 null application/json; charset=utf-8 295.8734ms
2025-09-25 13:29:53.858 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - application/json null
2025-09-25 13:29:53.876 +08:00 [INF] CORS policy execution successful.
2025-09-25 13:29:53.884 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-09-25 13:29:53.887 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 13:29:53.889 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-09-25 13:29:53.896 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-09-25 13:29:53.902 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-25 13:29:53.904 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 12.1986ms
2025-09-25 13:29:53.908 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-09-25 13:29:53.910 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5296/api/admin/course-completions - 200 null application/json; charset=utf-8 52.1313ms
