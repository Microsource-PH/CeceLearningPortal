2025-07-28 14:19:06.565 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-28 14:19:06.824 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-07-28 14:19:06.830 +08:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-07-28 14:19:06.831 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-07-28 14:19:06.833 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-28 14:19:06.836 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-07-28 14:19:06.856 +08:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-28 14:19:06.865 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-28 14:19:06.950 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-07-28 14:19:06.957 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-07-28 14:19:06.960 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-28 14:19:06.961 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-07-28 14:19:07.123 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1
2025-07-28 14:19:07.145 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1
2025-07-28 14:19:07.147 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1
2025-07-28 14:19:07.159 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.218 +08:00 [INF] Creating key {722ff43e-47c2-4271-9738-fe7695281cb5} with creation date 2025-07-28 06:19:07Z, activation date 2025-07-28 06:19:07Z, and expiration date 2025-10-26 06:19:07Z.
2025-07-28 14:19:07.228 +08:00 [INF] Writing data to file 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys\key-722ff43e-47c2-4271-9738-fe7695281cb5.xml'.
2025-07-28 14:19:07.289 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.292 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.350 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 14:19:07.356 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.358 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.361 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 14:19:07.393 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Name"
FROM "AspNetUserRoles" AS a
INNER JOIN "AspNetRoles" AS a0 ON a."RoleId" = a0."Id"
WHERE a."UserId" = @__userId_0
2025-07-28 14:19:07.400 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.412 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 14:19:07.420 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.423 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.425 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.434 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "AspNetUserRoles"
WHERE "RoleId" = @p0 AND "UserId" = @p1;
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 14:19:07.438 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.440 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 14:19:07.443 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.449 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.451 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.455 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 14:19:07.457 +08:00 [INF] Updated user: admin@example.com
2025-07-28 14:19:07.458 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.505 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.507 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.512 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 14:19:07.514 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.515 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.517 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 14:19:07.520 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Name"
FROM "AspNetUserRoles" AS a
INNER JOIN "AspNetRoles" AS a0 ON a."RoleId" = a0."Id"
WHERE a."UserId" = @__userId_0
2025-07-28 14:19:07.521 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.523 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 14:19:07.524 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.525 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.527 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.530 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "AspNetUserRoles"
WHERE "RoleId" = @p0 AND "UserId" = @p1;
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 14:19:07.532 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.534 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 14:19:07.535 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.537 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.539 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.541 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 14:19:07.543 +08:00 [INF] Updated user: instructor@example.com
2025-07-28 14:19:07.544 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.591 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.593 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.596 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 14:19:07.598 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.600 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.602 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 14:19:07.604 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Name"
FROM "AspNetUserRoles" AS a
INNER JOIN "AspNetRoles" AS a0 ON a."RoleId" = a0."Id"
WHERE a."UserId" = @__userId_0
2025-07-28 14:19:07.605 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.607 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 14:19:07.608 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.610 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.612 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.615 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "AspNetUserRoles"
WHERE "RoleId" = @p0 AND "UserId" = @p1;
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 14:19:07.617 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.619 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 14:19:07.621 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.622 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.624 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.626 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 14:19:07.628 +08:00 [INF] Updated user: student@example.com
2025-07-28 14:19:07.628 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.675 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.677 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.679 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 14:19:07.681 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.682 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.684 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 14:19:07.686 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Name"
FROM "AspNetUserRoles" AS a
INNER JOIN "AspNetRoles" AS a0 ON a."RoleId" = a0."Id"
WHERE a."UserId" = @__userId_0
2025-07-28 14:19:07.687 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.689 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 14:19:07.690 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.691 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.693 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.695 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "AspNetUserRoles"
WHERE "RoleId" = @p0 AND "UserId" = @p1;
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 14:19:07.697 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.698 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 14:19:07.700 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.701 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.703 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.705 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 14:19:07.707 +08:00 [INF] Updated user: michael.chen@example.com
2025-07-28 14:19:07.708 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.754 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.755 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.757 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 14:19:07.759 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.761 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.777 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 14:19:07.780 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Name"
FROM "AspNetUserRoles" AS a
INNER JOIN "AspNetRoles" AS a0 ON a."RoleId" = a0."Id"
WHERE a."UserId" = @__userId_0
2025-07-28 14:19:07.782 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.784 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 14:19:07.786 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.788 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.789 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.792 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "AspNetUserRoles"
WHERE "RoleId" = @p0 AND "UserId" = @p1;
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 14:19:07.794 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.795 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 14:19:07.797 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 14:19:07.798 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 14:19:07.800 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:07.803 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 14:19:07.804 +08:00 [INF] Updated user: emily.davis@example.com
2025-07-28 14:19:07.814 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "SubscriptionPlans" AS s)
2025-07-28 14:19:07.819 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Courses" AS c)
2025-07-28 14:19:07.827 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
2025-07-28 14:19:07.892 +08:00 [ERR] Failed executing DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Courses"
WHERE "Id" = @p0;
DELETE FROM "Courses"
WHERE "Id" = @p1;
DELETE FROM "Courses"
WHERE "Id" = @p2;
DELETE FROM "Courses"
WHERE "Id" = @p3;
DELETE FROM "Courses"
WHERE "Id" = @p4;
DELETE FROM "Courses"
WHERE "Id" = @p5;
DELETE FROM "Courses"
WHERE "Id" = @p6;
2025-07-28 14:19:07.908 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: update or delete on table "Courses" violates foreign key constraint "FK_Payments_Courses_CourseId" on table "Payments"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: update or delete on table "Courses" violates foreign key constraint "FK_Payments_Courses_CourseId" on table "Payments"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Payments
    ConstraintName: FK_Payments_Courses_CourseId
    File: ri_triggers.c
    Line: 2624
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: update or delete on table "Courses" violates foreign key constraint "FK_Payments_Courses_CourseId" on table "Payments"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: update or delete on table "Courses" violates foreign key constraint "FK_Payments_Courses_CourseId" on table "Payments"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Payments
    ConstraintName: FK_Payments_Courses_CourseId
    File: ri_triggers.c
    Line: 2624
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-07-28 14:19:07.917 +08:00 [ERR] An error occurred while seeding data
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: update or delete on table "Courses" violates foreign key constraint "FK_Payments_Courses_CourseId" on table "Payments"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: update or delete on table "Courses" violates foreign key constraint "FK_Payments_Courses_CourseId" on table "Payments"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Payments
    ConstraintName: FK_Payments_Courses_CourseId
    File: ri_triggers.c
    Line: 2624
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.DataSeederService.SeedCoursesAsync() in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\DataSeederService.cs:line 152
   at CeceLearningPortal.Api.Services.DataSeederService.SeedDataAsync() in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\DataSeederService.cs:line 44
2025-07-28 14:19:07.970 +08:00 [INF] Now listening on: http://localhost:5295
2025-07-28 14:19:07.971 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-28 14:19:07.972 +08:00 [INF] Hosting environment: Development
2025-07-28 14:19:07.973 +08:00 [INF] Content root path: D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-07-28 14:19:12.541 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-28 14:19:12.565 +08:00 [WRN] Failed to determine the https port for redirect.
2025-07-28 14:19:12.566 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:12.570 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 29.662ms
2025-07-28 14:19:12.574 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 61
2025-07-28 14:19:12.579 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:12.602 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 14:19:12.611 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 14:19:12.640 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:19:12.733 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-28 14:19:12.745 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-28 14:19:12.753 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 139.4792ms
2025-07-28 14:19:12.754 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 14:19:12.757 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 182.9228ms
2025-07-28 14:19:12.788 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - null null
2025-07-28 14:19:12.789 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:19:12.790 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:12.791 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:12.791 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - 204 null null 3.3622ms
2025-07-28 14:19:12.792 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.8866ms
2025-07-28 14:19:12.793 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:19:12.795 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:19:12.798 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:12.798 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:12.869 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:12.871 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:12.877 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:19:12.917 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:12.919 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 125.5584ms
2025-07-28 14:19:12.921 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:19:12.925 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-28 14:19:12.959 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:19:13.006 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:19:13.022 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 142.7926ms
2025-07-28 14:19:13.022 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:13.023 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 228.0198ms
2025-07-28 14:19:13.025 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:19:13.027 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:13.027 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 2.0947ms
2025-07-28 14:19:13.029 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:19:13.031 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:13.034 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:13.035 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 6.3036ms
2025-07-28 14:19:13.037 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:19:13.044 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:19:13.045 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:13.046 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.1785ms
2025-07-28 14:19:13.047 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:13.049 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:13.053 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:13.054 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:13.055 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:19:13.063 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:19:13.071 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:19:13.072 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 16.5836ms
2025-07-28 14:19:13.073 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:13.074 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 26.2906ms
2025-07-28 14:19:23.793 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:19:23.795 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:23.796 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.564ms
2025-07-28 14:19:23.798 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:19:23.799 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:23.802 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:23.804 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:23.804 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:19:23.810 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:19:23.816 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:19:23.817 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 11.0936ms
2025-07-28 14:19:23.817 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:23.818 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 20.1003ms
2025-07-28 14:19:23.820 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - null null
2025-07-28 14:19:23.821 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:23.821 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - 204 null null 1.8453ms
2025-07-28 14:19:23.823 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:19:23.824 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:23.827 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:23.828 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 5.1418ms
2025-07-28 14:19:23.830 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:19:23.834 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:19:23.835 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:23.836 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 2.0011ms
2025-07-28 14:19:23.838 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:19:23.839 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:23.841 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:23.842 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 4.5228ms
2025-07-28 14:19:23.844 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:19:23.847 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:19:23.849 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:23.849 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.9057ms
2025-07-28 14:19:23.851 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:23.852 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:23.854 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:23.856 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:23.856 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:19:23.861 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:19:23.866 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:19:23.867 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.9701ms
2025-07-28 14:19:23.868 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:23.869 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 17.724ms
2025-07-28 14:19:27.361 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:19:27.363 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:27.363 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.1062ms
2025-07-28 14:19:27.365 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:27.367 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:27.369 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:27.373 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:19:27.376 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:19:27.385 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-28 14:19:27.400 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:19:27.423 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:19:27.446 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:19:27.452 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:27.455 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:27.456 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:27.458 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:27.459 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:27.491 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:19:27.498 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:19:27.500 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:19:27.509 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 131.6346ms
2025-07-28 14:19:27.509 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:19:27.510 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 145.1539ms
2025-07-28 14:19:31.429 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:19:31.430 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:31.431 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 2.2152ms
2025-07-28 14:19:31.433 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:19:31.434 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:31.436 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:31.438 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 4.9922ms
2025-07-28 14:19:31.440 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:19:31.441 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:19:31.442 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:31.443 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.8256ms
2025-07-28 14:19:31.445 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:31.447 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:31.448 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:31.449 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:31.450 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:19:31.454 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:19:31.457 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:19:31.458 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.337ms
2025-07-28 14:19:31.459 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:31.460 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 14.5073ms
2025-07-28 14:19:31.462 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:31.463 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:31.465 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:31.466 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:31.466 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:19:31.470 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:19:31.474 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:19:31.475 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.3724ms
2025-07-28 14:19:31.475 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:31.476 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 14.3186ms
2025-07-28 14:19:31.478 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:31.479 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:31.481 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:31.483 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:19:31.484 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:19:31.486 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:19:31.490 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:19:31.491 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:19:31.493 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:31.494 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:31.496 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:31.497 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:31.498 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:31.500 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:19:31.502 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:19:31.503 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:19:31.504 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 19.7921ms
2025-07-28 14:19:31.505 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:19:31.506 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 27.8009ms
2025-07-28 14:19:34.042 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:19:34.043 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:34.044 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.9975ms
2025-07-28 14:19:34.046 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:34.047 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:34.049 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:34.051 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:19:34.051 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:19:34.054 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:19:34.058 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:19:34.060 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:19:34.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:34.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:34.065 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:34.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:34.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:34.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:19:34.071 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:19:34.072 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:19:34.073 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 20.9864ms
2025-07-28 14:19:34.074 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:19:34.075 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 29.4042ms
2025-07-28 14:19:35.541 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:19:35.542 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:35.545 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:35.546 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 5.1528ms
2025-07-28 14:19:35.548 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:19:35.550 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:35.552 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:35.553 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:35.555 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:35.555 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:19:35.559 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:19:35.563 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:19:35.564 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.0245ms
2025-07-28 14:19:35.565 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:35.565 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 14.9172ms
2025-07-28 14:19:35.567 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:35.568 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:35.569 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:35.571 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:35.571 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:19:35.575 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:19:35.579 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:19:35.580 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.4566ms
2025-07-28 14:19:35.580 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:35.581 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 14.1675ms
2025-07-28 14:19:35.583 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:35.584 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:35.585 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:35.587 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:19:35.587 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:19:35.590 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:19:35.593 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:19:35.595 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:19:35.597 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:35.598 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:35.599 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:35.600 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:35.602 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:35.604 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:19:35.606 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:19:35.607 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:19:35.608 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 20.1203ms
2025-07-28 14:19:35.609 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:19:35.609 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 26.8411ms
2025-07-28 14:19:41.239 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:19:41.240 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:41.241 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.7451ms
2025-07-28 14:19:41.242 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:41.244 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:41.245 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:41.247 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:19:41.247 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:19:41.250 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:19:41.254 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:19:41.255 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:19:41.257 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:41.258 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:41.259 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:41.261 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:41.262 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:41.264 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:19:41.266 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:19:41.267 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:19:41.268 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 20.1249ms
2025-07-28 14:19:41.269 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:19:41.270 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 27.3825ms
2025-07-28 14:19:42.775 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:19:42.776 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:42.776 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.7175ms
2025-07-28 14:19:42.778 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:19:42.779 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:42.781 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:42.782 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.9572ms
2025-07-28 14:19:42.784 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:19:42.785 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:19:42.786 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:42.786 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.6617ms
2025-07-28 14:19:42.788 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:42.789 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:42.790 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:42.791 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:42.792 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:19:42.796 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:19:42.799 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:19:42.800 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9919ms
2025-07-28 14:19:42.801 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:42.801 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.3022ms
2025-07-28 14:19:42.803 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:42.804 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:42.806 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:42.807 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:42.807 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:19:42.811 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:19:42.815 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:19:42.815 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.1563ms
2025-07-28 14:19:42.816 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:19:42.817 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.8661ms
2025-07-28 14:19:42.818 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:42.820 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:42.821 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:42.822 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:19:42.823 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:19:42.825 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:19:42.828 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:19:42.830 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:19:42.832 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:42.833 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:42.834 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:42.836 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:42.837 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:42.838 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:19:42.840 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:19:42.841 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:19:42.843 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 19.1911ms
2025-07-28 14:19:42.843 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:19:42.844 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 25.5716ms
2025-07-28 14:19:50.426 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:19:50.428 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:50.428 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.8601ms
2025-07-28 14:19:50.430 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:19:50.431 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:19:50.432 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:19:50.434 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:19:50.434 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:19:50.437 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:19:50.440 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:19:50.442 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:19:50.444 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:50.446 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:50.448 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:50.449 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:50.450 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:19:50.452 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:19:50.453 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:19:50.455 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:19:50.456 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 20.615ms
2025-07-28 14:19:50.457 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:19:50.457 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 27.5364ms
2025-07-28 14:21:13.157 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:21:13.159 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:13.160 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 2.6799ms
2025-07-28 14:21:13.162 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:21:13.163 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:13.165 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:13.166 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 4.2194ms
2025-07-28 14:21:13.167 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:21:13.168 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:21:13.169 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:13.170 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.4837ms
2025-07-28 14:21:13.171 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:21:13.172 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:13.174 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:13.175 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:21:13.175 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:21:13.178 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:21:13.182 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:21:13.183 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.1995ms
2025-07-28 14:21:13.184 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:21:13.185 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.4119ms
2025-07-28 14:21:13.187 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:21:13.188 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:13.189 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:13.190 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:21:13.191 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:21:13.194 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:21:13.198 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:21:13.199 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9946ms
2025-07-28 14:21:13.199 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:21:13.200 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.471ms
2025-07-28 14:21:13.205 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:21:13.207 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:13.207 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.5971ms
2025-07-28 14:21:13.208 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:21:13.210 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:13.211 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:13.212 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:21:13.213 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:21:13.215 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:21:13.218 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:21:13.220 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:21:13.221 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:13.223 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:13.224 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:13.225 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:13.226 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:13.228 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:21:13.230 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:21:13.231 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:21:13.232 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.3543ms
2025-07-28 14:21:13.233 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:21:13.233 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.9397ms
2025-07-28 14:21:19.620 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:21:19.621 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:19.622 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.6782ms
2025-07-28 14:21:19.624 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:21:19.625 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:19.626 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:19.627 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:21:19.628 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:21:19.631 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:21:19.635 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:21:19.636 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:21:19.638 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:19.639 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:19.641 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:19.642 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:19.643 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:19.645 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:21:19.647 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:21:19.648 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:21:19.649 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 20.1091ms
2025-07-28 14:21:19.650 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:21:19.650 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 26.7557ms
2025-07-28 14:21:20.173 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:21:20.174 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:20.174 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.8031ms
2025-07-28 14:21:20.176 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:21:20.177 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:20.179 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:20.180 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 4.3206ms
2025-07-28 14:21:20.182 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:21:20.183 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:21:20.184 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:20.185 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.5412ms
2025-07-28 14:21:20.186 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:21:20.187 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:20.189 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:20.190 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:21:20.190 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:21:20.194 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:21:20.197 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:21:20.199 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.3341ms
2025-07-28 14:21:20.199 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:21:20.200 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.6295ms
2025-07-28 14:21:20.202 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:21:20.203 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:20.204 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:20.206 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:21:20.206 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:21:20.209 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:21:20.213 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:21:20.214 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.8718ms
2025-07-28 14:21:20.214 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:21:20.215 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.3057ms
2025-07-28 14:21:20.217 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:21:20.218 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:20.220 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:20.221 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:21:20.221 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:21:20.224 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:21:20.227 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:21:20.229 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:21:20.231 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:20.232 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:20.234 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:20.235 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:20.237 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:20.239 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:21:20.242 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:21:20.243 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:21:20.244 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 22.0477ms
2025-07-28 14:21:20.245 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:21:20.245 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 28.728ms
2025-07-28 14:21:21.365 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:21:21.367 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:21.369 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:21.370 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:21:21.370 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:21:21.373 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:21:21.376 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:21:21.378 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:21:21.380 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:21.381 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:21.383 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:21.384 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:21.385 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:21.387 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:21:21.388 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:21:21.389 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:21:21.391 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 19.0869ms
2025-07-28 14:21:21.391 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:21:21.392 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 26.9633ms
2025-07-28 14:21:34.265 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:21:34.266 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:34.267 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.0965ms
2025-07-28 14:21:34.269 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:21:34.270 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:34.272 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:34.273 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:21:34.274 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:21:34.276 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:21:34.280 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:21:34.282 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:21:34.283 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:34.285 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:34.286 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:34.287 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:34.288 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:34.290 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:21:34.292 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:21:34.293 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:21:34.294 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 19.3547ms
2025-07-28 14:21:34.295 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:21:34.296 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 26.918ms
2025-07-28 14:21:40.954 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:21:40.955 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:40.956 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.8653ms
2025-07-28 14:21:40.958 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:21:40.959 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:40.960 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:40.961 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.3978ms
2025-07-28 14:21:40.963 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:21:40.964 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:21:40.965 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:40.966 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.721ms
2025-07-28 14:21:40.968 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:21:40.969 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:40.970 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:40.971 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:21:40.972 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:21:40.975 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:21:40.979 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:21:40.980 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.2177ms
2025-07-28 14:21:40.981 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:21:40.981 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.7888ms
2025-07-28 14:21:40.983 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:21:40.985 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:40.986 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:40.987 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:21:40.988 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:21:40.991 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:21:40.994 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:21:40.995 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.3355ms
2025-07-28 14:21:40.996 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:21:40.996 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.034ms
2025-07-28 14:21:40.998 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:21:40.999 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:41.000 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.4405ms
2025-07-28 14:21:41.001 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:21:41.003 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:21:41.004 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:21:41.005 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:21:41.005 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:21:41.008 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:21:41.011 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:21:41.013 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:21:41.015 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:41.016 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:41.017 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:41.019 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:41.020 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:21:41.022 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:21:41.023 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:21:41.025 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:21:41.026 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 19.1826ms
2025-07-28 14:21:41.026 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:21:41.027 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 25.2645ms
2025-07-28 14:22:52.901 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:22:52.902 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:22:52.903 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.9008ms
2025-07-28 14:22:52.904 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:22:52.905 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:22:52.907 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:22:52.908 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:22:52.908 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:22:52.912 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:22:52.916 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:22:52.917 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.3402ms
2025-07-28 14:22:52.917 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:22:52.918 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.6314ms
2025-07-28 14:22:52.920 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - null null
2025-07-28 14:22:52.921 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:22:52.921 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - 204 null null 1.5748ms
2025-07-28 14:22:52.923 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:22:52.924 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:22:52.925 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:22:52.926 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 3.6388ms
2025-07-28 14:22:52.928 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:22:52.929 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:22:52.929 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:22:52.931 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:22:52.932 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:22:52.932 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 3.2635ms
2025-07-28 14:22:52.932 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 3.3168ms
2025-07-28 14:22:52.934 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:22:52.936 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:22:52.937 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:22:52.938 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:22:52.939 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:22:52.939 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:22:52.940 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:22:52.941 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:22:52.941 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:22:52.944 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:22:52.944 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:22:52.948 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:22:52.950 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:22:52.951 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:22:52.951 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:22:52.952 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:22:52.955 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:22:52.956 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:22:52.957 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:22:52.958 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:22:52.960 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:22:52.961 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:22:52.963 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:22:52.964 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 21.3149ms
2025-07-28 14:22:52.965 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:22:52.965 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:22:52.965 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 31.0433ms
2025-07-28 14:22:52.976 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:22:53.008 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:22:53.011 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:22:53.015 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:22:53.017 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:22:53.018 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:22:53.020 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:22:53.021 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:22:53.022 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:22:53.024 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:22:53.026 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:22:53.027 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:22:53.029 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:22:53.031 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:22:53.032 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:22:53.033 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:22:53.035 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:22:53.036 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:22:53.038 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:22:53.039 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:22:53.040 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:22:53.042 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:22:53.043 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:22:53.045 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:22:53.046 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:22:53.048 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:22:53.049 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:22:53.050 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:22:53.051 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:22:53.053 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:22:53.054 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:22:53.057 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 112.2113ms
2025-07-28 14:22:53.058 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:22:53.058 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 122.4897ms
2025-07-28 14:24:27.946 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:24:27.947 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:24:27.947 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.7754ms
2025-07-28 14:24:27.949 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:24:27.950 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:24:27.995 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:24:27.996 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:24:27.997 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:24:28.005 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:24:28.009 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:24:28.010 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 11.2333ms
2025-07-28 14:24:28.010 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:24:28.011 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 61.7772ms
2025-07-28 14:24:28.013 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - null null
2025-07-28 14:24:28.014 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:24:28.015 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - 204 null null 2.0059ms
2025-07-28 14:24:28.016 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:24:28.017 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:24:28.019 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:24:28.020 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 3.8262ms
2025-07-28 14:24:28.021 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:24:28.024 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:24:28.024 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:24:28.025 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:24:28.026 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:24:28.026 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.5561ms
2025-07-28 14:24:28.027 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.3192ms
2025-07-28 14:24:28.028 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:24:28.029 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:24:28.031 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:24:28.032 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:24:28.034 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:24:28.035 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:24:28.036 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:24:28.038 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:24:28.040 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:24:28.043 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:24:28.045 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:24:28.048 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:24:28.050 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:24:28.051 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:24:28.053 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:24:28.055 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:24:28.057 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:24:28.058 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:24:28.059 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:24:28.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:24:28.063 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:24:28.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:24:28.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:24:28.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:24:28.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:24:28.070 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:24:28.072 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:24:28.074 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:24:28.075 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:24:28.077 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:24:28.078 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:24:28.078 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:24:28.079 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:24:28.080 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:24:28.082 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:24:28.083 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:24:28.084 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:24:28.085 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:24:28.087 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:24:28.088 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:24:28.089 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:24:28.090 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:24:28.090 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:24:28.091 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:24:28.092 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:24:28.093 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:24:28.094 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:24:28.095 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:24:28.096 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:24:28.097 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:24:28.098 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:24:28.099 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:24:28.100 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 63.8954ms
2025-07-28 14:24:28.101 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:24:28.101 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:24:28.102 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 73.5013ms
2025-07-28 14:24:28.103 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:24:28.106 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:24:28.107 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 23.967ms
2025-07-28 14:24:28.107 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:24:28.108 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 78.2067ms
2025-07-28 14:25:41.156 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:25:41.157 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:41.157 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.689ms
2025-07-28 14:25:41.159 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:25:41.160 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:41.161 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:25:41.162 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:25:41.163 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:25:41.167 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:25:41.170 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:25:41.171 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.3765ms
2025-07-28 14:25:41.172 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:25:41.173 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.9399ms
2025-07-28 14:25:41.176 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - null null
2025-07-28 14:25:41.177 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:41.178 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - 204 null null 1.6185ms
2025-07-28 14:25:41.179 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:25:41.180 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:41.181 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:25:41.183 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 3.8379ms
2025-07-28 14:25:41.184 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:25:41.185 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:25:41.186 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:25:41.187 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:41.188 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:41.188 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 3.2022ms
2025-07-28 14:25:41.188 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.8457ms
2025-07-28 14:25:41.190 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:25:41.191 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:25:41.192 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:41.194 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:41.195 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:25:41.195 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:25:41.196 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:25:41.197 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:25:41.197 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:25:41.198 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:25:41.200 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:25:41.202 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:25:41.203 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:25:41.204 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:25:41.206 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:25:41.206 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:25:41.208 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:25:41.209 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:41.210 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:25:41.211 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:25:41.212 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:25:41.213 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:25:41.214 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:25:41.215 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:25:41.215 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:25:41.217 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:25:41.217 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:25:41.218 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:41.220 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:25:41.220 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:41.222 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:25:41.222 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:25:41.223 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:25:41.224 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:25:41.225 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 25.1667ms
2025-07-28 14:25:41.227 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:25:41.227 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:25:41.227 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 37.3508ms
2025-07-28 14:25:41.229 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:25:41.231 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:41.232 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:41.234 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:25:41.235 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:25:41.237 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:25:41.239 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:25:41.240 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:41.241 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:41.242 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:41.244 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:25:41.245 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:25:41.247 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:25:41.248 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:25:41.249 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:41.251 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:41.252 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:41.253 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:25:41.254 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:25:41.255 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:25:41.256 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 57.3632ms
2025-07-28 14:25:41.257 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:25:41.257 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 66.294ms
2025-07-28 14:25:49.563 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:25:49.564 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:49.564 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.5616ms
2025-07-28 14:25:49.566 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:25:49.567 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:49.568 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:25:49.570 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:25:49.571 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:25:49.576 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:25:49.580 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:25:49.581 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.4435ms
2025-07-28 14:25:49.581 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:25:49.582 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 16.0684ms
2025-07-28 14:25:49.583 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - null null
2025-07-28 14:25:49.584 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:49.585 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - 204 null null 1.5887ms
2025-07-28 14:25:49.586 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:25:49.587 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:49.589 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:25:49.590 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 3.6566ms
2025-07-28 14:25:49.591 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:25:49.591 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:25:49.592 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:25:49.593 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:49.594 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:49.594 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 3.1034ms
2025-07-28 14:25:49.595 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.8658ms
2025-07-28 14:25:49.596 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:25:49.598 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:25:49.599 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:49.600 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:25:49.601 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:25:49.601 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:25:49.602 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:25:49.603 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:25:49.604 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:25:49.604 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:25:49.607 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:25:49.607 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:25:49.608 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:25:49.611 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:25:49.611 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:25:49.612 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:25:49.613 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:25:49.614 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:25:49.615 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:49.616 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:25:49.618 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:25:49.618 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:25:49.620 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:25:49.621 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:25:49.622 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:25:49.622 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:25:49.624 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:25:49.625 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:25:49.626 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:49.627 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:25:49.628 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:49.628 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:25:49.630 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:25:49.630 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 25.159ms
2025-07-28 14:25:49.631 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:25:49.632 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:25:49.633 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:25:49.633 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 36.9642ms
2025-07-28 14:25:49.635 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:25:49.637 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:49.639 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:49.640 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:25:49.641 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:25:49.643 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:25:49.644 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:25:49.646 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:49.647 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:49.648 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:49.649 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:25:49.651 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:25:49.653 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:25:49.654 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:25:49.655 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:49.657 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:49.658 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:25:49.659 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:25:49.660 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:25:49.661 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:25:49.662 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 56.141ms
2025-07-28 14:25:49.663 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:25:49.663 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 65.7699ms
2025-07-28 14:26:52.682 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:26:52.683 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:26:52.684 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.136ms
2025-07-28 14:26:52.687 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:26:52.688 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:26:52.690 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:26:52.691 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:26:52.691 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:26:52.695 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:26:52.699 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:26:52.701 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.6221ms
2025-07-28 14:26:52.702 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:26:52.703 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 16.533ms
2025-07-28 14:26:52.727 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:26:52.728 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:26:52.730 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:26:52.731 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:26:52.732 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:26:52.735 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:26:52.737 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - null null
2025-07-28 14:26:52.739 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:26:52.739 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - 204 null null 2.3635ms
2025-07-28 14:26:52.739 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:26:52.741 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:26:52.741 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.7469ms
2025-07-28 14:26:52.743 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:26:52.743 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:26:52.744 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 16.9314ms
2025-07-28 14:26:52.745 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:26:52.747 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 6.1317ms
2025-07-28 14:26:52.748 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:26:52.751 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:26:52.752 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:26:52.754 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:26:52.755 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 4.0159ms
2025-07-28 14:26:52.756 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:26:52.763 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:26:52.763 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:26:52.764 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:26:52.765 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:26:52.766 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.7614ms
2025-07-28 14:26:52.766 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 3.0579ms
2025-07-28 14:26:52.768 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:26:52.770 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:26:52.771 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:26:52.772 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:26:52.774 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:26:52.774 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:26:52.775 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:26:52.776 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:26:52.777 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:26:52.777 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:26:52.779 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:26:52.781 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:26:52.781 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:26:52.784 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:26:52.784 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:26:52.786 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:26:52.787 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:26:52.788 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:26:52.789 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:26:52.790 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:26:52.791 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:26:52.792 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:26:52.793 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:26:52.794 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:26:52.796 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:26:52.796 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:26:52.797 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:26:52.798 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:26:52.799 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:26:52.801 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:26:52.801 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:26:52.803 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:26:52.804 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:26:52.804 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 25.2085ms
2025-07-28 14:26:52.806 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:26:52.806 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:26:52.807 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 37.8346ms
2025-07-28 14:26:52.808 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:26:52.810 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:26:52.812 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:26:52.813 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:26:52.814 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:26:52.815 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:26:52.817 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:26:52.818 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:26:52.820 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:26:52.821 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:26:52.822 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:26:52.824 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:26:52.825 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:26:52.826 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:26:52.828 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:26:52.829 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:26:52.831 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:26:52.832 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:26:52.833 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:26:52.834 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:26:52.836 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:26:52.836 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 58.141ms
2025-07-28 14:26:52.837 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:26:52.838 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 69.4929ms
2025-07-28 14:26:56.429 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:26:56.430 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:26:56.431 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:26:56.433 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:26:56.433 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:26:56.436 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:26:56.440 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:26:56.442 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:26:56.443 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:26:56.444 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:26:56.445 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:26:56.446 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:26:56.448 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:26:56.449 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:26:56.451 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:26:56.452 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:26:56.453 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.4384ms
2025-07-28 14:26:56.454 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:26:56.454 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 25.6159ms
2025-07-28 14:27:01.861 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:27:01.863 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:27:01.863 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.9899ms
2025-07-28 14:27:01.865 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:27:01.866 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:27:01.868 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:27:01.870 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 4.7816ms
2025-07-28 14:27:01.872 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:27:01.873 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:27:01.874 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:27:01.875 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.8919ms
2025-07-28 14:27:01.877 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:27:01.878 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:27:01.880 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:27:01.881 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:27:01.881 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:27:01.891 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:27:01.895 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:27:01.896 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 13.5106ms
2025-07-28 14:27:01.897 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:27:01.898 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 20.9228ms
2025-07-28 14:27:01.899 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:27:01.901 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:27:01.903 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:27:01.904 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:27:01.905 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:27:01.908 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:27:01.912 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:27:01.913 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9681ms
2025-07-28 14:27:01.913 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:27:01.914 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 14.5997ms
2025-07-28 14:27:01.916 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:27:01.917 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:27:01.918 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.9969ms
2025-07-28 14:27:01.920 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:27:01.921 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:27:01.923 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:27:01.924 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:27:01.925 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:27:01.927 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:27:01.930 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:27:01.932 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:27:01.934 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:27:01.936 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:27:01.938 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:27:01.940 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:27:01.942 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:27:01.944 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:27:01.946 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:27:01.948 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:27:01.949 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 23.5064ms
2025-07-28 14:27:01.950 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:27:01.951 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 31.024ms
2025-07-28 14:27:15.878 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:27:15.879 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:27:15.879 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.594ms
2025-07-28 14:27:15.881 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:27:15.882 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:27:15.883 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:27:15.884 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.2108ms
2025-07-28 14:27:15.886 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:27:15.887 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:27:15.888 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:27:15.889 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.6661ms
2025-07-28 14:27:15.891 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:27:15.892 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:27:15.893 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:27:15.894 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:27:15.895 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:27:15.898 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:27:15.901 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:27:15.902 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.64ms
2025-07-28 14:27:15.903 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:27:15.904 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.0725ms
2025-07-28 14:27:15.905 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:27:15.906 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:27:15.908 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:27:15.909 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:27:15.909 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:27:15.912 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:27:15.916 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:27:15.916 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.1613ms
2025-07-28 14:27:15.917 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:27:15.918 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.3248ms
2025-07-28 14:27:15.919 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:27:15.921 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:27:15.921 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.637ms
2025-07-28 14:27:15.923 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:27:15.924 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:27:15.925 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:27:15.926 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:27:15.927 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:27:15.929 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:27:15.932 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:27:15.934 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:27:15.936 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:27:15.937 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:27:15.938 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:27:15.939 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:27:15.941 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:27:15.942 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:27:15.944 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:27:15.945 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:27:15.946 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.2057ms
2025-07-28 14:27:15.946 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:27:15.947 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.2316ms
2025-07-28 14:28:02.251 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:28:02.252 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:02.252 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.81ms
2025-07-28 14:28:02.254 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:28:02.255 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:02.257 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:28:02.258 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.8427ms
2025-07-28 14:28:02.259 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:28:02.260 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:28:02.262 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:02.262 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.6355ms
2025-07-28 14:28:02.264 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:28:02.265 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:02.266 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:28:02.267 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:28:02.268 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:28:02.272 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:28:02.275 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:28:02.276 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.8825ms
2025-07-28 14:28:02.277 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:28:02.277 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.3835ms
2025-07-28 14:28:02.279 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:28:02.280 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:02.281 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:28:02.282 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:28:02.283 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:28:02.286 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:28:02.290 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:28:02.290 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.8291ms
2025-07-28 14:28:02.291 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:28:02.292 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.0815ms
2025-07-28 14:28:02.293 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:28:02.294 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:02.295 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.5672ms
2025-07-28 14:28:02.296 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:28:02.297 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:02.299 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:28:02.300 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:28:02.300 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:28:02.303 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:28:02.306 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:28:02.308 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:28:02.310 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:02.311 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:02.312 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:02.313 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:02.314 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:02.316 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:28:02.317 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:28:02.319 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:28:02.320 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.4467ms
2025-07-28 14:28:02.320 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:28:02.321 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.8377ms
2025-07-28 14:28:03.860 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:28:03.861 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:03.862 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:28:03.863 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.5486ms
2025-07-28 14:28:03.865 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:28:03.870 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:28:03.871 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:03.873 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:28:03.874 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:28:03.874 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:28:03.878 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:28:03.881 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:28:03.882 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.6211ms
2025-07-28 14:28:03.883 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:28:03.883 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.946ms
2025-07-28 14:28:03.885 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:28:03.886 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:03.887 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:28:03.888 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:28:03.889 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:28:03.892 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:28:03.896 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:28:03.896 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.5691ms
2025-07-28 14:28:03.897 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:28:03.898 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.9544ms
2025-07-28 14:28:03.899 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:28:03.900 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:03.902 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:28:03.903 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:28:03.903 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:28:03.906 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:28:03.909 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:28:03.911 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:28:03.912 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:03.913 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:03.914 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:03.916 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:03.917 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:03.918 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:28:03.920 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:28:03.921 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:28:03.922 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.8047ms
2025-07-28 14:28:03.923 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:28:03.923 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.2556ms
2025-07-28 14:28:04.452 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:28:04.453 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:04.455 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:28:04.456 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.7526ms
2025-07-28 14:28:04.457 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:28:04.458 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:28:04.459 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:04.460 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:28:04.461 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:28:04.462 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:28:04.465 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:28:04.469 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:28:04.470 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9693ms
2025-07-28 14:28:04.470 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:28:04.471 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.3789ms
2025-07-28 14:28:04.473 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:28:04.474 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:04.475 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:28:04.476 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:28:04.477 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:28:04.480 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:28:04.483 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:28:04.484 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.5409ms
2025-07-28 14:28:04.485 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:28:04.485 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.4566ms
2025-07-28 14:28:04.487 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:28:04.489 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:28:04.490 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:28:04.491 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:28:04.491 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:28:04.494 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:28:04.497 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:28:04.499 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:28:04.500 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:04.501 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:04.503 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:04.504 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:04.505 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:28:04.507 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:28:04.508 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:28:04.509 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:28:04.510 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.0447ms
2025-07-28 14:28:04.511 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:28:04.511 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.2209ms
2025-07-28 14:32:11.737 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:32:11.740 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:11.741 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.0468ms
2025-07-28 14:32:11.743 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:32:11.745 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:11.794 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:11.795 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:11.795 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:32:11.802 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:32:11.805 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:32:11.807 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 10.5744ms
2025-07-28 14:32:11.807 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:11.808 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:32:11.808 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 65.1932ms
2025-07-28 14:32:11.809 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:11.811 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - null null
2025-07-28 14:32:11.812 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:11.812 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:11.813 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:11.813 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - 204 null null 2.6548ms
2025-07-28 14:32:11.814 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:32:11.815 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:32:11.817 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:11.819 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:32:11.822 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:32:11.823 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.3419ms
2025-07-28 14:32:11.824 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:11.825 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 17.0914ms
2025-07-28 14:32:11.960 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:11.961 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 145.9887ms
2025-07-28 14:32:11.963 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:32:11.964 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:32:11.965 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:11.966 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:11.967 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 3.4828ms
2025-07-28 14:32:11.969 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:32:11.970 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:32:11.970 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:32:11.971 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:11.972 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:11.973 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.8254ms
2025-07-28 14:32:11.973 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 3.063ms
2025-07-28 14:32:11.975 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:32:11.976 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:32:11.977 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:11.978 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:11.979 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:11.979 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:11.980 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:32:11.981 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:32:11.982 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:32:11.982 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:32:11.985 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:32:11.985 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:32:11.988 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:32:11.988 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:32:11.990 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:32:11.991 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:32:11.992 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:11.993 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:32:11.994 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:11.995 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:11.996 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:11.997 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:32:11.998 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:11.999 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:32:12.000 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:12.001 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:32:12.002 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:32:12.003 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:32:12.004 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:32:12.005 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:12.006 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:32:12.007 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:12.008 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 24.414ms
2025-07-28 14:32:12.009 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:32:12.009 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:32:12.011 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 34.5787ms
2025-07-28 14:32:12.011 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:32:12.014 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:32:12.016 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:32:12.017 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:12.019 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:12.020 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:32:12.021 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:32:12.023 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:32:12.024 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:32:12.026 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:12.027 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:12.028 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:12.029 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:32:12.030 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:32:12.032 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:32:12.033 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:32:12.035 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:12.036 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:12.037 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:12.038 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:32:12.039 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:32:12.040 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:32:12.041 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 56.9763ms
2025-07-28 14:32:12.042 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:32:12.042 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 67.571ms
2025-07-28 14:32:13.855 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:32:13.856 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:13.856 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.6203ms
2025-07-28 14:32:13.858 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:32:13.859 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:13.860 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:13.861 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.4733ms
2025-07-28 14:32:13.863 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:32:13.864 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:32:13.865 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:13.865 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.4157ms
2025-07-28 14:32:13.867 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:32:13.868 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:13.869 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:13.870 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:13.870 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:32:13.876 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:32:13.879 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:32:13.880 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.4966ms
2025-07-28 14:32:13.880 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:13.881 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 14.2047ms
2025-07-28 14:32:13.883 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:32:13.884 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:13.885 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:13.886 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:13.886 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:32:13.890 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:32:13.893 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:32:13.894 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.6935ms
2025-07-28 14:32:13.895 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:13.895 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.6859ms
2025-07-28 14:32:13.897 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:32:13.898 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:13.899 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:13.901 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:32:13.901 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:32:13.903 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:32:13.907 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:32:13.909 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:32:13.911 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:13.912 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:13.914 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:13.915 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:13.917 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:13.919 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:32:13.920 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:32:13.922 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:32:13.923 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 20.9579ms
2025-07-28 14:32:13.924 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:32:13.924 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 27.1535ms
2025-07-28 14:32:25.655 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:32:25.657 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:25.658 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.0378ms
2025-07-28 14:32:25.660 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:32:25.662 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:25.664 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:25.666 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:25.666 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:32:25.671 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:32:25.674 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:32:25.675 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.2936ms
2025-07-28 14:32:25.676 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:25.677 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 16.3609ms
2025-07-28 14:32:25.678 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:32:25.679 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:25.681 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:25.682 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:25.683 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:32:25.687 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:32:25.690 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - null null
2025-07-28 14:32:25.690 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:32:25.691 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:25.692 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.837ms
2025-07-28 14:32:25.692 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - 204 null null 2.3873ms
2025-07-28 14:32:25.693 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:25.694 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:32:25.695 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 16.4584ms
2025-07-28 14:32:25.696 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:25.699 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:25.700 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 5.4047ms
2025-07-28 14:32:25.701 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:32:25.710 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:32:25.712 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:25.713 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:25.714 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 4.2017ms
2025-07-28 14:32:25.716 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:32:25.719 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:32:25.719 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:32:25.721 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:25.722 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:25.722 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.9848ms
2025-07-28 14:32:25.723 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 3.2165ms
2025-07-28 14:32:25.724 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:32:25.726 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:32:25.727 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:25.728 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:25.730 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:25.730 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:25.731 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:32:25.732 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:32:25.733 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:32:25.733 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:32:25.735 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:32:25.736 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:32:25.736 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:32:25.740 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:32:25.740 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:32:25.742 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:32:25.743 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:32:25.744 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:25.745 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:25.746 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:25.747 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:32:25.748 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:25.750 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:32:25.751 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:25.753 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:32:25.754 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:25.756 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:32:25.758 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:32:25.759 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:25.760 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:32:25.760 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:25.761 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:32:25.763 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:32:25.763 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 28.5152ms
2025-07-28 14:32:25.766 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:32:25.766 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:32:25.768 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 41.8069ms
2025-07-28 14:32:25.768 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:32:25.771 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:32:25.773 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:25.775 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:25.776 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:32:25.778 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:32:25.780 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:32:25.781 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:32:25.783 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:25.784 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:25.785 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:25.787 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:32:25.788 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:32:25.789 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:32:25.791 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:32:25.793 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:25.794 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:25.795 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:32:25.796 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:32:25.797 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:32:25.798 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:32:25.799 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 64.9112ms
2025-07-28 14:32:25.800 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:32:25.800 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 75.726ms
2025-07-28 14:32:27.454 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:32:27.456 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:27.456 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.9887ms
2025-07-28 14:32:27.458 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:32:27.459 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:27.460 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:27.462 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.6159ms
2025-07-28 14:32:27.463 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:32:27.464 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:32:27.474 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:27.474 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 10.2175ms
2025-07-28 14:32:27.487 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:32:27.490 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:27.491 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:27.492 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:27.493 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:32:27.496 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:32:27.499 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:32:27.500 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.3771ms
2025-07-28 14:32:27.501 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:27.501 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 14.4674ms
2025-07-28 14:32:27.503 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:32:27.504 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:27.506 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:27.507 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:27.508 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:32:27.511 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:32:27.514 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:32:27.515 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4713ms
2025-07-28 14:32:27.516 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:32:27.517 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.4572ms
2025-07-28 14:32:27.518 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:32:27.520 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:32:27.521 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:32:27.522 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:32:27.523 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:32:27.525 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:32:27.528 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:32:27.530 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:32:27.532 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:27.533 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:27.534 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:27.535 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:27.537 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:32:27.538 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:32:27.540 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:32:27.541 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:32:27.542 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.3099ms
2025-07-28 14:32:27.543 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:32:27.543 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.8144ms
2025-07-28 14:33:14.932 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:33:14.935 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:14.935 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.0235ms
2025-07-28 14:33:14.938 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:33:14.940 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:14.942 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:14.945 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:14.946 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:14.951 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:14.955 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:14.956 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.4202ms
2025-07-28 14:33:14.957 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:14.957 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:33:14.957 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 19.5481ms
2025-07-28 14:33:14.959 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:14.962 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - null null
2025-07-28 14:33:14.962 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:14.963 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:14.964 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:14.965 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - 204 null null 2.9857ms
2025-07-28 14:33:14.965 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:14.967 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:33:14.969 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:14.970 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:14.971 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:14.972 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 4.7692ms
2025-07-28 14:33:14.975 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:33:14.975 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:14.977 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.5411ms
2025-07-28 14:33:14.978 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:14.979 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 21.7842ms
2025-07-28 14:33:14.992 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:33:14.994 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:14.995 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:14.996 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 4.1589ms
2025-07-28 14:33:14.998 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:33:15.001 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:33:15.001 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:33:15.002 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:15.003 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:15.004 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 3.0125ms
2025-07-28 14:33:15.004 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 3.3705ms
2025-07-28 14:33:15.006 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:15.008 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:15.009 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:15.011 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:15.012 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:15.012 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:15.013 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:33:15.015 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:15.015 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:33:15.016 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:33:15.018 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:33:15.019 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:33:15.020 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:33:15.022 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:33:15.023 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:33:15.024 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:33:15.026 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:33:15.027 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:15.028 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:33:15.029 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:15.030 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:33:15.031 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:15.032 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:33:15.033 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:15.035 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:33:15.035 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:15.037 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:33:15.038 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:33:15.039 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:33:15.040 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:33:15.040 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:33:15.041 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:33:15.043 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:33:15.044 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 25.9073ms
2025-07-28 14:33:15.045 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:33:15.045 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:15.047 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 39.2464ms
2025-07-28 14:33:15.047 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:33:15.051 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:33:15.053 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:33:15.054 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:33:15.055 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:33:15.057 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:33:15.059 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:33:15.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:33:15.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:33:15.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:33:15.065 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:33:15.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:33:15.067 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:33:15.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:33:15.070 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:33:15.072 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:33:15.073 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:33:15.074 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:33:15.075 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:33:15.077 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:33:15.078 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:33:15.078 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 61.4159ms
2025-07-28 14:33:15.079 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:33:15.080 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 73.3956ms
2025-07-28 14:33:16.339 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:33:16.340 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:16.340 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.6708ms
2025-07-28 14:33:16.342 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:33:16.344 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:16.345 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:16.346 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.9274ms
2025-07-28 14:33:16.348 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:33:16.349 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:33:16.350 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:16.350 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.4721ms
2025-07-28 14:33:16.352 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:16.353 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:16.354 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:16.355 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:16.356 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:16.359 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:16.362 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:16.363 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9661ms
2025-07-28 14:33:16.364 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:16.365 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.7196ms
2025-07-28 14:33:16.366 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:16.367 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:16.368 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:16.369 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:16.370 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:16.373 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:16.377 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:16.378 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.7273ms
2025-07-28 14:33:16.378 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:16.379 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.8529ms
2025-07-28 14:33:16.381 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:16.382 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:16.383 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:16.384 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:16.385 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:33:16.387 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:33:16.390 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:33:16.392 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:33:16.394 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:16.395 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:16.396 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:16.397 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:16.399 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:16.400 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:33:16.402 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:33:16.403 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:33:16.404 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.2495ms
2025-07-28 14:33:16.405 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:16.405 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.3813ms
2025-07-28 14:33:19.026 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:33:19.027 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:19.028 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:19.029 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.6786ms
2025-07-28 14:33:19.031 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:33:19.032 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:19.033 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:19.034 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:19.035 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:19.035 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:19.039 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:19.042 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:19.043 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.3872ms
2025-07-28 14:33:19.043 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:19.044 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.1402ms
2025-07-28 14:33:19.045 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:19.047 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:19.048 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:19.049 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:19.049 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:19.053 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:19.056 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:19.057 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.3626ms
2025-07-28 14:33:19.058 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:19.058 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.6134ms
2025-07-28 14:33:19.060 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:19.061 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:19.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:19.063 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:19.064 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:33:19.066 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:33:19.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:33:19.071 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:33:19.072 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:19.074 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:19.075 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:19.076 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:19.077 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:19.079 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:33:19.081 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:33:19.082 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:33:19.083 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.1314ms
2025-07-28 14:33:19.083 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:19.084 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.2681ms
2025-07-28 14:33:19.825 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:33:19.826 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:19.828 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:19.828 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.6668ms
2025-07-28 14:33:19.830 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:33:19.831 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:19.832 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:19.833 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:19.834 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:19.835 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:19.838 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:19.841 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:19.842 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.5781ms
2025-07-28 14:33:19.843 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:19.843 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.1609ms
2025-07-28 14:33:19.845 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:19.846 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:19.847 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:19.848 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:19.849 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:19.852 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:19.856 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:19.857 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.831ms
2025-07-28 14:33:19.858 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:19.858 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.1344ms
2025-07-28 14:33:19.860 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:19.861 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:19.863 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:19.864 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:19.865 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:33:19.867 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:33:19.870 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:33:19.872 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:33:19.873 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:19.874 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:19.875 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:19.877 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:19.878 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:19.879 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:33:19.881 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:33:19.882 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:33:19.883 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.5357ms
2025-07-28 14:33:19.884 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:19.884 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.5839ms
2025-07-28 14:33:20.609 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:33:20.611 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:20.612 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:20.613 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 4.1003ms
2025-07-28 14:33:20.615 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:33:20.616 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:20.617 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:20.619 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:20.620 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:20.620 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:20.624 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:20.627 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:20.628 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.902ms
2025-07-28 14:33:20.629 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:20.629 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.4036ms
2025-07-28 14:33:20.631 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:20.632 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:20.633 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:20.634 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:20.635 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:20.638 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:20.642 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:20.643 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.6396ms
2025-07-28 14:33:20.643 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:20.644 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.7878ms
2025-07-28 14:33:20.646 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:33:20.647 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:20.647 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.6418ms
2025-07-28 14:33:20.649 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:20.650 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:20.651 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:20.653 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:20.653 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:33:20.655 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:33:20.659 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:33:20.661 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:33:20.662 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:20.663 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:20.665 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:20.666 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:20.667 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:20.669 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:33:20.670 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:33:20.671 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:33:20.672 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.485ms
2025-07-28 14:33:20.673 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:20.674 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.9739ms
2025-07-28 14:33:38.507 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:33:38.509 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:38.509 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.8514ms
2025-07-28 14:33:38.511 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:33:38.512 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:38.513 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:38.514 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.3985ms
2025-07-28 14:33:38.516 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:33:38.517 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:33:38.518 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:38.518 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.7141ms
2025-07-28 14:33:38.520 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:38.521 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:38.522 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:38.523 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:38.524 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:38.527 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:38.531 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:38.531 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.7205ms
2025-07-28 14:33:38.532 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:38.533 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.6051ms
2025-07-28 14:33:38.534 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:38.535 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:38.537 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:38.538 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:38.538 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:38.542 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:38.549 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:38.549 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 10.3251ms
2025-07-28 14:33:38.550 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:38.551 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 16.5293ms
2025-07-28 14:33:38.552 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:33:38.553 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:38.554 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.4617ms
2025-07-28 14:33:38.556 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:38.557 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:38.558 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:38.560 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:38.560 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:33:38.563 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:33:38.566 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:33:38.567 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:33:38.569 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:38.570 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:38.571 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:38.572 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:38.574 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:38.575 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:33:38.577 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:33:38.578 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:33:38.579 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.6777ms
2025-07-28 14:33:38.579 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:38.580 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.3104ms
2025-07-28 14:33:39.183 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:33:39.184 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:39.185 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:39.186 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.6681ms
2025-07-28 14:33:39.188 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:33:39.193 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:39.194 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:39.195 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:39.196 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:39.197 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:39.200 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:39.203 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:39.204 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.2639ms
2025-07-28 14:33:39.205 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:39.205 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.5539ms
2025-07-28 14:33:39.207 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:39.208 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:39.210 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:39.211 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:39.211 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:39.214 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:39.218 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:39.218 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4524ms
2025-07-28 14:33:39.219 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:39.220 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.6167ms
2025-07-28 14:33:39.221 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:39.222 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:39.223 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:39.225 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:39.225 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:33:39.228 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:33:39.231 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:33:39.233 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:33:39.234 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:39.235 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:39.236 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:39.237 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:39.239 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:39.240 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:33:39.242 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:33:39.243 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:33:39.244 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.078ms
2025-07-28 14:33:39.245 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:39.246 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.4457ms
2025-07-28 14:33:39.699 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:33:39.700 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:39.701 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:39.703 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.7093ms
2025-07-28 14:33:39.704 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:33:39.710 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:39.711 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:39.712 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:39.713 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:39.714 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:39.717 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:39.720 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:39.721 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.3921ms
2025-07-28 14:33:39.722 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:39.722 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.5555ms
2025-07-28 14:33:39.724 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:39.725 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:39.726 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:39.727 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:39.728 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:39.731 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:39.734 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:39.735 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.1849ms
2025-07-28 14:33:39.736 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:39.736 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.471ms
2025-07-28 14:33:39.738 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:39.739 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:39.740 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:39.741 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:39.742 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:33:39.744 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:33:39.747 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:33:39.749 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:33:39.750 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:39.752 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:39.753 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:39.754 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:39.755 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:39.756 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:33:39.758 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:33:39.760 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:33:39.761 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.1221ms
2025-07-28 14:33:39.761 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:39.762 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.3444ms
2025-07-28 14:33:40.486 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:33:40.488 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:40.489 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:40.490 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.7053ms
2025-07-28 14:33:40.492 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:33:40.493 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:40.494 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:40.495 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:40.496 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:40.497 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:40.500 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:40.503 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:40.504 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.342ms
2025-07-28 14:33:40.505 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:40.505 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.6168ms
2025-07-28 14:33:40.507 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:40.508 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:40.510 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:40.511 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:40.511 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:40.515 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:40.518 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:40.519 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4746ms
2025-07-28 14:33:40.519 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:40.520 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.814ms
2025-07-28 14:33:40.521 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:40.523 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:40.524 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:40.525 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:40.525 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:33:40.528 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:33:40.531 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:33:40.533 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:33:40.534 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:40.535 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:40.537 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:40.538 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:40.539 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:40.541 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:33:40.542 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:33:40.543 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:33:40.544 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.9203ms
2025-07-28 14:33:40.545 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:40.546 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.0864ms
2025-07-28 14:33:40.986 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:33:40.987 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:40.989 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:40.990 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.5604ms
2025-07-28 14:33:40.991 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:33:40.993 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:40.994 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:40.995 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:40.996 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:40.997 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:41.000 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:41.003 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:41.004 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4362ms
2025-07-28 14:33:41.005 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:41.005 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.5659ms
2025-07-28 14:33:41.007 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:41.008 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:41.010 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:41.011 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:41.011 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:33:41.014 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:33:41.017 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:33:41.018 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.2725ms
2025-07-28 14:33:41.019 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:33:41.019 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.5659ms
2025-07-28 14:33:41.021 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:33:41.022 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:33:41.023 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:33:41.024 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:41.025 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:33:41.029 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:33:41.033 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:33:41.035 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:33:41.036 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:41.038 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:41.039 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:41.041 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:41.043 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:33:41.045 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:33:41.047 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:33:41.049 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:33:41.050 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 23.4009ms
2025-07-28 14:33:41.050 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:33:41.051 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 30.0839ms
2025-07-28 14:34:09.727 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:34:09.729 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:09.729 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.7822ms
2025-07-28 14:34:09.731 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:34:09.732 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:09.733 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:34:09.735 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.8561ms
2025-07-28 14:34:09.737 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:34:09.738 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:34:09.739 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:09.739 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.4316ms
2025-07-28 14:34:09.740 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:34:09.742 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:09.743 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:34:09.744 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:34:09.745 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:34:09.748 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:34:09.751 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:34:09.752 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4922ms
2025-07-28 14:34:09.752 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:34:09.753 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.5519ms
2025-07-28 14:34:09.755 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:34:09.756 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:09.757 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:34:09.758 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:34:09.758 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:34:09.762 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:34:09.766 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:34:09.766 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.8438ms
2025-07-28 14:34:09.767 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:34:09.768 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.0667ms
2025-07-28 14:34:09.770 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:34:09.771 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:09.771 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.5068ms
2025-07-28 14:34:09.773 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:34:09.774 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:09.776 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:34:09.777 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:34:09.778 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:34:09.780 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:34:09.784 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:34:09.786 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:34:09.787 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:09.788 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:09.790 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:09.791 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:09.792 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:09.794 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:34:09.796 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:34:09.797 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:34:09.798 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 19.3191ms
2025-07-28 14:34:09.799 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:34:09.799 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 26.6994ms
2025-07-28 14:34:43.301 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:34:43.301 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:34:43.302 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:43.303 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:43.304 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.8167ms
2025-07-28 14:34:43.304 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 2.9888ms
2025-07-28 14:34:43.306 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:34:43.307 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:34:43.308 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:43.310 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:43.311 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:34:43.311 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:34:43.312 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 6.7032ms
2025-07-28 14:34:43.314 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:34:43.315 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:34:43.315 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:34:43.316 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:34:43.318 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:43.318 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.2415ms
2025-07-28 14:34:43.320 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:34:43.320 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:34:43.323 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:43.323 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:34:43.324 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:34:43.324 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9361ms
2025-07-28 14:34:43.325 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:34:43.326 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:34:43.326 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:34:43.327 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 19.4629ms
2025-07-28 14:34:43.329 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:34:43.330 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:43.330 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:34:43.330 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.5262ms
2025-07-28 14:34:43.333 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:34:43.334 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:34:43.334 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:43.335 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.7136ms
2025-07-28 14:34:43.337 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:34:43.337 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:34:43.337 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 17.0842ms
2025-07-28 14:34:43.340 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:34:43.340 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:34:43.342 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:34:43.342 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:43.343 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 9.3415ms
2025-07-28 14:34:43.344 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:34:43.345 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:34:43.345 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:34:43.346 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:34:43.347 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:43.348 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:43.348 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:34:43.349 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 4.1025ms
2025-07-28 14:34:43.349 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 4.3439ms
2025-07-28 14:34:43.352 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:34:43.353 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:34:43.353 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:34:43.354 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:43.357 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:43.357 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:34:43.358 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:34:43.358 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:34:43.358 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.8762ms
2025-07-28 14:34:43.359 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:34:43.360 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:34:43.361 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:34:43.361 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:34:43.362 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:34:43.362 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 22.014ms
2025-07-28 14:34:43.364 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:34:43.365 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:34:43.367 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:34:43.369 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:34:43.370 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:34:43.371 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:34:43.372 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:34:43.373 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:43.374 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:34:43.375 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:43.376 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:34:43.377 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:43.378 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:34:43.379 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:43.381 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:34:43.381 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:43.383 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:34:43.384 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:34:43.385 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:34:43.386 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:34:43.386 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:34:43.387 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:34:43.389 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:34:43.389 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 25.2715ms
2025-07-28 14:34:43.390 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:34:43.391 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:34:43.391 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:34:43.392 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:34:43.394 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 40.7986ms
2025-07-28 14:34:43.394 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:34:43.395 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:34:43.397 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:34:43.398 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:34:43.399 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:34:43.399 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:34:43.400 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:34:43.402 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:34:43.402 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:34:43.404 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:34:43.406 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:34:43.406 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:34:43.408 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:34:43.409 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:34:43.410 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:34:43.411 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:43.412 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:34:43.413 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:43.414 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:34:43.415 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:43.416 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:34:43.417 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:43.418 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:34:43.419 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:34:43.420 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:34:43.421 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:34:43.422 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:34:43.423 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:34:43.424 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:34:43.425 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:34:43.426 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:34:43.427 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 25.8978ms
2025-07-28 14:34:43.428 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:34:43.428 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:34:43.430 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:34:43.430 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 39.908ms
2025-07-28 14:34:43.431 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:34:43.433 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:34:43.434 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 70.8828ms
2025-07-28 14:34:43.435 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:34:43.435 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 83.4464ms
2025-07-28 14:35:05.725 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:35:05.727 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:05.728 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.0703ms
2025-07-28 14:35:05.730 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:05.732 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:05.734 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:05.736 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:05.737 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:05.741 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:05.745 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:05.746 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.6336ms
2025-07-28 14:35:05.747 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:05.748 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:05.748 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 17.5352ms
2025-07-28 14:35:05.749 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:05.753 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:05.753 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:35:05.754 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:05.755 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:05.756 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:05.756 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.0332ms
2025-07-28 14:35:05.759 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:05.761 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:05.761 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:05.762 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:05.765 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:05.765 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:05.766 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:05.766 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.2821ms
2025-07-28 14:35:05.767 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 8.0313ms
2025-07-28 14:35:05.768 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:05.771 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 23.1354ms
2025-07-28 14:35:05.772 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:05.774 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:05.776 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:05.777 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:05.778 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:05.778 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 5.802ms
2025-07-28 14:35:05.783 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:35:05.783 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:35:05.785 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:05.786 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:05.787 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 4.5351ms
2025-07-28 14:35:05.788 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 4.8567ms
2025-07-28 14:35:05.790 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:05.791 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:05.792 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:05.794 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:05.795 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:05.795 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:05.796 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:05.797 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:05.798 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:35:05.799 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:35:05.801 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:35:05.802 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:35:05.804 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:35:05.804 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:35:05.806 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:05.807 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:35:05.808 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:05.808 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:05.810 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:05.811 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:05.812 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:05.813 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:05.814 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:05.815 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:05.816 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:05.817 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:05.818 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:05.820 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:35:05.820 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:05.822 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:35:05.822 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:05.823 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:35:05.824 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:05.825 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 25.4171ms
2025-07-28 14:35:05.826 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:05.827 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:05.828 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 37.2064ms
2025-07-28 14:35:05.828 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:05.831 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:05.833 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:05.834 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:05.835 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:05.837 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:05.840 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:05.842 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:05.844 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:05.845 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:05.847 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:05.848 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:05.849 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:05.851 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:05.853 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:05.854 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:05.855 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:05.856 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:05.857 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:05.859 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:05.860 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:35:05.860 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 59.8128ms
2025-07-28 14:35:05.861 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:05.862 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 71.9066ms
2025-07-28 14:35:06.995 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:35:06.996 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:06.996 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.8978ms
2025-07-28 14:35:06.998 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:35:06.999 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:07.001 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:07.002 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.7359ms
2025-07-28 14:35:07.003 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:35:07.004 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:35:07.005 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:07.006 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.3565ms
2025-07-28 14:35:07.007 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:07.008 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:07.010 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:07.011 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:07.011 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:07.015 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:07.018 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:07.019 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.7591ms
2025-07-28 14:35:07.020 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:07.020 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.9682ms
2025-07-28 14:35:07.022 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:07.023 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:07.024 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:07.025 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:07.026 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:07.029 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:07.032 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:07.033 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.449ms
2025-07-28 14:35:07.034 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:07.034 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.5395ms
2025-07-28 14:35:07.036 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:07.037 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:07.038 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:07.039 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:07.040 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:35:07.042 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:35:07.046 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:35:07.048 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:35:07.049 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:07.050 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:07.052 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:07.053 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:07.054 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:07.055 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:35:07.057 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:35:07.058 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:35:07.060 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.6257ms
2025-07-28 14:35:07.060 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:07.061 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.8832ms
2025-07-28 14:35:08.756 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:08.758 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:08.760 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:08.762 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:08.763 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:08.768 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:08.772 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:08.773 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.3301ms
2025-07-28 14:35:08.774 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:08.775 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:08.775 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 19.1944ms
2025-07-28 14:35:08.776 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:08.779 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:08.781 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:08.781 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:08.783 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:08.784 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:08.785 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:08.785 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:08.786 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:08.788 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:08.789 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 6.2704ms
2025-07-28 14:35:08.790 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:08.792 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.3064ms
2025-07-28 14:35:08.792 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:08.793 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 18.2384ms
2025-07-28 14:35:08.807 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:08.808 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:08.809 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:08.811 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:08.811 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:08.812 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.9995ms
2025-07-28 14:35:08.813 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:08.813 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:08.815 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:08.816 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:08.817 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:08.817 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:08.818 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:08.819 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:08.820 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:35:08.820 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:35:08.822 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:35:08.822 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:35:08.824 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:35:08.826 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:35:08.827 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:08.828 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:35:08.829 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:08.830 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:08.831 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:08.832 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:08.833 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:08.834 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:08.835 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:08.835 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:08.837 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:08.837 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:08.839 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:08.840 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:35:08.841 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:08.842 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:35:08.843 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:08.844 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:35:08.845 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:08.845 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 24.4747ms
2025-07-28 14:35:08.847 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:08.847 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:08.849 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 35.1986ms
2025-07-28 14:35:08.849 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:08.852 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:08.853 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:08.854 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:08.856 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:08.857 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:08.858 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:08.860 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:08.861 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:08.863 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:08.864 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:08.865 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:08.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:08.868 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:08.869 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:08.870 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:08.872 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:08.873 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:08.874 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:08.875 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:08.876 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:35:08.877 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 55.0017ms
2025-07-28 14:35:08.877 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:08.878 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 64.3691ms
2025-07-28 14:35:09.538 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:35:09.540 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:09.541 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:09.542 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.6878ms
2025-07-28 14:35:09.544 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:35:09.544 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:09.546 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:09.547 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:09.548 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:09.548 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:09.551 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:09.555 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:09.555 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.353ms
2025-07-28 14:35:09.556 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:09.557 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.1801ms
2025-07-28 14:35:09.558 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:09.560 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:09.561 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:09.562 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:09.563 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:09.566 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:09.569 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:09.570 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.1957ms
2025-07-28 14:35:09.570 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:09.571 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.5307ms
2025-07-28 14:35:09.572 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:09.573 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:09.575 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:09.576 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:09.576 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:35:09.578 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:35:09.582 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:35:09.583 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:35:09.584 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:09.586 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:09.587 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:09.588 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:09.589 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:09.591 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:35:09.592 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:35:09.594 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:35:09.595 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.4245ms
2025-07-28 14:35:09.595 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:09.596 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 23.2461ms
2025-07-28 14:35:10.925 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:35:10.927 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:10.928 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.2046ms
2025-07-28 14:35:10.931 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:10.933 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:10.935 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:10.937 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:10.938 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:10.942 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:10.947 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:10.948 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.8927ms
2025-07-28 14:35:10.949 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:10.950 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 18.8959ms
2025-07-28 14:35:10.954 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:10.956 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:10.957 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:10.958 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:10.959 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:10.961 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:35:10.962 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:10.963 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:10.963 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.9186ms
2025-07-28 14:35:10.966 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:10.966 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:10.967 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:10.968 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.0559ms
2025-07-28 14:35:10.969 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:10.969 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:10.970 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 15.4493ms
2025-07-28 14:35:10.971 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:10.973 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:10.974 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 7.6087ms
2025-07-28 14:35:10.979 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:10.980 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:10.981 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:10.983 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:10.983 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:10.984 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 5.3633ms
2025-07-28 14:35:10.987 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:35:10.987 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:35:10.988 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:10.989 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:10.990 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.9521ms
2025-07-28 14:35:10.990 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 3.1874ms
2025-07-28 14:35:10.992 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:10.993 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:10.994 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:10.995 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:10.997 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:10.997 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:10.998 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:10.999 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:10.999 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:35:11.000 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:35:11.002 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:35:11.003 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:35:11.003 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:35:11.006 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.006 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.008 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:35:11.009 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.010 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.011 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.012 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.012 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.013 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.014 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.015 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.017 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.017 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.018 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.020 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:35:11.020 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.021 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:35:11.022 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.023 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:35:11.024 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.025 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 22.9989ms
2025-07-28 14:35:11.026 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.027 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:11.029 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 35.2544ms
2025-07-28 14:35:11.029 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.032 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.033 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.034 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.035 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.037 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.038 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.040 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.041 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.042 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.044 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.045 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.046 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.048 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.049 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.051 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.052 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.053 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.054 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.055 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.056 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:35:11.057 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 55.8302ms
2025-07-28 14:35:11.057 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:11.058 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 66.0541ms
2025-07-28 14:35:11.462 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:11.464 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:11.465 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:11.466 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:11.467 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:11.470 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:11.474 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:11.475 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.5192ms
2025-07-28 14:35:11.476 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:11.476 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:11.478 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:11.478 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 15.9605ms
2025-07-28 14:35:11.480 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:11.482 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:11.482 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:11.484 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:11.485 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:11.486 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:11.487 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:11.489 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:11.489 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:11.490 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:11.490 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 6.1522ms
2025-07-28 14:35:11.491 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.6096ms
2025-07-28 14:35:11.493 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:11.494 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 17.7504ms
2025-07-28 14:35:11.508 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:11.510 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:11.511 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:11.512 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:11.513 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:11.513 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.8971ms
2025-07-28 14:35:11.515 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:11.515 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:11.516 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:11.517 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:11.518 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:11.518 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:11.519 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:11.520 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:11.521 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:35:11.521 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:35:11.523 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:35:11.523 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:35:11.526 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:35:11.526 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.528 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.529 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:35:11.530 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.530 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.532 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.533 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.534 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.534 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.536 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.536 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.538 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.538 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.540 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.541 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:35:11.541 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.543 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:35:11.543 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.544 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:35:11.545 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.546 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 24.2302ms
2025-07-28 14:35:11.547 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.547 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:11.549 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 34.2984ms
2025-07-28 14:35:11.549 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.552 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.553 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.554 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.555 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.557 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.558 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.560 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.561 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.562 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.564 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.565 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.566 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.568 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.569 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.571 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.572 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.573 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.574 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.575 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.577 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:35:11.577 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 54.6842ms
2025-07-28 14:35:11.578 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:11.579 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 63.8601ms
2025-07-28 14:35:11.780 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:11.782 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:11.783 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:11.784 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:11.785 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:11.789 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:11.793 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:11.794 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.2844ms
2025-07-28 14:35:11.795 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:11.795 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:11.797 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:11.797 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 16.6865ms
2025-07-28 14:35:11.799 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:11.800 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:11.801 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:11.802 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:11.803 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:11.804 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:11.804 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:11.805 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:11.807 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:11.808 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 5.8634ms
2025-07-28 14:35:11.809 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:11.810 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.8375ms
2025-07-28 14:35:11.811 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:11.812 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 16.4148ms
2025-07-28 14:35:11.827 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:11.829 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:11.830 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:11.831 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:11.832 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:11.832 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 5.0253ms
2025-07-28 14:35:11.852 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:11.853 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:11.854 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:11.855 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:11.857 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:11.857 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:11.858 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:11.858 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:11.859 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:35:11.859 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:35:11.862 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:35:11.862 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:35:11.864 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:35:11.864 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.867 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:35:11.868 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.869 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.870 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.871 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.872 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.873 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.873 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.874 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.875 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.876 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:11.877 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.878 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:35:11.879 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.881 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:35:11.881 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.882 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:35:11.883 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.884 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 23.6436ms
2025-07-28 14:35:11.885 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.886 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:11.887 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 34.22ms
2025-07-28 14:35:11.887 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.890 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.892 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.893 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.894 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.895 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.897 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.899 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.900 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.901 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.902 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.903 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.905 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.906 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:11.907 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:11.909 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.910 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.911 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:11.912 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:11.913 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:11.914 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:35:11.915 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 53.5833ms
2025-07-28 14:35:11.915 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:11.916 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 64.3519ms
2025-07-28 14:35:12.058 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:12.059 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.062 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.062 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:12.066 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:12.069 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:12.070 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.2626ms
2025-07-28 14:35:12.071 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.072 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.8812ms
2025-07-28 14:35:12.074 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:12.075 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.076 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.077 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.078 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:12.082 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:12.082 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:12.084 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.085 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:12.086 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.086 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.6581ms
2025-07-28 14:35:12.087 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:12.087 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.088 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:12.088 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 14.6077ms
2025-07-28 14:35:12.089 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 6.6276ms
2025-07-28 14:35:12.100 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:12.102 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.103 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.104 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:12.105 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:12.106 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 5.3665ms
2025-07-28 14:35:12.109 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:12.109 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:12.110 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.111 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.112 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.112 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.113 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:12.114 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:12.115 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:35:12.115 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:35:12.117 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:35:12.118 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:35:12.119 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:35:12.121 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.121 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.123 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:35:12.124 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.125 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.126 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.127 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.128 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.129 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.130 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.130 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.132 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.132 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.134 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.135 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:35:12.136 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.137 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:35:12.138 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.138 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:35:12.139 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.140 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 23.0871ms
2025-07-28 14:35:12.141 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.142 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:12.143 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 34.6848ms
2025-07-28 14:35:12.143 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.146 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.147 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.149 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.150 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.151 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.153 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.154 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.155 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.156 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.157 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.159 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.160 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.162 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.163 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.164 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.166 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.167 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.168 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.169 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.170 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:35:12.171 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 54.9929ms
2025-07-28 14:35:12.172 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:12.172 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 63.5596ms
2025-07-28 14:35:12.282 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:12.283 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.284 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.285 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.286 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:12.289 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:12.293 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:12.294 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9961ms
2025-07-28 14:35:12.295 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.295 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.6991ms
2025-07-28 14:35:12.295 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:12.298 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.300 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.301 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.301 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:12.304 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:12.305 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:12.305 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.308 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.308 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:12.309 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:12.310 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.6849ms
2025-07-28 14:35:12.310 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:12.311 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.312 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 7.7863ms
2025-07-28 14:35:12.312 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 17.0934ms
2025-07-28 14:35:12.322 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:12.324 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.325 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.326 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:12.327 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:12.327 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 5.2509ms
2025-07-28 14:35:12.330 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:12.330 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:12.331 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.332 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.333 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.333 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.334 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:12.335 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:12.336 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:35:12.336 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:35:12.338 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:35:12.339 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:35:12.339 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:35:12.342 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.342 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.344 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:35:12.345 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.345 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.346 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.347 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.348 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.349 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.350 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.351 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.352 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.353 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.354 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.355 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:35:12.356 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.357 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:35:12.358 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.359 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:35:12.360 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.361 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 22.587ms
2025-07-28 14:35:12.362 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.362 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:12.364 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 33.6245ms
2025-07-28 14:35:12.364 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.367 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.368 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.369 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.371 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.372 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.374 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.375 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.377 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.378 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.379 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.380 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.381 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.383 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.384 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.385 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.387 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.388 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.389 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.391 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.392 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:35:12.392 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 55.2314ms
2025-07-28 14:35:12.393 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:12.394 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 63.5497ms
2025-07-28 14:35:12.501 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:12.502 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.504 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.505 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.506 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:12.509 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:12.513 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:12.514 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.0722ms
2025-07-28 14:35:12.514 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:12.514 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.516 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.516 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 15.2093ms
2025-07-28 14:35:12.518 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.519 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.520 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:12.522 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:12.523 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.523 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:12.524 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.526 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:12.526 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:12.527 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:12.528 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.8877ms
2025-07-28 14:35:12.528 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 6.6286ms
2025-07-28 14:35:12.529 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.531 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 16.3392ms
2025-07-28 14:35:12.538 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:12.539 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.541 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.542 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:12.542 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:12.543 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 5.086ms
2025-07-28 14:35:12.545 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:12.545 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:12.546 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.547 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.549 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.549 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.550 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:12.550 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:12.551 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:35:12.551 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:35:12.553 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:35:12.554 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:35:12.556 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:35:12.556 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.558 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.559 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:35:12.560 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.561 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.562 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.563 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.564 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.565 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.566 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.567 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.569 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.569 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.570 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.571 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:35:12.572 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.574 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:35:12.574 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.575 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:35:12.576 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.577 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 24.5957ms
2025-07-28 14:35:12.578 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.578 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:12.580 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 34.5701ms
2025-07-28 14:35:12.580 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.582 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.584 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.585 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.586 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.587 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.589 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.590 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.592 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.593 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.594 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.595 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.596 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.598 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:12.599 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:12.601 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.602 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.603 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:12.604 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:12.606 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:12.607 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:35:12.607 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 54.2535ms
2025-07-28 14:35:12.608 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:12.608 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 63.1555ms
2025-07-28 14:35:12.916 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:35:12.918 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.918 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.7189ms
2025-07-28 14:35:12.920 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:35:12.921 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.922 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.923 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.4465ms
2025-07-28 14:35:12.925 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:35:12.927 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:35:12.928 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.929 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.736ms
2025-07-28 14:35:12.930 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:12.931 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.932 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.933 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.934 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:12.937 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:12.940 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:12.941 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.3868ms
2025-07-28 14:35:12.942 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.942 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.3329ms
2025-07-28 14:35:12.944 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:12.945 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.947 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.948 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.948 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:12.951 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:12.954 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:12.955 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.0711ms
2025-07-28 14:35:12.956 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:12.956 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.0023ms
2025-07-28 14:35:12.958 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:12.959 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:12.961 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:12.962 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:12.962 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:35:12.964 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:35:12.967 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.969 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:35:12.971 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.972 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.973 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.974 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.975 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:12.977 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:35:12.979 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:35:12.980 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:35:12.981 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.735ms
2025-07-28 14:35:12.981 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:12.982 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.0663ms
2025-07-28 14:35:17.058 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:35:17.058 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:35:17.060 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:17.061 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:17.061 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.2148ms
2025-07-28 14:35:17.062 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.4726ms
2025-07-28 14:35:17.063 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:17.065 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:17.066 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:17.067 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:17.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:17.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:17.070 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:17.071 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:17.071 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:17.072 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:17.072 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 7.3006ms
2025-07-28 14:35:17.075 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:17.079 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:17.080 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9571ms
2025-07-28 14:35:17.081 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:17.082 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 18.2345ms
2025-07-28 14:35:17.083 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:35:17.084 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:17.086 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:17.087 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.7472ms
2025-07-28 14:35:17.088 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:35:17.092 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:17.093 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:17.095 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:17.096 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:17.096 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:17.100 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:17.103 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:17.104 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.5826ms
2025-07-28 14:35:17.105 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:17.105 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.0722ms
2025-07-28 14:35:23.854 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:35:23.855 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:23.856 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.664ms
2025-07-28 14:35:23.857 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:35:23.858 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:23.860 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:23.861 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:23.861 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:23.865 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:23.868 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:23.869 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.6788ms
2025-07-28 14:35:23.870 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:23.870 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.1827ms
2025-07-28 14:35:23.872 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:35:23.873 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:23.873 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.4266ms
2025-07-28 14:35:23.875 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:35:23.876 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:23.877 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:23.878 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:35:23.879 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:35:23.880 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.7295ms
2025-07-28 14:35:23.885 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:35:23.885 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:35:23.886 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:23.887 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:23.888 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.6072ms
2025-07-28 14:35:23.888 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.9528ms
2025-07-28 14:35:23.890 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:23.892 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:23.893 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:23.894 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:23.896 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:23.896 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:23.897 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:23.898 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:23.898 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:35:23.899 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:35:23.901 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:35:23.901 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:35:23.904 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:35:23.904 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:35:23.905 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:23.906 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:35:23.907 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:23.908 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:23.910 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:23.910 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:23.911 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:23.912 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:23.913 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:23.914 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:23.915 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:23.916 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:23.917 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:23.918 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:35:23.919 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:23.920 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:35:23.921 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:23.922 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:35:23.923 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:23.924 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 24.0684ms
2025-07-28 14:35:23.925 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:23.925 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:23.927 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 36.8846ms
2025-07-28 14:35:23.927 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:23.930 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:23.931 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:23.932 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:23.933 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:23.935 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:23.936 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:23.938 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:23.939 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:23.940 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:23.941 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:23.942 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:23.944 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:23.945 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:35:23.947 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:35:23.948 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:23.949 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:23.951 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:35:23.952 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:35:23.953 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:35:23.954 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:35:23.955 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 54.0949ms
2025-07-28 14:35:23.955 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:35:23.956 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 64.3272ms
2025-07-28 14:35:25.906 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:35:25.908 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:25.908 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 2.0032ms
2025-07-28 14:35:25.910 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:35:25.911 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:25.913 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:25.914 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.9224ms
2025-07-28 14:35:25.916 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:35:25.917 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:35:25.918 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:25.918 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.4005ms
2025-07-28 14:35:25.920 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:25.921 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:25.922 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:25.923 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:25.924 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:25.927 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:25.930 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:25.931 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.7322ms
2025-07-28 14:35:25.932 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:25.933 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.9265ms
2025-07-28 14:35:25.934 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:25.935 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:25.937 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:25.938 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:25.938 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:35:25.941 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:35:25.945 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:35:25.945 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4113ms
2025-07-28 14:35:25.946 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:35:25.947 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.4512ms
2025-07-28 14:35:25.948 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:35:25.950 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:35:25.951 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:35:25.952 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:25.952 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:35:25.955 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:35:25.958 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:35:25.959 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:35:25.961 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:25.963 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:25.964 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:25.965 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:25.966 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:35:25.968 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:35:25.969 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:35:25.970 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:35:25.971 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.1721ms
2025-07-28 14:35:25.972 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:35:25.973 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.2928ms
2025-07-28 14:37:12.653 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:37:12.654 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:12.655 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.7628ms
2025-07-28 14:37:12.656 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:12.657 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:12.703 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:12.704 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:12.705 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:37:12.709 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:37:12.713 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:37:12.715 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:37:12.717 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:12.718 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:12.720 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:12.721 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:12.723 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:12.724 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:37:12.726 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:37:12.728 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:37:12.729 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 23.2776ms
2025-07-28 14:37:12.729 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:12.730 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 73.6969ms
2025-07-28 14:37:13.527 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:37:13.529 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:13.529 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.8954ms
2025-07-28 14:37:13.531 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:37:13.532 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:13.533 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:13.534 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.4324ms
2025-07-28 14:37:13.536 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:37:13.537 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:37:13.538 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:13.538 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.433ms
2025-07-28 14:37:13.539 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:13.541 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:13.542 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:13.543 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:13.544 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:37:13.549 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:37:13.552 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:37:13.553 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.028ms
2025-07-28 14:37:13.553 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:13.554 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 14.3788ms
2025-07-28 14:37:13.556 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:13.557 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:13.558 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:13.559 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:13.559 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:37:13.563 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:37:13.566 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:37:13.567 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4455ms
2025-07-28 14:37:13.567 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:13.568 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.1446ms
2025-07-28 14:37:13.569 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:13.570 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:13.571 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:13.572 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:13.573 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:37:13.575 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:37:13.578 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:37:13.580 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:37:13.581 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:13.582 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:13.584 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:13.585 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:13.586 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:13.588 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:37:13.589 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:37:13.591 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:37:13.591 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.7752ms
2025-07-28 14:37:13.592 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:13.593 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 23.4079ms
2025-07-28 14:37:14.573 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:14.574 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:14.576 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:14.577 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:14.577 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:37:14.580 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:37:14.583 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:37:14.585 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:37:14.586 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:14.588 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:14.589 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:14.590 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:14.591 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:14.593 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:37:14.594 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:37:14.596 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:37:14.597 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.4424ms
2025-07-28 14:37:14.597 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:14.598 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 25.1862ms
2025-07-28 14:37:15.817 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:37:15.818 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:15.820 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:15.821 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.6968ms
2025-07-28 14:37:15.822 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:37:15.823 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:15.824 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:15.826 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:15.827 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:15.827 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:37:15.831 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:37:15.834 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:37:15.835 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.6555ms
2025-07-28 14:37:15.836 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:15.836 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.3394ms
2025-07-28 14:37:15.838 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:15.839 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:15.840 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:15.841 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:15.842 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:37:15.845 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:37:15.848 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:37:15.849 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4798ms
2025-07-28 14:37:15.850 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:15.850 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.3065ms
2025-07-28 14:37:15.852 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:15.853 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:15.854 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:15.855 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:15.856 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:37:15.858 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:37:15.861 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:37:15.863 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:37:15.864 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:15.865 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:15.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:15.868 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:15.869 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:15.870 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:37:15.872 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:37:15.873 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:37:15.874 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.2387ms
2025-07-28 14:37:15.874 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:15.875 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 23.2291ms
2025-07-28 14:37:23.498 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:37:23.500 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:23.500 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.7346ms
2025-07-28 14:37:23.502 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:23.503 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:23.504 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:23.505 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:23.506 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:37:23.508 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:37:23.511 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:37:23.513 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:37:23.514 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:23.516 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:23.517 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:23.518 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:23.519 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:23.521 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:37:23.522 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:37:23.523 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:37:23.524 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.749ms
2025-07-28 14:37:23.525 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:23.526 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.3151ms
2025-07-28 14:37:25.284 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:37:25.285 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:25.286 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.9823ms
2025-07-28 14:37:25.287 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:37:25.288 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:25.290 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:25.291 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.3027ms
2025-07-28 14:37:25.292 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:37:25.293 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:37:25.294 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:25.295 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 2.2092ms
2025-07-28 14:37:25.297 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:25.298 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:25.300 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:25.301 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:25.301 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:37:25.304 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:37:25.307 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:37:25.308 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.1725ms
2025-07-28 14:37:25.309 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:25.309 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.0733ms
2025-07-28 14:37:25.311 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:25.312 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:25.314 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:25.315 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:25.315 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:37:25.318 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:37:25.322 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:37:25.322 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.351ms
2025-07-28 14:37:25.323 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:25.324 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.8489ms
2025-07-28 14:37:25.326 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:25.327 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:25.328 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:25.329 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:25.330 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:37:25.332 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:37:25.335 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:37:25.337 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:37:25.338 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:25.339 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:25.340 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:25.342 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:25.343 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:25.344 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:37:25.346 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:37:25.347 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:37:25.348 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.6739ms
2025-07-28 14:37:25.349 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:25.350 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.0535ms
2025-07-28 14:37:30.584 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:37:30.586 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:30.586 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 2.0622ms
2025-07-28 14:37:30.588 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:37:30.589 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:30.590 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:30.591 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.6535ms
2025-07-28 14:37:30.593 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:37:30.594 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:37:30.595 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:30.596 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.789ms
2025-07-28 14:37:30.597 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:30.598 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:30.600 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:30.601 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:30.601 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:37:30.605 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:37:30.608 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:37:30.609 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.5105ms
2025-07-28 14:37:30.609 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:30.610 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.6884ms
2025-07-28 14:37:30.612 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:30.613 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:30.614 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:30.616 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:30.616 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:37:30.619 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:37:30.622 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:37:30.623 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.1384ms
2025-07-28 14:37:30.624 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:30.624 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.3755ms
2025-07-28 14:37:30.626 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:37:30.627 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:30.627 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.4513ms
2025-07-28 14:37:30.629 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:30.630 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:30.631 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:30.632 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:30.633 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:37:30.635 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:37:30.638 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:37:30.640 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:37:30.641 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:30.642 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:30.644 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:30.645 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:30.646 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:30.648 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:37:30.650 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:37:30.651 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:37:30.652 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.2928ms
2025-07-28 14:37:30.653 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:30.653 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.3407ms
2025-07-28 14:37:32.862 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:37:32.863 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:32.864 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:32.866 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.9857ms
2025-07-28 14:37:32.867 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:37:32.868 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:32.869 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:32.870 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:32.871 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:32.872 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:37:32.875 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:37:32.878 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:37:32.879 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4646ms
2025-07-28 14:37:32.880 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:32.880 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.3961ms
2025-07-28 14:37:32.882 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:32.883 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:32.884 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:32.885 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:32.886 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:37:32.889 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:37:32.893 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:37:32.893 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4645ms
2025-07-28 14:37:32.894 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:32.895 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.655ms
2025-07-28 14:37:32.897 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:32.898 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:32.899 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:32.900 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:32.901 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:37:32.903 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:37:32.906 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:37:32.908 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:37:32.909 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:32.910 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:32.912 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:32.913 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:32.914 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:32.916 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:37:32.918 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:37:32.919 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:37:32.920 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.0578ms
2025-07-28 14:37:32.920 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:32.921 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.1789ms
2025-07-28 14:37:37.962 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - null null
2025-07-28 14:37:37.964 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:37.964 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 204 null null 1.8137ms
2025-07-28 14:37:37.966 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - application/json null
2025-07-28 14:37:37.967 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:37.968 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:37.970 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats - 404 0 null 3.7785ms
2025-07-28 14:37:37.971 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/f9f0e64e-3771-4aa9-8470-21e709677e44/instructor-stats, Response status code: 404
2025-07-28 14:37:37.972 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:37:37.973 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:37.974 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.5088ms
2025-07-28 14:37:37.975 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:37.976 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:37.978 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:37.979 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:37.979 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:37:37.983 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:37:37.986 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:37:37.987 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.6675ms
2025-07-28 14:37:37.988 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:37.988 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 13.0475ms
2025-07-28 14:37:37.990 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:37.991 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:37.992 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:37.993 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:37.993 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:37:37.997 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:37:38.001 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:37:38.001 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.0217ms
2025-07-28 14:37:38.002 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:37:38.003 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 12.852ms
2025-07-28 14:37:38.004 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:37:38.005 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:38.006 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.5353ms
2025-07-28 14:37:38.007 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:37:38.008 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:37:38.009 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:37:38.010 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:38.011 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:37:38.014 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:37:38.019 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:37:38.020 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:37:38.022 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:38.023 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:38.024 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:38.025 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:38.027 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:37:38.028 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:37:38.030 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:37:38.031 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:37:38.032 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 19.6275ms
2025-07-28 14:37:38.033 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:37:38.033 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 26.3652ms
2025-07-28 14:38:51.729 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:38:51.730 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:38:51.731 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.9162ms
2025-07-28 14:38:51.732 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:38:51.733 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:38:51.735 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:38:51.736 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:38:51.737 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:38:51.738 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:38:51.740 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:38:51.742 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:51.744 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:51.746 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:51.748 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:51.749 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:51.751 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:51.752 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:51.754 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:51.755 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:51.756 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:51.757 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:51.759 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:51.760 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:51.762 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:51.763 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:51.764 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:51.765 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:51.767 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:51.768 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:51.770 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:51.771 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:51.772 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:51.773 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:51.775 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:51.776 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:51.778 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:51.779 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:51.780 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:51.782 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:51.783 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:51.784 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:51.785 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:38:51.786 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 48.6455ms
2025-07-28 14:38:51.787 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:38:51.787 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 55.2217ms
2025-07-28 14:38:51.789 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:38:51.790 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:38:51.790 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.3832ms
2025-07-28 14:38:51.792 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:38:51.793 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:38:51.794 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:38:51.795 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:38:51.795 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:38:51.798 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:38:51.801 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:38:51.803 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:38:51.804 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:51.806 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:51.807 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:51.808 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:51.809 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:51.811 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:38:51.813 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:38:51.814 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:38:51.815 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.7298ms
2025-07-28 14:38:51.816 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:38:51.816 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 24.7034ms
2025-07-28 14:38:56.088 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:38:56.090 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:38:56.091 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:38:56.092 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:38:56.092 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:38:56.094 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:38:56.096 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:38:56.098 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:56.099 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:56.101 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:56.102 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:56.104 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:56.105 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:56.107 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:56.108 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:56.109 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:56.111 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:56.112 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:56.114 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:56.115 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:56.117 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:56.118 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:56.119 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:56.120 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:56.122 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:56.123 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:56.125 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:56.126 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:56.127 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:56.128 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:56.129 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:56.131 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:56.132 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:56.134 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:56.135 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:56.136 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:56.137 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:56.139 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:56.140 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:38:56.141 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 47.2402ms
2025-07-28 14:38:56.141 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:38:56.142 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 53.2483ms
2025-07-28 14:38:56.143 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:38:56.145 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:38:56.146 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:38:56.147 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:38:56.147 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:38:56.150 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:38:56.153 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:38:56.154 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:38:56.156 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:56.157 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:56.158 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:56.159 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:56.160 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:56.162 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:38:56.164 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:38:56.165 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:38:56.166 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.5648ms
2025-07-28 14:38:56.167 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:38:56.167 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 23.6936ms
2025-07-28 14:38:57.976 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:38:57.977 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:38:57.978 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.7339ms
2025-07-28 14:38:57.979 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:38:57.980 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:38:57.982 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:38:57.983 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:38:57.983 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:38:57.985 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:38:57.987 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:38:57.988 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:57.990 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:57.991 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:57.993 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:57.994 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:57.996 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:57.997 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:57.999 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:58.000 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:58.001 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:58.002 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:58.004 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:58.006 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:58.007 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:58.008 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:58.009 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:58.011 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:58.012 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:58.014 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:58.015 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:58.016 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:58.018 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:58.019 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:58.020 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:58.022 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:38:58.023 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:38:58.024 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:58.026 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:58.027 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:38:58.028 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:38:58.030 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:38:58.031 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:38:58.031 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 47.0846ms
2025-07-28 14:38:58.032 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:38:58.033 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 53.6351ms
2025-07-28 14:38:58.034 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:38:58.036 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:38:58.036 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.5381ms
2025-07-28 14:38:58.037 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:38:58.039 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:38:58.040 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:38:58.041 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:38:58.042 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:38:58.044 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:38:58.047 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:38:58.048 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:38:58.050 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:58.051 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:58.052 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:58.053 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:58.054 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:38:58.056 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:38:58.057 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:38:58.059 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:38:58.060 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.2394ms
2025-07-28 14:38:58.060 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:38:58.061 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 23.5945ms
2025-07-28 14:39:00.094 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:39:00.096 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:39:00.097 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:39:00.099 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:39:00.099 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:39:00.101 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:39:00.102 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:39:00.104 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:00.106 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:00.108 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:00.109 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:00.110 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:00.112 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:00.113 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:00.115 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:00.116 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:00.117 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:00.119 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:00.120 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:00.122 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:00.123 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:00.124 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:00.125 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:00.127 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:00.128 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:00.130 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:00.131 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:00.133 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:00.134 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:00.135 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:00.136 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:00.138 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:00.139 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:00.140 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:00.142 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:00.143 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:00.144 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:00.146 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:00.147 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:39:00.148 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 47.908ms
2025-07-28 14:39:00.148 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:39:00.149 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 54.7456ms
2025-07-28 14:39:00.151 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:39:00.152 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:39:00.153 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:39:00.154 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:39:00.155 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:39:00.157 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:39:00.159 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:39:00.161 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:39:00.162 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:00.164 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:00.165 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:00.166 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:00.168 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:00.169 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:39:00.171 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:39:00.172 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:39:00.173 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.2652ms
2025-07-28 14:39:00.173 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:39:00.174 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 23.3108ms
2025-07-28 14:39:02.111 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:39:02.112 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:39:02.114 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:39:02.115 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:39:02.115 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:39:02.117 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:39:02.119 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:39:02.121 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:02.123 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:02.124 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:02.126 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:02.127 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:02.129 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:02.131 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:02.133 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:02.134 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:02.135 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:02.137 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:02.138 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:02.140 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:02.142 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:02.143 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:02.144 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:02.146 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:02.148 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:02.149 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:02.151 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:02.152 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:02.154 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:02.155 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:02.156 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:02.158 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:02.160 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:02.161 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:02.162 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:02.164 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:02.166 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:02.167 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:02.168 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:39:02.169 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 52.5249ms
2025-07-28 14:39:02.170 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:39:02.170 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 59.5825ms
2025-07-28 14:39:02.172 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:39:02.173 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:39:02.175 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:39:02.176 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:39:02.177 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:39:02.179 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:39:02.182 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:39:02.184 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:39:02.186 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:02.187 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:02.188 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:02.190 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:02.191 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:02.193 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:39:02.195 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:39:02.196 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:39:02.197 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 19.8066ms
2025-07-28 14:39:02.198 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:39:02.199 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 26.6936ms
2025-07-28 14:39:11.908 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:39:11.909 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:39:11.909 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.6497ms
2025-07-28 14:39:11.911 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:39:11.912 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:39:11.913 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:39:11.914 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:39:11.915 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:39:11.917 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:39:11.918 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:39:11.920 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:11.922 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:11.923 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:11.925 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:11.926 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:11.928 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:11.929 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:11.931 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:11.932 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:11.933 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:11.934 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:11.936 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:11.938 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:11.939 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:11.940 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:11.941 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:11.943 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:11.944 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:11.946 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:11.947 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:11.948 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:11.949 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:11.951 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:11.952 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:11.953 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:39:11.955 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:39:11.956 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:11.957 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:11.959 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:39:11.960 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:39:11.961 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:39:11.962 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:39:11.963 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 47.6166ms
2025-07-28 14:39:11.964 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:39:11.965 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 53.8743ms
2025-07-28 14:39:11.966 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:39:11.967 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:39:11.968 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.4409ms
2025-07-28 14:39:11.969 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:39:11.970 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:39:11.971 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:39:11.972 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:39:11.973 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:39:11.975 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:39:11.978 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:39:11.980 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:39:11.981 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:11.982 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:11.984 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:11.985 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:11.986 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:39:11.988 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:39:11.989 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:39:11.990 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:39:11.991 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.5154ms
2025-07-28 14:39:11.992 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:39:11.993 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 23.6524ms
2025-07-28 14:40:34.337 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:40:34.339 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:34.339 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.7724ms
2025-07-28 14:40:34.340 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:40:34.342 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:34.343 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:40:34.344 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:40:34.345 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:40:34.347 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:40:34.350 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:40:34.352 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:40:34.354 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:34.355 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:34.357 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:34.358 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:34.359 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:34.361 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:40:34.362 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:40:34.363 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:40:34.364 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.6924ms
2025-07-28 14:40:34.365 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:40:34.366 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 25.0941ms
2025-07-28 14:40:35.383 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:40:35.384 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:35.385 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.893ms
2025-07-28 14:40:35.386 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:40:35.387 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:35.389 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:40:35.390 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:40:35.390 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:40:35.392 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:40:35.393 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:40:35.395 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:35.397 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:35.398 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:35.400 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:35.401 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:35.403 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:35.404 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:35.406 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:35.407 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:35.408 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:35.410 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:35.411 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:35.413 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:35.414 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:35.415 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:35.417 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:35.418 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:35.419 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:35.421 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:35.422 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:35.423 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:35.425 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:35.426 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:35.427 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:35.429 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:35.430 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:35.432 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:35.433 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:35.434 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:35.435 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:35.437 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:35.438 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:40:35.439 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 47.3467ms
2025-07-28 14:40:35.439 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:40:35.440 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 53.4908ms
2025-07-28 14:40:35.441 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:40:35.442 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:35.444 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:40:35.445 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:40:35.445 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:40:35.447 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:40:35.451 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:40:35.452 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:40:35.454 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:35.455 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:35.456 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:35.457 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:35.459 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:35.460 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:40:35.462 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:40:35.463 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:40:35.464 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.9522ms
2025-07-28 14:40:35.465 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:40:35.465 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 23.8118ms
2025-07-28 14:40:36.508 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:40:36.509 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:36.510 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:40:36.512 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:40:36.512 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:40:36.514 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:40:36.518 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:40:36.519 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:40:36.520 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:36.522 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:36.523 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:36.524 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:36.525 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:36.527 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:40:36.528 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:40:36.529 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:40:36.530 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.2645ms
2025-07-28 14:40:36.531 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:40:36.531 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 23.5747ms
2025-07-28 14:40:39.935 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:40:39.936 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:39.938 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:40:39.939 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:40:39.939 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:40:39.941 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:40:39.943 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:40:39.945 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:39.946 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:39.948 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:39.949 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:39.951 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:39.953 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:39.954 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:39.956 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:39.957 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:39.958 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:39.959 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:39.961 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:39.962 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:39.964 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:39.965 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:39.966 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:39.968 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:39.969 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:39.971 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:39.972 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:39.973 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:39.975 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:39.976 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:39.977 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:39.978 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:39.980 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:39.981 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:39.983 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:39.984 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:39.985 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:39.987 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:39.988 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:40:39.988 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 48.3589ms
2025-07-28 14:40:39.989 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:40:39.990 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 54.7223ms
2025-07-28 14:40:39.991 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:40:39.992 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:39.993 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.4348ms
2025-07-28 14:40:39.994 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:40:39.995 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:39.996 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:40:39.997 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:40:39.998 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:40:40.000 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:40:40.003 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:40:40.005 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:40:40.006 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:40.007 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:40.008 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:40.010 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:40.011 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:40.013 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:40:40.014 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:40:40.015 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:40:40.016 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.9983ms
2025-07-28 14:40:40.017 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:40:40.018 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 23.647ms
2025-07-28 14:40:55.074 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:40:55.075 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:55.075 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.8141ms
2025-07-28 14:40:55.077 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:40:55.078 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:55.079 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:40:55.080 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:40:55.081 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:40:55.083 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:40:55.084 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:40:55.086 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:55.088 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:55.089 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:55.090 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:55.091 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:55.093 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:55.094 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:55.096 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:55.097 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:55.098 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:55.099 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:55.101 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:55.103 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:55.104 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:55.105 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:55.106 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:55.108 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:55.109 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:55.111 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:55.112 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:55.113 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:55.114 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:55.116 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:55.117 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:55.119 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."StudentId" = p."UserId" AND e."CourseId" = @__courseId_0) AND p."Status" = 'Completed' AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = p."UserId" AND s."Status" = 'Active' AND s."StartDate" <= p."CreatedAt")
2025-07-28 14:40:55.120 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."BillingCycle", s."CreatedAt", s."EndDate", s."NextBillingDate", s."PlanName", s."Price", s."StartDate", s."Status", s."StripeSubscriptionId", s."SubscriptionPlanId", s."UpdatedAt", s."UserId", s0."Id", s0."CreatedAt", s0."Description", s0."Features", s0."HasUnlimitedAccess", s0."IsActive", s0."MaxCourseAccess", s0."MonthlyPrice", s0."Name", s0."UpdatedAt", s0."YearlyPrice"
FROM "Subscriptions" AS s
INNER JOIN "SubscriptionPlans" AS s0 ON s."SubscriptionPlanId" = s0."Id"
WHERE s."Status" = 'Active' AND EXISTS (
    SELECT 1
    FROM "Enrollments" AS e
    WHERE e."CourseId" = @__courseId_0 AND e."StudentId" = s."UserId" AND e."EnrolledAt" >= s."StartDate")
2025-07-28 14:40:55.122 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:55.123 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:55.124 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
WHERE c."Status" = 'Active'
2025-07-28 14:40:55.125 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0
2025-07-28 14:40:55.127 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
WHERE e."CourseId" = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM "Subscriptions" AS s
    WHERE s."UserId" = e."StudentId" AND s."Status" = 'Active' AND s."StartDate" <= e."EnrolledAt")
2025-07-28 14:40:55.128 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:40:55.128 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 46.3948ms
2025-07-28 14:40:55.129 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:40:55.129 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 52.4557ms
2025-07-28 14:40:55.131 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - null null
2025-07-28 14:40:55.132 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:55.133 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 204 null null 1.7182ms
2025-07-28 14:40:55.134 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - application/json null
2025-07-28 14:40:55.135 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:55.136 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:40:55.138 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:40:55.138 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:40:55.140 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:40:55.144 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:40:55.145 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:40:55.147 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:55.148 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:55.149 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:55.150 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:55.152 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."CourseId" = @__c_Id_0 AND p."Status" = 'Completed'
2025-07-28 14:40:55.153 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:40:55.155 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:40:55.156 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:40:55.157 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.8794ms
2025-07-28 14:40:55.157 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:40:55.158 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/f9f0e64e-3771-4aa9-8470-21e709677e44 - 200 null application/json; charset=utf-8 23.9915ms
2025-07-28 14:40:57.758 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-28 14:40:57.760 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:57.760 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 1.7897ms
2025-07-28 14:40:57.762 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-28 14:40:57.763 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:57.764 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:40:57.765 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 14:40:57.768 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 14:40:57.781 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-28 14:40:57.787 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
UPDATE "RefreshTokens" SET "RevokedAt" = @p2
WHERE "Id" = @p3;
2025-07-28 14:40:57.797 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType26`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:40:57.799 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 29.8385ms
2025-07-28 14:40:57.800 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 14:40:57.801 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 39.0467ms
2025-07-28 14:40:57.832 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:40:57.834 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:57.835 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.5344ms
2025-07-28 14:40:57.837 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:40:57.839 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:57.840 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:40:57.840 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:40:57.845 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:40:57.849 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:40:57.850 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.0855ms
2025-07-28 14:40:57.851 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:40:57.851 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 14.3667ms
2025-07-28 14:40:57.857 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:40:57.859 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:57.860 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.5892ms
2025-07-28 14:40:57.863 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:40:57.864 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:40:57.865 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:40:57.868 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-28 14:40:57.868 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 5.4499ms
2025-07-28 14:41:01.035 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-28 14:41:01.037 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:41:01.037 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 2.0488ms
2025-07-28 14:41:01.039 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 51
2025-07-28 14:41:01.040 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:41:01.041 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 14:41:01.041 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 14:41:01.050 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:41:01.098 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-28 14:41:01.100 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-28 14:41:01.101 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 58.6862ms
2025-07-28 14:41:01.102 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 14:41:01.102 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 63.3453ms
2025-07-28 14:41:01.119 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:41:01.120 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:41:01.121 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:41:01.122 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:41:01.123 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.3542ms
2025-07-28 14:41:01.123 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.9236ms
2025-07-28 14:41:01.125 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:41:01.127 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:41:01.128 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:41:01.129 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:41:01.131 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:41:01.132 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:41:01.134 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:41:01.139 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:41:01.143 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:41:01.146 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:41:01.149 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:41:01.165 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:41:01.175 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:41:01.177 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:41:01.178 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:41:01.178 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:41:01.182 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:41:01.182 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:41:01.185 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:41:01.186 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.8401ms
2025-07-28 14:41:01.187 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:41:01.187 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 60.5116ms
2025-07-28 14:41:01.190 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:41:01.194 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:41:01.199 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:41:01.202 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:41:01.210 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 74.7854ms
2025-07-28 14:41:01.211 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:41:01.211 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 86.3314ms
2025-07-28 14:41:03.746 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:41:03.747 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:41:03.749 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:41:03.750 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:41:03.750 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:41:03.752 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:41:03.754 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:41:03.755 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:41:03.756 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:41:03.761 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:41:03.764 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:41:03.765 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:41:03.767 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:41:03.768 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:41:03.770 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:41:03.771 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:41:03.772 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 20.5372ms
2025-07-28 14:41:03.773 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:41:03.773 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 27.2446ms
2025-07-28 14:41:05.038 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:41:05.040 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:41:05.042 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:41:05.043 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:41:05.043 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:41:05.047 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:41:05.050 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:41:05.051 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.0221ms
2025-07-28 14:41:05.052 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:41:05.053 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 14.3096ms
2025-07-28 14:41:05.055 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:41:05.056 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:41:05.057 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:41:05.058 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:41:05.059 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:41:05.061 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:41:05.062 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:41:05.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:41:05.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:41:05.069 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:41:05.072 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:41:05.074 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:41:05.076 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:41:05.078 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:41:05.079 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:41:05.080 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:41:05.081 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 21.2378ms
2025-07-28 14:41:05.082 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:41:05.083 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 28.1194ms
2025-07-28 14:44:44.709 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:44:44.711 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:44:44.712 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.3743ms
2025-07-28 14:44:44.714 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:44:44.715 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:44:44.717 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:44:44.719 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:44:44.719 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:44:44.724 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:44:44.728 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:44:44.730 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.1676ms
2025-07-28 14:44:44.730 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:44:44.731 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 17.2654ms
2025-07-28 14:44:44.733 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:44:44.735 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:44:44.736 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.1981ms
2025-07-28 14:44:44.737 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:44:44.739 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:44:44.740 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:44:44.741 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:44:44.742 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:44:44.744 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:44:44.746 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:44:44.747 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:44:44.748 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:44:44.752 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:44:44.755 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:44:44.758 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:44:44.760 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:44:44.761 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:44:44.762 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:44:44.764 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:44:44.765 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 21.5311ms
2025-07-28 14:44:44.766 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:44:44.766 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 28.7186ms
2025-07-28 14:45:15.713 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:45:15.715 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:45:15.715 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.6644ms
2025-07-28 14:45:15.717 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:45:15.718 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:45:15.719 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:45:15.720 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:45:15.720 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:45:15.724 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:45:15.727 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:45:15.728 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.7091ms
2025-07-28 14:45:15.729 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:45:15.729 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 12.5735ms
2025-07-28 14:45:15.731 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:45:15.732 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:45:15.732 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.6402ms
2025-07-28 14:45:15.734 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:45:15.735 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:45:15.736 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:45:15.738 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:45:15.738 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:45:15.739 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:45:15.741 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:45:15.742 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:45:15.743 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:45:15.746 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:45:15.748 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:45:15.750 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:45:15.751 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:45:15.752 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:45:15.754 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:45:15.755 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:45:15.756 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 16.5647ms
2025-07-28 14:45:15.756 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:45:15.757 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 22.9661ms
2025-07-28 14:45:26.412 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:45:26.413 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:45:26.414 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.5773ms
2025-07-28 14:45:26.415 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:45:26.417 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:45:26.418 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:45:26.419 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:45:26.419 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:45:26.423 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:45:26.427 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:45:26.428 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.4774ms
2025-07-28 14:45:26.428 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:45:26.429 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.6699ms
2025-07-28 14:45:26.431 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:45:26.432 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:45:26.432 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.5009ms
2025-07-28 14:45:26.433 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:45:26.435 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:45:26.436 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:45:26.437 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:45:26.437 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:45:26.439 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:45:26.440 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:45:26.441 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:45:26.442 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:45:26.445 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:45:26.447 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:45:26.449 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:45:26.450 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:45:26.452 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:45:26.453 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:45:26.454 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:45:26.455 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 16.676ms
2025-07-28 14:45:26.456 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:45:26.456 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 22.6799ms
2025-07-28 14:45:48.636 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:45:48.638 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:45:48.639 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.3649ms
2025-07-28 14:45:48.641 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:45:48.642 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:45:48.644 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:45:48.645 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:45:48.646 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:45:48.650 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:45:48.653 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:45:48.654 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.1217ms
2025-07-28 14:45:48.655 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:45:48.656 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 15.3806ms
2025-07-28 14:45:48.658 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:45:48.660 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:45:48.660 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.0767ms
2025-07-28 14:45:48.663 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:45:48.664 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:45:48.666 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:45:48.668 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:45:48.668 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:45:48.670 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:45:48.672 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:45:48.673 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:45:48.675 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:45:48.678 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:45:48.681 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:45:48.683 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:45:48.684 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:45:48.686 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:45:48.688 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:45:48.689 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:45:48.690 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 20.5366ms
2025-07-28 14:45:48.691 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:45:48.692 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 29.2142ms
2025-07-28 14:45:48.694 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:45:48.695 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:45:48.697 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:45:48.698 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:45:48.699 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:45:48.701 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:45:48.702 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:45:48.704 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:45:48.705 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:45:48.709 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:45:48.712 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:45:48.714 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:45:48.715 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:45:48.717 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:45:48.719 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:45:48.720 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:45:48.721 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 21.313ms
2025-07-28 14:45:48.722 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:45:48.723 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 29.1042ms
2025-07-28 14:46:28.047 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:46:28.049 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:46:28.049 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.663ms
2025-07-28 14:46:28.050 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:46:28.051 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:46:28.053 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:46:28.054 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:46:28.055 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:46:28.059 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:46:28.062 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:46:28.063 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.8585ms
2025-07-28 14:46:28.064 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:46:28.064 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.6028ms
2025-07-28 14:46:28.066 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:46:28.067 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:46:28.067 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.596ms
2025-07-28 14:46:28.069 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:46:28.070 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:46:28.072 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:46:28.073 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:46:28.074 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:46:28.075 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:46:28.076 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:46:28.078 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:46:28.079 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:46:28.082 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:46:28.084 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:46:28.085 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:46:28.087 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:46:28.088 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:46:28.090 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:46:28.091 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:46:28.092 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 17.059ms
2025-07-28 14:46:28.092 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:46:28.093 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 23.9113ms
2025-07-28 14:46:28.094 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:46:28.095 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:46:28.097 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:46:28.098 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:46:28.099 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:46:28.100 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:46:28.101 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:46:28.102 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:46:28.104 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:46:28.107 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:46:28.109 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:46:28.111 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:46:28.112 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:46:28.113 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:46:28.115 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:46:28.115 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:46:28.116 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 16.9178ms
2025-07-28 14:46:28.117 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:46:28.117 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 23.1045ms
2025-07-28 14:49:04.804 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:49:04.804 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:49:04.805 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:04.807 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:04.807 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.3082ms
2025-07-28 14:49:04.807 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.5409ms
2025-07-28 14:49:04.809 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:49:04.810 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:49:04.811 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:04.812 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:04.863 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:04.864 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:49:04.865 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:49:04.867 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:49:04.869 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:49:04.871 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:49:04.872 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:49:04.876 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:49:04.879 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:49:04.880 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:49:04.882 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:49:04.884 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:49:04.885 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:49:04.886 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:49:04.887 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 21.2307ms
2025-07-28 14:49:04.887 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:49:04.888 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 78.9656ms
2025-07-28 14:49:04.965 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:04.966 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:49:04.966 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:49:04.971 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:49:04.977 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:49:04.978 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 10.6723ms
2025-07-28 14:49:04.979 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:49:04.979 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 169.0042ms
2025-07-28 14:49:11.277 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:49:11.279 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:11.279 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.9478ms
2025-07-28 14:49:11.281 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:49:11.282 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:11.283 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:11.285 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:49:11.285 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:49:11.289 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:49:11.292 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:49:11.293 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.4763ms
2025-07-28 14:49:11.294 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:49:11.295 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.9756ms
2025-07-28 14:49:11.297 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:49:11.298 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:11.298 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.7286ms
2025-07-28 14:49:11.300 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:49:11.301 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:11.303 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:11.304 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:49:11.305 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:49:11.306 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:49:11.309 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:49:11.310 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:49:11.312 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:49:11.315 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:49:11.319 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:49:11.321 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:49:11.323 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:49:11.325 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:49:11.327 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:49:11.328 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:49:11.329 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 23.7104ms
2025-07-28 14:49:11.330 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:49:11.331 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 30.7647ms
2025-07-28 14:49:11.333 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:49:11.334 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:11.335 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:11.337 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:49:11.337 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:49:11.339 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:49:11.340 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:49:11.342 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:49:11.343 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:49:11.348 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:49:11.351 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:49:11.353 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:49:11.355 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:49:11.356 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:49:11.358 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:49:11.359 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:49:11.360 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 21.7707ms
2025-07-28 14:49:11.361 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:49:11.361 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 28.4401ms
2025-07-28 14:49:16.249 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:49:16.249 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:49:16.250 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:16.252 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:16.253 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:16.253 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:16.254 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:49:16.255 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:49:16.256 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:49:16.256 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:49:16.259 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:49:16.260 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:49:16.261 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:49:16.262 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:49:16.265 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:49:16.265 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:49:16.266 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.5148ms
2025-07-28 14:49:16.267 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:49:16.268 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 18.6539ms
2025-07-28 14:49:16.268 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:49:16.272 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:49:16.274 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:49:16.276 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:49:16.277 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:49:16.279 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:49:16.280 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:49:16.281 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 23.053ms
2025-07-28 14:49:16.282 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:49:16.282 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 33.1355ms
2025-07-28 14:49:20.152 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/profile - null null
2025-07-28 14:49:20.153 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:20.153 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/profile - 204 null null 1.6508ms
2025-07-28 14:49:20.155 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/profile - application/json null
2025-07-28 14:49:20.156 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:20.158 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:20.159 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/profile - 404 0 null 3.9615ms
2025-07-28 14:49:20.160 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/profile, Response status code: 404
2025-07-28 14:49:20.161 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21 - null null
2025-07-28 14:49:20.162 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:20.162 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21 - 204 null null 1.3221ms
2025-07-28 14:49:20.164 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21 - application/json null
2025-07-28 14:49:20.165 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:20.166 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:20.167 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-07-28 14:49:20.169 +08:00 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUser(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-07-28 14:49:20.172 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:49:20.174 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserDto'.
2025-07-28 14:49:20.175 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api) in 4.9523ms
2025-07-28 14:49:20.176 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-07-28 14:49:20.176 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21 - 200 null application/json; charset=utf-8 12.6067ms
2025-07-28 14:49:20.178 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/stats - null null
2025-07-28 14:49:20.179 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:20.180 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/stats - 204 null null 1.7474ms
2025-07-28 14:49:20.181 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/stats - application/json null
2025-07-28 14:49:20.182 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:20.183 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:20.184 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-07-28 14:49:20.187 +08:00 [INF] Route matched with {action = "GetUserStats", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserStats(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-07-28 14:49:20.194 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-28 14:49:20.209 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", s."Id", s."Category", s."CreatedAt", s."Description", s."Discount", s."Duration", s."EnrollmentType", s."Features", s."InstructorId", s."IsBestseller", s."Level", s."OriginalPrice", s."PreviewUrl", s."Price", s."Status", s."Thumbnail", s."Title", s."UpdatedAt", s."Id0", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id1", s."ApprovedAt", s."ApprovedBy", s."Comment", s."CourseId0", s."CreatedAt0", s."Rating", s."Status0", s."StudentId0"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", e."Id" AS "Id0", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", r."Id" AS "Id1", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId" AS "CourseId0", r."CreatedAt" AS "CreatedAt0", r."Rating", r."Status" AS "Status0", r."StudentId" AS "StudentId0"
    FROM "Courses" AS c
    LEFT JOIN "Enrollments" AS e ON c."Id" = e."CourseId"
    LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
) AS s ON a0."Id" = s."InstructorId"
ORDER BY a0."Id", s."Id", s."Id0"
2025-07-28 14:49:20.214 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserStatsDto'.
2025-07-28 14:49:20.218 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api) in 30.129ms
2025-07-28 14:49:20.219 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-07-28 14:49:20.219 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/stats - 200 null application/json; charset=utf-8 37.9213ms
2025-07-28 14:49:20.221 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/certificates - null null
2025-07-28 14:49:20.222 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:20.222 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/certificates - 204 null null 1.4768ms
2025-07-28 14:49:20.223 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/certificates - application/json null
2025-07-28 14:49:20.225 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:20.226 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:20.227 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/certificates - 404 0 null 3.4149ms
2025-07-28 14:49:20.228 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/certificates, Response status code: 404
2025-07-28 14:49:20.229 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/activity - null null
2025-07-28 14:49:20.230 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:20.231 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/activity - 204 null null 1.488ms
2025-07-28 14:49:20.232 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/activity - application/json null
2025-07-28 14:49:20.233 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:20.234 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:20.235 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/activity - 404 0 null 3.2551ms
2025-07-28 14:49:20.237 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/28b8e854-738a-4e69-835c-71299a8f9b21/activity, Response status code: 404
2025-07-28 14:49:20.238 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - null null
2025-07-28 14:49:20.239 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:20.239 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/admin/stats - 204 null null 1.3408ms
2025-07-28 14:49:20.241 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/admin/stats - application/json null
2025-07-28 14:49:20.242 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:20.243 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:20.244 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/admin/stats - 404 0 null 3.2716ms
2025-07-28 14:49:20.245 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/admin/stats, Response status code: 404
2025-07-28 14:49:24.322 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:49:24.323 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:24.324 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.6715ms
2025-07-28 14:49:24.325 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:49:24.326 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:24.328 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:24.329 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:49:24.329 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:49:24.333 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:49:24.337 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:49:24.338 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.278ms
2025-07-28 14:49:24.338 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:49:24.339 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.5442ms
2025-07-28 14:49:24.341 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:49:24.342 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:24.342 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.6561ms
2025-07-28 14:49:24.344 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:49:24.345 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:24.346 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:24.347 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:49:24.348 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:49:24.350 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:49:24.351 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:49:24.353 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:49:24.354 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:49:24.357 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:49:24.360 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:49:24.361 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:49:24.363 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:49:24.365 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:49:24.366 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:49:24.367 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:49:24.368 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 18.8408ms
2025-07-28 14:49:24.369 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:49:24.369 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 25.4032ms
2025-07-28 14:49:24.371 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:49:24.372 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:24.373 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:24.374 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:49:24.375 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:49:24.376 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:49:24.377 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:49:24.379 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:49:24.380 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:49:24.383 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:49:24.386 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:49:24.387 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:49:24.389 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:49:24.390 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:49:24.391 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:49:24.392 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:49:24.394 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 18.1151ms
2025-07-28 14:49:24.394 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:49:24.395 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 24.2233ms
2025-07-28 14:49:48.020 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:49:48.021 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:48.022 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.1977ms
2025-07-28 14:49:48.024 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:49:48.026 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:48.027 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:48.028 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:49:48.029 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:49:48.030 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:49:48.031 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:49:48.033 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:49:48.034 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:49:48.037 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:49:48.039 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:49:48.041 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:49:48.042 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:49:48.044 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:49:48.045 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:49:48.046 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:49:48.047 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 17.1354ms
2025-07-28 14:49:48.047 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:49:48.048 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 24.0686ms
2025-07-28 14:49:51.722 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:49:51.723 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.724 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.6785ms
2025-07-28 14:49:51.725 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:49:51.726 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.728 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:51.729 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:49:51.729 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:49:51.733 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:49:51.736 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:49:51.736 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.233ms
2025-07-28 14:49:51.737 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:49:51.738 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 12.7201ms
2025-07-28 14:49:51.739 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses/59 - null null
2025-07-28 14:49:51.740 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses/60 - null null
2025-07-28 14:49:51.742 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.742 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses/58 - null null
2025-07-28 14:49:51.742 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses/57 - null null
2025-07-28 14:49:51.742 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses/56 - null null
2025-07-28 14:49:51.742 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses/61 - null null
2025-07-28 14:49:51.743 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.743 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses/59 - 204 null null 3.6819ms
2025-07-28 14:49:51.744 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.745 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.746 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.748 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.748 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses/60 - 204 null null 7.7586ms
2025-07-28 14:49:51.749 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses/55 - null null
2025-07-28 14:49:51.750 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses/58 - 204 null null 8.1235ms
2025-07-28 14:49:51.750 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses/57 - 204 null null 8.3297ms
2025-07-28 14:49:51.751 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses/56 - 204 null null 8.8825ms
2025-07-28 14:49:51.751 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses/61 - 204 null null 9.0469ms
2025-07-28 14:49:51.752 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses/59 - application/json null
2025-07-28 14:49:51.753 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.755 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses/60 - application/json null
2025-07-28 14:49:51.756 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses/58 - application/json null
2025-07-28 14:49:51.757 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses/57 - application/json null
2025-07-28 14:49:51.759 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses/56 - application/json null
2025-07-28 14:49:51.760 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.760 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses/55 - 204 null null 10.7472ms
2025-07-28 14:49:51.761 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.763 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.764 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.765 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.766 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:51.766 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses/61 - application/json null
2025-07-28 14:49:51.767 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:51.769 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-07-28 14:49:51.770 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.771 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-07-28 14:49:51.773 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:51.774 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:49:51.774 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-07-28 14:49:51.774 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:49:51.776 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:49:51.782 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-28 14:49:51.806 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."Category", s."CreatedAt", s."Description", s."Discount", s."Duration", s."EnrollmentType", s."Features", s."InstructorId", s."IsBestseller", s."Level", s."OriginalPrice", s."PreviewUrl", s."Price", s."Status", s."Thumbnail", s."Title", s."UpdatedAt", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt0", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0."Id", s0."CourseId", s0."CreatedAt", s0."Description", s0."Order", s0."Title", s0."UpdatedAt", s0."Id0", s0."Content", s0."CreatedAt0", s0."Duration", s0."ModuleId", s0."Order0", s0."Title0", s0."Type", s0."UpdatedAt0", s0."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt" AS "CreatedAt0", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM "Courses" AS c
    INNER JOIN "AspNetUsers" AS a ON c."InstructorId" = a."Id"
    WHERE c."Id" = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0."Id", c0."CourseId", c0."CreatedAt", c0."Description", c0."Order", c0."Title", c0."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c0
    LEFT JOIN "Lessons" AS l ON c0."Id" = l."ModuleId"
) AS s0 ON s."Id" = s0."CourseId"
LEFT JOIN "Reviews" AS r ON s."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON s."Id" = e."CourseId"
ORDER BY s."Id", s."Id0", s0."Id", s0."Id0", r."Id"
2025-07-28 14:49:51.806 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."Category", s."CreatedAt", s."Description", s."Discount", s."Duration", s."EnrollmentType", s."Features", s."InstructorId", s."IsBestseller", s."Level", s."OriginalPrice", s."PreviewUrl", s."Price", s."Status", s."Thumbnail", s."Title", s."UpdatedAt", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt0", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0."Id", s0."CourseId", s0."CreatedAt", s0."Description", s0."Order", s0."Title", s0."UpdatedAt", s0."Id0", s0."Content", s0."CreatedAt0", s0."Duration", s0."ModuleId", s0."Order0", s0."Title0", s0."Type", s0."UpdatedAt0", s0."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt" AS "CreatedAt0", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM "Courses" AS c
    INNER JOIN "AspNetUsers" AS a ON c."InstructorId" = a."Id"
    WHERE c."Id" = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0."Id", c0."CourseId", c0."CreatedAt", c0."Description", c0."Order", c0."Title", c0."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c0
    LEFT JOIN "Lessons" AS l ON c0."Id" = l."ModuleId"
) AS s0 ON s."Id" = s0."CourseId"
LEFT JOIN "Reviews" AS r ON s."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON s."Id" = e."CourseId"
ORDER BY s."Id", s."Id0", s0."Id", s0."Id0", r."Id"
2025-07-28 14:49:51.813 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-07-28 14:49:51.813 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-07-28 14:49:51.814 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 37.0135ms
2025-07-28 14:49:51.814 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 39.5013ms
2025-07-28 14:49:51.815 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-07-28 14:49:51.816 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:51.816 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-07-28 14:49:51.816 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses/60 - 200 null application/json; charset=utf-8 61.8344ms
2025-07-28 14:49:51.818 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-07-28 14:49:51.818 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses/59 - 200 null application/json; charset=utf-8 65.6995ms
2025-07-28 14:49:51.820 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses/55 - application/json null
2025-07-28 14:49:51.820 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:51.820 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:49:51.823 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:49:51.825 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-07-28 14:49:51.825 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:51.827 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:49:51.827 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:49:51.827 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."Category", s."CreatedAt", s."Description", s."Discount", s."Duration", s."EnrollmentType", s."Features", s."InstructorId", s."IsBestseller", s."Level", s."OriginalPrice", s."PreviewUrl", s."Price", s."Status", s."Thumbnail", s."Title", s."UpdatedAt", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt0", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0."Id", s0."CourseId", s0."CreatedAt", s0."Description", s0."Order", s0."Title", s0."UpdatedAt", s0."Id0", s0."Content", s0."CreatedAt0", s0."Duration", s0."ModuleId", s0."Order0", s0."Title0", s0."Type", s0."UpdatedAt0", s0."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt" AS "CreatedAt0", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM "Courses" AS c
    INNER JOIN "AspNetUsers" AS a ON c."InstructorId" = a."Id"
    WHERE c."Id" = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0."Id", c0."CourseId", c0."CreatedAt", c0."Description", c0."Order", c0."Title", c0."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c0
    LEFT JOIN "Lessons" AS l ON c0."Id" = l."ModuleId"
) AS s0 ON s."Id" = s0."CourseId"
LEFT JOIN "Reviews" AS r ON s."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON s."Id" = e."CourseId"
ORDER BY s."Id", s."Id0", s0."Id", s0."Id0", r."Id"
2025-07-28 14:49:51.828 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-07-28 14:49:51.830 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-07-28 14:49:51.832 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-07-28 14:49:51.832 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:49:51.832 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:49:51.833 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 7.5487ms
2025-07-28 14:49:51.834 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."Category", s."CreatedAt", s."Description", s."Discount", s."Duration", s."EnrollmentType", s."Features", s."InstructorId", s."IsBestseller", s."Level", s."OriginalPrice", s."PreviewUrl", s."Price", s."Status", s."Thumbnail", s."Title", s."UpdatedAt", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt0", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0."Id", s0."CourseId", s0."CreatedAt", s0."Description", s0."Order", s0."Title", s0."UpdatedAt", s0."Id0", s0."Content", s0."CreatedAt0", s0."Duration", s0."ModuleId", s0."Order0", s0."Title0", s0."Type", s0."UpdatedAt0", s0."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt" AS "CreatedAt0", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM "Courses" AS c
    INNER JOIN "AspNetUsers" AS a ON c."InstructorId" = a."Id"
    WHERE c."Id" = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0."Id", c0."CourseId", c0."CreatedAt", c0."Description", c0."Order", c0."Title", c0."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c0
    LEFT JOIN "Lessons" AS l ON c0."Id" = l."ModuleId"
) AS s0 ON s."Id" = s0."CourseId"
LEFT JOIN "Reviews" AS r ON s."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON s."Id" = e."CourseId"
ORDER BY s."Id", s."Id0", s0."Id", s0."Id0", r."Id"
2025-07-28 14:49:51.836 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-07-28 14:49:51.838 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-07-28 14:49:51.838 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses/58 - 200 null application/json; charset=utf-8 82.0368ms
2025-07-28 14:49:51.839 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 10.0152ms
2025-07-28 14:49:51.840 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."Category", s."CreatedAt", s."Description", s."Discount", s."Duration", s."EnrollmentType", s."Features", s."InstructorId", s."IsBestseller", s."Level", s."OriginalPrice", s."PreviewUrl", s."Price", s."Status", s."Thumbnail", s."Title", s."UpdatedAt", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt0", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0."Id", s0."CourseId", s0."CreatedAt", s0."Description", s0."Order", s0."Title", s0."UpdatedAt", s0."Id0", s0."Content", s0."CreatedAt0", s0."Duration", s0."ModuleId", s0."Order0", s0."Title0", s0."Type", s0."UpdatedAt0", s0."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt" AS "CreatedAt0", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM "Courses" AS c
    INNER JOIN "AspNetUsers" AS a ON c."InstructorId" = a."Id"
    WHERE c."Id" = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0."Id", c0."CourseId", c0."CreatedAt", c0."Description", c0."Order", c0."Title", c0."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c0
    LEFT JOIN "Lessons" AS l ON c0."Id" = l."ModuleId"
) AS s0 ON s."Id" = s0."CourseId"
LEFT JOIN "Reviews" AS r ON s."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON s."Id" = e."CourseId"
ORDER BY s."Id", s."Id0", s0."Id", s0."Id0", r."Id"
2025-07-28 14:49:51.840 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."Category", s."CreatedAt", s."Description", s."Discount", s."Duration", s."EnrollmentType", s."Features", s."InstructorId", s."IsBestseller", s."Level", s."OriginalPrice", s."PreviewUrl", s."Price", s."Status", s."Thumbnail", s."Title", s."UpdatedAt", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt0", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0."Id", s0."CourseId", s0."CreatedAt", s0."Description", s0."Order", s0."Title", s0."UpdatedAt", s0."Id0", s0."Content", s0."CreatedAt0", s0."Duration", s0."ModuleId", s0."Order0", s0."Title0", s0."Type", s0."UpdatedAt0", s0."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt" AS "CreatedAt0", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM "Courses" AS c
    INNER JOIN "AspNetUsers" AS a ON c."InstructorId" = a."Id"
    WHERE c."Id" = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0."Id", c0."CourseId", c0."CreatedAt", c0."Description", c0."Order", c0."Title", c0."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c0
    LEFT JOIN "Lessons" AS l ON c0."Id" = l."ModuleId"
) AS s0 ON s."Id" = s0."CourseId"
LEFT JOIN "Reviews" AS r ON s."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON s."Id" = e."CourseId"
ORDER BY s."Id", s."Id0", s0."Id", s0."Id0", r."Id"
2025-07-28 14:49:51.841 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-07-28 14:49:51.843 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-07-28 14:49:51.844 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses/57 - 200 null application/json; charset=utf-8 87.2438ms
2025-07-28 14:49:51.845 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 11.1325ms
2025-07-28 14:49:51.846 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-07-28 14:49:51.847 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-07-28 14:49:51.848 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 12.7076ms
2025-07-28 14:49:51.848 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses/56 - 200 null application/json; charset=utf-8 89.6743ms
2025-07-28 14:49:51.849 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-07-28 14:49:51.851 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses/55 - 200 null application/json; charset=utf-8 30.77ms
2025-07-28 14:49:51.856 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."Category", s."CreatedAt", s."Description", s."Discount", s."Duration", s."EnrollmentType", s."Features", s."InstructorId", s."IsBestseller", s."Level", s."OriginalPrice", s."PreviewUrl", s."Price", s."Status", s."Thumbnail", s."Title", s."UpdatedAt", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt0", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0."Id", s0."CourseId", s0."CreatedAt", s0."Description", s0."Order", s0."Title", s0."UpdatedAt", s0."Id0", s0."Content", s0."CreatedAt0", s0."Duration", s0."ModuleId", s0."Order0", s0."Title0", s0."Type", s0."UpdatedAt0", s0."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt" AS "CreatedAt0", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM "Courses" AS c
    INNER JOIN "AspNetUsers" AS a ON c."InstructorId" = a."Id"
    WHERE c."Id" = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0."Id", c0."CourseId", c0."CreatedAt", c0."Description", c0."Order", c0."Title", c0."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c0
    LEFT JOIN "Lessons" AS l ON c0."Id" = l."ModuleId"
) AS s0 ON s."Id" = s0."CourseId"
LEFT JOIN "Reviews" AS r ON s."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON s."Id" = e."CourseId"
ORDER BY s."Id", s."Id0", s0."Id", s0."Id0", r."Id"
2025-07-28 14:49:51.858 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-07-28 14:49:51.859 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 81.5408ms
2025-07-28 14:49:51.860 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-07-28 14:49:51.860 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses/61 - 200 null application/json; charset=utf-8 94.0913ms
2025-07-28 14:51:16.759 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:51:16.760 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:16.761 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.0051ms
2025-07-28 14:51:16.762 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:51:16.763 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:16.765 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:51:16.767 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:51:16.768 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:51:16.772 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:51:16.776 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:51:16.776 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.5204ms
2025-07-28 14:51:16.777 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:51:16.778 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 15.8096ms
2025-07-28 14:51:16.780 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:51:16.781 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:16.782 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.6252ms
2025-07-28 14:51:16.783 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:51:16.784 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:16.785 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:51:16.786 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:51:16.787 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:51:16.788 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:51:16.790 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:51:16.792 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:51:16.794 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:51:16.797 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:51:16.800 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:51:16.803 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:51:16.804 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:51:16.807 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:51:16.808 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:51:16.809 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:51:16.810 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 22.2963ms
2025-07-28 14:51:16.811 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:51:16.812 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 28.7206ms
2025-07-28 14:51:16.814 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:51:16.815 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:16.817 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:51:16.818 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:51:16.818 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:51:16.820 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-07-28 14:51:16.821 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Courses" AS c
2025-07-28 14:51:16.823 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
WHERE p."Status" = 'Completed'
2025-07-28 14:51:16.824 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Enrollments" AS e
2025-07-28 14:51:16.828 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "InstructorId", a."FullName" AS "InstructorName", (
    SELECT count(*)::int
    FROM "Courses" AS c0
    WHERE c0."InstructorId" = a."Id") AS "TotalCourses", (
    SELECT count(*)::int
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c1 ON e."CourseId" = c1."Id"
    WHERE c1."InstructorId" = a."Id") AS "TotalStudents", (
    SELECT COALESCE(sum(p0."Amount"), 0.0)
    FROM "Payments" AS p0
    LEFT JOIN "Courses" AS c2 ON p0."CourseId" = c2."Id"
    WHERE c2."InstructorId" = a."Id" AND p0."Status" = 'Completed') AS "TotalRevenue", COALESCE((
    SELECT avg(r."Rating"::double precision)
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c3 ON r."CourseId" = c3."Id"
    WHERE c3."InstructorId" = a."Id"), 0.0) AS "AverageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = a."Id" AND p."Status" = 'Completed') DESC
LIMIT @__p_0
2025-07-28 14:51:16.830 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Category", count(*)::int AS "CourseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int AS "EnrollmentCount", (
    SELECT COALESCE(sum(p."Amount"), 0.0)
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c0 ON p."CourseId" = c0."Id"
    WHERE c0."Category" = c."Category" AND p."Status" = 'Completed') AS "Revenue"
FROM "Courses" AS c
GROUP BY c."Category"
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM "Enrollments" AS e
    WHERE c."Id" = e."CourseId")), 0)::int DESC
2025-07-28 14:51:16.832 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Year", p0."Month", COALESCE(sum(p0."Amount"), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    WHERE p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_0
) AS p0
GROUP BY p0."Year", p0."Month"
2025-07-28 14:51:16.834 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-07-28 14:51:16.836 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
2025-07-28 14:51:16.837 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s."PlanName" AS "Plan", count(*)::int AS "Count", COALESCE(sum(s."Price"), 0.0) AS "MonthlyRevenue"
FROM "Subscriptions" AS s
WHERE s."Status" = 'Active'
GROUP BY s."PlanName"
2025-07-28 14:51:16.838 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`6[[<>f__AnonymousType3`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:51:16.839 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 20.0116ms
2025-07-28 14:51:16.840 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:51:16.840 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 200 null application/json; charset=utf-8 26.5187ms
2025-07-28 14:51:45.995 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-28 14:51:45.996 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:45.996 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 1.5799ms
2025-07-28 14:51:45.998 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-28 14:51:45.999 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:46.000 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:51:46.001 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 14:51:46.002 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 14:51:46.004 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-28 14:51:46.016 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
2025-07-28 14:51:46.017 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType26`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:51:46.018 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 14.698ms
2025-07-28 14:51:46.018 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 14:51:46.019 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 20.8463ms
2025-07-28 14:51:46.030 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:51:46.032 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:46.032 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.0352ms
2025-07-28 14:51:46.034 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:51:46.035 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:46.036 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:51:46.036 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:51:46.041 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:51:46.044 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:51:46.045 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.4373ms
2025-07-28 14:51:46.046 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:51:46.046 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 12.069ms
2025-07-28 14:51:46.050 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:51:46.051 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:46.051 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.4794ms
2025-07-28 14:51:46.053 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:51:46.054 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:46.055 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:51:46.055 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-28 14:51:46.056 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 2.7332ms
2025-07-28 14:51:51.858 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-28 14:51:51.859 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:51.860 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 2.0562ms
2025-07-28 14:51:51.862 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 55
2025-07-28 14:51:51.863 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:51.864 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 14:51:51.864 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 14:51:51.867 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:51:51.916 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-28 14:51:51.918 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-28 14:51:51.918 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 52.8027ms
2025-07-28 14:51:51.919 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 14:51:51.919 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 57.5302ms
2025-07-28 14:51:51.934 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:51:51.934 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:51:51.935 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:51.937 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:51.937 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.4577ms
2025-07-28 14:51:51.937 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.2364ms
2025-07-28 14:51:51.939 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:51:51.941 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:51:51.942 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:51.944 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:51.945 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:51:51.945 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:51:51.947 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:51:51.948 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:51:51.948 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:51:51.949 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:51:51.950 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 9.5481ms
2025-07-28 14:51:51.953 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:51:51.956 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:51:51.957 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.3464ms
2025-07-28 14:51:51.958 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:51:51.959 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 19.4863ms
2025-07-28 14:51:56.741 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:51:56.743 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:56.745 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:51:56.746 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:51:56.747 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:51:56.752 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:51:56.755 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:51:56.756 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.9574ms
2025-07-28 14:51:56.757 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:51:56.757 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 16.1167ms
2025-07-28 14:51:56.759 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:51:56.761 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:56.763 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:51:56.764 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:51:56.765 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:51:56.766 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 6.2421ms
2025-07-28 14:51:56.779 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-28 14:51:56.781 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:56.782 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 2.3798ms
2025-07-28 14:51:56.784 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 14:51:56.785 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:56.787 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:51:56.788 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 4.6281ms
2025-07-28 14:51:56.790 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 14:51:56.791 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 14:51:56.792 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:56.793 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.841ms
2025-07-28 14:51:56.795 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 14:51:56.796 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:56.797 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:51:56.799 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.7269ms
2025-07-28 14:51:56.800 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 14:51:56.802 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 14:51:56.803 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:56.804 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.7854ms
2025-07-28 14:51:56.806 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 14:51:56.807 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:56.808 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:51:56.810 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 4.2329ms
2025-07-28 14:51:56.812 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 14:51:56.813 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 14:51:56.814 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:51:56.816 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:51:56.817 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.9672ms
2025-07-28 14:51:56.819 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 14:52:04.943 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 14:52:04.944 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:52:04.945 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.9257ms
2025-07-28 14:52:04.947 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 14:52:04.948 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:52:04.949 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:52:04.950 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 3.5872ms
2025-07-28 14:52:04.952 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 14:55:03.148 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:55:03.150 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:03.151 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.7573ms
2025-07-28 14:55:03.152 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:55:03.154 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:03.201 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:03.202 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:55:03.203 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:55:03.209 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:55:03.213 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:55:03.213 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.7992ms
2025-07-28 14:55:03.214 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:55:03.214 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 61.9862ms
2025-07-28 14:55:03.216 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:55:03.217 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:03.218 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.4016ms
2025-07-28 14:55:03.219 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:55:03.220 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:03.222 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:03.222 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:55:03.223 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:55:03.223 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.3329ms
2025-07-28 14:55:03.226 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-28 14:55:03.227 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:03.228 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 1.7799ms
2025-07-28 14:55:03.229 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 14:55:03.230 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:03.232 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:03.233 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 3.2375ms
2025-07-28 14:55:03.234 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 14:55:03.235 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 14:55:03.236 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:03.237 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.7353ms
2025-07-28 14:55:03.239 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 14:55:03.240 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:03.242 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:03.243 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 4.0676ms
2025-07-28 14:55:03.244 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 14:55:03.245 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 14:55:03.247 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:03.247 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.6211ms
2025-07-28 14:55:03.249 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 14:55:03.250 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:03.251 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:03.252 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 3.6255ms
2025-07-28 14:55:03.254 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 14:55:03.255 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 14:55:03.256 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:03.257 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:03.258 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.4475ms
2025-07-28 14:55:03.260 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 14:55:07.814 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-28 14:55:07.815 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:07.815 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 1.7443ms
2025-07-28 14:55:07.817 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-28 14:55:07.818 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:07.819 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:07.821 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 14:55:07.821 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 14:55:07.824 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-28 14:55:07.835 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
2025-07-28 14:55:07.836 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType26`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:55:07.837 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 14.7976ms
2025-07-28 14:55:07.838 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 14:55:07.838 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 21.0883ms
2025-07-28 14:55:07.861 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:55:07.862 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:07.863 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:55:07.863 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:55:07.867 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:55:07.870 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:55:07.871 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9654ms
2025-07-28 14:55:07.872 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:55:07.872 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 11.8182ms
2025-07-28 14:55:07.878 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:55:07.880 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:07.880 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:55:07.881 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-28 14:55:07.882 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 3.1534ms
2025-07-28 14:55:12.263 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-28 14:55:12.264 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:12.265 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 1.9065ms
2025-07-28 14:55:12.266 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 59
2025-07-28 14:55:12.267 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:12.268 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 14:55:12.268 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 14:55:12.271 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:55:12.318 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-28 14:55:12.320 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-28 14:55:12.320 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 51.3047ms
2025-07-28 14:55:12.321 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 14:55:12.322 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 55.5373ms
2025-07-28 14:55:12.331 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:55:12.332 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:55:12.333 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:12.334 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:12.334 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.0597ms
2025-07-28 14:55:12.335 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.599ms
2025-07-28 14:55:12.336 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:55:12.338 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:55:12.339 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:12.340 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:12.341 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:12.342 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:55:12.343 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:55:12.346 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:55:12.350 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:55:12.351 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.2552ms
2025-07-28 14:55:12.352 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:55:12.352 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 16.0715ms
2025-07-28 14:55:12.386 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:12.387 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:55:12.388 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:55:12.388 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 50.6955ms
2025-07-28 14:55:14.129 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:55:14.131 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:14.132 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:14.133 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:55:14.134 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:55:14.142 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:55:14.146 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:55:14.147 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 11.5832ms
2025-07-28 14:55:14.147 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:55:14.148 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 18.8184ms
2025-07-28 14:55:14.150 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:55:14.151 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:14.152 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:14.154 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:55:14.154 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:55:14.155 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 5.0942ms
2025-07-28 14:55:14.160 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-28 14:55:14.162 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:14.162 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 1.9762ms
2025-07-28 14:55:14.164 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 14:55:14.165 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:14.166 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:14.167 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 3.4085ms
2025-07-28 14:55:14.169 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 14:55:14.170 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 14:55:14.172 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:14.172 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 2.0592ms
2025-07-28 14:55:14.174 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 14:55:14.175 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:14.176 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:14.178 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.691ms
2025-07-28 14:55:14.179 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 14:55:14.180 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 14:55:14.182 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:14.182 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.6869ms
2025-07-28 14:55:14.183 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 14:55:14.185 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:14.186 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:14.187 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 3.7626ms
2025-07-28 14:55:14.189 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 14:55:14.190 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 14:55:14.191 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:14.192 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:14.193 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.3447ms
2025-07-28 14:55:14.195 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 14:55:17.172 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-28 14:55:17.173 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:17.173 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 1.5863ms
2025-07-28 14:55:17.174 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-28 14:55:17.175 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:17.177 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:17.178 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 14:55:17.179 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 14:55:17.182 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-28 14:55:17.185 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
UPDATE "RefreshTokens" SET "RevokedAt" = @p2
WHERE "Id" = @p3;
2025-07-28 14:55:17.196 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType26`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:55:17.197 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 16.646ms
2025-07-28 14:55:17.198 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 14:55:17.198 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 23.8742ms
2025-07-28 14:55:17.219 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:55:17.220 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:17.221 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:55:17.221 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:55:17.225 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:55:17.229 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:55:17.230 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.4544ms
2025-07-28 14:55:17.230 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:55:17.231 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 12.1983ms
2025-07-28 14:55:17.234 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:55:17.235 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:17.236 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:55:17.236 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-28 14:55:17.237 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 2.7214ms
2025-07-28 14:55:21.574 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-28 14:55:21.576 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:21.576 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 1.9525ms
2025-07-28 14:55:21.578 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 61
2025-07-28 14:55:21.579 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:21.579 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 14:55:21.580 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 14:55:21.582 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:55:21.630 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-28 14:55:21.632 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-28 14:55:21.632 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 51.3995ms
2025-07-28 14:55:21.633 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 14:55:21.633 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 55.691ms
2025-07-28 14:55:21.643 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:55:21.643 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:55:21.645 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:21.646 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:21.646 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.0325ms
2025-07-28 14:55:21.647 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.2199ms
2025-07-28 14:55:21.648 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:55:21.649 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:55:21.651 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:21.652 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:21.653 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:21.653 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:21.654 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:55:21.655 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:55:21.656 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:55:21.656 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:55:21.658 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 8.751ms
2025-07-28 14:55:21.660 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:55:21.663 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:55:21.664 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9663ms
2025-07-28 14:55:21.665 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:55:21.665 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 17.5015ms
2025-07-28 14:55:23.213 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:55:23.214 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:23.215 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:23.217 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:55:23.217 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:55:23.221 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:55:23.224 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:55:23.225 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4881ms
2025-07-28 14:55:23.225 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:55:23.226 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.0297ms
2025-07-28 14:55:23.227 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:55:23.229 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:23.230 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:23.232 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:55:23.232 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:55:23.233 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 5.5123ms
2025-07-28 14:55:23.244 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-28 14:55:23.245 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:23.246 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 2.4163ms
2025-07-28 14:55:23.248 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 14:55:23.249 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:23.252 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:23.253 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 4.6055ms
2025-07-28 14:55:23.254 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 14:55:23.255 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 14:55:23.256 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:23.257 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.4757ms
2025-07-28 14:55:23.258 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 14:55:23.259 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:23.260 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:23.261 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.3195ms
2025-07-28 14:55:23.263 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 14:55:23.264 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 14:55:23.265 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:23.265 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.506ms
2025-07-28 14:55:23.267 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 14:55:23.268 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:23.269 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:23.270 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 3.3807ms
2025-07-28 14:55:23.272 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 14:55:23.274 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 14:55:23.275 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:55:23.276 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:55:23.277 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.336ms
2025-07-28 14:55:23.278 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 14:57:14.520 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-28 14:57:14.521 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:14.522 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 1.5487ms
2025-07-28 14:57:14.523 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-28 14:57:14.524 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:14.526 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:14.527 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 14:57:14.528 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 14:57:14.530 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-28 14:57:14.541 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
2025-07-28 14:57:14.542 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType26`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:57:14.542 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 13.53ms
2025-07-28 14:57:14.543 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 14:57:14.544 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 20.1952ms
2025-07-28 14:57:14.571 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:57:14.573 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:14.573 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.6771ms
2025-07-28 14:57:14.575 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:57:14.576 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:14.577 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:57:14.578 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:57:14.583 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:57:14.587 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:57:14.587 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.3962ms
2025-07-28 14:57:14.588 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:57:14.589 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 14.2036ms
2025-07-28 14:57:14.591 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:57:14.592 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:14.593 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.6237ms
2025-07-28 14:57:14.594 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:57:14.596 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:14.596 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:57:14.597 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-28 14:57:14.597 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 2.885ms
2025-07-28 14:57:17.834 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-28 14:57:17.836 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:17.836 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 1.5908ms
2025-07-28 14:57:17.837 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 64
2025-07-28 14:57:17.838 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:17.839 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 14:57:17.839 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 14:57:17.841 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 14:57:17.889 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-28 14:57:17.891 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-28 14:57:17.892 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 51.3109ms
2025-07-28 14:57:17.892 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 14:57:17.893 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 55.3047ms
2025-07-28 14:57:17.907 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 14:57:17.908 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 14:57:17.909 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:17.910 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:17.911 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 4.2193ms
2025-07-28 14:57:17.911 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.7256ms
2025-07-28 14:57:17.913 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:57:17.915 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:57:17.916 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:17.918 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:17.919 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:17.919 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:17.920 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:57:17.921 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:57:17.922 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:57:17.922 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:57:17.923 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 9.5784ms
2025-07-28 14:57:17.927 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:57:17.930 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:57:17.931 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.0549ms
2025-07-28 14:57:17.932 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:57:17.932 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 17.2745ms
2025-07-28 14:57:17.934 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - null null
2025-07-28 14:57:17.935 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:17.935 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - 204 null null 1.531ms
2025-07-28 14:57:17.937 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - application/json null
2025-07-28 14:57:17.938 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:17.940 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:17.941 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - 404 0 null 3.8219ms
2025-07-28 14:57:17.942 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats, Response status code: 404
2025-07-28 14:57:17.943 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 14:57:17.945 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:17.945 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 1.5013ms
2025-07-28 14:57:17.946 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 14:57:17.948 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:17.949 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:17.950 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:57:17.951 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:57:17.955 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:57:17.958 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:57:17.958 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4352ms
2025-07-28 14:57:17.959 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:57:17.960 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 13.2897ms
2025-07-28 14:57:19.394 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 14:57:19.395 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:19.396 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:19.397 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:57:19.398 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 14:57:19.402 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 14:57:19.405 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 14:57:19.406 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.6935ms
2025-07-28 14:57:19.406 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 14:57:19.407 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 12.9577ms
2025-07-28 14:57:19.408 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 14:57:19.410 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:19.411 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:19.412 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 14:57:19.412 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 14:57:19.413 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.3442ms
2025-07-28 14:57:19.418 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 14:57:19.418 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 14:57:19.420 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:19.421 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:19.421 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.9033ms
2025-07-28 14:57:19.421 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 3.1137ms
2025-07-28 14:57:19.423 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 14:57:19.425 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 14:57:19.426 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:19.427 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:19.429 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:19.429 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:19.430 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:57:19.431 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:57:19.431 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:57:19.432 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:57:19.434 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:57:19.434 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:57:19.436 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:57:19.436 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:57:19.438 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:57:19.438 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:57:19.440 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 6.4785ms
2025-07-28 14:57:19.440 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:57:19.440 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:57:19.442 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 17.3599ms
2025-07-28 14:57:19.442 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:57:19.444 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:57:19.445 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 12.8663ms
2025-07-28 14:57:19.446 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:57:19.446 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 23.4818ms
2025-07-28 14:57:21.838 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 14:57:21.839 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:21.841 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:21.842 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:57:21.843 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:57:21.845 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:57:21.848 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:57:21.850 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:57:21.851 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:57:21.857 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:57:21.858 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:57:21.859 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 15.6427ms
2025-07-28 14:57:21.860 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:57:21.860 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 22.3294ms
2025-07-28 14:57:23.654 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 14:57:23.655 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:23.656 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:23.657 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:57:23.658 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:57:23.659 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:57:23.661 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:57:23.662 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:57:23.663 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 4.0226ms
2025-07-28 14:57:23.663 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:57:23.664 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 10.0202ms
2025-07-28 14:57:23.666 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 14:57:23.667 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:23.669 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:23.670 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:57:23.670 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:57:23.672 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:57:23.674 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:57:23.675 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:57:23.677 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:57:23.678 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:57:23.679 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:57:23.680 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 9.6228ms
2025-07-28 14:57:23.681 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:57:23.682 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 15.4631ms
2025-07-28 14:57:25.782 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 14:57:25.784 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:25.784 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.0001ms
2025-07-28 14:57:25.786 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 14:57:25.787 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:25.789 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:25.790 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:57:25.790 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 14:57:25.792 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 14:57:25.793 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 14:57:25.795 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 14:57:25.795 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 4.1492ms
2025-07-28 14:57:25.796 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 14:57:25.796 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 10.44ms
2025-07-28 14:57:25.798 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 14:57:25.799 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:25.800 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 1.9556ms
2025-07-28 14:57:25.801 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 14:57:25.803 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:25.804 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:25.805 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:57:25.805 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:57:25.807 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:57:25.809 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:57:25.811 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:57:25.812 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:57:25.814 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:57:25.815 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:57:25.816 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 10.3681ms
2025-07-28 14:57:25.817 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:57:25.818 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 16.1812ms
2025-07-28 14:57:27.870 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 14:57:27.871 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:57:27.872 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:57:27.874 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:57:27.874 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:57:27.876 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:57:27.878 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:57:27.880 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:57:27.881 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:57:27.883 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:57:27.884 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:57:27.885 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 10.1641ms
2025-07-28 14:57:27.886 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:57:27.886 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 16.0882ms
2025-07-28 14:58:21.782 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 14:58:21.783 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:58:21.784 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.3802ms
2025-07-28 14:58:21.786 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 14:58:21.787 +08:00 [INF] CORS policy execution successful.
2025-07-28 14:58:21.788 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 14:58:21.790 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:58:21.790 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 14:58:21.793 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 14:58:21.795 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 14:58:21.797 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 14:58:21.798 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 14:58:21.800 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 14:58:21.802 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 14:58:21.803 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 11.6104ms
2025-07-28 14:58:21.804 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 14:58:21.804 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 18.7551ms
2025-07-28 15:02:10.317 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:02:10.318 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:10.319 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 1.7561ms
2025-07-28 15:02:10.320 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:10.322 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:10.367 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:10.368 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:02:10.368 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:02:10.373 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:02:10.376 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:02:10.378 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:02:10.380 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:02:10.381 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:02:10.382 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:02:10.383 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 13.8777ms
2025-07-28 15:02:10.384 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:02:10.384 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 63.9279ms
2025-07-28 15:02:11.043 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:02:11.044 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:11.044 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 1.6164ms
2025-07-28 15:02:11.046 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:11.047 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:11.048 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:11.049 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:02:11.049 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:02:11.051 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:02:11.052 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:02:11.053 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:02:11.054 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 3.6521ms
2025-07-28 15:02:11.055 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:02:11.055 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 9.5529ms
2025-07-28 15:02:11.057 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:11.058 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:11.059 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:11.060 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:02:11.060 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:02:11.062 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:02:11.064 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:02:11.066 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:02:11.068 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:02:11.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:02:11.071 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:02:11.072 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 10.133ms
2025-07-28 15:02:11.072 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:02:11.073 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 15.9723ms
2025-07-28 15:02:12.503 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:12.505 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:12.506 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:12.507 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:02:12.508 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:02:12.509 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:02:12.511 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:02:12.512 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:02:12.512 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 3.6245ms
2025-07-28 15:02:12.513 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:02:12.513 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 9.9545ms
2025-07-28 15:02:12.515 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:12.516 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:12.517 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:12.518 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:02:12.518 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:02:12.520 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:02:12.522 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:02:12.524 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:02:12.525 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:02:12.527 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:02:12.528 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:02:12.529 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 9.6803ms
2025-07-28 15:02:12.529 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:02:12.530 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 15.0911ms
2025-07-28 15:02:13.124 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:13.125 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:13.126 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:13.127 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:02:13.128 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:02:13.130 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:02:13.132 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:02:13.133 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:02:13.135 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:02:13.137 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:02:13.138 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:02:13.139 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 10.1188ms
2025-07-28 15:02:13.139 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:02:13.140 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 16.3543ms
2025-07-28 15:02:17.662 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:02:17.663 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:02:17.664 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:17.665 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:17.666 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.6063ms
2025-07-28 15:02:17.666 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.5033ms
2025-07-28 15:02:17.668 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:02:17.671 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:02:17.672 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:17.673 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:17.675 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:17.676 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:17.677 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:02:17.682 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:02:17.685 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:02:17.686 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.2943ms
2025-07-28 15:02:17.687 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:17.688 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 19.4452ms
2025-07-28 15:02:17.690 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - null null
2025-07-28 15:02:17.691 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:17.692 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - 204 null null 1.7128ms
2025-07-28 15:02:17.693 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - application/json null
2025-07-28 15:02:17.695 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:17.696 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:17.698 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - 404 0 null 4.3948ms
2025-07-28 15:02:17.699 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats, Response status code: 404
2025-07-28 15:02:17.700 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:02:17.701 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:17.702 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 1.4867ms
2025-07-28 15:02:17.703 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:17.705 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:17.706 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:17.707 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:17.708 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:02:17.711 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:02:17.714 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:02:17.715 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4428ms
2025-07-28 15:02:17.716 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:17.716 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 12.6569ms
2025-07-28 15:02:17.722 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:17.723 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:02:17.724 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:02:17.724 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 53.9494ms
2025-07-28 15:02:18.751 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:02:18.752 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:18.753 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:18.755 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:18.755 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:02:18.762 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:02:18.765 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:02:18.766 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 10.0333ms
2025-07-28 15:02:18.767 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:18.767 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 16.4926ms
2025-07-28 15:02:18.769 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:02:18.770 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:18.771 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:18.772 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:02:18.773 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:02:18.773 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.5804ms
2025-07-28 15:02:18.778 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:02:18.779 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:02:18.780 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:18.781 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:18.781 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.6345ms
2025-07-28 15:02:18.782 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.9522ms
2025-07-28 15:02:18.783 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:18.784 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:18.785 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:18.786 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:18.788 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:18.788 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:18.789 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:02:18.790 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:02:18.790 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:02:18.791 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:02:18.793 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:02:18.793 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:02:18.795 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:02:18.795 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:02:18.797 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:02:18.797 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:02:18.799 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:02:18.799 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 6.4288ms
2025-07-28 15:02:18.800 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:02:18.800 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:02:18.801 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:02:18.802 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 17.6552ms
2025-07-28 15:02:18.803 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 11.4443ms
2025-07-28 15:02:18.805 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:02:18.805 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 22.1903ms
2025-07-28 15:02:19.905 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:02:19.905 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:02:19.906 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:19.907 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:19.909 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:19.909 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:19.910 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:02:19.911 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:19.911 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:02:19.912 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:02:19.912 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 7.115ms
2025-07-28 15:02:19.916 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:02:19.919 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:02:19.919 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.3569ms
2025-07-28 15:02:19.920 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:19.921 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 15.6787ms
2025-07-28 15:02:19.922 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - application/json null
2025-07-28 15:02:19.924 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:19.925 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:19.926 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - 404 0 null 3.5306ms
2025-07-28 15:02:19.927 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats, Response status code: 404
2025-07-28 15:02:19.933 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:19.934 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:19.935 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:19.936 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:19.937 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:02:19.940 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:02:19.943 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:02:19.943 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 5.8776ms
2025-07-28 15:02:19.944 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:19.944 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 11.8241ms
2025-07-28 15:02:20.942 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:02:20.944 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:20.945 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:20.946 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:20.946 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:02:20.950 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:02:20.953 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:02:20.954 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.5645ms
2025-07-28 15:02:20.955 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:20.955 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 12.9377ms
2025-07-28 15:02:20.957 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:02:20.958 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:20.959 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:20.960 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:02:20.961 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:02:20.961 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.6686ms
2025-07-28 15:02:20.966 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:20.966 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:20.967 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:20.968 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:20.970 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:20.970 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:20.971 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:02:20.972 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:02:20.972 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:02:20.973 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:02:20.975 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:02:20.975 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:02:20.976 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:02:20.977 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:02:20.978 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:02:20.979 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:02:20.981 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:02:20.981 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 6.634ms
2025-07-28 15:02:20.983 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:02:20.983 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:02:20.984 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:02:20.984 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 18.1788ms
2025-07-28 15:02:20.985 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 11.6396ms
2025-07-28 15:02:20.987 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:02:20.988 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 21.8425ms
2025-07-28 15:02:21.825 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:02:21.825 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:02:21.827 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:21.828 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:21.829 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:21.830 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:21.831 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:02:21.832 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:21.832 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:02:21.833 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:02:21.833 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 8.3821ms
2025-07-28 15:02:21.837 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:02:21.841 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:02:21.841 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.0816ms
2025-07-28 15:02:21.842 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:21.843 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 17.6797ms
2025-07-28 15:02:21.844 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - application/json null
2025-07-28 15:02:21.845 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:21.846 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:21.847 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - 404 0 null 3.3499ms
2025-07-28 15:02:21.849 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats, Response status code: 404
2025-07-28 15:02:21.850 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:21.852 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:21.853 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:21.854 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:21.854 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:02:21.858 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:02:21.861 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:02:21.862 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.5497ms
2025-07-28 15:02:21.863 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:21.863 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 12.9359ms
2025-07-28 15:02:36.686 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:02:36.688 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:36.688 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.0052ms
2025-07-28 15:02:36.690 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:02:36.691 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:36.693 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:36.694 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:36.694 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:02:36.698 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:02:36.701 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:02:36.702 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.343ms
2025-07-28 15:02:36.702 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:02:36.703 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.2176ms
2025-07-28 15:02:36.704 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:02:36.706 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:36.706 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.7596ms
2025-07-28 15:02:36.708 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:02:36.709 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:36.710 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:36.711 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:02:36.711 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:02:36.712 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.4368ms
2025-07-28 15:02:36.713 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:02:36.713 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:02:36.715 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:36.716 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:36.716 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.4638ms
2025-07-28 15:02:36.716 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.8336ms
2025-07-28 15:02:36.718 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:36.719 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:02:36.720 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:36.721 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:02:36.723 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:36.723 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:02:36.724 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:02:36.725 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:02:36.725 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:02:36.726 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:02:36.728 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:02:36.728 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:02:36.729 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:02:36.730 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:02:36.731 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:02:36.732 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:02:36.733 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:02:36.734 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 6.1333ms
2025-07-28 15:02:36.735 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:02:36.735 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:02:36.736 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:02:36.737 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 17.8117ms
2025-07-28 15:02:36.738 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 11.3175ms
2025-07-28 15:02:36.740 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:02:36.740 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 22.5162ms
2025-07-28 15:03:38.153 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:03:38.155 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:03:38.156 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.6111ms
2025-07-28 15:03:38.158 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:03:38.159 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:03:38.161 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:03:38.162 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:03:38.163 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:03:38.165 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:03:38.167 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:03:38.169 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:03:38.170 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:03:38.172 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:03:38.173 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:03:38.174 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 10.4056ms
2025-07-28 15:03:38.175 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:03:38.176 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 17.9773ms
2025-07-28 15:03:39.031 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:03:39.032 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:03:39.033 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 1.8151ms
2025-07-28 15:03:39.034 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:03:39.035 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:03:39.037 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:03:39.038 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:03:39.038 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:03:39.040 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:03:39.041 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:03:39.042 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:03:39.043 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 3.6151ms
2025-07-28 15:03:39.044 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:03:39.044 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 9.6197ms
2025-07-28 15:03:39.046 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:03:39.047 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:03:39.048 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:03:39.049 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:03:39.049 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:03:39.051 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:03:39.053 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:03:39.054 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:03:39.056 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:03:39.058 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:03:39.059 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:03:39.060 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 9.4515ms
2025-07-28 15:03:39.060 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:03:39.061 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 15.0864ms
2025-07-28 15:03:40.556 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:03:40.557 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:03:40.559 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:03:40.560 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:03:40.560 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:03:40.562 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:03:40.564 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:03:40.566 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:03:40.567 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:03:40.569 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:03:40.570 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:03:40.571 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 9.7549ms
2025-07-28 15:03:40.572 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:03:40.573 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 16.762ms
2025-07-28 15:04:38.937 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:04:38.938 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:38.939 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.5988ms
2025-07-28 15:04:38.940 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:04:38.941 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:38.942 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:04:38.943 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:04:38.944 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:04:38.947 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:04:38.951 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:04:38.952 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.5292ms
2025-07-28 15:04:38.952 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:04:38.953 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 12.6575ms
2025-07-28 15:04:38.954 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:04:38.956 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:38.956 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.8052ms
2025-07-28 15:04:38.958 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:04:38.959 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:38.960 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:04:38.961 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:04:38.961 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:04:38.962 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.1845ms
2025-07-28 15:04:38.963 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:04:38.963 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:04:38.964 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:38.965 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:38.966 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.443ms
2025-07-28 15:04:38.966 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.6998ms
2025-07-28 15:04:38.968 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:04:38.969 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:04:38.970 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:38.971 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:38.973 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:04:38.973 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:04:38.974 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:04:38.974 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:04:38.975 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:04:38.975 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:04:38.977 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:04:38.978 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:04:38.978 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:04:38.980 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:04:38.981 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:04:38.982 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 6.1342ms
2025-07-28 15:04:38.982 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:04:38.983 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:04:38.984 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 16.5533ms
2025-07-28 15:04:38.984 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:04:38.987 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:04:38.988 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:04:38.989 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 12.4886ms
2025-07-28 15:04:38.990 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:04:38.991 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 21.7519ms
2025-07-28 15:04:45.812 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:04:45.813 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:45.813 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.768ms
2025-07-28 15:04:45.815 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:04:45.816 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:45.818 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:04:45.819 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:04:45.820 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:04:45.824 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:04:45.828 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:04:45.829 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.252ms
2025-07-28 15:04:45.829 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:04:45.830 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 14.9544ms
2025-07-28 15:04:45.832 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:04:45.833 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:45.834 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.7152ms
2025-07-28 15:04:45.835 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:04:45.836 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:45.837 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:04:45.838 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:04:45.839 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:04:45.839 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.2509ms
2025-07-28 15:04:45.841 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:04:45.841 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:04:45.842 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:45.843 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:45.843 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.3507ms
2025-07-28 15:04:45.843 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.7953ms
2025-07-28 15:04:45.845 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:04:45.846 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:04:45.847 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:45.848 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:04:45.849 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:04:45.849 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:04:45.850 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:04:45.851 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:04:45.852 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:04:45.852 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:04:45.854 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:04:45.854 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:04:45.856 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:04:45.857 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:04:45.858 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:04:45.858 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:04:45.860 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:04:45.860 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 6.0919ms
2025-07-28 15:04:45.861 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:04:45.861 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:04:45.862 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:04:45.863 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 18.1203ms
2025-07-28 15:04:45.864 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 11.08ms
2025-07-28 15:04:45.866 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:04:45.866 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 20.1531ms
2025-07-28 15:07:33.222 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:07:33.224 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:07:33.225 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.0841ms
2025-07-28 15:07:33.228 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:07:33.230 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:07:33.279 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:07:33.280 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:07:33.281 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:07:33.287 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:07:33.290 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:07:33.291 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.4738ms
2025-07-28 15:07:33.292 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:07:33.293 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 65.2017ms
2025-07-28 15:07:33.293 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:07:33.294 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:07:33.295 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:07:33.296 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:07:33.297 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.6016ms
2025-07-28 15:07:33.297 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:07:33.298 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:07:33.299 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:07:33.300 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:07:33.301 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:07:33.302 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:07:33.303 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:07:33.304 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:07:33.304 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 5.8521ms
2025-07-28 15:07:33.348 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:07:33.351 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:07:33.352 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 50.0291ms
2025-07-28 15:07:33.353 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:07:33.353 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 60.6506ms
2025-07-28 15:07:33.355 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:07:33.356 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:07:33.357 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:07:33.358 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:07:33.359 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:07:33.359 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.4024ms
2025-07-28 15:07:33.361 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:07:33.361 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:07:33.363 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:07:33.364 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:07:33.364 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.9095ms
2025-07-28 15:07:33.364 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 3.0522ms
2025-07-28 15:07:33.366 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:07:33.367 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:07:33.369 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:07:33.370 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:07:33.371 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:07:33.372 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:07:33.372 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:07:33.373 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:07:33.374 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:07:33.374 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:07:33.376 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:07:33.377 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:07:33.379 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:07:33.379 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:07:33.380 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:07:33.381 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:07:33.382 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:07:33.382 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 6.0288ms
2025-07-28 15:07:33.384 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:07:33.384 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:07:33.385 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:07:33.385 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 19.3209ms
2025-07-28 15:07:33.386 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 11.1685ms
2025-07-28 15:07:33.389 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:07:33.389 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 21.6839ms
2025-07-28 15:14:27.745 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:14:27.746 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:27.747 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 1.651ms
2025-07-28 15:14:27.748 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:14:27.750 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:27.802 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:14:27.803 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:14:27.803 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:14:27.810 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:14:27.813 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:14:27.815 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:14:27.816 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:14:27.818 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:14:27.819 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:14:27.820 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 15.6799ms
2025-07-28 15:14:27.820 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:14:27.821 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 73.0299ms
2025-07-28 15:14:28.961 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:14:28.962 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:28.962 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 1.5552ms
2025-07-28 15:14:28.964 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:14:28.965 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:28.966 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:14:28.967 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:14:28.968 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:14:28.969 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:14:28.970 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:14:28.971 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:14:28.972 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 3.5688ms
2025-07-28 15:14:28.973 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:14:28.973 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 9.3069ms
2025-07-28 15:14:28.974 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:14:28.975 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:28.976 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:14:28.977 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:14:28.978 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:14:28.979 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:14:28.981 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:14:28.982 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:14:28.984 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:14:28.985 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:14:28.987 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:14:28.987 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 9.0623ms
2025-07-28 15:14:28.988 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:14:28.989 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 14.123ms
2025-07-28 15:14:29.894 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:14:29.895 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:29.896 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:14:29.897 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:14:29.897 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:14:29.899 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:14:29.901 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:14:29.903 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:14:29.904 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:14:29.906 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:14:29.907 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:14:29.908 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 9.5828ms
2025-07-28 15:14:29.908 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:14:29.909 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 15.1268ms
2025-07-28 15:14:41.377 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-28 15:14:41.378 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:41.378 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 1.5044ms
2025-07-28 15:14:41.380 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-28 15:14:41.381 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:41.382 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:14:41.383 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 15:14:41.384 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 15:14:41.386 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-28 15:14:41.398 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
2025-07-28 15:14:41.399 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType26`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:14:41.400 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 15.0718ms
2025-07-28 15:14:41.400 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 15:14:41.401 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 21.1674ms
2025-07-28 15:14:41.444 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:14:41.446 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:41.446 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.1813ms
2025-07-28 15:14:41.448 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:14:41.450 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:41.451 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:14:41.452 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:14:41.460 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:14:41.465 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:14:41.466 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 13.0571ms
2025-07-28 15:14:41.467 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:14:41.468 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 19.6285ms
2025-07-28 15:14:41.470 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:14:41.471 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:41.472 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.703ms
2025-07-28 15:14:41.473 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:14:41.474 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:41.475 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:14:41.476 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-28 15:14:41.476 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 3.1588ms
2025-07-28 15:14:47.860 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-28 15:14:47.861 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:47.862 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 1.9187ms
2025-07-28 15:14:47.863 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 55
2025-07-28 15:14:47.865 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:47.865 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 15:14:47.866 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 15:14:47.868 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 15:14:47.915 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-28 15:14:47.916 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-28 15:14:47.917 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 50.0617ms
2025-07-28 15:14:47.917 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 15:14:47.918 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 54.6779ms
2025-07-28 15:14:47.933 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:14:47.934 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:14:47.934 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:47.936 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:47.936 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.071ms
2025-07-28 15:14:47.936 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.1452ms
2025-07-28 15:14:47.938 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:14:47.939 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:14:47.940 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:47.941 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:14:47.942 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:14:47.943 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:14:47.944 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:14:47.944 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 6.4867ms
2025-07-28 15:14:47.983 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:14:47.984 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:14:47.985 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:14:47.988 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:14:47.991 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:14:47.991 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.1264ms
2025-07-28 15:14:47.992 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:14:47.993 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 53.7572ms
2025-07-28 15:17:48.187 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:17:48.188 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:17:48.189 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.2053ms
2025-07-28 15:17:48.191 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:17:48.192 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:17:48.194 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:17:48.195 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:17:48.196 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:17:48.199 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:17:48.203 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:17:48.204 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.4333ms
2025-07-28 15:17:48.205 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:17:48.206 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 15.1176ms
2025-07-28 15:17:48.208 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:17:48.209 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:17:48.209 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.5457ms
2025-07-28 15:17:48.211 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:17:48.212 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:17:48.213 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:17:48.214 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:17:48.215 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:17:48.215 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.5324ms
2025-07-28 15:17:48.225 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-28 15:17:48.227 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:17:48.227 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 2.3593ms
2025-07-28 15:17:48.229 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:17:48.230 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:17:48.232 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:17:48.233 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 3.6738ms
2025-07-28 15:17:48.235 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:17:48.236 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 15:17:48.237 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:17:48.237 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.9289ms
2025-07-28 15:17:48.239 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:17:48.241 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:17:48.243 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:17:48.245 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 5.4299ms
2025-07-28 15:17:48.247 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:17:48.249 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 15:17:48.251 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:17:48.252 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 2.8824ms
2025-07-28 15:17:48.255 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:17:48.256 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:17:48.258 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:17:48.259 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 4.8874ms
2025-07-28 15:17:48.262 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:17:48.264 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:17:48.265 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:17:48.267 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:17:48.269 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 5.1739ms
2025-07-28 15:17:48.271 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:18:05.457 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 15:18:05.458 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:18:05.459 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.5285ms
2025-07-28 15:18:05.460 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:18:05.461 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:18:05.463 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:18:05.464 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 3.6128ms
2025-07-28 15:18:05.465 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:18:08.380 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:18:08.381 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:18:08.382 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:18:08.383 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:18:08.383 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.057ms
2025-07-28 15:18:08.384 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.547ms
2025-07-28 15:18:08.385 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:18:08.387 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:18:08.388 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:18:08.389 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:18:08.390 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:18:08.390 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:18:08.391 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:18:08.392 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:18:08.392 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:18:08.393 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:18:08.394 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 7.3976ms
2025-07-28 15:18:08.399 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:18:08.403 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:18:08.404 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.9394ms
2025-07-28 15:18:08.404 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:18:08.405 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 19.6498ms
2025-07-28 15:22:32.646 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:22:32.647 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:32.648 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.0183ms
2025-07-28 15:22:32.650 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:22:32.652 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:32.698 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:32.700 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:22:32.700 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:22:32.707 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:22:32.711 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:22:32.711 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 10.5482ms
2025-07-28 15:22:32.712 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:22:32.713 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 62.8026ms
2025-07-28 15:22:32.714 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:22:32.715 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:32.716 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.5903ms
2025-07-28 15:22:32.717 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:22:32.718 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:32.720 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:32.721 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:22:32.721 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:22:32.722 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.3952ms
2025-07-28 15:22:32.730 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-28 15:22:32.731 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:32.731 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 1.449ms
2025-07-28 15:22:32.733 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:22:32.734 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:32.735 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:32.736 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 3.1379ms
2025-07-28 15:22:32.738 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:22:32.738 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 15:22:32.739 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:32.740 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.3962ms
2025-07-28 15:22:32.741 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:22:32.743 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:32.744 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:32.746 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 4.3491ms
2025-07-28 15:22:32.747 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:22:32.748 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 15:22:32.749 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:32.750 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.3457ms
2025-07-28 15:22:32.751 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:22:32.752 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:32.754 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:32.755 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 3.5025ms
2025-07-28 15:22:32.756 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:22:32.758 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:22:32.759 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:32.760 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:32.761 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.9347ms
2025-07-28 15:22:32.763 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:22:33.189 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:22:33.190 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.192 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:33.193 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.6325ms
2025-07-28 15:22:33.194 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:22:33.685 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - null null
2025-07-28 15:22:33.686 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.686 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - 204 null null 1.6057ms
2025-07-28 15:22:33.688 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - application/json null
2025-07-28 15:22:33.689 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.690 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:33.691 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - 404 0 null 3.4519ms
2025-07-28 15:22:33.693 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile, Response status code: 404
2025-07-28 15:22:33.694 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - null null
2025-07-28 15:22:33.695 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.695 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - 204 null null 1.3775ms
2025-07-28 15:22:33.696 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - application/json null
2025-07-28 15:22:33.697 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.699 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:33.700 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-07-28 15:22:33.700 +08:00 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUser(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-07-28 15:22:33.702 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:22:33.703 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserDto'.
2025-07-28 15:22:33.704 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api) in 3.0345ms
2025-07-28 15:22:33.704 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-07-28 15:22:33.705 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - 200 null application/json; charset=utf-8 8.5394ms
2025-07-28 15:22:33.706 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - null null
2025-07-28 15:22:33.707 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.708 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - 204 null null 1.5408ms
2025-07-28 15:22:33.709 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - application/json null
2025-07-28 15:22:33.710 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.711 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:33.712 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-07-28 15:22:33.712 +08:00 [INF] Route matched with {action = "GetUserStats", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserStats(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-07-28 15:22:33.714 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", s."Id", s."Category", s."CreatedAt", s."Description", s."Discount", s."Duration", s."EnrollmentType", s."Features", s."InstructorId", s."IsBestseller", s."Level", s."OriginalPrice", s."PreviewUrl", s."Price", s."Status", s."Thumbnail", s."Title", s."UpdatedAt", s."Id0", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id1", s."ApprovedAt", s."ApprovedBy", s."Comment", s."CourseId0", s."CreatedAt0", s."Rating", s."Status0", s."StudentId0"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", e."Id" AS "Id0", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", r."Id" AS "Id1", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId" AS "CourseId0", r."CreatedAt" AS "CreatedAt0", r."Rating", r."Status" AS "Status0", r."StudentId" AS "StudentId0"
    FROM "Courses" AS c
    LEFT JOIN "Enrollments" AS e ON c."Id" = e."CourseId"
    LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
) AS s ON a0."Id" = s."InstructorId"
ORDER BY a0."Id", s."Id", s."Id0"
2025-07-28 15:22:33.716 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserStatsDto'.
2025-07-28 15:22:33.716 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api) in 3.3561ms
2025-07-28 15:22:33.717 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-07-28 15:22:33.717 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - 200 null application/json; charset=utf-8 8.3752ms
2025-07-28 15:22:33.719 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - null null
2025-07-28 15:22:33.720 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.720 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - 204 null null 1.3009ms
2025-07-28 15:22:33.721 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - application/json null
2025-07-28 15:22:33.722 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.723 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:33.724 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - 404 0 null 2.8401ms
2025-07-28 15:22:33.726 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates, Response status code: 404
2025-07-28 15:22:33.726 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - null null
2025-07-28 15:22:33.727 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.728 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - 204 null null 1.292ms
2025-07-28 15:22:33.729 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - application/json null
2025-07-28 15:22:33.730 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.731 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:33.732 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - 404 0 null 2.7645ms
2025-07-28 15:22:33.733 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity, Response status code: 404
2025-07-28 15:22:33.734 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:22:33.735 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.735 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:33.736 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 2.5597ms
2025-07-28 15:22:33.738 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:22:33.738 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:22:33.739 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.740 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:33.741 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 2.5904ms
2025-07-28 15:22:33.742 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:22:33.743 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:22:33.744 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.745 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:33.746 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 2.5656ms
2025-07-28 15:22:33.747 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:22:33.748 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:22:33.749 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:33.750 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:33.751 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 2.5936ms
2025-07-28 15:22:33.752 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:22:34.938 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:22:34.940 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:34.941 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:34.942 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.5394ms
2025-07-28 15:22:34.943 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:22:35.912 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - application/json null
2025-07-28 15:22:35.913 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:35.914 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:35.915 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - 404 0 null 3.3559ms
2025-07-28 15:22:35.916 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile, Response status code: 404
2025-07-28 15:22:35.917 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - application/json null
2025-07-28 15:22:35.918 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:35.919 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:35.920 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-07-28 15:22:35.921 +08:00 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUser(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-07-28 15:22:35.922 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:22:35.923 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserDto'.
2025-07-28 15:22:35.923 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api) in 2.1256ms
2025-07-28 15:22:35.924 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-07-28 15:22:35.925 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - 200 null application/json; charset=utf-8 7.3883ms
2025-07-28 15:22:35.926 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - application/json null
2025-07-28 15:22:35.927 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:35.928 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:35.929 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-07-28 15:22:35.929 +08:00 [INF] Route matched with {action = "GetUserStats", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserStats(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-07-28 15:22:35.931 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", s."Id", s."Category", s."CreatedAt", s."Description", s."Discount", s."Duration", s."EnrollmentType", s."Features", s."InstructorId", s."IsBestseller", s."Level", s."OriginalPrice", s."PreviewUrl", s."Price", s."Status", s."Thumbnail", s."Title", s."UpdatedAt", s."Id0", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id1", s."ApprovedAt", s."ApprovedBy", s."Comment", s."CourseId0", s."CreatedAt0", s."Rating", s."Status0", s."StudentId0"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", e."Id" AS "Id0", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", r."Id" AS "Id1", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId" AS "CourseId0", r."CreatedAt" AS "CreatedAt0", r."Rating", r."Status" AS "Status0", r."StudentId" AS "StudentId0"
    FROM "Courses" AS c
    LEFT JOIN "Enrollments" AS e ON c."Id" = e."CourseId"
    LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
) AS s ON a0."Id" = s."InstructorId"
ORDER BY a0."Id", s."Id", s."Id0"
2025-07-28 15:22:35.933 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserStatsDto'.
2025-07-28 15:22:35.933 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api) in 3.1456ms
2025-07-28 15:22:35.934 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-07-28 15:22:35.934 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - 200 null application/json; charset=utf-8 8.2939ms
2025-07-28 15:22:35.936 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - application/json null
2025-07-28 15:22:35.937 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:35.938 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:35.939 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - 404 0 null 2.8421ms
2025-07-28 15:22:35.940 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates, Response status code: 404
2025-07-28 15:22:35.941 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - application/json null
2025-07-28 15:22:35.942 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:35.943 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:35.944 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - 404 0 null 2.7358ms
2025-07-28 15:22:35.945 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity, Response status code: 404
2025-07-28 15:22:35.946 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:22:35.947 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:35.948 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:35.949 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 2.7484ms
2025-07-28 15:22:35.950 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:22:35.951 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:22:35.952 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:35.952 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:35.953 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 2.6645ms
2025-07-28 15:22:35.955 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:22:35.956 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:22:35.957 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:35.958 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:35.959 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.0196ms
2025-07-28 15:22:35.960 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:22:35.961 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:22:35.962 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:35.963 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:35.964 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 2.791ms
2025-07-28 15:22:35.965 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:22:41.609 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 15:22:41.610 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:41.611 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.8046ms
2025-07-28 15:22:41.612 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:22:41.614 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:41.616 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:41.617 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 4.6164ms
2025-07-28 15:22:41.619 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:22:42.228 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:22:42.229 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:42.230 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.7949ms
2025-07-28 15:22:42.231 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:22:42.232 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:42.235 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:42.236 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:22:42.237 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:22:42.240 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:22:42.244 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:22:42.245 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.0058ms
2025-07-28 15:22:42.245 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:22:42.246 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 14.4807ms
2025-07-28 15:22:42.247 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:22:42.248 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:42.249 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.4845ms
2025-07-28 15:22:42.250 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:22:42.251 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:42.252 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:42.254 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:22:42.254 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:22:42.254 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.2978ms
2025-07-28 15:22:42.263 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-28 15:22:42.264 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:42.264 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 1.5739ms
2025-07-28 15:22:42.266 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:22:42.267 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:42.268 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:42.269 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 3.2867ms
2025-07-28 15:22:42.271 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:22:42.271 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:22:42.273 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:42.274 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:42.275 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.2359ms
2025-07-28 15:22:42.276 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:22:42.277 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 15:22:42.278 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:42.279 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.5736ms
2025-07-28 15:22:42.281 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:22:42.282 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:42.283 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:42.284 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 3.5175ms
2025-07-28 15:22:42.285 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:22:42.286 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:22:42.287 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:22:42.288 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:22:42.289 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 2.9992ms
2025-07-28 15:22:42.291 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:17.835 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:23:17.835 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:23:17.837 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:17.838 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:17.838 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.3721ms
2025-07-28 15:23:17.839 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.2081ms
2025-07-28 15:23:17.840 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:23:17.842 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:23:17.844 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:17.845 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:17.846 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:17.847 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:23:17.848 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:23:17.849 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 8.0458ms
2025-07-28 15:23:17.891 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:17.892 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:23:17.893 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:23:17.897 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:23:17.900 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:23:17.901 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9341ms
2025-07-28 15:23:17.901 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:23:17.902 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 59.7824ms
2025-07-28 15:23:20.873 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:23:20.875 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:20.876 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:20.877 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:23:20.877 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:23:20.881 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:23:20.884 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:23:20.885 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4583ms
2025-07-28 15:23:20.885 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:23:20.886 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 12.7048ms
2025-07-28 15:23:20.888 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:23:20.889 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:20.891 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:20.892 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:23:20.892 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:23:20.893 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 5.0637ms
2025-07-28 15:23:20.904 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-28 15:23:20.905 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:20.905 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 1.8413ms
2025-07-28 15:23:20.907 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:23:20.908 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:20.910 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:20.911 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 3.6273ms
2025-07-28 15:23:20.912 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:23:20.913 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 15:23:20.914 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:20.914 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.3385ms
2025-07-28 15:23:20.916 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:20.917 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:20.917 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:20.918 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 2.7214ms
2025-07-28 15:23:20.920 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:20.921 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 15:23:20.922 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:20.922 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.2911ms
2025-07-28 15:23:20.923 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:23:20.924 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:20.925 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:20.926 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 3.0241ms
2025-07-28 15:23:20.928 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:23:20.928 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:20.930 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:20.931 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:20.931 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 2.9531ms
2025-07-28 15:23:20.933 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:21.450 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:21.451 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:21.453 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:21.454 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 4.0024ms
2025-07-28 15:23:21.456 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:22.333 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - null null
2025-07-28 15:23:22.334 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:22.334 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - 204 null null 1.5726ms
2025-07-28 15:23:22.336 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - application/json null
2025-07-28 15:23:22.337 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:22.338 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:22.339 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - 404 0 null 3.1651ms
2025-07-28 15:23:22.340 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile, Response status code: 404
2025-07-28 15:23:22.341 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - null null
2025-07-28 15:23:22.342 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:22.343 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - 204 null null 1.6326ms
2025-07-28 15:23:22.344 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - application/json null
2025-07-28 15:23:22.345 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:22.346 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:22.348 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-07-28 15:23:22.348 +08:00 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUser(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-07-28 15:23:22.350 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:23:22.351 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserDto'.
2025-07-28 15:23:22.352 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api) in 3.3384ms
2025-07-28 15:23:22.353 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-07-28 15:23:22.353 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - 200 null application/json; charset=utf-8 9.1107ms
2025-07-28 15:23:22.355 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - null null
2025-07-28 15:23:22.356 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:22.356 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - 204 null null 1.5058ms
2025-07-28 15:23:22.358 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - application/json null
2025-07-28 15:23:22.359 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:22.360 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:22.361 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-07-28 15:23:22.362 +08:00 [INF] Route matched with {action = "GetUserStats", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserStats(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-07-28 15:23:22.366 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", s."Id", s."Category", s."CreatedAt", s."Description", s."Discount", s."Duration", s."EnrollmentType", s."Features", s."InstructorId", s."IsBestseller", s."Level", s."OriginalPrice", s."PreviewUrl", s."Price", s."Status", s."Thumbnail", s."Title", s."UpdatedAt", s."Id0", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id1", s."ApprovedAt", s."ApprovedBy", s."Comment", s."CourseId0", s."CreatedAt0", s."Rating", s."Status0", s."StudentId0"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", e."Id" AS "Id0", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", r."Id" AS "Id1", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId" AS "CourseId0", r."CreatedAt" AS "CreatedAt0", r."Rating", r."Status" AS "Status0", r."StudentId" AS "StudentId0"
    FROM "Courses" AS c
    LEFT JOIN "Enrollments" AS e ON c."Id" = e."CourseId"
    LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
) AS s ON a0."Id" = s."InstructorId"
ORDER BY a0."Id", s."Id", s."Id0"
2025-07-28 15:23:22.367 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserStatsDto'.
2025-07-28 15:23:22.368 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api) in 5.3151ms
2025-07-28 15:23:22.368 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-07-28 15:23:22.369 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - 200 null application/json; charset=utf-8 11.4278ms
2025-07-28 15:23:22.370 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - null null
2025-07-28 15:23:22.371 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:22.372 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - 204 null null 1.4178ms
2025-07-28 15:23:22.373 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - application/json null
2025-07-28 15:23:22.375 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:22.376 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:22.377 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - 404 0 null 3.4412ms
2025-07-28 15:23:22.378 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates, Response status code: 404
2025-07-28 15:23:22.379 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - null null
2025-07-28 15:23:22.380 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:22.380 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - 204 null null 1.341ms
2025-07-28 15:23:22.382 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - application/json null
2025-07-28 15:23:22.383 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:22.384 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:22.385 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - 404 0 null 3.0531ms
2025-07-28 15:23:22.386 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity, Response status code: 404
2025-07-28 15:23:22.387 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:23:22.388 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:22.389 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:22.390 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 2.8445ms
2025-07-28 15:23:22.391 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:23:22.392 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:22.393 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:22.394 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:22.395 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 2.6647ms
2025-07-28 15:23:22.396 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:22.397 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:22.398 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:22.399 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:22.400 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 2.5973ms
2025-07-28 15:23:22.401 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:22.402 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:23:22.403 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:22.403 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:22.404 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 2.5527ms
2025-07-28 15:23:22.405 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:23:24.300 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:24.302 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:24.303 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:24.304 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.447ms
2025-07-28 15:23:24.305 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:25.122 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:23:25.123 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:25.124 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.5691ms
2025-07-28 15:23:25.125 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:23:25.126 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:25.127 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:25.128 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:23:25.129 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:23:25.132 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:23:25.136 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:23:25.136 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.5662ms
2025-07-28 15:23:25.137 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:23:25.137 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 12.22ms
2025-07-28 15:23:25.139 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:23:25.140 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:25.140 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.4368ms
2025-07-28 15:23:25.142 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:23:25.143 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:25.144 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:25.145 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:23:25.146 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:23:25.146 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.1909ms
2025-07-28 15:23:25.153 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:23:25.155 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:25.156 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:25.158 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 4.4317ms
2025-07-28 15:23:25.159 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:23:25.161 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:25.162 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:25.163 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:25.164 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.375ms
2025-07-28 15:23:25.165 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:25.166 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:23:25.167 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:25.168 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:25.169 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 2.8307ms
2025-07-28 15:23:25.170 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:23:25.173 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:25.174 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:25.176 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:25.177 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 4.4779ms
2025-07-28 15:23:25.179 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:26.645 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 15:23:26.646 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:26.647 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.8915ms
2025-07-28 15:23:26.648 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:26.649 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:26.651 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:26.652 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.5258ms
2025-07-28 15:23:26.653 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:33.101 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:23:33.102 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:33.102 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.7024ms
2025-07-28 15:23:33.104 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:23:33.105 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:33.106 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:33.107 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:23:33.108 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:23:33.112 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:23:33.116 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:23:33.117 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.4978ms
2025-07-28 15:23:33.117 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:23:33.118 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.89ms
2025-07-28 15:23:33.119 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:23:33.120 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:33.121 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.4238ms
2025-07-28 15:23:33.122 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:23:33.123 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:33.124 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:33.126 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:23:33.126 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:23:33.127 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.8382ms
2025-07-28 15:23:33.134 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-28 15:23:33.135 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:33.135 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 1.4447ms
2025-07-28 15:23:33.137 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:23:33.138 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:33.139 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:33.140 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 3.323ms
2025-07-28 15:23:33.142 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:23:33.143 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 15:23:33.144 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:33.144 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.387ms
2025-07-28 15:23:33.145 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:33.146 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:33.148 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:33.149 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.1685ms
2025-07-28 15:23:33.150 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:33.151 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 15:23:33.152 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:33.152 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.3628ms
2025-07-28 15:23:33.154 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:23:33.154 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:33.156 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:33.157 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 3.1472ms
2025-07-28 15:23:33.158 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:23:33.160 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:33.161 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:33.162 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:33.163 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.3822ms
2025-07-28 15:23:33.165 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:33.650 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:23:33.650 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:23:33.651 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:33.652 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:33.654 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:33.654 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:33.654 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:23:33.656 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:23:33.656 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:23:33.657 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:23:33.658 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 7.7023ms
2025-07-28 15:23:33.663 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:23:33.666 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:23:33.667 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.063ms
2025-07-28 15:23:33.667 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:23:33.668 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 17.9307ms
2025-07-28 15:23:43.201 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:23:43.203 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:43.203 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.9361ms
2025-07-28 15:23:43.205 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:23:43.206 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:43.207 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:43.208 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:23:43.209 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:23:43.213 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:23:43.216 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:23:43.217 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.7424ms
2025-07-28 15:23:43.217 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:23:43.218 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.142ms
2025-07-28 15:23:43.220 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:23:43.221 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:43.221 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.5258ms
2025-07-28 15:23:43.222 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:23:43.223 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:43.225 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:43.226 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:23:43.226 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:23:43.227 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.4445ms
2025-07-28 15:23:43.233 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-28 15:23:43.234 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:43.234 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 1.6145ms
2025-07-28 15:23:43.236 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:23:43.237 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:43.238 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:43.239 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 3.4718ms
2025-07-28 15:23:43.241 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:23:43.242 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 15:23:43.243 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:43.243 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.6011ms
2025-07-28 15:23:43.245 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:43.246 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:43.247 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:43.248 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.0472ms
2025-07-28 15:23:43.249 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:43.250 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 15:23:43.251 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:43.251 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.2901ms
2025-07-28 15:23:43.253 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:23:43.254 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:43.255 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:43.255 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 2.8325ms
2025-07-28 15:23:43.257 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:23:43.258 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:43.259 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:43.260 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:43.261 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.4192ms
2025-07-28 15:23:43.263 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:44.963 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:44.964 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:44.965 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:44.966 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.7008ms
2025-07-28 15:23:44.968 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:45.788 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - null null
2025-07-28 15:23:45.789 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:45.790 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - 204 null null 2.0528ms
2025-07-28 15:23:45.792 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - application/json null
2025-07-28 15:23:45.794 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:45.795 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:45.797 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - 404 0 null 4.7698ms
2025-07-28 15:23:45.799 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile, Response status code: 404
2025-07-28 15:23:45.800 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - null null
2025-07-28 15:23:45.801 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:45.802 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - 204 null null 1.8875ms
2025-07-28 15:23:45.804 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - application/json null
2025-07-28 15:23:45.805 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:45.806 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:45.807 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-07-28 15:23:45.808 +08:00 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUser(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-07-28 15:23:45.810 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:23:45.811 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserDto'.
2025-07-28 15:23:45.812 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api) in 2.9837ms
2025-07-28 15:23:45.813 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-07-28 15:23:45.813 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - 200 null application/json; charset=utf-8 9.8189ms
2025-07-28 15:23:45.815 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - null null
2025-07-28 15:23:45.816 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:45.817 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - 204 null null 1.6221ms
2025-07-28 15:23:45.818 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - application/json null
2025-07-28 15:23:45.819 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:45.821 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:45.822 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-07-28 15:23:45.822 +08:00 [INF] Route matched with {action = "GetUserStats", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserStats(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-07-28 15:23:45.824 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", s."Id", s."Category", s."CreatedAt", s."Description", s."Discount", s."Duration", s."EnrollmentType", s."Features", s."InstructorId", s."IsBestseller", s."Level", s."OriginalPrice", s."PreviewUrl", s."Price", s."Status", s."Thumbnail", s."Title", s."UpdatedAt", s."Id0", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id1", s."ApprovedAt", s."ApprovedBy", s."Comment", s."CourseId0", s."CreatedAt0", s."Rating", s."Status0", s."StudentId0"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", e."Id" AS "Id0", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", r."Id" AS "Id1", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId" AS "CourseId0", r."CreatedAt" AS "CreatedAt0", r."Rating", r."Status" AS "Status0", r."StudentId" AS "StudentId0"
    FROM "Courses" AS c
    LEFT JOIN "Enrollments" AS e ON c."Id" = e."CourseId"
    LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
) AS s ON a0."Id" = s."InstructorId"
ORDER BY a0."Id", s."Id", s."Id0"
2025-07-28 15:23:45.826 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserStatsDto'.
2025-07-28 15:23:45.827 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api) in 3.9114ms
2025-07-28 15:23:45.828 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-07-28 15:23:45.829 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - 200 null application/json; charset=utf-8 10.1648ms
2025-07-28 15:23:45.830 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - null null
2025-07-28 15:23:45.832 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:45.832 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - 204 null null 1.9281ms
2025-07-28 15:23:45.834 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - application/json null
2025-07-28 15:23:45.835 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:45.837 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:45.838 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - 404 0 null 3.8652ms
2025-07-28 15:23:45.840 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates, Response status code: 404
2025-07-28 15:23:45.842 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - null null
2025-07-28 15:23:45.843 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:45.844 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - 204 null null 2.175ms
2025-07-28 15:23:45.846 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - application/json null
2025-07-28 15:23:45.847 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:45.849 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:45.850 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - 404 0 null 4.3278ms
2025-07-28 15:23:45.852 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity, Response status code: 404
2025-07-28 15:23:45.853 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:23:45.855 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:45.856 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:45.857 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 3.799ms
2025-07-28 15:23:45.859 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:23:45.860 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:45.861 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:45.862 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:45.863 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.039ms
2025-07-28 15:23:45.864 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:45.865 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:23:45.866 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:45.868 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:45.869 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.4776ms
2025-07-28 15:23:45.870 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:23:45.871 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:23:45.872 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:45.873 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:45.874 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 2.9653ms
2025-07-28 15:23:45.876 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:23:50.140 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:23:50.140 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:23:50.141 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:50.142 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:50.143 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.0474ms
2025-07-28 15:23:50.143 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.0919ms
2025-07-28 15:23:50.144 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:23:50.146 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:23:50.147 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:50.148 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:23:50.149 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:50.149 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:23:50.150 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:23:50.151 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:23:50.151 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:23:50.152 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:23:50.153 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 8.7415ms
2025-07-28 15:23:50.155 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:23:50.158 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:23:50.159 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.3153ms
2025-07-28 15:23:50.160 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:23:50.160 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 14.5696ms
2025-07-28 15:24:19.384 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-28 15:24:19.385 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:19.385 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 1.5131ms
2025-07-28 15:24:19.387 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-28 15:24:19.388 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:19.389 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:24:19.390 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 15:24:19.391 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 15:24:19.394 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-28 15:24:19.405 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
2025-07-28 15:24:19.406 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType26`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:24:19.407 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 14.746ms
2025-07-28 15:24:19.407 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 15:24:19.408 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 21.184ms
2025-07-28 15:24:19.415 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:24:19.417 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:19.417 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.5201ms
2025-07-28 15:24:19.418 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:24:19.419 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:24:19.420 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:19.421 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:19.422 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.6789ms
2025-07-28 15:24:19.422 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:24:19.424 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:24:19.424 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:24:19.426 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:19.427 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:24:19.427 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-28 15:24:19.428 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 3.9994ms
2025-07-28 15:24:19.429 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:24:19.432 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:24:19.433 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4261ms
2025-07-28 15:24:19.434 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:24:19.434 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 15.2444ms
2025-07-28 15:24:21.808 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-28 15:24:21.810 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:21.811 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 2.1589ms
2025-07-28 15:24:21.812 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 55
2025-07-28 15:24:21.813 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:21.814 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 15:24:21.814 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 15:24:21.816 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 15:24:21.863 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-28 15:24:21.864 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-28 15:24:21.865 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 49.9226ms
2025-07-28 15:24:21.866 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 15:24:21.866 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 53.9548ms
2025-07-28 15:24:21.876 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:24:21.876 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:24:21.877 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:21.878 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:21.878 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.5125ms
2025-07-28 15:24:21.878 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.7358ms
2025-07-28 15:24:21.880 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:24:21.881 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:24:21.882 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:21.883 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:21.885 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:24:21.885 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:24:21.886 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:24:21.887 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:24:21.887 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:24:21.888 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:24:21.889 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 7.646ms
2025-07-28 15:24:21.891 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:24:21.894 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:24:21.895 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.2577ms
2025-07-28 15:24:21.895 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:24:21.896 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 15.9728ms
2025-07-28 15:24:24.720 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:24:24.722 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:24.723 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:24:24.724 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:24:24.725 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:24:24.729 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:24:24.732 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:24:24.733 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9109ms
2025-07-28 15:24:24.733 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:24:24.734 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.4892ms
2025-07-28 15:24:24.735 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:24:24.737 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:24.738 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:24:24.739 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:24:24.739 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:24:24.740 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.3779ms
2025-07-28 15:24:24.746 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-28 15:24:24.748 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:24.748 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 1.9536ms
2025-07-28 15:24:24.749 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:24:24.750 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:24.752 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:24:24.753 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 3.1427ms
2025-07-28 15:24:24.754 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:24:24.755 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 15:24:24.756 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:24.756 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.2795ms
2025-07-28 15:24:24.757 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:24:24.758 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:24.760 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:24:24.761 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.2154ms
2025-07-28 15:24:24.762 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:24:24.764 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 15:24:24.765 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:24.766 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.7609ms
2025-07-28 15:24:24.767 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:24:24.768 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:24.770 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:24:24.771 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 3.4707ms
2025-07-28 15:24:24.772 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:24:24.773 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:24:24.774 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:24.776 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:24:24.777 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.6346ms
2025-07-28 15:24:24.778 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:24:27.979 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:24:27.979 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:24:27.980 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:27.982 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:27.982 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.2865ms
2025-07-28 15:24:27.982 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.5429ms
2025-07-28 15:24:27.984 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:24:27.985 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:24:27.986 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:27.987 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:24:27.988 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:24:27.988 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:24:27.989 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:24:27.990 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:24:27.991 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:24:27.992 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:24:27.992 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 8.6592ms
2025-07-28 15:24:27.997 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:24:28.000 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:24:28.000 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.6182ms
2025-07-28 15:24:28.001 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:24:28.002 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 16.4461ms
2025-07-28 15:26:13.474 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-28 15:26:13.476 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:13.476 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 1.6224ms
2025-07-28 15:26:13.477 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-28 15:26:13.478 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:13.480 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:26:13.482 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 15:26:13.483 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 15:26:13.485 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-28 15:26:13.488 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
2025-07-28 15:26:13.489 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType26`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:26:13.489 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 5.8252ms
2025-07-28 15:26:13.490 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 15:26:13.491 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 13.2308ms
2025-07-28 15:26:13.500 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:26:13.501 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:26:13.501 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:13.503 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:13.503 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.286ms
2025-07-28 15:26:13.504 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.8397ms
2025-07-28 15:26:13.505 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:26:13.506 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:26:13.508 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:13.509 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:13.509 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:26:13.510 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:26:13.511 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-28 15:26:13.511 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:26:13.512 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 6.8889ms
2025-07-28 15:26:13.516 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:26:13.521 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:26:13.522 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.9404ms
2025-07-28 15:26:13.523 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:26:13.524 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 17.3204ms
2025-07-28 15:26:18.434 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:26:18.434 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:26:18.436 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:18.437 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:18.438 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:26:18.439 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:26:18.439 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:26:18.440 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-28 15:26:18.443 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 8.9541ms
2025-07-28 15:26:18.446 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:26:18.451 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:26:18.452 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.9715ms
2025-07-28 15:26:18.452 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:26:18.453 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 19.3699ms
2025-07-28 15:26:29.180 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:26:29.181 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:29.181 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.6953ms
2025-07-28 15:26:29.183 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:26:29.184 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:29.185 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:26:29.185 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:26:29.189 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:26:29.193 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:26:29.194 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.4754ms
2025-07-28 15:26:29.195 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:26:29.196 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 12.8619ms
2025-07-28 15:26:29.198 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:26:29.199 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:29.200 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.8631ms
2025-07-28 15:26:29.201 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:26:29.203 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:29.203 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:26:29.204 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-28 15:26:29.204 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 2.7108ms
2025-07-28 15:26:40.407 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-28 15:26:40.408 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:40.408 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 1.6356ms
2025-07-28 15:26:40.410 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 55
2025-07-28 15:26:40.411 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:40.412 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 15:26:40.412 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 15:26:40.415 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 15:26:40.463 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-28 15:26:40.464 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-28 15:26:40.465 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 51.2927ms
2025-07-28 15:26:40.465 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 15:26:40.466 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 55.9778ms
2025-07-28 15:26:40.479 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:26:40.479 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:26:40.480 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:40.481 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:40.482 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.9494ms
2025-07-28 15:26:40.482 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 2.9597ms
2025-07-28 15:26:40.483 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:26:40.485 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:26:40.486 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:40.487 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:26:40.488 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:26:40.488 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:26:40.489 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:26:40.490 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:26:40.491 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:26:40.491 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:26:40.493 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 8.091ms
2025-07-28 15:26:40.495 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:26:40.498 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:26:40.499 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9236ms
2025-07-28 15:26:40.500 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:26:40.500 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 16.9754ms
2025-07-28 15:28:36.651 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:28:36.651 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:28:36.652 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:28:36.654 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:28:36.654 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.5321ms
2025-07-28 15:28:36.655 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.9092ms
2025-07-28 15:28:36.657 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:28:36.659 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:28:36.660 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:28:36.661 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:28:36.708 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:28:36.709 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:28:36.709 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:28:36.710 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 52.7751ms
2025-07-28 15:28:36.710 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:28:36.713 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:28:36.713 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:28:36.721 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:28:36.724 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:28:36.725 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 10.7638ms
2025-07-28 15:28:36.725 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:28:36.726 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 67.0809ms
2025-07-28 15:28:37.948 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:28:37.950 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:28:37.951 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:28:37.952 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:28:37.953 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:28:37.956 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:28:37.959 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:28:37.960 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.6922ms
2025-07-28 15:28:37.961 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:28:37.962 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.6301ms
2025-07-28 15:28:37.964 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:28:37.965 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:28:37.966 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:28:37.967 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:28:37.968 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:28:37.968 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.6479ms
2025-07-28 15:28:37.983 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-28 15:28:37.985 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:28:37.985 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 2.1679ms
2025-07-28 15:28:37.987 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:28:37.988 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:28:37.989 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:28:37.990 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 3.3037ms
2025-07-28 15:28:37.992 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:28:37.993 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 15:28:37.994 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:28:37.994 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.2941ms
2025-07-28 15:28:37.995 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:28:37.996 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:28:38.001 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:28:38.002 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 6.6919ms
2025-07-28 15:28:38.004 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:28:38.004 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 15:28:38.006 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:28:38.006 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.5423ms
2025-07-28 15:28:38.008 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:28:38.009 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:28:38.011 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:28:38.012 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 3.9909ms
2025-07-28 15:28:38.013 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:28:38.016 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:28:38.017 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:28:38.018 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:28:38.019 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.4991ms
2025-07-28 15:28:38.021 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:29:01.865 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 15:29:01.866 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:01.867 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 2.0612ms
2025-07-28 15:29:01.869 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:29:01.870 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:01.871 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:01.873 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 4.1775ms
2025-07-28 15:29:01.875 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:29:10.624 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:29:10.626 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:10.627 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 2.3772ms
2025-07-28 15:29:10.629 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:29:10.630 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:10.632 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:10.634 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:29:10.634 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:29:10.638 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:29:10.641 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:29:10.642 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9965ms
2025-07-28 15:29:10.643 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:29:10.643 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 14.15ms
2025-07-28 15:29:10.645 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:29:10.646 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:10.647 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.9486ms
2025-07-28 15:29:10.648 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:29:10.649 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:10.651 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:10.652 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:29:10.652 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:29:10.653 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.3033ms
2025-07-28 15:29:10.662 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-28 15:29:10.664 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:10.665 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 2.6035ms
2025-07-28 15:29:10.667 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:29:10.668 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:10.669 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:10.671 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 4.0182ms
2025-07-28 15:29:10.672 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:29:10.673 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 15:29:10.675 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:10.675 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.4773ms
2025-07-28 15:29:10.676 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:29:10.678 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:10.679 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:10.680 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.4199ms
2025-07-28 15:29:10.681 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:29:10.682 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 15:29:10.683 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:10.684 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.4465ms
2025-07-28 15:29:10.685 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:29:10.686 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:10.688 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:10.689 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 3.3649ms
2025-07-28 15:29:10.690 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:29:10.692 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:29:10.693 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:10.695 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:10.696 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.6465ms
2025-07-28 15:29:10.698 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:29:40.189 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - null null
2025-07-28 15:29:40.191 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.191 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - 204 null null 2.0506ms
2025-07-28 15:29:40.193 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - application/json null
2025-07-28 15:29:40.194 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.195 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:40.197 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile - 404 0 null 4.0592ms
2025-07-28 15:29:40.198 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/profile, Response status code: 404
2025-07-28 15:29:40.200 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - null null
2025-07-28 15:29:40.201 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.201 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - 204 null null 1.6143ms
2025-07-28 15:29:40.203 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - application/json null
2025-07-28 15:29:40.204 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.205 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:40.206 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-07-28 15:29:40.207 +08:00 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUser(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-07-28 15:29:40.208 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:29:40.209 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserDto'.
2025-07-28 15:29:40.210 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api) in 2.6538ms
2025-07-28 15:29:40.211 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-07-28 15:29:40.212 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432 - 200 null application/json; charset=utf-8 8.777ms
2025-07-28 15:29:40.213 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - null null
2025-07-28 15:29:40.214 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.215 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - 204 null null 1.6051ms
2025-07-28 15:29:40.216 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - application/json null
2025-07-28 15:29:40.217 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.218 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:40.219 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-07-28 15:29:40.220 +08:00 [INF] Route matched with {action = "GetUserStats", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserStats(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-07-28 15:29:40.222 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", s."Id", s."Category", s."CreatedAt", s."Description", s."Discount", s."Duration", s."EnrollmentType", s."Features", s."InstructorId", s."IsBestseller", s."Level", s."OriginalPrice", s."PreviewUrl", s."Price", s."Status", s."Thumbnail", s."Title", s."UpdatedAt", s."Id0", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id1", s."ApprovedAt", s."ApprovedBy", s."Comment", s."CourseId0", s."CreatedAt0", s."Rating", s."Status0", s."StudentId0"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", e."Id" AS "Id0", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", r."Id" AS "Id1", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId" AS "CourseId0", r."CreatedAt" AS "CreatedAt0", r."Rating", r."Status" AS "Status0", r."StudentId" AS "StudentId0"
    FROM "Courses" AS c
    LEFT JOIN "Enrollments" AS e ON c."Id" = e."CourseId"
    LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
) AS s ON a0."Id" = s."InstructorId"
ORDER BY a0."Id", s."Id", s."Id0"
2025-07-28 15:29:40.223 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserStatsDto'.
2025-07-28 15:29:40.224 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api) in 3.4507ms
2025-07-28 15:29:40.225 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-07-28 15:29:40.225 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/stats - 200 null application/json; charset=utf-8 9.0606ms
2025-07-28 15:29:40.227 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - null null
2025-07-28 15:29:40.228 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.228 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - 204 null null 1.5295ms
2025-07-28 15:29:40.230 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - application/json null
2025-07-28 15:29:40.232 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.233 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:40.234 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates - 404 0 null 4.3485ms
2025-07-28 15:29:40.236 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/certificates, Response status code: 404
2025-07-28 15:29:40.237 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - null null
2025-07-28 15:29:40.238 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.238 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - 204 null null 1.3111ms
2025-07-28 15:29:40.239 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - application/json null
2025-07-28 15:29:40.240 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.241 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:40.242 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity - 404 0 null 3.0682ms
2025-07-28 15:29:40.244 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/1de5783a-d5cb-447a-a9c8-aa821ab9c432/activity, Response status code: 404
2025-07-28 15:29:40.245 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - null null
2025-07-28 15:29:40.246 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.246 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/stats - 204 null null 1.3312ms
2025-07-28 15:29:40.247 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/stats - application/json null
2025-07-28 15:29:40.248 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.249 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:40.250 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/stats - 404 0 null 2.8882ms
2025-07-28 15:29:40.252 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/stats, Response status code: 404
2025-07-28 15:29:40.253 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - null null
2025-07-28 15:29:40.254 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.254 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/subscriptions/current - 204 null null 1.2927ms
2025-07-28 15:29:40.255 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:29:40.256 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.257 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:40.258 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 3.0756ms
2025-07-28 15:29:40.260 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:29:40.262 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - application/json null
2025-07-28 15:29:40.263 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.265 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:40.266 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/subscriptions/current - 404 0 null 4.2909ms
2025-07-28 15:29:40.267 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/subscriptions/current, Response status code: 404
2025-07-28 15:29:40.269 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - null null
2025-07-28 15:29:40.270 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.270 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/students/courses - 204 null null 1.471ms
2025-07-28 15:29:40.271 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/students/courses - application/json null
2025-07-28 15:29:40.273 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:40.274 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:40.275 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/students/courses - 404 0 null 3.4729ms
2025-07-28 15:29:40.276 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/students/courses, Response status code: 404
2025-07-28 15:29:46.845 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - null null
2025-07-28 15:29:46.846 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:46.847 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/logout - 204 null null 1.7354ms
2025-07-28 15:29:46.848 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/logout - application/json 0
2025-07-28 15:29:46.849 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:46.851 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:46.852 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 15:29:46.852 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 15:29:46.854 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r."Id", r."CreatedAt", r."CreatedByIp", r."ExpiresAt", r."ReplacedByToken", r."RevokedAt", r."RevokedByIp", r."Token", r."UserId"
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN "RefreshTokens" AS r ON a0."Id" = r."UserId"
ORDER BY a0."Id"
2025-07-28 15:29:46.866 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "RefreshTokens" SET "RevokedAt" = @p0
WHERE "Id" = @p1;
2025-07-28 15:29:46.867 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType26`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:29:46.868 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 15.1055ms
2025-07-28 15:29:46.869 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-07-28 15:29:46.869 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/logout - 200 null application/json; charset=utf-8 21.0626ms
2025-07-28 15:29:50.838 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - null null
2025-07-28 15:29:50.840 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:50.840 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/auth/login - 204 null null 2.1083ms
2025-07-28 15:29:50.842 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5295/api/auth/login - application/json 64
2025-07-28 15:29:50.843 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:50.843 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 15:29:50.844 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-07-28 15:29:50.846 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 15:29:50.894 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO "RefreshTokens" ("CreatedAt", "CreatedByIp", "ExpiresAt", "ReplacedByToken", "RevokedAt", "RevokedByIp", "Token", "UserId")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING "Id";
2025-07-28 15:29:50.896 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-07-28 15:29:50.897 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 52.1558ms
2025-07-28 15:29:50.897 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-07-28 15:29:50.898 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5295/api/auth/login - 200 null application/json; charset=utf-8 56.1645ms
2025-07-28 15:29:50.923 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:29:50.923 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:29:50.925 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:50.926 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:50.927 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 3.5831ms
2025-07-28 15:29:50.927 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 3.9342ms
2025-07-28 15:29:50.929 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:29:50.930 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:29:50.932 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:50.933 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:50.935 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:50.935 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:50.936 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:29:50.937 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:29:50.938 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:29:50.938 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:29:50.938 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 9.6031ms
2025-07-28 15:29:50.943 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:29:50.946 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:29:50.947 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.3346ms
2025-07-28 15:29:50.947 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:29:50.948 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 17.6995ms
2025-07-28 15:29:50.950 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - null null
2025-07-28 15:29:50.951 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:50.952 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - 204 null null 1.8925ms
2025-07-28 15:29:50.953 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - application/json null
2025-07-28 15:29:50.955 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:50.956 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:50.957 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - 404 0 null 3.7763ms
2025-07-28 15:29:50.959 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats, Response status code: 404
2025-07-28 15:29:50.960 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:29:50.962 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:50.962 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 1.8493ms
2025-07-28 15:29:50.964 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:29:50.965 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:50.967 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:50.969 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:29:50.969 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:29:50.976 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:29:50.979 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:29:50.980 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.6849ms
2025-07-28 15:29:50.981 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:29:50.981 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 17.5017ms
2025-07-28 15:29:52.638 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:29:52.640 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:52.641 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:52.642 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:29:52.643 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:29:52.646 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:29:52.650 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:29:52.650 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.8593ms
2025-07-28 15:29:52.651 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:29:52.651 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 13.0959ms
2025-07-28 15:29:52.653 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:29:52.654 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:52.656 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:52.657 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:29:52.657 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:29:52.658 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.6182ms
2025-07-28 15:29:52.663 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:29:52.663 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:29:52.665 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:52.666 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:52.666 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 3.0293ms
2025-07-28 15:29:52.667 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 3.1973ms
2025-07-28 15:29:52.668 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:29:52.670 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:29:52.671 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:52.672 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:52.673 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:52.673 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:52.674 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:29:52.675 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:29:52.676 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:29:52.676 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:29:52.678 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:29:52.678 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:29:52.681 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:29:52.682 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:29:52.683 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:29:52.684 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 6.1558ms
2025-07-28 15:29:52.685 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:29:52.685 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:29:52.685 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 17.0358ms
2025-07-28 15:29:52.687 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:29:52.690 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:29:52.691 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:29:52.692 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 14.4905ms
2025-07-28 15:29:52.692 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:29:52.693 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 23.0704ms
2025-07-28 15:29:54.381 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:29:54.381 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:29:54.382 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:54.384 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:54.386 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:54.386 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:54.387 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:29:54.388 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:29:54.388 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:29:54.389 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:29:54.389 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 8.7369ms
2025-07-28 15:29:54.393 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:29:54.396 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:29:54.397 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.6871ms
2025-07-28 15:29:54.398 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:29:54.398 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 17.3543ms
2025-07-28 15:29:54.400 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - application/json null
2025-07-28 15:29:54.401 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:54.402 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:54.403 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats - 404 0 null 3.289ms
2025-07-28 15:29:54.405 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5295/api/users/9a460b27-0204-4b6e-a1f4-79ef838d0b5f/instructor-stats, Response status code: 404
2025-07-28 15:29:54.410 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:29:54.411 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:54.412 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:54.413 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:29:54.414 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:29:54.417 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:29:54.421 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:29:54.421 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.5856ms
2025-07-28 15:29:54.422 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:29:54.423 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses?instructorId=9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 12.9765ms
2025-07-28 15:29:59.415 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:29:59.417 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:59.417 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 1.986ms
2025-07-28 15:29:59.419 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:29:59.420 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:29:59.422 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:29:59.423 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:29:59.423 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:29:59.425 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:29:59.427 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:29:59.429 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:29:59.431 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:29:59.433 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:29:59.434 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:29:59.435 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 10.4488ms
2025-07-28 15:29:59.435 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:29:59.436 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 17.2087ms
2025-07-28 15:30:03.225 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:30:03.227 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:03.227 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.1273ms
2025-07-28 15:30:03.229 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:30:03.230 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:03.232 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:30:03.233 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:30:03.234 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:30:03.236 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:30:03.237 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:30:03.238 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:30:03.239 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 4.0116ms
2025-07-28 15:30:03.240 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:30:03.240 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 11.0789ms
2025-07-28 15:30:03.242 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:30:03.243 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:03.244 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:30:03.245 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:30:03.245 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:30:03.247 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:30:03.249 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:30:03.251 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:30:03.253 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:30:03.254 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:30:03.255 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:30:03.256 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 10.2288ms
2025-07-28 15:30:03.257 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:30:03.257 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 15.7958ms
2025-07-28 15:30:04.892 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:30:04.894 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:04.894 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.3345ms
2025-07-28 15:30:04.896 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:30:04.897 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:04.898 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:30:04.899 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:30:04.900 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:30:04.903 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:30:04.905 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:30:04.907 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:30:04.909 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:30:04.911 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:30:04.913 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:30:04.914 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 12.2249ms
2025-07-28 15:30:04.914 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:30:04.915 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 19.0811ms
2025-07-28 15:30:11.140 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 15:30:11.141 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:11.142 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 1.6931ms
2025-07-28 15:30:11.144 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 15:30:11.145 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:11.147 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:30:11.149 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:30:11.149 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 15:30:11.153 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 15:30:11.156 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 15:30:11.157 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.5948ms
2025-07-28 15:30:11.157 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 15:30:11.158 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 14.232ms
2025-07-28 15:30:11.160 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 15:30:11.161 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:11.161 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 1.5184ms
2025-07-28 15:30:11.163 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 15:30:11.164 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:11.165 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:30:11.166 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 15:30:11.167 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-07-28 15:30:11.168 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 403 0 null 4.8335ms
2025-07-28 15:30:11.169 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:30:11.169 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:30:11.170 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:11.171 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:11.171 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.3904ms
2025-07-28 15:30:11.172 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 2.7188ms
2025-07-28 15:30:11.173 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:30:11.175 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:30:11.176 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:11.178 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:11.179 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:30:11.179 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:30:11.180 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:30:11.181 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:30:11.182 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:30:11.182 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:30:11.185 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:30:11.185 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:30:11.188 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:30:11.189 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:30:11.190 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:30:11.190 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:30:11.192 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:30:11.192 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 7.748ms
2025-07-28 15:30:11.194 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:30:11.194 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:30:11.194 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 20.9844ms
2025-07-28 15:30:11.196 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:30:11.198 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 14.4713ms
2025-07-28 15:30:11.198 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:30:11.199 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 24.0952ms
2025-07-28 15:30:13.599 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:30:13.601 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:13.602 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:30:13.603 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:30:13.603 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:30:13.605 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:30:13.607 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:30:13.609 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:30:13.610 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:30:13.612 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:30:13.613 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:30:13.614 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 9.3818ms
2025-07-28 15:30:13.614 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:30:13.615 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 15.7413ms
2025-07-28 15:30:15.184 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:30:15.186 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:15.187 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:30:15.188 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:30:15.188 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:30:15.190 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:30:15.191 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:30:15.192 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:30:15.193 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 3.6875ms
2025-07-28 15:30:15.193 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:30:15.194 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 9.3455ms
2025-07-28 15:30:15.195 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:30:15.196 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:15.197 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:30:15.198 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:30:15.199 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:30:15.201 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:30:15.203 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:30:15.204 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:30:15.206 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:30:15.207 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:30:15.208 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:30:15.209 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 9.2689ms
2025-07-28 15:30:15.210 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:30:15.210 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 14.9068ms
2025-07-28 15:30:17.662 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:30:17.664 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:17.664 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 1.9926ms
2025-07-28 15:30:17.666 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:30:17.667 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:17.668 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:30:17.669 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:30:17.670 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-07-28 15:30:17.671 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-07-28 15:30:17.673 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
WHERE c."InstructorId" = @__instructorId_0
2025-07-28 15:30:17.674 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-07-28 15:30:17.674 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 3.5169ms
2025-07-28 15:30:17.675 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-07-28 15:30:17.675 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/revenue/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 9.6568ms
2025-07-28 15:30:17.677 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:30:17.678 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:17.678 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 1.2997ms
2025-07-28 15:30:17.679 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:30:17.680 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:30:17.681 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:30:17.682 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:30:17.683 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:30:17.685 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:30:17.687 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:30:17.688 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:30:17.690 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:30:17.691 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:30:17.692 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:30:17.693 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 9.1361ms
2025-07-28 15:30:17.694 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:30:17.694 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 14.8324ms
2025-07-28 15:31:34.769 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - null null
2025-07-28 15:31:34.770 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:31:34.771 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 204 null null 1.5809ms
2025-07-28 15:31:34.772 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - application/json null
2025-07-28 15:31:34.773 +08:00 [INF] CORS policy execution successful.
2025-07-28 15:31:34.775 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "RefreshTokens" AS r
    WHERE r."UserId" = @__userId_0 AND r."RevokedAt" IS NULL AND now() < r."ExpiresAt")
2025-07-28 15:31:34.776 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:31:34.777 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-07-28 15:31:34.779 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt", s."Id", s."CertificateUrl", s."CompletedAt", s."CourseId", s."EnrolledAt", s."ProgressPercentage", s."StudentId", s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId"
FROM "Courses" AS c
LEFT JOIN (
    SELECT e."Id", e."CertificateUrl", e."CompletedAt", e."CourseId", e."EnrolledAt", e."ProgressPercentage", e."StudentId", a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "Enrollments" AS e
    INNER JOIN "AspNetUsers" AS a ON e."StudentId" = a."Id"
) AS s ON c."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c."Id" = r."CourseId"
WHERE c."InstructorId" = @__instructorId_0
ORDER BY c."Id", s."Id", s."Id0"
2025-07-28 15:31:34.781 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(p."Amount"), 0.0)
FROM "Payments" AS p
LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed'
2025-07-28 15:31:34.783 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__sixMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s."Amount"), 0.0) AS "Revenue"
FROM (
    SELECT p."Amount", date_part('year', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', p."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "Payments" AS p
    LEFT JOIN "Courses" AS c ON p."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0 AND p."Status" = 'Completed' AND p."CreatedAt" >= @__sixMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-07-28 15:31:34.785 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."EnrolledAt"
FROM (
    SELECT e."EnrolledAt", e."StudentId", c."Title"
    FROM "Enrollments" AS e
    INNER JOIN "Courses" AS c ON e."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY e."EnrolledAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."EnrolledAt" DESC
2025-07-28 15:31:34.786 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s."Title", s."CreatedAt", s."Rating"
FROM (
    SELECT r."CreatedAt", r."Rating", r."StudentId", c."Title"
    FROM "Reviews" AS r
    INNER JOIN "Courses" AS c ON r."CourseId" = c."Id"
    WHERE c."InstructorId" = @__instructorId_0
    ORDER BY r."CreatedAt" DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s."StudentId" = a."Id"
ORDER BY s."CreatedAt" DESC
2025-07-28 15:31:34.787 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`5[[<>f__AnonymousType1`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-07-28 15:31:34.788 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 10.6135ms
2025-07-28 15:31:34.789 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-07-28 15:31:34.789 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/instructor/9a460b27-0204-4b6e-a1f4-79ef838d0b5f - 200 null application/json; charset=utf-8 17.4772ms
2025-07-28 16:49:43.361 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-28 16:49:43.630 +08:00 [FTL] Application start-up failed
System.InvalidOperationException: An error was generated for warning 'Microsoft.EntityFrameworkCore.Migrations.PendingModelChangesWarning': The model for context 'ApplicationDbContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes. This exception can be suppressed or logged by passing event ID 'RelationalEventId.PendingModelChangesWarning' to the 'ConfigureWarnings' method in 'DbContext.OnConfiguring' or 'AddDbContext'.
   at Microsoft.EntityFrameworkCore.Diagnostics.EventDefinition`1.Log[TLoggerCategory](IDiagnosticsLogger`1 logger, TParam arg)
   at Microsoft.EntityFrameworkCore.Diagnostics.RelationalLoggerExtensions.PendingModelChangesWarning(IDiagnosticsLogger`1 diagnostics, Type contextType)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.ValidateMigrations(Boolean useTransaction, String targetMigration)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.Migrate(String targetMigration)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Migrations.Internal.NpgsqlMigrator.Migrate(String targetMigration)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.Migrate(DatabaseFacade databaseFacade)
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 202
2025-07-28 16:50:37.498 +08:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-28 16:50:37.572 +08:00 [INF] Now listening on: http://localhost:5295
2025-07-28 16:50:37.573 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-28 16:50:37.574 +08:00 [INF] Hosting environment: Development
2025-07-28 16:50:37.574 +08:00 [INF] Content root path: D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-07-28 16:53:36.553 +08:00 [FTL] Application start-up failed
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 175
2025-07-28 16:53:45.739 +08:00 [FTL] Application start-up failed
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 175
2025-07-28 16:53:57.192 +08:00 [FTL] Application start-up failed
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 175
2025-07-28 16:54:08.479 +08:00 [FTL] Application start-up failed
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Program.cs:line 175
2025-07-28 16:54:18.621 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-28 16:54:18.860 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-07-28 16:54:18.865 +08:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-07-28 16:54:18.865 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-07-28 16:54:18.866 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-28 16:54:18.868 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-07-28 16:54:18.883 +08:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-07-28 16:54:18.891 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-28 16:54:18.972 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2025-07-28 16:54:18.978 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2025-07-28 16:54:18.979 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-07-28 16:54:18.980 +08:00 [INF] No migrations were applied. The database is already up to date.
2025-07-28 16:54:19.141 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1
2025-07-28 16:54:19.161 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1
2025-07-28 16:54:19.161 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1
2025-07-28 16:54:19.174 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.293 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.295 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.351 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 16:54:19.356 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.357 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.358 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 16:54:19.390 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Name"
FROM "AspNetUserRoles" AS a
INNER JOIN "AspNetRoles" AS a0 ON a."RoleId" = a0."Id"
WHERE a."UserId" = @__userId_0
2025-07-28 16:54:19.395 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.404 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 16:54:19.410 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.413 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.413 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.420 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "AspNetUserRoles"
WHERE "RoleId" = @p0 AND "UserId" = @p1;
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 16:54:19.423 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.423 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 16:54:19.426 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.430 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.430 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.434 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 16:54:19.435 +08:00 [INF] Updated user: admin@example.com
2025-07-28 16:54:19.436 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.485 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.485 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.489 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 16:54:19.490 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.490 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.491 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 16:54:19.492 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Name"
FROM "AspNetUserRoles" AS a
INNER JOIN "AspNetRoles" AS a0 ON a."RoleId" = a0."Id"
WHERE a."UserId" = @__userId_0
2025-07-28 16:54:19.492 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.493 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 16:54:19.493 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.494 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.494 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.495 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "AspNetUserRoles"
WHERE "RoleId" = @p0 AND "UserId" = @p1;
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 16:54:19.496 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.496 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 16:54:19.497 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.497 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.497 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.498 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 16:54:19.499 +08:00 [INF] Updated user: instructor@example.com
2025-07-28 16:54:19.499 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.544 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.545 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.546 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 16:54:19.546 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.547 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.548 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 16:54:19.549 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Name"
FROM "AspNetUserRoles" AS a
INNER JOIN "AspNetRoles" AS a0 ON a."RoleId" = a0."Id"
WHERE a."UserId" = @__userId_0
2025-07-28 16:54:19.549 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.550 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 16:54:19.550 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.550 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.551 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.552 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "AspNetUserRoles"
WHERE "RoleId" = @p0 AND "UserId" = @p1;
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 16:54:19.553 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.554 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 16:54:19.554 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.554 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.555 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.556 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 16:54:19.556 +08:00 [INF] Updated user: student@example.com
2025-07-28 16:54:19.557 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.603 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.604 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.605 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 16:54:19.605 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.606 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.607 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 16:54:19.607 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Name"
FROM "AspNetUserRoles" AS a
INNER JOIN "AspNetRoles" AS a0 ON a."RoleId" = a0."Id"
WHERE a."UserId" = @__userId_0
2025-07-28 16:54:19.608 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.608 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 16:54:19.609 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.609 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.610 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.610 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "AspNetUserRoles"
WHERE "RoleId" = @p0 AND "UserId" = @p1;
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 16:54:19.611 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.612 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 16:54:19.612 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.612 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.613 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.614 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 16:54:19.614 +08:00 [INF] Updated user: michael.chen@example.com
2025-07-28 16:54:19.614 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.659 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.661 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.662 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 16:54:19.662 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.663 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.663 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p23='?', @p0='?' (DbType = Int32), @p1='?', @p2='?', @p24='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = Boolean), @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?', @p15='?' (DbType = Boolean), @p16='?', @p17='?' (DbType = DateTime), @p18='?', @p19='?', @p20='?', @p21='?' (DbType = Boolean), @p22='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "Avatar" = @p1, "ConcurrencyStamp" = @p2, "CreatedAt" = @p3, "Email" = @p4, "EmailConfirmed" = @p5, "FullName" = @p6, "LastLoginAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "NotificationPreferences" = @p12, "PasswordHash" = @p13, "PhoneNumber" = @p14, "PhoneNumberConfirmed" = @p15, "RefreshToken" = @p16, "RefreshTokenExpiryTime" = @p17, "Role" = @p18, "SecurityStamp" = @p19, "Status" = @p20, "TwoFactorEnabled" = @p21, "UserName" = @p22
WHERE "Id" = @p23 AND "ConcurrencyStamp" = @p24;
2025-07-28 16:54:19.664 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Name"
FROM "AspNetUserRoles" AS a
INNER JOIN "AspNetRoles" AS a0 ON a."RoleId" = a0."Id"
WHERE a."UserId" = @__userId_0
2025-07-28 16:54:19.664 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.665 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 16:54:19.665 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.666 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.666 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.667 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "AspNetUserRoles"
WHERE "RoleId" = @p0 AND "UserId" = @p1;
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 16:54:19.668 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.668 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?', @__p_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__p_0 AND a."RoleId" = @__p_1
LIMIT 1
2025-07-28 16:54:19.669 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2
2025-07-28 16:54:19.669 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1
2025-07-28 16:54:19.669 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-07-28 16:54:19.670 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?', @p1='?', @p25='?', @p2='?' (DbType = Int32), @p3='?', @p4='?', @p26='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Boolean), @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?', @p17='?' (DbType = Boolean), @p18='?', @p19='?' (DbType = DateTime), @p20='?', @p21='?', @p22='?', @p23='?' (DbType = Boolean), @p24='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "Avatar" = @p3, "ConcurrencyStamp" = @p4, "CreatedAt" = @p5, "Email" = @p6, "EmailConfirmed" = @p7, "FullName" = @p8, "LastLoginAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "NotificationPreferences" = @p14, "PasswordHash" = @p15, "PhoneNumber" = @p16, "PhoneNumberConfirmed" = @p17, "RefreshToken" = @p18, "RefreshTokenExpiryTime" = @p19, "Role" = @p20, "SecurityStamp" = @p21, "Status" = @p22, "TwoFactorEnabled" = @p23, "UserName" = @p24
WHERE "Id" = @p25 AND "ConcurrencyStamp" = @p26;
2025-07-28 16:54:19.671 +08:00 [INF] Updated user: emily.davis@example.com
2025-07-28 16:54:19.680 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "SubscriptionPlans" AS s)
2025-07-28 16:54:19.686 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Courses" AS c)
2025-07-28 16:54:19.692 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
FROM "Courses" AS c
2025-07-28 16:54:19.751 +08:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "Courses"
WHERE "Id" = @p0;
DELETE FROM "Courses"
WHERE "Id" = @p1;
DELETE FROM "Courses"
WHERE "Id" = @p2;
DELETE FROM "Courses"
WHERE "Id" = @p3;
DELETE FROM "Courses"
WHERE "Id" = @p4;
DELETE FROM "Courses"
WHERE "Id" = @p5;
DELETE FROM "Courses"
WHERE "Id" = @p6;
2025-07-28 16:54:19.765 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'CeceLearningPortal.Api.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: update or delete on table "Courses" violates foreign key constraint "FK_Payments_Courses_CourseId" on table "Payments"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: update or delete on table "Courses" violates foreign key constraint "FK_Payments_Courses_CourseId" on table "Payments"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Payments
    ConstraintName: FK_Payments_Courses_CourseId
    File: ri_triggers.c
    Line: 2624
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: update or delete on table "Courses" violates foreign key constraint "FK_Payments_Courses_CourseId" on table "Payments"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: update or delete on table "Courses" violates foreign key constraint "FK_Payments_Courses_CourseId" on table "Payments"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Payments
    ConstraintName: FK_Payments_Courses_CourseId
    File: ri_triggers.c
    Line: 2624
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-07-28 16:54:19.766 +08:00 [ERR] An error occurred while seeding data
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23503: update or delete on table "Courses" violates foreign key constraint "FK_Payments_Courses_CourseId" on table "Payments"

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23503
    MessageText: update or delete on table "Courses" violates foreign key constraint "FK_Payments_Courses_CourseId" on table "Payments"
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Payments
    ConstraintName: FK_Payments_Courses_CourseId
    File: ri_triggers.c
    Line: 2624
    Routine: ri_ReportViolation
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at CeceLearningPortal.Api.Services.DataSeederService.SeedCoursesAsync() in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\DataSeederService.cs:line 152
   at CeceLearningPortal.Api.Services.DataSeederService.SeedDataAsync() in D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api\Services\DataSeederService.cs:line 44
2025-07-28 16:54:19.798 +08:00 [INF] Now listening on: http://localhost:5295
2025-07-28 16:54:19.798 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2025-07-28 16:54:19.798 +08:00 [INF] Hosting environment: Development
2025-07-28 16:54:19.798 +08:00 [INF] Content root path: D:\ProductDevelopment\Cece\CeceLearningPortal.Backend\CeceLearningPortal.Api
2025-07-28 16:55:32.530 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/courses - null null
2025-07-28 16:55:32.530 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - null null
2025-07-28 16:55:32.552 +08:00 [WRN] Failed to determine the https port for redirect.
2025-07-28 16:55:32.553 +08:00 [INF] CORS policy execution successful.
2025-07-28 16:55:32.553 +08:00 [INF] CORS policy execution successful.
2025-07-28 16:55:32.557 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/courses - 204 null null 28.2384ms
2025-07-28 16:55:32.557 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5295/api/analytics/platform - 204 null null 28.2387ms
2025-07-28 16:55:32.561 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/courses - application/json null
2025-07-28 16:55:32.561 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5295/api/analytics/platform - application/json null
2025-07-28 16:55:32.564 +08:00 [INF] CORS policy execution successful.
2025-07-28 16:55:32.564 +08:00 [INF] CORS policy execution successful.
2025-07-28 16:55:32.588 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 16:55:32.590 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-07-28 16:55:32.592 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-07-28 16:55:32.592 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/analytics/platform - 401 0 null 31.468ms
2025-07-28 16:55:32.599 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-07-28 16:55:32.659 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-07-28 16:55:32.693 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."Category", c0."CreatedAt", c0."Description", c0."Discount", c0."Duration", c0."EnrollmentType", c0."Features", c0."InstructorId", c0."IsBestseller", c0."Level", c0."OriginalPrice", c0."PreviewUrl", c0."Price", c0."Status", c0."Thumbnail", c0."Title", c0."UpdatedAt", a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s."Id", s."CourseId", s."CreatedAt", s."Description", s."Order", s."Title", s."UpdatedAt", s."Id0", s."Content", s."CreatedAt0", s."Duration", s."ModuleId", s."Order0", s."Title0", s."Type", s."UpdatedAt0", s."VideoUrl", r."Id", r."ApprovedAt", r."ApprovedBy", r."Comment", r."CourseId", r."CreatedAt", r."Rating", r."Status", r."StudentId", e."Id", e."AverageQuizScore", e."CertificateIssued", e."CertificateUrl", e."CompletedAt", e."CompletedLessons", e."CourseId", e."EnrolledAt", e."LastAccessedDate", e."ProgressPercentage", e."QuizCount", e."StudentId", e."TotalTimeSpent"
FROM (
    SELECT c."Id", c."Category", c."CreatedAt", c."Description", c."Discount", c."Duration", c."EnrollmentType", c."Features", c."InstructorId", c."IsBestseller", c."Level", c."OriginalPrice", c."PreviewUrl", c."Price", c."Status", c."Thumbnail", c."Title", c."UpdatedAt"
    FROM "Courses" AS c
    ORDER BY c."CreatedAt" DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0."InstructorId" = a."Id"
LEFT JOIN (
    SELECT c1."Id", c1."CourseId", c1."CreatedAt", c1."Description", c1."Order", c1."Title", c1."UpdatedAt", l."Id" AS "Id0", l."Content", l."CreatedAt" AS "CreatedAt0", l."Duration", l."ModuleId", l."Order" AS "Order0", l."Title" AS "Title0", l."Type", l."UpdatedAt" AS "UpdatedAt0", l."VideoUrl"
    FROM "CourseModules" AS c1
    LEFT JOIN "Lessons" AS l ON c1."Id" = l."ModuleId"
) AS s ON c0."Id" = s."CourseId"
LEFT JOIN "Reviews" AS r ON c0."Id" = r."CourseId"
LEFT JOIN "Enrollments" AS e ON c0."Id" = e."CourseId"
ORDER BY c0."CreatedAt" DESC, c0."Id", a."Id", s."Id", s."Id0", r."Id"
2025-07-28 16:55:32.743 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-07-28 16:55:32.764 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 163.2213ms
2025-07-28 16:55:32.764 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-07-28 16:55:32.766 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5295/api/courses - 200 null application/json; charset=utf-8 205.6377ms
