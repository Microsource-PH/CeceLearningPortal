2025-08-01 00:04:35.866 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:04:35.869 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:35.869 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 3.0415ms
2025-08-01 00:04:35.871 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:04:35.871 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:35.893 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:35.893 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:04:35.893 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:04:35.908 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:04:35.910 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:04:35.910 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 16.9879ms
2025-08-01 00:04:35.911 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:04:35.911 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 40.0651ms
2025-08-01 00:04:35.914 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:04:35.914 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:35.914 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.5521ms
2025-08-01 00:04:35.915 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:04:35.916 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:35.917 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:35.918 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:04:35.918 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:04:35.920 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:04:35.921 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:04:35.922 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 3.7422ms
2025-08-01 00:04:35.922 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:04:35.922 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 6.7961ms
2025-08-01 00:04:37.495 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:04:37.496 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:37.496 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.8732ms
2025-08-01 00:04:37.497 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:04:37.498 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:37.500 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:37.500 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:04:37.500 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:04:37.506 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:04:37.508 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:04:37.509 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.6687ms
2025-08-01 00:04:37.509 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:04:37.509 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 11.7756ms
2025-08-01 00:04:37.513 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:04:37.513 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:37.514 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.5843ms
2025-08-01 00:04:37.515 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:04:37.515 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:37.517 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:37.517 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:04:37.517 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:04:37.517 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.4659ms
2025-08-01 00:04:37.538 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:04:37.538 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:37.539 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:37.539 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:04:37.540 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:04:37.540 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.0706ms
2025-08-01 00:04:37.552 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:04:37.553 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:37.556 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:04:37.556 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:04:37.556 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:37.557 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:37.557 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.8026ms
2025-08-01 00:04:37.557 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.515ms
2025-08-01 00:04:37.557 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:37.567 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:04:37.568 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:04:37.568 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:37.568 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:04:37.569 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:04:37.570 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:37.571 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:37.575 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:04:37.576 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:04:37.580 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:04:37.585 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:04:37.589 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:04:37.591 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:37.592 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:37.594 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:37.595 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:37.597 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:37.598 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:37.599 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:37.599 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:04:37.600 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:04:37.600 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:37.603 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:04:37.606 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:04:37.607 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:37.610 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:04:37.611 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:37.612 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:37.613 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:37.614 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:04:37.614 +08:00 [INF] Executed DbCommand (20ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:04:37.614 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:04:37.615 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:37.616 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 39.6488ms
2025-08-01 00:04:37.616 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:04:37.616 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 48.7523ms
2025-08-01 00:04:37.616 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:04:37.617 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 48.081ms
2025-08-01 00:04:37.617 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:04:37.617 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 65.0201ms
2025-08-01 00:04:37.620 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:37.623 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:37.625 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:37.627 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:37.628 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:37.630 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:37.631 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:37.633 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:37.634 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:37.636 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:37.637 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:37.638 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:37.640 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:37.641 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:37.642 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:37.643 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:37.643 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:04:37.643 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 43.7395ms
2025-08-01 00:04:37.644 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:04:37.644 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 74.6373ms
2025-08-01 00:04:47.639 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:04:47.639 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:47.640 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.8511ms
2025-08-01 00:04:47.641 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5294/api/courses/21 - application/json 1005
2025-08-01 00:04:47.641 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:47.643 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:47.643 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api)'
2025-08-01 00:04:47.643 +08:00 [INF] Route matched with {action = "UpdateCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCourse(Int32, CeceLearningPortal.Api.DTOs.UpdateCourseDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:04:47.643 +08:00 [INF] UpdateCourse called for ID: 21
2025-08-01 00:04:47.644 +08:00 [INF] Received data: {"Title":"Computer Vision Fundamentals","Description":"Learn the fundamentals of computer vision, image processing, and deep learning for visual recognition tasks.","ShortDescription":"","Price":150,"OriginalPrice":299.99,"Duration":"30 hours","Level":"Advanced","Category":"Business","Thumbnail":null,"ThumbnailUrl":"","PromoVideoUrl":"","Language":"en","Features":[],"PreviewUrl":"","EnrollmentType":null,"Status":null,"CourseFeatures":{"Certificate":false,"Community":false,"LiveSessions":false,"DownloadableResources":false,"Assignments":false,"Quizzes":false},"CourseType":"Custom","PricingModel":"OneTime","Currency":"PHP","AccessType":"Limited","AccessDuration":null,"Automations":{"WelcomeEmail":true,"CompletionCertificate":true,"ProgressReminders":true,"AbandonmentSequence":false},"Modules":[{"Title":"Getting Started","Description":"Introduction and fundamentals","Order":1,"Lessons":[{"Title":"Lessontest","Duration":"10:00","Type":"Video","Content":null,"VideoUrl":null,"Order":1}]}]}
2025-08-01 00:04:47.644 +08:00 [INF] CourseType: Custom
2025-08-01 00:04:47.644 +08:00 [INF] PricingModel: OneTime
2025-08-01 00:04:47.644 +08:00 [INF] Language: en
2025-08-01 00:04:47.644 +08:00 [INF] CourseFeatures: {"Certificate":false,"Community":false,"LiveSessions":false,"DownloadableResources":false,"Assignments":false,"Quizzes":false}
2025-08-01 00:04:47.646 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.id = @__id_0
LIMIT 1
2025-08-01 00:04:47.648 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__course_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.course_id, c.created_at, c.description, c."order", c.title, c.updated_at, c0.id, c0.content, c0.created_at, c0.duration, c0.module_id, c0."order", c0.title, c0.type, c0.updated_at, c0.video_url
FROM course_modules AS c
LEFT JOIN course_lessons AS c0 ON c.id = c0.module_id
WHERE c.course_id = @__course_Id_0
ORDER BY c.id
2025-08-01 00:04:47.654 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p2='?', @p3='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE course_modules SET updated_at = @p0
WHERE id = @p1;
UPDATE courses SET category = @p2, updated_at = @p3
WHERE id = @p4;
2025-08-01 00:04:47.656 +08:00 [INF] Update successful. Returned course: {"Id":21,"Title":"Computer Vision Fundamentals","Description":"Learn the fundamentals of computer vision, image processing, and deep learning for visual recognition tasks.","InstructorId":"bee889a2-efca-471d-807c-a7674a945612","InstructorName":"Unknown","Price":150,"OriginalPrice":299.99,"Discount":49,"Duration":"30 hours","Level":"Advanced","Category":"Business","Thumbnail":null,"Status":"Active","IsBestseller":false,"Features":[],"PreviewUrl":"","EnrollmentType":"OneTime","StudentsCount":0,"AverageRating":0,"LecturesCount":1,"CreatedAt":"2025-05-31T06:05:22.858366Z","UpdatedAt":"2025-07-31T16:04:47.646842Z","CourseType":"Custom"}
2025-08-01 00:04:47.657 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-08-01 00:04:47.657 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api) in 13.784ms
2025-08-01 00:04:47.657 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api)'
2025-08-01 00:04:47.657 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 16.2838ms
2025-08-01 00:04:47.667 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:04:47.668 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:47.668 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.6246ms
2025-08-01 00:04:47.669 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:04:47.670 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:47.674 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:47.674 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:04:47.675 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:04:47.682 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:04:47.685 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:04:47.686 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 10.5406ms
2025-08-01 00:04:47.686 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:04:47.686 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 17.1457ms
2025-08-01 00:04:47.728 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:04:47.728 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:47.728 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.6336ms
2025-08-01 00:04:47.729 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:04:47.730 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:47.731 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:47.731 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:04:47.731 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:04:47.732 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.2025ms
2025-08-01 00:04:47.766 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:04:47.768 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:47.768 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:04:47.768 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:04:47.770 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:47.770 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:47.770 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 1.9096ms
2025-08-01 00:04:47.770 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 1.9785ms
2025-08-01 00:04:47.781 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:04:47.781 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:47.782 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:04:47.782 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:47.782 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:47.783 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:04:47.783 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:04:47.783 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 16.7768ms
2025-08-01 00:04:47.785 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:47.785 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:04:47.785 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:04:47.786 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:47.786 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:04:47.786 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:04:47.790 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:04:47.795 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:04:47.796 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:04:47.797 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:47.799 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:47.800 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:47.800 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:04:47.803 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:47.806 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:47.807 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:04:47.807 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:47.809 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:47.809 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:47.810 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:47.810 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:47.812 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:47.813 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:47.814 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:47.814 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:47.816 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:47.816 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:47.818 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:47.818 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:47.819 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:47.819 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:47.821 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:47.821 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:04:47.822 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:47.823 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:04:47.824 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:04:47.825 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:47.826 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 38.4138ms
2025-08-01 00:04:47.826 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:04:47.826 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 44.5278ms
2025-08-01 00:04:47.829 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:47.831 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:47.832 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:47.833 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:47.835 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:47.835 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:04:47.835 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 49.4904ms
2025-08-01 00:04:47.835 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:04:47.836 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 54.7426ms
2025-08-01 00:04:55.171 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:04:55.172 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:55.172 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.5848ms
2025-08-01 00:04:55.173 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:04:55.173 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:55.175 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:55.175 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:04:55.175 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:04:55.180 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:04:55.181 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:04:55.181 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 5.6359ms
2025-08-01 00:04:55.181 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:04:55.182 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 8.9144ms
2025-08-01 00:04:55.184 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:04:55.184 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:55.185 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.6173ms
2025-08-01 00:04:55.187 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:04:55.187 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:55.189 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:55.189 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:04:55.189 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:04:55.192 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:04:55.193 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:04:55.193 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 3.7787ms
2025-08-01 00:04:55.193 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:04:55.194 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 6.9409ms
2025-08-01 00:04:59.374 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:04:59.375 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:59.375 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.5798ms
2025-08-01 00:04:59.376 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:04:59.376 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:59.377 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:59.378 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:04:59.378 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:04:59.383 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:04:59.385 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:04:59.385 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.0384ms
2025-08-01 00:04:59.385 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:04:59.386 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 9.9131ms
2025-08-01 00:04:59.391 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:04:59.392 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:59.392 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.6081ms
2025-08-01 00:04:59.393 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:04:59.394 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:59.396 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:59.396 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:04:59.396 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:04:59.396 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.0268ms
2025-08-01 00:04:59.415 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:04:59.415 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:59.416 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:59.416 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:04:59.416 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:04:59.417 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 1.9893ms
2025-08-01 00:04:59.431 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:04:59.431 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:59.432 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:04:59.433 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:04:59.433 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:59.433 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:59.433 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.6838ms
2025-08-01 00:04:59.433 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.6204ms
2025-08-01 00:04:59.434 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:59.435 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:04:59.435 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:04:59.446 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:04:59.446 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:04:59.447 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:59.447 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:04:59.449 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:59.451 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:04:59.452 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:04:59.452 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:04:59.452 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:04:59.453 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:04:59.454 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:04:59.456 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:04:59.456 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:04:59.456 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:04:59.457 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:59.458 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:04:59.458 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:04:59.458 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 23.3759ms
2025-08-01 00:04:59.459 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:59.460 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:04:59.460 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 29.5588ms
2025-08-01 00:04:59.461 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:04:59.462 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:59.464 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:59.464 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:59.465 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:59.465 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:59.467 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:59.467 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:59.468 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:59.468 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:59.469 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:59.469 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:59.470 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:59.470 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:59.471 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:04:59.471 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:59.472 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:59.473 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:04:59.475 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:59.476 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:04:59.476 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:59.476 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:04:59.477 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 24.0766ms
2025-08-01 00:04:59.477 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:04:59.477 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 31.3292ms
2025-08-01 00:04:59.479 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:59.480 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:59.481 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:59.482 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:59.483 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:59.484 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:04:59.486 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:59.487 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:04:59.488 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:04:59.488 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 35.4742ms
2025-08-01 00:04:59.488 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:04:59.488 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 42.4963ms
2025-08-01 00:05:12.429 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:05:12.430 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:12.430 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.3948ms
2025-08-01 00:05:12.431 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5294/api/courses/21 - application/json 1005
2025-08-01 00:05:12.431 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:12.432 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:05:12.433 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api)'
2025-08-01 00:05:12.433 +08:00 [INF] Route matched with {action = "UpdateCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCourse(Int32, CeceLearningPortal.Api.DTOs.UpdateCourseDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:05:12.433 +08:00 [INF] UpdateCourse called for ID: 21
2025-08-01 00:05:12.434 +08:00 [INF] Received data: {"Title":"Computer Vision Fundamentals","Description":"Learn the fundamentals of computer vision, image processing, and deep learning for visual recognition tasks.","ShortDescription":"","Price":150,"OriginalPrice":299.99,"Duration":"30 hours","Level":"Advanced","Category":"Business","Thumbnail":null,"ThumbnailUrl":"","PromoVideoUrl":"","Language":"en","Features":[],"PreviewUrl":"","EnrollmentType":null,"Status":null,"CourseFeatures":{"Certificate":false,"Community":false,"LiveSessions":false,"DownloadableResources":false,"Assignments":false,"Quizzes":false},"CourseType":"Custom","PricingModel":"OneTime","Currency":"PHP","AccessType":"Limited","AccessDuration":null,"Automations":{"WelcomeEmail":true,"CompletionCertificate":true,"ProgressReminders":true,"AbandonmentSequence":false},"Modules":[{"Title":"Getting Started","Description":"Introduction and fundamentals","Order":1,"Lessons":[{"Title":"Lessontest","Duration":"10:00","Type":"Video","Content":null,"VideoUrl":null,"Order":1}]}]}
2025-08-01 00:05:12.434 +08:00 [INF] CourseType: Custom
2025-08-01 00:05:12.434 +08:00 [INF] PricingModel: OneTime
2025-08-01 00:05:12.434 +08:00 [INF] Language: en
2025-08-01 00:05:12.434 +08:00 [INF] CourseFeatures: {"Certificate":false,"Community":false,"LiveSessions":false,"DownloadableResources":false,"Assignments":false,"Quizzes":false}
2025-08-01 00:05:12.435 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.id = @__id_0
LIMIT 1
2025-08-01 00:05:12.437 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__course_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.course_id, c.created_at, c.description, c."order", c.title, c.updated_at, c0.id, c0.content, c0.created_at, c0.duration, c0.module_id, c0."order", c0.title, c0.type, c0.updated_at, c0.video_url
FROM course_modules AS c
LEFT JOIN course_lessons AS c0 ON c.id = c0.module_id
WHERE c.course_id = @__course_Id_0
ORDER BY c.id
2025-08-01 00:05:12.439 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE course_modules SET updated_at = @p0
WHERE id = @p1;
UPDATE courses SET updated_at = @p2
WHERE id = @p3;
2025-08-01 00:05:12.441 +08:00 [INF] Update successful. Returned course: {"Id":21,"Title":"Computer Vision Fundamentals","Description":"Learn the fundamentals of computer vision, image processing, and deep learning for visual recognition tasks.","InstructorId":"bee889a2-efca-471d-807c-a7674a945612","InstructorName":"Unknown","Price":150,"OriginalPrice":299.99,"Discount":49,"Duration":"30 hours","Level":"Advanced","Category":"Business","Thumbnail":null,"Status":"Active","IsBestseller":false,"Features":[],"PreviewUrl":"","EnrollmentType":"OneTime","StudentsCount":0,"AverageRating":0,"LecturesCount":1,"CreatedAt":"2025-05-31T06:05:22.858366Z","UpdatedAt":"2025-07-31T16:05:12.43661Z","CourseType":"Custom"}
2025-08-01 00:05:12.441 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-08-01 00:05:12.441 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api) in 8.4782ms
2025-08-01 00:05:12.442 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api)'
2025-08-01 00:05:12.442 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 10.9865ms
2025-08-01 00:05:12.450 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:05:12.451 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:12.451 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.348ms
2025-08-01 00:05:12.453 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:05:12.454 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:12.455 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:05:12.456 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:05:12.456 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:05:12.462 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:05:12.465 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:05:12.465 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.3051ms
2025-08-01 00:05:12.466 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:05:12.466 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 12.6353ms
2025-08-01 00:05:12.523 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:05:12.523 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:12.524 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.6381ms
2025-08-01 00:05:12.525 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:05:12.526 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:12.527 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:05:12.528 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:05:12.528 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:05:12.528 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.57ms
2025-08-01 00:05:12.555 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:05:12.555 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:05:12.555 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:05:12.556 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:12.556 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:12.556 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:12.556 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 1.2113ms
2025-08-01 00:05:12.556 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 1.2803ms
2025-08-01 00:05:12.559 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:05:12.560 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:05:12.560 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:05:12.560 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:05:12.560 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:05:12.560 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:12.561 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 5.7155ms
2025-08-01 00:05:12.565 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:12.567 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:05:12.567 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:05:12.568 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:05:12.568 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:05:12.568 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:05:12.568 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:05:12.570 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:05:12.571 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:05:12.571 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:05:12.572 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:05:12.573 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:05:12.574 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:12.577 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:05:12.578 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:12.578 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:05:12.579 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:05:12.579 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:05:12.581 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:12.582 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:05:12.583 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:05:12.583 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:12.585 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:05:12.585 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:05:12.586 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:05:12.587 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:12.588 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:05:12.590 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:12.593 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:05:12.593 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:05:12.594 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:12.594 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:05:12.595 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:05:12.595 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 27.2613ms
2025-08-01 00:05:12.596 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:05:12.596 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 35.6645ms
2025-08-01 00:05:12.597 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:12.598 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:05:12.600 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:12.601 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:12.602 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:05:12.604 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:12.605 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:12.607 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:05:12.608 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:12.610 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:12.610 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:05:12.610 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 41.9532ms
2025-08-01 00:05:12.610 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:05:12.611 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 50.6484ms
2025-08-01 00:05:15.378 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:05:15.378 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:15.380 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:05:15.381 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:05:15.381 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:05:15.387 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:05:15.389 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:05:15.390 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 8.6736ms
2025-08-01 00:05:15.390 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:05:15.390 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 12.0241ms
2025-08-01 00:05:15.393 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:05:15.393 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:15.393 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.6791ms
2025-08-01 00:05:15.395 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:05:15.396 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:15.397 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:05:15.397 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:05:15.397 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:05:15.400 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:05:15.400 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:05:15.400 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 2.5037ms
2025-08-01 00:05:15.400 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:05:15.401 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 5.3476ms
2025-08-01 00:05:57.457 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:05:57.457 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:57.458 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.0849ms
2025-08-01 00:05:57.460 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:05:57.460 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:57.463 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:05:57.464 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:05:57.464 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:05:57.468 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:05:57.473 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:05:57.473 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.2822ms
2025-08-01 00:05:57.474 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:05:57.474 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 14.0904ms
2025-08-01 00:05:57.482 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:05:57.482 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:57.482 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.5728ms
2025-08-01 00:05:57.484 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:05:57.484 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:57.485 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:05:57.486 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:05:57.486 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:05:57.486 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.7785ms
2025-08-01 00:05:57.508 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:05:57.508 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:57.510 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:05:57.510 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:05:57.510 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:05:57.510 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.7504ms
2025-08-01 00:05:57.524 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:05:57.524 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:57.524 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.8457ms
2025-08-01 00:05:57.526 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:05:57.527 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:57.527 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.9946ms
2025-08-01 00:05:57.527 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:05:57.528 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:57.538 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 10.3252ms
2025-08-01 00:05:57.539 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:05:57.539 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:57.539 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:05:57.540 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:57.541 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:05:57.545 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:05:57.549 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:05:57.549 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:05:57.549 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:05:57.549 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:05:57.550 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:05:57.549 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:05:57.550 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:05:57.550 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:05:57.550 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:05:57.551 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:05:57.553 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:05:57.553 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:05:57.555 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:05:57.555 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:05:57.556 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:05:57.557 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:05:57.557 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 6.9257ms
2025-08-01 00:05:57.557 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:05:57.558 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 18.185ms
2025-08-01 00:05:57.558 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:57.559 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:05:57.565 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:57.567 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:05:57.568 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:05:57.569 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:05:57.570 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:05:57.570 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:57.572 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:05:57.573 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:57.574 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:05:57.582 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:05:57.582 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:05:57.584 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:05:57.584 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:57.585 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:57.585 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:05:57.586 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:05:57.592 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:05:57.592 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:05:57.592 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:57.593 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 43.4012ms
2025-08-01 00:05:57.596 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:05:57.596 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 57.767ms
2025-08-01 00:05:57.611 +08:00 [INF] Executed DbCommand (15ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:57.613 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:05:57.614 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:57.616 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:57.619 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:05:57.620 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:57.623 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:57.642 +08:00 [INF] Executed DbCommand (18ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:05:57.645 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:57.647 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:05:57.648 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:05:57.648 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 98.0147ms
2025-08-01 00:05:57.650 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:05:57.650 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 109.8313ms
2025-08-01 00:06:09.528 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:06:09.529 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:09.529 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.4213ms
2025-08-01 00:06:09.530 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5294/api/courses/21 - application/json 1005
2025-08-01 00:06:09.530 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:09.532 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:09.532 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api)'
2025-08-01 00:06:09.532 +08:00 [INF] Route matched with {action = "UpdateCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCourse(Int32, CeceLearningPortal.Api.DTOs.UpdateCourseDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:06:09.533 +08:00 [INF] UpdateCourse called for ID: 21
2025-08-01 00:06:09.533 +08:00 [INF] Received data: {"Title":"Computer Vision Fundamentals","Description":"Learn the fundamentals of computer vision, image processing, and deep learning for visual recognition tasks.","ShortDescription":"","Price":150,"OriginalPrice":299.99,"Duration":"30 hours","Level":"Advanced","Category":"Business","Thumbnail":null,"ThumbnailUrl":"","PromoVideoUrl":"","Language":"en","Features":[],"PreviewUrl":"","EnrollmentType":null,"Status":null,"CourseFeatures":{"Certificate":false,"Community":false,"LiveSessions":false,"DownloadableResources":false,"Assignments":false,"Quizzes":false},"CourseType":"Custom","PricingModel":"OneTime","Currency":"PHP","AccessType":"Limited","AccessDuration":null,"Automations":{"WelcomeEmail":true,"CompletionCertificate":true,"ProgressReminders":true,"AbandonmentSequence":false},"Modules":[{"Title":"Getting Started","Description":"Introduction and fundamentals","Order":1,"Lessons":[{"Title":"Lessontest","Duration":"10:00","Type":"Video","Content":null,"VideoUrl":null,"Order":1}]}]}
2025-08-01 00:06:09.533 +08:00 [INF] CourseType: Custom
2025-08-01 00:06:09.533 +08:00 [INF] PricingModel: OneTime
2025-08-01 00:06:09.533 +08:00 [INF] Language: en
2025-08-01 00:06:09.533 +08:00 [INF] CourseFeatures: {"Certificate":false,"Community":false,"LiveSessions":false,"DownloadableResources":false,"Assignments":false,"Quizzes":false}
2025-08-01 00:06:09.534 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.id = @__id_0
LIMIT 1
2025-08-01 00:06:09.536 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__course_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.course_id, c.created_at, c.description, c."order", c.title, c.updated_at, c0.id, c0.content, c0.created_at, c0.duration, c0.module_id, c0."order", c0.title, c0.type, c0.updated_at, c0.video_url
FROM course_modules AS c
LEFT JOIN course_lessons AS c0 ON c.id = c0.module_id
WHERE c.course_id = @__course_Id_0
ORDER BY c.id
2025-08-01 00:06:09.539 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE course_modules SET updated_at = @p0
WHERE id = @p1;
UPDATE courses SET updated_at = @p2
WHERE id = @p3;
2025-08-01 00:06:09.540 +08:00 [INF] Update successful. Returned course: {"Id":21,"Title":"Computer Vision Fundamentals","Description":"Learn the fundamentals of computer vision, image processing, and deep learning for visual recognition tasks.","InstructorId":"bee889a2-efca-471d-807c-a7674a945612","InstructorName":"Unknown","Price":150,"OriginalPrice":299.99,"Discount":49,"Duration":"30 hours","Level":"Advanced","Category":"Business","Thumbnail":null,"Status":"Active","IsBestseller":false,"Features":[],"PreviewUrl":"","EnrollmentType":"OneTime","StudentsCount":0,"AverageRating":0,"LecturesCount":1,"CreatedAt":"2025-05-31T06:05:22.858366Z","UpdatedAt":"2025-07-31T16:06:09.535408Z","CourseType":"Custom"}
2025-08-01 00:06:09.540 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-08-01 00:06:09.541 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api) in 8.3965ms
2025-08-01 00:06:09.541 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api)'
2025-08-01 00:06:09.541 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 11.102ms
2025-08-01 00:06:09.550 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:06:09.551 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:09.551 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.646ms
2025-08-01 00:06:09.552 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:06:09.553 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:09.556 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:09.556 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:06:09.557 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:06:09.562 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:06:09.565 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:06:09.565 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.3688ms
2025-08-01 00:06:09.565 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:06:09.566 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 13.0988ms
2025-08-01 00:06:09.621 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:06:09.621 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:09.621 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.3627ms
2025-08-01 00:06:09.624 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:06:09.624 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:09.627 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:09.627 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:06:09.627 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:06:09.627 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.4003ms
2025-08-01 00:06:09.654 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:06:09.655 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:06:09.655 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:09.654 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:06:09.655 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:09.655 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:09.655 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.772ms
2025-08-01 00:06:09.655 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 1.1075ms
2025-08-01 00:06:09.657 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:06:09.658 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:06:09.658 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:09.658 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:09.658 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:09.664 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:06:09.664 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:06:09.665 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 10.7624ms
2025-08-01 00:06:09.667 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:09.668 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:06:09.668 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:06:09.668 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:09.669 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:06:09.669 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:06:09.671 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:06:09.672 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:06:09.673 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:06:09.674 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:09.674 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:06:09.675 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:09.676 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:06:09.677 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:09.677 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:09.678 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:09.678 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:09.679 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:09.679 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:09.680 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:09.681 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:09.682 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:09.682 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:09.683 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:09.683 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:09.684 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:09.684 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:09.685 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:06:09.685 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:09.687 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:09.687 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:06:09.687 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:06:09.688 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 19.5169ms
2025-08-01 00:06:09.688 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:06:09.688 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 30.568ms
2025-08-01 00:06:09.689 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:09.691 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:09.693 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:09.694 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:09.696 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:09.697 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:09.698 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:09.699 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:09.701 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:09.702 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:09.702 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:06:09.703 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 33.4173ms
2025-08-01 00:06:09.703 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:06:09.703 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 45.4962ms
2025-08-01 00:06:12.661 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:06:12.662 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:12.663 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:12.664 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:06:12.664 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:06:12.669 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:06:12.670 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:06:12.670 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 6.2309ms
2025-08-01 00:06:12.670 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:06:12.671 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 9.169ms
2025-08-01 00:06:12.673 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:06:12.673 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:12.673 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.5298ms
2025-08-01 00:06:12.676 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:06:12.677 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:12.678 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:12.679 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:06:12.680 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:06:12.682 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:06:12.683 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:06:12.683 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 2.7732ms
2025-08-01 00:06:12.683 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:06:12.683 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 7.0428ms
2025-08-01 00:06:42.415 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:06:42.415 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:42.416 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.5659ms
2025-08-01 00:06:42.417 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:06:42.418 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:42.419 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:42.419 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:06:42.420 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:06:42.424 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:06:42.426 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:06:42.426 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.3622ms
2025-08-01 00:06:42.427 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:06:42.427 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 9.6563ms
2025-08-01 00:06:42.430 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:06:42.430 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:42.430 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.4988ms
2025-08-01 00:06:42.433 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:06:42.433 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:42.436 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:42.436 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:06:42.436 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:06:42.437 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 4.0512ms
2025-08-01 00:06:42.457 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:06:42.457 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:42.458 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:42.458 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:06:42.458 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:06:42.459 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.0555ms
2025-08-01 00:06:42.468 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:06:42.468 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:06:42.468 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:42.469 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:42.469 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.8424ms
2025-08-01 00:06:42.469 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.7996ms
2025-08-01 00:06:42.471 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:06:42.471 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:06:42.471 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:42.472 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:42.473 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:42.473 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:42.474 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:06:42.474 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:06:42.474 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:06:42.474 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:06:42.476 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:06:42.477 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:06:42.477 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:06:42.479 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:42.479 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:06:42.481 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:42.481 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:06:42.482 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:42.482 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:42.483 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:42.483 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:42.484 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:42.484 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:42.499 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:42.500 +08:00 [INF] Executed DbCommand (15ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:42.501 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:42.501 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:42.502 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:42.502 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:42.506 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:42.506 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:42.509 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:42.509 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:06:42.510 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:42.510 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:06:42.511 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:06:42.511 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 36.044ms
2025-08-01 00:06:42.511 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:06:42.511 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 40.4218ms
2025-08-01 00:06:42.511 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:42.513 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:42.514 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:42.515 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:42.515 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:42.516 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:42.517 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:42.518 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:42.518 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:42.519 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:42.520 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:06:42.520 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 44.9739ms
2025-08-01 00:06:42.520 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:06:42.520 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 48.8815ms
2025-08-01 00:06:44.066 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:06:44.066 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:44.066 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.3918ms
2025-08-01 00:06:44.067 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:06:44.068 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:44.069 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:44.070 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:06:44.070 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:06:44.074 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:06:44.075 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:06:44.075 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 5.6219ms
2025-08-01 00:06:44.076 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:06:44.076 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 8.2819ms
2025-08-01 00:06:49.236 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:06:49.237 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:49.237 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.4226ms
2025-08-01 00:06:49.238 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5294/api/courses/21 - application/json 1005
2025-08-01 00:06:49.238 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:49.239 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:49.240 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api)'
2025-08-01 00:06:49.240 +08:00 [INF] Route matched with {action = "UpdateCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCourse(Int32, CeceLearningPortal.Api.DTOs.UpdateCourseDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:06:49.240 +08:00 [INF] UpdateCourse called for ID: 21
2025-08-01 00:06:49.240 +08:00 [INF] Received data: {"Title":"Computer Vision Fundamentals","Description":"Learn the fundamentals of computer vision, image processing, and deep learning for visual recognition tasks.","ShortDescription":"","Price":150,"OriginalPrice":299.99,"Duration":"30 hours","Level":"Advanced","Category":"Business","Thumbnail":null,"ThumbnailUrl":"","PromoVideoUrl":"","Language":"en","Features":[],"PreviewUrl":"","EnrollmentType":null,"Status":null,"CourseFeatures":{"Certificate":false,"Community":false,"LiveSessions":false,"DownloadableResources":false,"Assignments":false,"Quizzes":false},"CourseType":"Custom","PricingModel":"OneTime","Currency":"PHP","AccessType":"Limited","AccessDuration":null,"Automations":{"WelcomeEmail":true,"CompletionCertificate":true,"ProgressReminders":true,"AbandonmentSequence":false},"Modules":[{"Title":"Getting Started","Description":"Introduction and fundamentals","Order":1,"Lessons":[{"Title":"Lessontest","Duration":"10:00","Type":"Video","Content":null,"VideoUrl":null,"Order":1}]}]}
2025-08-01 00:06:49.241 +08:00 [INF] CourseType: Custom
2025-08-01 00:06:49.241 +08:00 [INF] PricingModel: OneTime
2025-08-01 00:06:49.241 +08:00 [INF] Language: en
2025-08-01 00:06:49.241 +08:00 [INF] CourseFeatures: {"Certificate":false,"Community":false,"LiveSessions":false,"DownloadableResources":false,"Assignments":false,"Quizzes":false}
2025-08-01 00:06:49.242 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.id = @__id_0
LIMIT 1
2025-08-01 00:06:49.244 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__course_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.course_id, c.created_at, c.description, c."order", c.title, c.updated_at, c0.id, c0.content, c0.created_at, c0.duration, c0.module_id, c0."order", c0.title, c0.type, c0.updated_at, c0.video_url
FROM course_modules AS c
LEFT JOIN course_lessons AS c0 ON c.id = c0.module_id
WHERE c.course_id = @__course_Id_0
ORDER BY c.id
2025-08-01 00:06:49.246 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE course_modules SET updated_at = @p0
WHERE id = @p1;
UPDATE courses SET updated_at = @p2
WHERE id = @p3;
2025-08-01 00:06:49.248 +08:00 [INF] Update successful. Returned course: {"Id":21,"Title":"Computer Vision Fundamentals","Description":"Learn the fundamentals of computer vision, image processing, and deep learning for visual recognition tasks.","InstructorId":"bee889a2-efca-471d-807c-a7674a945612","InstructorName":"Unknown","Price":150,"OriginalPrice":299.99,"Discount":49,"Duration":"30 hours","Level":"Advanced","Category":"Business","Thumbnail":null,"Status":"Active","IsBestseller":false,"Features":[],"PreviewUrl":"","EnrollmentType":"OneTime","StudentsCount":0,"AverageRating":0,"LecturesCount":1,"CreatedAt":"2025-05-31T06:05:22.858366Z","UpdatedAt":"2025-07-31T16:06:49.243312Z","CourseType":"Custom"}
2025-08-01 00:06:49.248 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-08-01 00:06:49.248 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api) in 8.0415ms
2025-08-01 00:06:49.248 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api)'
2025-08-01 00:06:49.248 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 10.5562ms
2025-08-01 00:06:49.251 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:06:49.251 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:49.251 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.5759ms
2025-08-01 00:06:49.253 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:06:49.254 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:49.255 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:49.255 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:06:49.255 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:06:49.260 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:06:49.262 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:06:49.262 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.5871ms
2025-08-01 00:06:49.262 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:06:49.263 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 9.4542ms
2025-08-01 00:06:49.296 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:06:49.297 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:49.297 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.3504ms
2025-08-01 00:06:49.298 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:06:49.298 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:49.300 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:49.300 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:06:49.300 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:06:49.300 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.1785ms
2025-08-01 00:06:49.312 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:06:49.313 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:49.314 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:49.315 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:06:49.315 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:06:49.315 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.5487ms
2025-08-01 00:06:49.315 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:06:49.316 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:49.316 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.6174ms
2025-08-01 00:06:49.316 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:06:49.317 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:49.317 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.8117ms
2025-08-01 00:06:49.317 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:06:49.318 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:49.318 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:06:49.318 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:49.320 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:49.320 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:49.320 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:06:49.320 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:06:49.320 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:06:49.321 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:06:49.322 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:06:49.324 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:06:49.324 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:06:49.326 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:49.326 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:49.326 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:06:49.328 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:49.330 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:06:49.331 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:49.332 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:49.332 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:49.333 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:49.334 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:49.334 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:49.335 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:49.335 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:49.336 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:49.336 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:49.339 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:49.351 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:49.351 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:06:49.352 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:49.354 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:06:49.354 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:49.358 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:49.359 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:06:49.359 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:06:49.359 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 38.2109ms
2025-08-01 00:06:49.359 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:06:49.359 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 42.3688ms
2025-08-01 00:06:49.360 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:49.362 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:49.363 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:49.363 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:49.364 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:49.365 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:49.366 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:06:49.367 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:49.367 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:06:49.368 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:06:49.368 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 47.0701ms
2025-08-01 00:06:49.368 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:06:49.368 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 49.9657ms
2025-08-01 00:06:51.483 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:06:51.484 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:51.485 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:51.486 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:06:51.486 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:06:51.490 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:06:51.491 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:06:51.492 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 5.9012ms
2025-08-01 00:06:51.492 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:06:51.492 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 8.7324ms
2025-08-01 00:06:51.494 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:06:51.495 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:51.496 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 1.2472ms
2025-08-01 00:06:51.498 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:06:51.498 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:06:51.500 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:06:51.500 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:06:51.501 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:06:51.503 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:06:51.503 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:06:51.503 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 2.386ms
2025-08-01 00:06:51.503 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:06:51.504 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 5.8816ms
2025-08-01 00:10:18.212 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:10:18.214 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:18.214 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.8161ms
2025-08-01 00:10:18.215 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:10:18.216 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:18.236 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:18.236 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:10:18.236 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:10:18.252 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:10:18.254 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:10:18.254 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 17.7753ms
2025-08-01 00:10:18.254 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:10:18.255 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 39.3305ms
2025-08-01 00:10:18.260 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:10:18.260 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:18.260 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.3561ms
2025-08-01 00:10:18.262 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:10:18.262 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:18.264 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:18.265 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:10:18.265 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:10:18.265 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.4412ms
2025-08-01 00:10:18.289 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:10:18.290 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:18.291 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:18.291 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:10:18.291 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:10:18.291 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.0744ms
2025-08-01 00:10:18.311 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:10:18.312 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:18.312 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.5176ms
2025-08-01 00:10:18.315 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:10:18.315 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:18.315 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.4684ms
2025-08-01 00:10:18.319 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:10:18.320 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:18.321 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 1.3188ms
2025-08-01 00:10:18.321 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:10:18.322 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:18.324 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:10:18.324 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:18.326 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:10:18.326 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:18.326 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:18.327 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:10:18.327 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:10:18.331 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:18.331 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:10:18.332 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:10:18.334 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:10:18.336 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:10:18.339 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:18.343 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:18.344 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:18.346 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:18.347 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:18.349 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:18.350 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:18.350 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:18.350 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:10:18.350 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:10:18.351 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:18.352 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:18.352 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:18.355 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:18.356 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:18.357 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:18.360 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:18.360 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:10:18.362 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:18.362 +08:00 [INF] Executed DbCommand (17ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:10:18.363 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:18.363 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:10:18.364 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 36.5659ms
2025-08-01 00:10:18.364 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:10:18.364 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 42.96ms
2025-08-01 00:10:18.365 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:18.365 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:10:18.367 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:18.367 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:10:18.369 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:18.370 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:18.370 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:18.371 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:18.371 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:18.372 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:10:18.372 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 39.6807ms
2025-08-01 00:10:18.372 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:10:18.372 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 46.2454ms
2025-08-01 00:10:18.372 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:18.374 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:18.376 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:18.377 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:18.379 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:18.382 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:10:18.384 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:10:18.384 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:10:18.385 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 34.3475ms
2025-08-01 00:10:18.385 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:10:18.385 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 61.647ms
2025-08-01 00:10:25.014 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:10:25.014 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:25.014 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.3929ms
2025-08-01 00:10:25.015 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5294/api/courses/21 - application/json 1002
2025-08-01 00:10:25.015 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:25.017 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:25.017 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api)'
2025-08-01 00:10:25.017 +08:00 [INF] Route matched with {action = "UpdateCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCourse(Int32, CeceLearningPortal.Api.DTOs.UpdateCourseDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:10:25.017 +08:00 [INF] UpdateCourse called for ID: 21
2025-08-01 00:10:25.018 +08:00 [INF] Received data: {"Title":"Computer Vision Fundamentals","Description":"Learn the fundamentals of computer vision, image processing, and deep learning for visual recognition tasks.","ShortDescription":"","Price":150,"OriginalPrice":299.99,"Duration":"30 hours","Level":"Advanced","Category":"Business","Thumbnail":null,"ThumbnailUrl":"","PromoVideoUrl":"","Language":"en","Features":[],"PreviewUrl":"","EnrollmentType":null,"Status":null,"CourseFeatures":{"Certificate":true,"Community":false,"LiveSessions":true,"DownloadableResources":false,"Assignments":true,"Quizzes":false},"CourseType":"Custom","PricingModel":"OneTime","Currency":"PHP","AccessType":"Limited","AccessDuration":null,"Automations":{"WelcomeEmail":true,"CompletionCertificate":true,"ProgressReminders":true,"AbandonmentSequence":false},"Modules":[{"Title":"Getting Started","Description":"Introduction and fundamentals","Order":1,"Lessons":[{"Title":"Lessontest","Duration":"10:00","Type":"Video","Content":null,"VideoUrl":null,"Order":1}]}]}
2025-08-01 00:10:25.018 +08:00 [INF] CourseType: Custom
2025-08-01 00:10:25.018 +08:00 [INF] PricingModel: OneTime
2025-08-01 00:10:25.018 +08:00 [INF] Language: en
2025-08-01 00:10:25.018 +08:00 [INF] CourseFeatures: {"Certificate":true,"Community":false,"LiveSessions":true,"DownloadableResources":false,"Assignments":true,"Quizzes":false}
2025-08-01 00:10:25.019 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.id = @__id_0
LIMIT 1
2025-08-01 00:10:25.021 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__course_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.course_id, c.created_at, c.description, c."order", c.title, c.updated_at, c0.id, c0.content, c0.created_at, c0.duration, c0.module_id, c0."order", c0.title, c0.type, c0.updated_at, c0.video_url
FROM course_modules AS c
LEFT JOIN course_lessons AS c0 ON c.id = c0.module_id
WHERE c.course_id = @__course_Id_0
ORDER BY c.id
2025-08-01 00:10:25.030 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p6='?' (DbType = Int32), @p2='?' (DbType = Boolean), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE course_modules SET updated_at = @p0
WHERE id = @p1;
UPDATE courses SET "HasAssignments" = @p2, "HasCertificate" = @p3, "HasLiveSessions" = @p4, updated_at = @p5
WHERE id = @p6;
2025-08-01 00:10:25.031 +08:00 [INF] Update successful. Returned course: {"Id":21,"Title":"Computer Vision Fundamentals","Description":"Learn the fundamentals of computer vision, image processing, and deep learning for visual recognition tasks.","InstructorId":"bee889a2-efca-471d-807c-a7674a945612","InstructorName":"Unknown","Price":150,"OriginalPrice":299.99,"Discount":49,"Duration":"30 hours","Level":"Advanced","Category":"Business","Thumbnail":null,"Status":"Active","IsBestseller":false,"Features":[],"PreviewUrl":"","EnrollmentType":"OneTime","StudentsCount":0,"AverageRating":0,"LecturesCount":1,"CreatedAt":"2025-05-31T06:05:22.858366Z","UpdatedAt":"2025-07-31T16:10:25.020384Z","CourseType":"Custom"}
2025-08-01 00:10:25.031 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-08-01 00:10:25.031 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api) in 14.2746ms
2025-08-01 00:10:25.032 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api)'
2025-08-01 00:10:25.032 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 16.5841ms
2025-08-01 00:10:25.041 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:10:25.041 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:25.042 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.7029ms
2025-08-01 00:10:25.043 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:10:25.044 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:25.048 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:25.048 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:10:25.048 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:10:25.054 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:10:25.058 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:10:25.058 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.8574ms
2025-08-01 00:10:25.059 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:10:25.059 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 15.7087ms
2025-08-01 00:10:25.115 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:10:25.116 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:25.116 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.4441ms
2025-08-01 00:10:25.118 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:10:25.118 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:25.120 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:25.120 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:10:25.120 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:10:25.120 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.8221ms
2025-08-01 00:10:25.136 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:10:25.136 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:10:25.136 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:10:25.136 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:25.137 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:25.137 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:25.147 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 10.4562ms
2025-08-01 00:10:25.148 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 11.3051ms
2025-08-01 00:10:25.150 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:10:25.151 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:25.151 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:10:25.152 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:25.152 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:25.154 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:10:25.154 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:10:25.155 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 18.5435ms
2025-08-01 00:10:25.156 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:25.156 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:10:25.157 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:10:25.157 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:25.157 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:10:25.157 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:10:25.158 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:10:25.160 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:10:25.160 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:10:25.162 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:25.163 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:10:25.164 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:25.164 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:10:25.165 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:25.165 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:25.167 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:25.167 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:25.169 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:25.171 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:25.171 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:25.172 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:25.173 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:25.174 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:25.174 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:25.175 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:25.175 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:25.177 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:25.177 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:10:25.178 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:25.179 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:10:25.180 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:10:25.180 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:25.180 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 23.7176ms
2025-08-01 00:10:25.181 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:10:25.181 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 30.588ms
2025-08-01 00:10:25.182 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:25.184 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:25.185 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:25.186 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:25.187 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:25.188 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:25.190 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:25.191 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:25.192 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:25.194 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:25.194 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:10:25.194 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 37.3305ms
2025-08-01 00:10:25.195 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:10:25.195 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 43.6ms
2025-08-01 00:10:26.773 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:10:26.774 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:26.776 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:26.776 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:10:26.777 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:10:26.783 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:10:26.784 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:10:26.785 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 7.7322ms
2025-08-01 00:10:26.785 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:10:26.785 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 12.17ms
2025-08-01 00:10:26.788 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:10:26.788 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:26.789 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.4704ms
2025-08-01 00:10:26.790 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:10:26.790 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:26.792 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:26.793 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:10:26.793 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:10:26.795 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:10:26.796 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:10:26.796 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 3.1885ms
2025-08-01 00:10:26.796 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:10:26.797 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 6.4759ms
2025-08-01 00:10:39.903 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:10:39.903 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:39.903 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.5557ms
2025-08-01 00:10:39.904 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:10:39.905 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:39.906 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:39.907 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:10:39.907 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:10:39.913 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:10:39.916 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:10:39.916 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.5626ms
2025-08-01 00:10:39.917 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:10:39.917 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 12.314ms
2025-08-01 00:10:39.923 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:10:39.923 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:39.923 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.4372ms
2025-08-01 00:10:39.924 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:10:39.925 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:39.927 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:39.927 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:10:39.928 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:10:39.928 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.3568ms
2025-08-01 00:10:39.949 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:10:39.950 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:39.952 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:39.952 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:10:39.952 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:10:39.952 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.8384ms
2025-08-01 00:10:39.964 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:10:39.965 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:39.965 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.9286ms
2025-08-01 00:10:39.966 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:10:39.966 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:10:39.967 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:39.967 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:39.967 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:10:39.967 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.8129ms
2025-08-01 00:10:39.967 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.7984ms
2025-08-01 00:10:39.968 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:39.980 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:10:39.980 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:10:39.980 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:39.980 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:10:39.982 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:39.982 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:39.982 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:10:39.983 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:10:39.983 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:10:39.983 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:10:39.983 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:10:39.986 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:10:39.983 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:10:39.990 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:10:39.992 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:10:39.993 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:10:39.994 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:39.994 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:10:39.994 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:10:39.995 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:39.996 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:10:39.996 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 7.5707ms
2025-08-01 00:10:39.996 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:10:39.996 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 29.5341ms
2025-08-01 00:10:39.997 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:39.998 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:10:40.000 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:40.000 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:40.002 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:40.002 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:40.003 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:40.003 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:40.004 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:40.004 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:40.005 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:40.005 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:40.006 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:40.006 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:40.007 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:10:40.007 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:40.008 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:40.008 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:10:40.010 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:40.010 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:10:40.011 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:10:40.012 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 28.4569ms
2025-08-01 00:10:40.012 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:40.012 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:10:40.013 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 32.9857ms
2025-08-01 00:10:40.014 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:40.015 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:40.017 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:40.019 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:40.020 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:40.021 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:10:40.022 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:40.023 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:10:40.023 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:10:40.023 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 35.1695ms
2025-08-01 00:10:40.024 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:10:40.024 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 44.1013ms
2025-08-01 00:11:58.525 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:11:58.526 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:11:58.526 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.6255ms
2025-08-01 00:11:58.527 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5294/api/courses/21 - application/json 1002
2025-08-01 00:11:58.527 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:11:58.529 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:11:58.529 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api)'
2025-08-01 00:11:58.529 +08:00 [INF] Route matched with {action = "UpdateCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCourse(Int32, CeceLearningPortal.Api.DTOs.UpdateCourseDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:11:58.530 +08:00 [INF] UpdateCourse called for ID: 21
2025-08-01 00:11:58.531 +08:00 [INF] Received data: {"Title":"Computer Vision Fundamentals","Description":"Learn the fundamentals of computer vision, image processing, and deep learning for visual recognition tasks.","ShortDescription":"","Price":150,"OriginalPrice":299.99,"Duration":"30 hours","Level":"Advanced","Category":"Business","Thumbnail":null,"ThumbnailUrl":"","PromoVideoUrl":"","Language":"en","Features":[],"PreviewUrl":"","EnrollmentType":null,"Status":null,"CourseFeatures":{"Certificate":true,"Community":false,"LiveSessions":true,"DownloadableResources":false,"Assignments":true,"Quizzes":false},"CourseType":"Custom","PricingModel":"OneTime","Currency":"PHP","AccessType":"Limited","AccessDuration":null,"Automations":{"WelcomeEmail":true,"CompletionCertificate":true,"ProgressReminders":true,"AbandonmentSequence":false},"Modules":[{"Title":"Getting Started","Description":"Introduction and fundamentals","Order":1,"Lessons":[{"Title":"Lessontest","Duration":"10:00","Type":"Video","Content":null,"VideoUrl":null,"Order":1}]}]}
2025-08-01 00:11:58.531 +08:00 [INF] CourseType: Custom
2025-08-01 00:11:58.531 +08:00 [INF] PricingModel: OneTime
2025-08-01 00:11:58.531 +08:00 [INF] Language: en
2025-08-01 00:11:58.531 +08:00 [INF] CourseFeatures: {"Certificate":true,"Community":false,"LiveSessions":true,"DownloadableResources":false,"Assignments":true,"Quizzes":false}
2025-08-01 00:11:58.533 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.id = @__id_0
LIMIT 1
2025-08-01 00:11:58.536 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__course_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.course_id, c.created_at, c.description, c."order", c.title, c.updated_at, c0.id, c0.content, c0.created_at, c0.duration, c0.module_id, c0."order", c0.title, c0.type, c0.updated_at, c0.video_url
FROM course_modules AS c
LEFT JOIN course_lessons AS c0 ON c.id = c0.module_id
WHERE c.course_id = @__course_Id_0
ORDER BY c.id
2025-08-01 00:11:58.538 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE course_modules SET updated_at = @p0
WHERE id = @p1;
UPDATE courses SET updated_at = @p2
WHERE id = @p3;
2025-08-01 00:11:58.540 +08:00 [INF] Update successful. Returned course: {"Id":21,"Title":"Computer Vision Fundamentals","Description":"Learn the fundamentals of computer vision, image processing, and deep learning for visual recognition tasks.","InstructorId":"bee889a2-efca-471d-807c-a7674a945612","InstructorName":"Unknown","Price":150,"OriginalPrice":299.99,"Discount":49,"Duration":"30 hours","Level":"Advanced","Category":"Business","Thumbnail":null,"Status":"Active","IsBestseller":false,"Features":[],"PreviewUrl":"","EnrollmentType":"OneTime","StudentsCount":0,"AverageRating":0,"LecturesCount":1,"CreatedAt":"2025-05-31T06:05:22.858366Z","UpdatedAt":"2025-07-31T16:11:58.534314Z","CourseType":"Custom"}
2025-08-01 00:11:58.540 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-08-01 00:11:58.541 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api) in 11.0285ms
2025-08-01 00:11:58.541 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api)'
2025-08-01 00:11:58.541 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 14.1531ms
2025-08-01 00:11:58.562 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:11:58.563 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:11:58.563 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.5419ms
2025-08-01 00:11:58.568 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:11:58.570 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:11:58.574 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:11:58.574 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:11:58.574 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:11:58.743 +08:00 [INF] Executed DbCommand (167ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:11:58.750 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:11:58.750 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 175.9262ms
2025-08-01 00:11:58.751 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:11:58.751 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 182.4099ms
2025-08-01 00:11:58.761 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:11:58.762 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:11:58.762 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.6958ms
2025-08-01 00:11:58.773 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:11:58.774 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:11:58.793 +08:00 [INF] Executed DbCommand (17ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:11:58.794 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:11:58.794 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:11:58.794 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 21.565ms
2025-08-01 00:11:58.797 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:11:58.798 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:11:58.802 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:11:58.803 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:11:58.803 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 1.0083ms
2025-08-01 00:11:58.803 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:11:58.804 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:11:58.804 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:11:58.804 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:11:58.804 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:11:58.805 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 7.3392ms
2025-08-01 00:11:58.805 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.6812ms
2025-08-01 00:11:58.810 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:11:58.810 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:11:58.810 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:11:58.810 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:11:58.813 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:11:58.813 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:11:58.813 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:11:58.813 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:11:58.813 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:11:58.814 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:11:58.824 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:11:58.828 +08:00 [INF] Executed DbCommand (13ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:11:58.829 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:11:58.833 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:11:58.833 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:11:58.839 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:11:58.840 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:11:58.841 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:11:58.843 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:11:58.844 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:11:58.846 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:11:58.849 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:11:58.855 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:11:58.879 +08:00 [INF] Executed DbCommand (27ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:11:58.886 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:11:58.887 +08:00 [INF] Executed DbCommand (32ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:11:58.889 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:11:58.890 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:11:58.897 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:11:58.898 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:11:58.903 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:11:58.903 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:11:58.905 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:11:58.905 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 91.3729ms
2025-08-01 00:11:58.905 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:11:58.906 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 95.661ms
2025-08-01 00:11:58.906 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:11:58.908 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:11:58.911 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:11:58.912 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:11:58.914 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:11:58.915 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:11:58.917 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:11:58.919 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:11:58.923 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:11:58.924 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:11:58.925 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:11:58.927 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:11:58.929 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:11:58.929 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:11:58.929 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 115.591ms
2025-08-01 00:11:58.929 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:11:58.929 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 119.4851ms
2025-08-01 00:12:00.516 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:12:00.517 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:00.519 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:00.519 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:12:00.519 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:12:00.528 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:12:00.529 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:12:00.529 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 10.18ms
2025-08-01 00:12:00.530 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:12:00.530 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 13.8499ms
2025-08-01 00:12:00.532 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:12:00.533 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:00.533 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.8013ms
2025-08-01 00:12:00.536 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:12:00.536 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:00.538 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:00.538 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:12:00.538 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:12:00.541 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:12:00.542 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:12:00.542 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 3.0402ms
2025-08-01 00:12:00.542 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:12:00.542 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 6.0417ms
2025-08-01 00:12:08.594 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:12:08.594 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:08.594 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.7203ms
2025-08-01 00:12:08.596 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:12:08.596 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:08.597 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:08.598 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:12:08.598 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:12:08.602 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:12:08.604 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:12:08.605 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.8604ms
2025-08-01 00:12:08.605 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:12:08.605 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 9.4385ms
2025-08-01 00:12:08.609 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:12:08.610 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:08.610 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.6662ms
2025-08-01 00:12:08.611 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:12:08.612 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:08.614 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:08.614 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:12:08.614 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:12:08.615 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.2921ms
2025-08-01 00:12:08.631 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:12:08.631 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:08.633 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:08.633 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:12:08.633 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:12:08.633 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.4028ms
2025-08-01 00:12:08.644 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:12:08.644 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:12:08.644 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:08.644 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:08.644 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.6314ms
2025-08-01 00:12:08.644 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.5233ms
2025-08-01 00:12:08.647 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:12:08.647 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:12:08.647 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:08.647 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:08.649 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:08.649 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:08.650 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:12:08.650 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:12:08.650 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:12:08.650 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:12:08.652 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:12:08.654 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:12:08.654 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:12:08.655 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:08.657 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:08.657 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:12:08.658 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:08.659 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:12:08.659 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:08.661 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:08.661 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:08.662 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:08.663 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:08.663 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:08.664 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:08.664 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:08.665 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:08.678 +08:00 [INF] Executed DbCommand (14ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:08.680 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:08.680 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:08.680 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:08.680 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:08.682 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:08.686 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:12:08.686 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:08.688 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:08.688 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:12:08.689 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:12:08.689 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 38.5986ms
2025-08-01 00:12:08.689 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:08.689 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:12:08.690 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 43.155ms
2025-08-01 00:12:08.691 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:08.692 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:08.693 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:08.694 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:08.695 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:08.696 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:08.697 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:08.697 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:12:08.697 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 47.1166ms
2025-08-01 00:12:08.697 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:12:08.698 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 51.018ms
2025-08-01 00:12:10.296 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:12:10.296 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:10.298 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:10.299 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:12:10.299 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:12:10.301 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:12:10.304 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:12:10.306 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:12:10.309 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:10.310 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:10.311 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:10.313 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:10.313 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:10.315 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:10.316 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:10.318 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:12:10.319 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:12:10.320 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:12:10.320 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 20.7943ms
2025-08-01 00:12:10.320 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:12:10.320 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 24.1473ms
2025-08-01 00:12:11.534 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:12:11.535 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:11.537 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:11.537 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:12:11.537 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:12:11.539 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:12:11.540 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:12:11.541 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:11.543 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:11.544 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:11.545 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:11.547 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:11.548 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:11.549 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:11.551 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:11.552 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:11.553 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:11.554 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:11.555 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:11.556 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:11.557 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:11.558 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:11.559 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:11.560 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:11.561 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:11.562 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:11.563 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:11.565 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:11.565 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:12:11.565 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 28.0156ms
2025-08-01 00:12:11.565 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:12:11.566 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 31.2021ms
2025-08-01 00:12:11.568 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:12:11.568 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:11.570 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:11.570 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:12:11.570 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:12:11.573 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:12:11.575 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:12:11.577 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:12:11.578 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:11.579 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:11.580 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:11.581 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:11.582 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:11.583 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:11.584 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:11.585 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:12:11.586 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:12:11.586 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:12:11.587 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 16.2324ms
2025-08-01 00:12:11.587 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:12:11.587 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 18.8171ms
2025-08-01 00:12:15.318 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/28 - null null
2025-08-01 00:12:15.318 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:15.319 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/28 - 204 null null 0.4334ms
2025-08-01 00:12:15.319 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/28 - application/json null
2025-08-01 00:12:15.320 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:15.321 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:15.321 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:12:15.321 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:12:15.327 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:12:15.328 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:12:15.328 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 6.6581ms
2025-08-01 00:12:15.328 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:12:15.328 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/28 - 200 null application/json; charset=utf-8 9.0935ms
2025-08-01 00:12:15.331 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:12:15.331 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:15.331 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.555ms
2025-08-01 00:12:15.334 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:12:15.334 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:15.335 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:15.336 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:12:15.336 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:12:15.339 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:12:15.339 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:12:15.340 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 3.7396ms
2025-08-01 00:12:15.340 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:12:15.340 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 6.953ms
2025-08-01 00:12:23.819 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments/courses/28 - null null
2025-08-01 00:12:23.820 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:23.820 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments/courses/28 - 204 null null 0.7397ms
2025-08-01 00:12:23.821 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/enrollments/courses/28 - application/json 0
2025-08-01 00:12:23.822 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:23.824 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:23.824 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.EnrollInCourse (CeceLearningPortal.Api)'
2025-08-01 00:12:23.830 +08:00 [INF] Route matched with {action = "EnrollInCourse", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] EnrollInCourse(Int32) on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:12:23.848 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32), @__studentId_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND e.student_id = @__studentId_1
LIMIT 1
2025-08-01 00:12:23.874 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM courses AS c
INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
WHERE c.id = @__courseId_0
LIMIT 1
2025-08-01 00:12:23.939 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Double), @p1='?' (DbType = Boolean), @p2='?', @p3='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?' (DbType = DateTime), @p8='?' (DbType = Double), @p9='?' (DbType = Int32), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO enrollments (average_quiz_score, certificate_issued, certificate_url, completed_at, completed_lessons, course_id, enrolled_at, last_accessed_date, progress_percentage, quiz_count, student_id, total_time_spent)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2025-08-01 00:12:23.943 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:12:23.945 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.EnrollmentDto'.
2025-08-01 00:12:23.948 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.EnrollInCourse (CeceLearningPortal.Api) in 117.8503ms
2025-08-01 00:12:23.948 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.EnrollInCourse (CeceLearningPortal.Api)'
2025-08-01 00:12:23.949 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/enrollments/courses/28 - 200 null application/json; charset=utf-8 127.402ms
2025-08-01 00:12:23.953 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/learning/courses/28/progress - null null
2025-08-01 00:12:23.954 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:23.954 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/learning/courses/28/progress - 204 null null 0.9563ms
2025-08-01 00:12:23.956 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5294/api/learning/courses/28/progress - application/json 223
2025-08-01 00:12:23.957 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:23.959 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:23.959 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5294/api/learning/courses/28/progress - 404 0 null 3.1783ms
2025-08-01 00:12:23.959 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: PUT http://localhost:5294/api/learning/courses/28/progress, Response status code: 404
2025-08-01 00:12:26.525 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:12:26.526 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:26.526 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.485ms
2025-08-01 00:12:26.527 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:12:26.528 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:26.528 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.7386ms
2025-08-01 00:12:26.529 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:12:26.529 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:26.530 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:12:26.531 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:26.532 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:26.533 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:12:26.533 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:12:26.533 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 4.4111ms
2025-08-01 00:12:26.533 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:26.534 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:12:26.534 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:12:26.539 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:12:26.543 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:12:26.544 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.2968ms
2025-08-01 00:12:26.544 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:12:26.544 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 14.2471ms
2025-08-01 00:12:26.551 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - null null
2025-08-01 00:12:26.552 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:26.553 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 204 null null 1.143ms
2025-08-01 00:12:26.554 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - application/json null
2025-08-01 00:12:26.555 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:26.557 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:26.557 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 404 0 null 2.8896ms
2025-08-01 00:12:26.558 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats, Response status code: 404
2025-08-01 00:12:26.589 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:12:26.590 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:26.590 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.3801ms
2025-08-01 00:12:26.601 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:12:26.602 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:26.607 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:26.608 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:12:26.609 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:12:26.613 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:12:26.616 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:12:26.616 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.4092ms
2025-08-01 00:12:26.617 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:12:26.617 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 15.7329ms
2025-08-01 00:12:37.380 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:12:37.381 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:37.381 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.1753ms
2025-08-01 00:12:37.382 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:12:37.383 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:37.385 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:37.385 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:12:37.385 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:12:37.391 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:12:37.395 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:12:37.396 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 10.1502ms
2025-08-01 00:12:37.396 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:12:37.398 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 15.4084ms
2025-08-01 00:12:37.401 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:12:37.401 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:37.401 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.3883ms
2025-08-01 00:12:37.402 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:12:37.402 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:37.405 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:37.405 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:12:37.405 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:12:37.405 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.9581ms
2025-08-01 00:12:37.428 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:12:37.429 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:37.431 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:37.431 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:12:37.431 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:12:37.431 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.7161ms
2025-08-01 00:12:37.440 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:12:37.440 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:12:37.440 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:37.440 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:37.440 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.7083ms
2025-08-01 00:12:37.441 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.9676ms
2025-08-01 00:12:37.443 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:12:37.443 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:12:37.443 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:37.443 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:37.446 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:37.446 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:37.446 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:12:37.447 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:12:37.447 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:12:37.447 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:12:37.448 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:12:37.450 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:12:37.450 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:12:37.452 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:37.454 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:12:37.454 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:37.455 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:12:37.456 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:37.457 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:37.457 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:37.458 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:37.476 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:37.476 +08:00 [INF] Executed DbCommand (18ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:37.478 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:37.485 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:37.486 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:37.487 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:37.487 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:37.488 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:37.489 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:37.490 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:37.491 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:12:37.492 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:37.493 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:12:37.493 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:12:37.493 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:37.493 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 45.7523ms
2025-08-01 00:12:37.493 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:12:37.494 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 50.8762ms
2025-08-01 00:12:37.495 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:37.496 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:37.496 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:37.497 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:37.498 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:37.499 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:37.500 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:37.501 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:37.502 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:37.503 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:37.503 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:12:37.503 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 56.0853ms
2025-08-01 00:12:37.503 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:12:37.503 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 60.5719ms
2025-08-01 00:12:47.443 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/profile - null null
2025-08-01 00:12:47.444 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:47.444 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/profile - 204 null null 0.8507ms
2025-08-01 00:12:47.445 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/profile - application/json null
2025-08-01 00:12:47.445 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:47.448 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:47.448 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/profile - 404 0 null 3.4526ms
2025-08-01 00:12:47.449 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/profile, Response status code: 404
2025-08-01 00:12:47.451 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:12:47.451 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:47.452 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.6007ms
2025-08-01 00:12:47.453 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:12:47.454 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:47.456 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:47.457 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-08-01 00:12:47.462 +08:00 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUser(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-08-01 00:12:47.531 +08:00 [INF] Executed DbCommand (64ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:12:47.533 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserDto'.
2025-08-01 00:12:47.535 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api) in 72.9302ms
2025-08-01 00:12:47.535 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-08-01 00:12:47.535 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 81.9239ms
2025-08-01 00:12:47.537 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/stats - null null
2025-08-01 00:12:47.538 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:47.538 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/stats - 204 null null 0.3644ms
2025-08-01 00:12:47.539 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/stats - application/json null
2025-08-01 00:12:47.539 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:47.555 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:47.555 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-08-01 00:12:47.559 +08:00 [INF] Route matched with {action = "GetUserStats", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserStats(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-08-01 00:12:47.572 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-01 00:12:47.604 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s.id0, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s.id1, s.approved_at, s.approved_by, s.comment, s.course_id0, s.created_at0, s.is_flagged, s.rating, s.status0, s.student_id0
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, e.id AS id0, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c0.id AS id1, c0.approved_at, c0.approved_by, c0.comment, c0.course_id AS course_id0, c0.created_at AS created_at0, c0.is_flagged, c0.rating, c0.status AS status0, c0.student_id AS student_id0
    FROM courses AS c
    LEFT JOIN enrollments AS e ON c.id = e.course_id
    LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
) AS s ON a0."Id" = s.instructor_id
ORDER BY a0."Id", s.id, s.id0
2025-08-01 00:12:47.622 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserStatsDto'.
2025-08-01 00:12:47.629 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api) in 70.418ms
2025-08-01 00:12:47.630 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-08-01 00:12:47.630 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/stats - 200 null application/json; charset=utf-8 91.1211ms
2025-08-01 00:12:47.633 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/certificates - null null
2025-08-01 00:12:47.633 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:47.633 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/certificates - 204 null null 0.3451ms
2025-08-01 00:12:47.635 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/certificates - application/json null
2025-08-01 00:12:47.635 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:47.637 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:47.638 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/certificates - 404 0 null 2.9985ms
2025-08-01 00:12:47.638 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/certificates, Response status code: 404
2025-08-01 00:12:47.640 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/activity - null null
2025-08-01 00:12:47.641 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:47.641 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/activity - 204 null null 0.4649ms
2025-08-01 00:12:47.642 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/activity - application/json null
2025-08-01 00:12:47.642 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:47.644 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:47.644 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/activity - 404 0 null 2.0807ms
2025-08-01 00:12:47.645 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/activity, Response status code: 404
2025-08-01 00:12:47.647 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - null null
2025-08-01 00:12:47.648 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:47.648 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 204 null null 0.5466ms
2025-08-01 00:12:47.650 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - application/json null
2025-08-01 00:12:47.650 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:47.652 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:47.652 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 404 0 null 2.1395ms
2025-08-01 00:12:47.653 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats, Response status code: 404
2025-08-01 00:12:53.492 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:12:53.492 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:53.493 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.3886ms
2025-08-01 00:12:53.494 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:12:53.494 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:53.496 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:53.496 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:12:53.496 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:12:53.499 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:12:53.501 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:12:53.503 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:12:53.504 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:53.505 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:53.506 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:53.507 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:53.508 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:53.510 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:53.511 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:53.513 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:12:53.514 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:12:53.515 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:12:53.515 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 19.1256ms
2025-08-01 00:12:53.516 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:12:53.516 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 22.3692ms
2025-08-01 00:12:54.904 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:12:54.904 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:54.904 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.4165ms
2025-08-01 00:12:54.905 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:12:54.905 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:54.907 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:54.907 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:12:54.907 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:12:54.908 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:12:54.910 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:12:54.912 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:54.913 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:54.914 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:54.915 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:54.916 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:54.918 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:54.919 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:54.921 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:54.922 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:54.923 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:54.924 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:54.925 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:54.926 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:54.927 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:54.928 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:54.929 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:54.930 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:54.931 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:54.931 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:12:54.932 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:54.933 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:12:54.934 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:12:54.934 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 26.4787ms
2025-08-01 00:12:54.934 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:12:54.934 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 29.1775ms
2025-08-01 00:12:54.937 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:12:54.938 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:12:54.939 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:12:54.939 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:12:54.939 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:12:54.942 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:12:54.944 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:12:54.946 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:12:54.947 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:54.948 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:54.949 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:54.950 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:54.952 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:54.954 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:54.955 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:12:54.956 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:12:54.957 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:12:54.958 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:12:54.958 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 18.7057ms
2025-08-01 00:12:54.958 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:12:54.958 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 21.092ms
2025-08-01 00:13:03.937 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:13:03.938 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:03.938 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.1593ms
2025-08-01 00:13:03.939 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:13:03.940 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:03.941 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:03.942 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:13:03.942 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:13:03.946 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:13:03.949 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:13:03.949 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.0993ms
2025-08-01 00:13:03.950 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:13:03.950 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 10.5057ms
2025-08-01 00:13:03.953 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:13:03.954 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:03.954 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.5713ms
2025-08-01 00:13:03.955 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:13:03.955 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:03.957 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:03.957 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:13:03.957 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:13:03.957 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.2573ms
2025-08-01 00:13:03.978 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:13:03.979 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:03.980 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:03.981 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:13:03.981 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:13:03.981 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.6258ms
2025-08-01 00:13:03.994 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:13:03.994 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:13:03.994 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:03.994 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:03.994 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.6858ms
2025-08-01 00:13:03.995 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.6991ms
2025-08-01 00:13:04.000 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:13:04.000 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:13:04.001 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:04.001 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:04.003 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:04.003 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:04.003 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:13:04.004 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:13:04.005 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:13:04.005 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:13:04.009 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:13:04.011 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:13:04.011 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:13:04.013 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:13:04.014 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:13:04.014 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:04.016 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:04.016 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:13:04.018 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:13:04.019 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:04.019 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:04.020 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:04.020 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:04.021 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:04.022 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:04.022 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:13:04.023 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:04.023 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:04.025 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:04.025 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:04.026 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:04.026 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:13:04.028 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:04.028 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:13:04.030 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:04.030 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:13:04.030 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:13:04.031 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 25.5411ms
2025-08-01 00:13:04.031 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:13:04.031 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:13:04.031 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 30.922ms
2025-08-01 00:13:04.036 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:04.037 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:04.038 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:13:04.039 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:04.041 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:04.043 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:13:04.044 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:04.045 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:04.046 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:13:04.046 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 40.4446ms
2025-08-01 00:13:04.047 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:13:04.047 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 46.7433ms
2025-08-01 00:13:09.002 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:13:09.002 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:09.003 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.6302ms
2025-08-01 00:13:09.004 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:13:09.004 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:09.006 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:09.007 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:13:09.007 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:13:09.011 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:13:09.015 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:13:09.017 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:13:09.018 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:09.019 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:09.021 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:09.023 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:09.024 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:09.025 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:09.026 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:09.028 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:13:09.029 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:13:09.029 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:13:09.029 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 22.4749ms
2025-08-01 00:13:09.030 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:13:09.030 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 25.6978ms
2025-08-01 00:13:10.288 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:13:10.289 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:10.289 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.4097ms
2025-08-01 00:13:10.290 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:13:10.290 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:10.293 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:10.293 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:13:10.293 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:13:10.295 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:13:10.296 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:13:10.297 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:13:10.298 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:10.300 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:10.301 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:13:10.302 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:10.304 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:10.306 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:13:10.307 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:10.308 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:10.309 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:13:10.310 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:10.311 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:10.312 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:13:10.313 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:10.314 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:10.316 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:13:10.317 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:10.318 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:10.320 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:13:10.322 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:10.323 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:13:10.323 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:13:10.323 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 30.1487ms
2025-08-01 00:13:10.323 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:13:10.324 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 33.8577ms
2025-08-01 00:13:10.326 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:13:10.327 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:10.328 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:10.329 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:13:10.329 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:13:10.331 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:13:10.334 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:13:10.338 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:13:10.341 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:10.342 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:10.343 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:10.344 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:10.345 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:10.347 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:10.348 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:13:10.349 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:13:10.351 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:13:10.351 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:13:10.352 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 22.7531ms
2025-08-01 00:13:10.352 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:13:10.353 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 25.9983ms
2025-08-01 00:13:14.332 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/logout - null null
2025-08-01 00:13:14.333 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:14.333 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/logout - 204 null null 0.8103ms
2025-08-01 00:13:14.334 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/logout - application/json 0
2025-08-01 00:13:14.334 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:14.336 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:14.336 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-08-01 00:13:14.336 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-01 00:13:14.359 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-08-01 00:13:14.362 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET revoked_at = @p0
WHERE id = @p1;
2025-08-01 00:13:14.363 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:13:14.363 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 26.7034ms
2025-08-01 00:13:14.363 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-08-01 00:13:14.363 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/logout - 200 null application/json; charset=utf-8 29.0544ms
2025-08-01 00:13:14.441 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:13:14.441 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:14.441 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.4372ms
2025-08-01 00:13:14.442 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:13:14.443 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:14.443 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:13:14.443 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:13:14.448 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:13:14.451 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:13:14.452 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.3771ms
2025-08-01 00:13:14.452 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:13:14.452 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 9.8257ms
2025-08-01 00:13:14.504 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:13:14.504 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:14.504 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.414ms
2025-08-01 00:13:14.505 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:13:14.506 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:14.506 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:13:14.511 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-01 00:13:14.512 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 401 0 null 6.2165ms
2025-08-01 00:13:21.345 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - null null
2025-08-01 00:13:21.346 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:21.346 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - 204 null null 0.6548ms
2025-08-01 00:13:21.347 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/login - application/json 55
2025-08-01 00:13:21.347 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:21.348 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-01 00:13:21.348 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-01 00:13:21.352 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-08-01 00:13:21.478 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-08-01 00:13:21.480 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-08-01 00:13:21.480 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 131.7935ms
2025-08-01 00:13:21.480 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-01 00:13:21.480 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/login - 200 null application/json; charset=utf-8 133.1036ms
2025-08-01 00:13:21.515 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:13:21.515 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:13:21.515 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:21.516 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:21.516 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.8105ms
2025-08-01 00:13:21.516 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.8833ms
2025-08-01 00:13:21.518 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:13:21.518 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:13:21.519 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:21.519 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:21.521 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:21.521 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:21.521 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:13:21.521 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:13:21.521 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:13:21.522 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:13:21.522 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.3928ms
2025-08-01 00:13:21.526 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:13:21.528 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:13:21.529 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9099ms
2025-08-01 00:13:21.529 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:13:21.529 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 10.8318ms
2025-08-01 00:13:23.809 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:13:23.812 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:23.813 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:23.813 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:13:23.814 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:13:23.817 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:13:23.820 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:13:23.820 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.4198ms
2025-08-01 00:13:23.820 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:13:23.821 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 12.0221ms
2025-08-01 00:13:23.825 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:13:23.825 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:23.828 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:23.828 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:13:23.828 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:13:23.828 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.1397ms
2025-08-01 00:13:23.862 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:13:23.863 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:23.865 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:23.866 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:13:23.866 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:13:23.866 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.4697ms
2025-08-01 00:13:23.871 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - null null
2025-08-01 00:13:23.872 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:23.872 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - 204 null null 0.9742ms
2025-08-01 00:13:23.875 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/stats - application/json null
2025-08-01 00:13:23.878 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:23.880 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:23.880 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:13:23.884 +08:00 [INF] Route matched with {action = "GetStudentStats", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStudentStats() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:13:23.906 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
WHERE e.student_id = @__userId_0
2025-08-01 00:13:23.931 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t.amount, t.course_id, t.created_at, t.currency, t.payment_intent_id, t.payment_method, t.processed_at, t.status, t.subscription_id, t.transaction_id, t.user_id
FROM transactions AS t
WHERE t.user_id = @__userId_0 AND t.status = 'Completed'
2025-08-01 00:13:23.944 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType56`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:13:23.947 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api) in 63.4116ms
2025-08-01 00:13:23.947 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:13:23.948 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/stats - 200 null application/json; charset=utf-8 72.6275ms
2025-08-01 00:13:23.949 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - null null
2025-08-01 00:13:23.950 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:23.950 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - 204 null null 0.3308ms
2025-08-01 00:13:23.951 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/courses - application/json null
2025-08-01 00:13:23.951 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:23.952 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:23.953 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:13:23.956 +08:00 [INF] Route matched with {action = "GetEnrolledCourses", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetEnrolledCourses() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:13:23.983 +08:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-08-01 00:13:24.027 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s ON c.id = s.course_id
WHERE e.student_id = @__userId_0
ORDER BY COALESCE(e.last_accessed_date, e.enrolled_at) DESC, e.id, c.id, a."Id", s.id
2025-08-01 00:13:24.028 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType55`14[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:13:24.031 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api) in 74.3018ms
2025-08-01 00:13:24.031 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:13:24.031 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/courses - 200 null application/json; charset=utf-8 80.0667ms
2025-08-01 00:13:24.034 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - null null
2025-08-01 00:13:24.034 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:24.034 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - 204 null null 0.3596ms
2025-08-01 00:13:24.035 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - application/json null
2025-08-01 00:13:24.035 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:13:24.037 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:13:24.037 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - 404 0 null 1.9661ms
2025-08-01 00:13:24.037 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/subscriptions/current, Response status code: 404
2025-08-01 00:14:44.505 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/25 - null null
2025-08-01 00:14:44.505 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:44.506 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/25 - 204 null null 0.8558ms
2025-08-01 00:14:44.507 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/25 - application/json null
2025-08-01 00:14:44.507 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:44.513 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:14:44.513 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:14:44.513 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:14:44.518 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:14:44.519 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:14:44.520 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 6.1633ms
2025-08-01 00:14:44.520 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:14:44.520 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/25 - 200 null application/json; charset=utf-8 13.0643ms
2025-08-01 00:14:44.531 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:14:44.531 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:44.531 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.7594ms
2025-08-01 00:14:44.533 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:14:44.534 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:44.536 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:14:44.536 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:14:44.537 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:14:44.539 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:14:44.540 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:14:44.540 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 2.7865ms
2025-08-01 00:14:44.540 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:14:44.540 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 6.853ms
2025-08-01 00:14:53.045 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:14:53.045 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:53.045 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.4481ms
2025-08-01 00:14:53.047 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:14:53.047 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:53.049 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:14:53.050 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:14:53.050 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:14:53.055 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:14:53.059 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:14:53.059 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.0458ms
2025-08-01 00:14:53.059 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:14:53.059 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 12.5551ms
2025-08-01 00:14:53.063 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:14:53.063 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:53.063 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.8055ms
2025-08-01 00:14:53.065 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:14:53.065 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:53.067 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:14:53.068 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:14:53.068 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:14:53.068 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.0369ms
2025-08-01 00:14:53.102 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:14:53.102 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:53.104 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:14:53.105 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:14:53.105 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:14:53.105 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.7421ms
2025-08-01 00:14:53.129 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - null null
2025-08-01 00:14:53.130 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:53.130 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - 204 null null 0.6328ms
2025-08-01 00:14:53.132 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/stats - application/json null
2025-08-01 00:14:53.133 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:53.146 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:14:53.146 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:14:53.146 +08:00 [INF] Route matched with {action = "GetStudentStats", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStudentStats() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:14:53.148 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
WHERE e.student_id = @__userId_0
2025-08-01 00:14:53.150 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t.amount, t.course_id, t.created_at, t.currency, t.payment_intent_id, t.payment_method, t.processed_at, t.status, t.subscription_id, t.transaction_id, t.user_id
FROM transactions AS t
WHERE t.user_id = @__userId_0 AND t.status = 'Completed'
2025-08-01 00:14:53.151 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType56`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:14:53.154 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api) in 7.3584ms
2025-08-01 00:14:53.154 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:14:53.154 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/stats - 200 null application/json; charset=utf-8 22.3233ms
2025-08-01 00:14:53.168 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - null null
2025-08-01 00:14:53.168 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:53.168 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - 204 null null 0.4093ms
2025-08-01 00:14:53.169 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/courses - application/json null
2025-08-01 00:14:53.169 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:53.171 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:14:53.171 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:14:53.171 +08:00 [INF] Route matched with {action = "GetEnrolledCourses", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetEnrolledCourses() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:14:53.174 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s ON c.id = s.course_id
WHERE e.student_id = @__userId_0
ORDER BY COALESCE(e.last_accessed_date, e.enrolled_at) DESC, e.id, c.id, a."Id", s.id
2025-08-01 00:14:53.174 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType55`14[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:14:53.175 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api) in 3.3994ms
2025-08-01 00:14:53.175 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:14:53.175 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/courses - 200 null application/json; charset=utf-8 5.9781ms
2025-08-01 00:14:53.195 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - null null
2025-08-01 00:14:53.195 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:53.195 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - 204 null null 0.4236ms
2025-08-01 00:14:53.196 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - application/json null
2025-08-01 00:14:53.196 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:14:53.198 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:14:53.198 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - 404 0 null 1.8063ms
2025-08-01 00:14:53.198 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/subscriptions/current, Response status code: 404
2025-08-01 00:15:39.793 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/25 - null null
2025-08-01 00:15:39.794 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:39.794 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/25 - 204 null null 0.3543ms
2025-08-01 00:15:39.795 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/25 - application/json null
2025-08-01 00:15:39.795 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:39.819 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:15:39.819 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:15:39.819 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:15:39.842 +08:00 [INF] Executed DbCommand (21ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:15:39.843 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:15:39.843 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 23.9892ms
2025-08-01 00:15:39.844 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:15:39.844 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/25 - 200 null application/json; charset=utf-8 48.7204ms
2025-08-01 00:15:39.847 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:15:39.848 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:39.848 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.799ms
2025-08-01 00:15:39.851 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:15:39.852 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:39.855 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:15:39.875 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:15:39.928 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:15:39.938 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:15:39.938 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:15:39.938 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 5.6232ms
2025-08-01 00:15:39.939 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:15:39.939 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 87.6091ms
2025-08-01 00:15:50.500 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:15:50.500 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:50.500 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.8949ms
2025-08-01 00:15:50.502 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:15:50.502 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:50.504 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:15:50.505 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:15:50.505 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:15:50.523 +08:00 [INF] Executed DbCommand (17ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:15:50.528 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:15:50.528 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 23.2098ms
2025-08-01 00:15:50.528 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:15:50.529 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 26.4507ms
2025-08-01 00:15:50.532 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:15:50.533 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:50.533 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.6077ms
2025-08-01 00:15:50.534 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:15:50.534 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:50.536 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:15:50.536 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:15:50.536 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:15:50.536 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.2353ms
2025-08-01 00:15:50.569 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:15:50.569 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:50.571 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:15:50.571 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:15:50.571 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:15:50.571 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.3564ms
2025-08-01 00:15:50.597 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - null null
2025-08-01 00:15:50.597 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:50.597 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - 204 null null 0.7867ms
2025-08-01 00:15:50.599 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/stats - application/json null
2025-08-01 00:15:50.600 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:50.603 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:15:50.604 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:15:50.604 +08:00 [INF] Route matched with {action = "GetStudentStats", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStudentStats() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:15:50.606 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
WHERE e.student_id = @__userId_0
2025-08-01 00:15:50.609 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t.amount, t.course_id, t.created_at, t.currency, t.payment_intent_id, t.payment_method, t.processed_at, t.status, t.subscription_id, t.transaction_id, t.user_id
FROM transactions AS t
WHERE t.user_id = @__userId_0 AND t.status = 'Completed'
2025-08-01 00:15:50.609 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType56`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:15:50.609 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api) in 4.6894ms
2025-08-01 00:15:50.610 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:15:50.610 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/stats - 200 null application/json; charset=utf-8 10.6389ms
2025-08-01 00:15:50.627 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - null null
2025-08-01 00:15:50.627 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:50.627 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - 204 null null 0.3863ms
2025-08-01 00:15:50.628 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/courses - application/json null
2025-08-01 00:15:50.629 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:50.630 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:15:50.630 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:15:50.630 +08:00 [INF] Route matched with {action = "GetEnrolledCourses", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetEnrolledCourses() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:15:50.633 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s ON c.id = s.course_id
WHERE e.student_id = @__userId_0
ORDER BY COALESCE(e.last_accessed_date, e.enrolled_at) DESC, e.id, c.id, a."Id", s.id
2025-08-01 00:15:50.633 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType55`14[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:15:50.634 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api) in 3.0868ms
2025-08-01 00:15:50.634 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:15:50.634 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/courses - 200 null application/json; charset=utf-8 5.6826ms
2025-08-01 00:15:50.653 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - null null
2025-08-01 00:15:50.653 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:50.653 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - 204 null null 0.3935ms
2025-08-01 00:15:50.654 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - application/json null
2025-08-01 00:15:50.654 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:50.655 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:15:50.656 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - 404 0 null 1.8249ms
2025-08-01 00:15:50.656 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/subscriptions/current, Response status code: 404
2025-08-01 00:15:56.058 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/28 - null null
2025-08-01 00:15:56.058 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:56.058 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/28 - 204 null null 0.4323ms
2025-08-01 00:15:56.062 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/28 - application/json null
2025-08-01 00:15:56.062 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:56.065 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:15:56.066 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:15:56.066 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:15:56.071 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:15:56.073 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:15:56.073 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 6.667ms
2025-08-01 00:15:56.073 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:15:56.073 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/28 - 200 null application/json; charset=utf-8 11.5497ms
2025-08-01 00:15:56.077 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:15:56.077 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:56.077 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.5826ms
2025-08-01 00:15:56.080 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:15:56.080 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:15:56.082 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:15:56.082 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:15:56.082 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:15:56.084 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:15:56.085 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:15:56.085 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 2.154ms
2025-08-01 00:15:56.085 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:15:56.085 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 5.3404ms
2025-08-01 00:17:05.565 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:17:05.565 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:05.565 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.6853ms
2025-08-01 00:17:05.567 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:17:05.567 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:05.570 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:05.570 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:17:05.571 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:17:05.576 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:17:05.581 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:17:05.581 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 10.2059ms
2025-08-01 00:17:05.582 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:17:05.582 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 14.9662ms
2025-08-01 00:17:05.585 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:17:05.586 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:05.586 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.8982ms
2025-08-01 00:17:05.588 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:17:05.588 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:05.591 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:05.591 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:17:05.591 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:17:05.592 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.8153ms
2025-08-01 00:17:05.627 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:17:05.627 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:05.630 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:05.630 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:17:05.630 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:17:05.631 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.8017ms
2025-08-01 00:17:05.652 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - null null
2025-08-01 00:17:05.653 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:05.653 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - 204 null null 0.5427ms
2025-08-01 00:17:05.654 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/stats - application/json null
2025-08-01 00:17:05.655 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:05.663 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:05.664 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:17:05.665 +08:00 [INF] Route matched with {action = "GetStudentStats", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStudentStats() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:17:05.704 +08:00 [INF] Executed DbCommand (33ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
WHERE e.student_id = @__userId_0
2025-08-01 00:17:05.705 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t.amount, t.course_id, t.created_at, t.currency, t.payment_intent_id, t.payment_method, t.processed_at, t.status, t.subscription_id, t.transaction_id, t.user_id
FROM transactions AS t
WHERE t.user_id = @__userId_0 AND t.status = 'Completed'
2025-08-01 00:17:05.705 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType56`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:05.706 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api) in 40.3534ms
2025-08-01 00:17:05.706 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:17:05.706 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/stats - 200 null application/json; charset=utf-8 51.6285ms
2025-08-01 00:17:05.708 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - null null
2025-08-01 00:17:05.708 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:05.708 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - 204 null null 0.3815ms
2025-08-01 00:17:05.710 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/courses - application/json null
2025-08-01 00:17:05.710 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:05.711 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:05.712 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:17:05.712 +08:00 [INF] Route matched with {action = "GetEnrolledCourses", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetEnrolledCourses() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:17:05.716 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s ON c.id = s.course_id
WHERE e.student_id = @__userId_0
ORDER BY COALESCE(e.last_accessed_date, e.enrolled_at) DESC, e.id, c.id, a."Id", s.id
2025-08-01 00:17:05.717 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType55`14[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:17:05.717 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api) in 4.9706ms
2025-08-01 00:17:05.717 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:17:05.718 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/courses - 200 null application/json; charset=utf-8 7.9849ms
2025-08-01 00:17:05.737 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - null null
2025-08-01 00:17:05.738 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:05.738 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - 204 null null 0.5224ms
2025-08-01 00:17:05.739 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - application/json null
2025-08-01 00:17:05.740 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:05.741 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:05.742 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - 404 0 null 2.5568ms
2025-08-01 00:17:05.742 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/subscriptions/current, Response status code: 404
2025-08-01 00:17:11.469 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/28 - null null
2025-08-01 00:17:11.469 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:11.470 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/28 - 204 null null 0.4174ms
2025-08-01 00:17:11.471 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/28 - application/json null
2025-08-01 00:17:11.471 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:11.475 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:11.476 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:17:11.476 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:17:11.480 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:17:11.482 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:17:11.482 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 5.779ms
2025-08-01 00:17:11.483 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:17:11.483 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/28 - 200 null application/json; charset=utf-8 12.0871ms
2025-08-01 00:17:11.488 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:17:11.489 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:11.489 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.4054ms
2025-08-01 00:17:11.490 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:17:11.490 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:11.492 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:11.493 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:17:11.493 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:17:11.496 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:17:11.496 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:17:11.497 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 4.1601ms
2025-08-01 00:17:11.497 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:17:11.497 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 7.828ms
2025-08-01 00:17:18.799 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:17:18.799 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:18.800 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.0582ms
2025-08-01 00:17:18.801 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:17:18.801 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:18.803 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:18.804 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:17:18.804 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:17:18.809 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:17:18.812 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:17:18.813 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.5471ms
2025-08-01 00:17:18.813 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:17:18.813 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 11.8837ms
2025-08-01 00:17:18.819 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:17:18.819 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:18.819 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.632ms
2025-08-01 00:17:18.821 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:17:18.821 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:18.823 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:18.823 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:17:18.823 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:17:18.823 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.5965ms
2025-08-01 00:17:18.855 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:17:18.855 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:18.857 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:18.857 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:17:18.857 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:17:18.858 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.5625ms
2025-08-01 00:17:18.863 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - null null
2025-08-01 00:17:18.863 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:18.863 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - 204 null null 0.3663ms
2025-08-01 00:17:18.866 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/stats - application/json null
2025-08-01 00:17:18.866 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:18.869 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:18.869 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:17:18.869 +08:00 [INF] Route matched with {action = "GetStudentStats", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStudentStats() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:17:18.870 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
WHERE e.student_id = @__userId_0
2025-08-01 00:17:18.871 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t.amount, t.course_id, t.created_at, t.currency, t.payment_intent_id, t.payment_method, t.processed_at, t.status, t.subscription_id, t.transaction_id, t.user_id
FROM transactions AS t
WHERE t.user_id = @__userId_0 AND t.status = 'Completed'
2025-08-01 00:17:18.871 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType56`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:18.872 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api) in 2.556ms
2025-08-01 00:17:18.872 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:17:18.872 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/stats - 200 null application/json; charset=utf-8 6.0681ms
2025-08-01 00:17:18.906 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - null null
2025-08-01 00:17:18.906 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:18.907 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - 204 null null 0.6818ms
2025-08-01 00:17:18.908 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/courses - application/json null
2025-08-01 00:17:18.908 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:18.910 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:18.910 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:17:18.910 +08:00 [INF] Route matched with {action = "GetEnrolledCourses", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetEnrolledCourses() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:17:18.915 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s ON c.id = s.course_id
WHERE e.student_id = @__userId_0
ORDER BY COALESCE(e.last_accessed_date, e.enrolled_at) DESC, e.id, c.id, a."Id", s.id
2025-08-01 00:17:18.916 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType55`14[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:17:18.917 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api) in 5.8336ms
2025-08-01 00:17:18.917 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:17:18.917 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/courses - 200 null application/json; charset=utf-8 9.2146ms
2025-08-01 00:17:18.940 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - null null
2025-08-01 00:17:18.940 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:18.940 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - 204 null null 0.3935ms
2025-08-01 00:17:18.941 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - application/json null
2025-08-01 00:17:18.942 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:18.943 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:18.944 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - 404 0 null 2.452ms
2025-08-01 00:17:18.944 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/subscriptions/current, Response status code: 404
2025-08-01 00:17:31.923 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/logout - null null
2025-08-01 00:17:31.923 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:31.923 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/logout - 204 null null 0.4016ms
2025-08-01 00:17:31.925 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/logout - application/json 0
2025-08-01 00:17:31.925 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:31.926 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:31.926 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-08-01 00:17:31.926 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-01 00:17:31.928 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-08-01 00:17:31.932 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET revoked_at = @p0
WHERE id = @p1;
UPDATE refresh_tokens SET revoked_at = @p2
WHERE id = @p3;
2025-08-01 00:17:31.933 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:31.933 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 6.3976ms
2025-08-01 00:17:31.933 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-08-01 00:17:31.933 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/logout - 200 null application/json; charset=utf-8 8.7059ms
2025-08-01 00:17:32.019 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:17:32.020 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:32.020 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.6885ms
2025-08-01 00:17:32.021 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:17:32.022 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:32.022 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:17:32.022 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:17:32.027 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:17:32.029 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:17:32.030 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.9563ms
2025-08-01 00:17:32.030 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:17:32.030 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 8.5204ms
2025-08-01 00:17:32.129 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:17:32.130 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:32.134 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 5.1896ms
2025-08-01 00:17:32.138 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:17:32.140 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:32.142 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:17:32.143 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-01 00:17:32.151 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 401 0 null 12.6424ms
2025-08-01 00:17:34.406 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - null null
2025-08-01 00:17:34.406 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:34.406 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - 204 null null 0.5503ms
2025-08-01 00:17:34.407 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/login - application/json 51
2025-08-01 00:17:34.408 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:34.408 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-01 00:17:34.408 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-01 00:17:34.411 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-08-01 00:17:34.523 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-08-01 00:17:34.524 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-08-01 00:17:34.524 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 115.6672ms
2025-08-01 00:17:34.524 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-01 00:17:34.525 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/login - 200 null application/json; charset=utf-8 117.1784ms
2025-08-01 00:17:34.560 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:17:34.560 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:17:34.560 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:34.560 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:34.560 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.513ms
2025-08-01 00:17:34.560 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.3239ms
2025-08-01 00:17:34.561 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:17:34.561 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:17:34.562 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:34.562 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:34.564 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:34.564 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:17:34.565 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:17:34.571 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:17:34.574 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:17:34.574 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.1448ms
2025-08-01 00:17:34.574 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:17:34.574 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 13.0224ms
2025-08-01 00:17:34.583 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:34.583 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:17:34.588 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:17:34.597 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-01 00:17:34.604 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-08-01 00:17:34.611 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-08-01 00:17:34.616 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-08-01 00:17:34.647 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-08-01 00:17:34.668 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-08-01 00:17:34.679 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-08-01 00:17:34.694 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-08-01 00:17:34.704 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-08-01 00:17:34.715 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-08-01 00:17:34.716 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:34.735 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 146.8949ms
2025-08-01 00:17:34.735 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:17:34.735 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 200 null application/json; charset=utf-8 173.9314ms
2025-08-01 00:17:36.412 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/profile - null null
2025-08-01 00:17:36.413 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:36.413 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/profile - 204 null null 1.1437ms
2025-08-01 00:17:36.414 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/profile - application/json null
2025-08-01 00:17:36.415 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:36.416 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:36.417 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/profile - 404 0 null 2.4876ms
2025-08-01 00:17:36.418 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/profile, Response status code: 404
2025-08-01 00:17:36.420 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51 - null null
2025-08-01 00:17:36.420 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:36.420 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51 - 204 null null 0.3501ms
2025-08-01 00:17:36.421 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51 - application/json null
2025-08-01 00:17:36.422 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:36.424 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:36.425 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-08-01 00:17:36.425 +08:00 [INF] Route matched with {action = "GetUser", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUser(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-08-01 00:17:36.427 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:17:36.428 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserDto'.
2025-08-01 00:17:36.428 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api) in 3.0307ms
2025-08-01 00:17:36.428 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUser (CeceLearningPortal.Api)'
2025-08-01 00:17:36.428 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51 - 200 null application/json; charset=utf-8 6.7574ms
2025-08-01 00:17:36.431 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/stats - null null
2025-08-01 00:17:36.431 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:36.431 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/stats - 204 null null 0.3983ms
2025-08-01 00:17:36.432 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/stats - application/json null
2025-08-01 00:17:36.432 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:36.435 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:36.435 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-08-01 00:17:36.435 +08:00 [INF] Route matched with {action = "GetUserStats", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserStats(System.String) on controller CeceLearningPortal.Api.Controllers.UsersController (CeceLearningPortal.Api).
2025-08-01 00:17:36.438 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s.id0, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s.id1, s.approved_at, s.approved_by, s.comment, s.course_id0, s.created_at0, s.is_flagged, s.rating, s.status0, s.student_id0
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, e.id AS id0, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c0.id AS id1, c0.approved_at, c0.approved_by, c0.comment, c0.course_id AS course_id0, c0.created_at AS created_at0, c0.is_flagged, c0.rating, c0.status AS status0, c0.student_id AS student_id0
    FROM courses AS c
    LEFT JOIN enrollments AS e ON c.id = e.course_id
    LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
) AS s ON a0."Id" = s.instructor_id
ORDER BY a0."Id", s.id, s.id0
2025-08-01 00:17:36.438 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.UserStatsDto'.
2025-08-01 00:17:36.439 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api) in 3.2631ms
2025-08-01 00:17:36.439 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.UsersController.GetUserStats (CeceLearningPortal.Api)'
2025-08-01 00:17:36.439 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/stats - 200 null application/json; charset=utf-8 6.916ms
2025-08-01 00:17:36.441 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/certificates - null null
2025-08-01 00:17:36.441 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:36.441 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/certificates - 204 null null 0.3732ms
2025-08-01 00:17:36.442 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/certificates - application/json null
2025-08-01 00:17:36.443 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:36.444 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:36.444 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/certificates - 404 0 null 2.0558ms
2025-08-01 00:17:36.445 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/certificates, Response status code: 404
2025-08-01 00:17:36.449 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/activity - null null
2025-08-01 00:17:36.450 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:36.450 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/activity - 204 null null 1.2407ms
2025-08-01 00:17:36.451 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/activity - application/json null
2025-08-01 00:17:36.452 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:36.455 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:36.475 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/activity - 404 0 null 23.9552ms
2025-08-01 00:17:36.476 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/718ad447-829b-4170-973a-87a1da659b51/activity, Response status code: 404
2025-08-01 00:17:36.495 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/stats - null null
2025-08-01 00:17:36.497 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:36.517 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/stats - 204 null null 21.1889ms
2025-08-01 00:17:36.518 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/stats - application/json null
2025-08-01 00:17:36.542 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:36.544 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:36.544 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetAdminStats (CeceLearningPortal.Api)'
2025-08-01 00:17:36.547 +08:00 [INF] Route matched with {action = "GetAdminStats", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAdminStats() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:36.552 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-01 00:17:36.561 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
WHERE date_trunc('day', a."CreatedAt", 'UTC') = date_trunc('day', now(), 'UTC')
2025-08-01 00:17:36.566 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
WHERE c.status = 'Active'
2025-08-01 00:17:36.570 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
WHERE c.status = 'Draft'
2025-08-01 00:17:36.571 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-08-01 00:17:36.575 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
WHERE a."LastLoginAt" > now() + INTERVAL '-30 mins'
2025-08-01 00:17:36.576 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType7`7[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType8`4[[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:17:36.580 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetAdminStats (CeceLearningPortal.Api) in 32.4064ms
2025-08-01 00:17:36.580 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetAdminStats (CeceLearningPortal.Api)'
2025-08-01 00:17:36.580 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/stats - 200 null application/json; charset=utf-8 62.381ms
2025-08-01 00:17:37.486 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:17:37.486 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:37.487 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:37.488 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:17:37.488 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:17:37.489 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-01 00:17:37.490 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-08-01 00:17:37.490 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-08-01 00:17:37.491 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-08-01 00:17:37.496 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-08-01 00:17:37.499 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-08-01 00:17:37.502 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-08-01 00:17:37.503 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-08-01 00:17:37.505 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-08-01 00:17:37.506 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-08-01 00:17:37.507 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:37.507 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 19.5746ms
2025-08-01 00:17:37.508 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:17:37.508 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 200 null application/json; charset=utf-8 22.1876ms
2025-08-01 00:17:37.510 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/course-completions - null null
2025-08-01 00:17:37.511 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:37.511 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/course-completions - 204 null null 0.5625ms
2025-08-01 00:17:37.512 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/course-completions - application/json null
2025-08-01 00:17:37.512 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:37.513 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:37.514 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-08-01 00:17:37.519 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:37.538 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-08-01 00:17:37.539 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:17:37.540 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 21.3191ms
2025-08-01 00:17:37.540 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-08-01 00:17:37.540 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/course-completions - 200 null application/json; charset=utf-8 28.8774ms
2025-08-01 00:17:39.191 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users - null null
2025-08-01 00:17:39.191 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/subscription-plans - null null
2025-08-01 00:17:39.191 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.192 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.192 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users - 204 null null 0.4868ms
2025-08-01 00:17:39.192 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/subscription-plans - 204 null null 0.5944ms
2025-08-01 00:17:39.202 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/subscription-plans - application/json null
2025-08-01 00:17:39.203 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users - application/json null
2025-08-01 00:17:39.203 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.203 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.204 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:39.204 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:39.205 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-08-01 00:17:39.205 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-08-01 00:17:39.214 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:39.217 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:39.227 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-01 00:17:39.234 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-08-01 00:17:39.236 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:17:39.247 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price, s0.id, s0.billing_cycle, s0.created_at, s0.end_date, s0.next_billing_date, s0.plan_name, s0.price, s0.start_date, s0.status, s0.stripe_subscription_id, s0.subscription_plan_id, s0.updated_at, s0.user_id
FROM subscription_plans AS s
LEFT JOIN subscriptions AS s0 ON s.id = s0.subscription_plan_id
ORDER BY s.id
2025-08-01 00:17:39.260 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 42.0743ms
2025-08-01 00:17:39.260 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-08-01 00:17:39.260 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users - 200 null application/json; charset=utf-8 57.51ms
2025-08-01 00:17:39.264 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - null null
2025-08-01 00:17:39.264 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.264 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - 204 null null 0.651ms
2025-08-01 00:17:39.264 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - null null
2025-08-01 00:17:39.267 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - null null
2025-08-01 00:17:39.267 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.267 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.267 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - 204 null null 2.6757ms
2025-08-01 00:17:39.267 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - null null
2025-08-01 00:17:39.267 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - null null
2025-08-01 00:17:39.267 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - 204 null null 0.4825ms
2025-08-01 00:17:39.267 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - null null
2025-08-01 00:17:39.268 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.268 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.268 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.268 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - 204 null null 1.2905ms
2025-08-01 00:17:39.268 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - application/json null
2025-08-01 00:17:39.268 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - 204 null null 1.3482ms
2025-08-01 00:17:39.269 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - 204 null null 1.3101ms
2025-08-01 00:17:39.269 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - null null
2025-08-01 00:17:39.269 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.270 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.270 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - 204 null null 1.4976ms
2025-08-01 00:17:39.270 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - null null
2025-08-01 00:17:39.271 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.271 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - 204 null null 0.437ms
2025-08-01 00:17:39.271 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - null null
2025-08-01 00:17:39.271 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - null null
2025-08-01 00:17:39.272 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.272 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.272 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - 204 null null 0.6222ms
2025-08-01 00:17:39.272 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - 204 null null 0.8819ms
2025-08-01 00:17:39.272 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:39.273 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.274 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - null null
2025-08-01 00:17:39.274 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.274 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - 204 null null 0.6522ms
2025-08-01 00:17:39.276 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - application/json null
2025-08-01 00:17:39.276 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - application/json null
2025-08-01 00:17:39.277 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - application/json null
2025-08-01 00:17:39.277 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.278 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.277 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - application/json null
2025-08-01 00:17:39.277 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.278 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.280 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:39.281 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.282 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:39.285 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:39.298 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:39.299 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.299 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:39.301 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:39.301 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:39.301 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.301 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.301 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:39.301 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:39.308 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:17:39.309 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:39.310 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:17:39.310 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:17:39.310 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:39.310 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:17:39.311 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:39.311 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:39.312 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 12.7579ms
2025-08-01 00:17:39.312 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 29.4318ms
2025-08-01 00:17:39.312 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 10.5469ms
2025-08-01 00:17:39.312 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 26.1168ms
2025-08-01 00:17:39.312 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.312 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.312 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - 200 null application/json; charset=utf-8 36.8613ms
2025-08-01 00:17:39.312 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.312 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.317 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - 200 null application/json; charset=utf-8 41.4016ms
2025-08-01 00:17:39.317 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - application/json null
2025-08-01 00:17:39.312 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - 200 null application/json; charset=utf-8 44.0339ms
2025-08-01 00:17:39.317 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - 200 null application/json; charset=utf-8 39.8403ms
2025-08-01 00:17:39.318 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.318 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - application/json null
2025-08-01 00:17:39.318 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - application/json null
2025-08-01 00:17:39.319 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - application/json null
2025-08-01 00:17:39.319 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.319 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.319 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.321 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:39.321 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.322 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:39.322 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:39.322 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:39.322 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:39.322 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.322 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.322 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:39.322 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.323 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:39.323 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:39.323 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:17:39.325 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:17:39.325 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:17:39.325 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:17:39.325 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:39.325 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:39.325 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:17:39.325 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:39.325 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 2.6133ms
2025-08-01 00:17:39.326 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 3.779ms
2025-08-01 00:17:39.326 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:39.326 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 2.6067ms
2025-08-01 00:17:39.326 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.326 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.327 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - 200 null application/json; charset=utf-8 8.505ms
2025-08-01 00:17:39.327 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.327 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 3.1062ms
2025-08-01 00:17:39.327 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - 200 null application/json; charset=utf-8 9.9512ms
2025-08-01 00:17:39.328 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - 200 null application/json; charset=utf-8 9.209ms
2025-08-01 00:17:39.328 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.329 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - application/json null
2025-08-01 00:17:39.329 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - 200 null application/json; charset=utf-8 10.6579ms
2025-08-01 00:17:39.329 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - application/json null
2025-08-01 00:17:39.329 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.330 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:17:39.332 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:39.332 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:17:39.333 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.333 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.333 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:39.333 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:17:39.335 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:17:39.335 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:17:39.336 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:39.336 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:17:39.336 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:39.336 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 2.486ms
2025-08-01 00:17:39.336 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 2.5761ms
2025-08-01 00:17:39.336 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:17:39.336 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.336 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.337 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 35.2631ms
2025-08-01 00:17:39.337 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:17:39.337 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - 200 null application/json; charset=utf-8 8.0431ms
2025-08-01 00:17:39.337 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - 200 null application/json; charset=utf-8 8.0607ms
2025-08-01 00:17:39.337 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - 200 null application/json; charset=utf-8 59.4858ms
2025-08-01 00:17:39.341 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 126.3507ms
2025-08-01 00:17:39.341 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-08-01 00:17:39.341 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/subscription-plans - 200 null application/json; charset=utf-8 138.5646ms
2025-08-01 00:18:15.715 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:18:15.715 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.716 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.381ms
2025-08-01 00:18:15.716 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:18:15.717 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.718 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.719 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:18:15.719 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.723 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:18:15.726 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:18:15.726 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.7018ms
2025-08-01 00:18:15.726 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:18:15.726 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 9.6904ms
2025-08-01 00:18:15.731 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/28 - null null
2025-08-01 00:18:15.732 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.732 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/28 - 204 null null 0.8083ms
2025-08-01 00:18:15.732 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/25 - null null
2025-08-01 00:18:15.733 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.733 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:18:15.733 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/25 - 204 null null 0.8776ms
2025-08-01 00:18:15.733 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.733 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.5737ms
2025-08-01 00:18:15.733 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/27 - null null
2025-08-01 00:18:15.734 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.734 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/27 - 204 null null 0.3287ms
2025-08-01 00:18:15.734 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/24 - null null
2025-08-01 00:18:15.734 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.734 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/24 - 204 null null 0.3357ms
2025-08-01 00:18:15.736 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/20 - null null
2025-08-01 00:18:15.736 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.738 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/20 - 204 null null 2.0949ms
2025-08-01 00:18:15.739 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/29 - null null
2025-08-01 00:18:15.740 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.740 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/29 - 204 null null 0.3413ms
2025-08-01 00:18:15.740 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/28 - application/json null
2025-08-01 00:18:15.740 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/26 - null null
2025-08-01 00:18:15.741 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.741 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.741 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/26 - 204 null null 0.5322ms
2025-08-01 00:18:15.741 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/23 - null null
2025-08-01 00:18:15.741 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/19 - null null
2025-08-01 00:18:15.741 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.742 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.742 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/23 - 204 null null 0.6331ms
2025-08-01 00:18:15.742 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/19 - 204 null null 0.592ms
2025-08-01 00:18:15.742 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/25 - application/json null
2025-08-01 00:18:15.743 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.743 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.743 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/22 - null null
2025-08-01 00:18:15.743 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.743 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.743 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.744 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/22 - 204 null null 0.6287ms
2025-08-01 00:18:15.745 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/18 - null null
2025-08-01 00:18:15.745 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:18:15.745 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/17 - null null
2025-08-01 00:18:15.746 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.746 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.746 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.746 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/18 - 204 null null 0.9627ms
2025-08-01 00:18:15.746 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.746 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/17 - 204 null null 0.588ms
2025-08-01 00:18:15.747 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.747 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/31 - null null
2025-08-01 00:18:15.747 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.747 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.747 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/31 - 204 null null 0.6513ms
2025-08-01 00:18:15.750 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/30 - null null
2025-08-01 00:18:15.750 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/27 - application/json null
2025-08-01 00:18:15.751 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/32 - null null
2025-08-01 00:18:15.751 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.751 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.751 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.751 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/32 - 204 null null 0.6464ms
2025-08-01 00:18:15.751 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/30 - 204 null null 1.0144ms
2025-08-01 00:18:15.751 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.752 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.752 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.755 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/20 - application/json null
2025-08-01 00:18:15.755 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/24 - application/json null
2025-08-01 00:18:15.755 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.755 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.756 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.756 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.756 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.757 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.757 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.757 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.757 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.757 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.757 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.761 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.763 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.763 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 6.5559ms
2025-08-01 00:18:15.763 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.763 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/27 - 200 null application/json; charset=utf-8 13.2544ms
2025-08-01 00:18:15.765 +08:00 [INF] Executed DbCommand (19ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.765 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/29 - application/json null
2025-08-01 00:18:15.766 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.767 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.767 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 23.596ms
2025-08-01 00:18:15.768 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.768 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/28 - 200 null application/json; charset=utf-8 27.426ms
2025-08-01 00:18:15.769 +08:00 [INF] Executed DbCommand (20ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.769 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.772 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.772 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.772 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/26 - application/json null
2025-08-01 00:18:15.774 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.774 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.774 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.774 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 26.3236ms
2025-08-01 00:18:15.774 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.774 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.775 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 16.9812ms
2025-08-01 00:18:15.775 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/25 - 200 null application/json; charset=utf-8 32.9646ms
2025-08-01 00:18:15.775 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.775 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/20 - 200 null application/json; charset=utf-8 20.804ms
2025-08-01 00:18:15.776 +08:00 [INF] Executed DbCommand (21ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.776 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.777 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/23 - application/json null
2025-08-01 00:18:15.777 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/19 - application/json null
2025-08-01 00:18:15.777 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.778 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.777 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.777 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.778 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.778 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 25.6156ms
2025-08-01 00:18:15.779 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.779 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 34.2006ms
2025-08-01 00:18:15.780 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.780 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.780 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.780 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.780 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.780 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/22 - application/json null
2025-08-01 00:18:15.780 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.781 +08:00 [INF] Executed DbCommand (22ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.781 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.781 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.782 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.784 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.786 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 28.5673ms
2025-08-01 00:18:15.787 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 12.2281ms
2025-08-01 00:18:15.787 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.788 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.788 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/29 - 200 null application/json; charset=utf-8 23.2623ms
2025-08-01 00:18:15.788 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/24 - 200 null application/json; charset=utf-8 33.1535ms
2025-08-01 00:18:15.788 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.790 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/17 - application/json null
2025-08-01 00:18:15.790 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/18 - application/json null
2025-08-01 00:18:15.791 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.791 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.791 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.791 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.791 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.791 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 12.5248ms
2025-08-01 00:18:15.792 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.792 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.792 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.792 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.793 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.794 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/26 - 200 null application/json; charset=utf-8 21.0768ms
2025-08-01 00:18:15.793 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.795 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/31 - application/json null
2025-08-01 00:18:15.794 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 12.8342ms
2025-08-01 00:18:15.794 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.793 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.796 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 15.1268ms
2025-08-01 00:18:15.796 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.795 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.795 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.795 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.796 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.796 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/19 - 200 null application/json; charset=utf-8 19.3204ms
2025-08-01 00:18:15.796 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.796 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.796 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/23 - 200 null application/json; charset=utf-8 19.6791ms
2025-08-01 00:18:15.798 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/30 - application/json null
2025-08-01 00:18:15.798 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/32 - application/json null
2025-08-01 00:18:15.798 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.799 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:15.800 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.801 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.801 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.801 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.801 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.801 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:15.802 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.802 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.803 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.804 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.804 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:18:15.804 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 12.6181ms
2025-08-01 00:18:15.805 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.805 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/22 - 200 null application/json; charset=utf-8 24.7146ms
2025-08-01 00:18:15.808 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.808 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.810 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.810 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 13.4865ms
2025-08-01 00:18:15.810 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.811 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.811 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 13.6076ms
2025-08-01 00:18:15.811 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/18 - 200 null application/json; charset=utf-8 20.5997ms
2025-08-01 00:18:15.811 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.811 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.811 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.811 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:18:15.812 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.812 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/17 - 200 null application/json; charset=utf-8 22.253ms
2025-08-01 00:18:15.812 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.813 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 9.156ms
2025-08-01 00:18:15.813 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 12.5038ms
2025-08-01 00:18:15.813 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:18:15.814 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.814 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.814 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 9.4385ms
2025-08-01 00:18:15.814 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/30 - 200 null application/json; charset=utf-8 16.4005ms
2025-08-01 00:18:15.814 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/31 - 200 null application/json; charset=utf-8 18.9418ms
2025-08-01 00:18:15.815 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:18:15.817 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/32 - 200 null application/json; charset=utf-8 19.5144ms
2025-08-01 00:18:16.777 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/subscription-plans - null null
2025-08-01 00:18:16.777 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:16.778 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/subscription-plans - 204 null null 0.3739ms
2025-08-01 00:18:16.778 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/subscription-plans - application/json null
2025-08-01 00:18:16.779 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:16.781 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:16.781 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-08-01 00:18:16.781 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:16.783 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price, s0.id, s0.billing_cycle, s0.created_at, s0.end_date, s0.next_billing_date, s0.plan_name, s0.price, s0.start_date, s0.status, s0.stripe_subscription_id, s0.subscription_plan_id, s0.updated_at, s0.user_id
FROM subscription_plans AS s
LEFT JOIN subscriptions AS s0 ON s.id = s0.subscription_plan_id
ORDER BY s.id
2025-08-01 00:18:16.784 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:18:16.784 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 3.0628ms
2025-08-01 00:18:16.784 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-08-01 00:18:16.785 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/subscription-plans - 200 null application/json; charset=utf-8 6.0145ms
2025-08-01 00:18:27.924 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/subscription-plans - null null
2025-08-01 00:18:27.924 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:27.924 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/subscription-plans - 204 null null 0.336ms
2025-08-01 00:18:27.926 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/subscription-plans - application/json null
2025-08-01 00:18:27.926 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:27.927 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:27.928 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-08-01 00:18:27.928 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:27.930 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price, s0.id, s0.billing_cycle, s0.created_at, s0.end_date, s0.next_billing_date, s0.plan_name, s0.price, s0.start_date, s0.status, s0.stripe_subscription_id, s0.subscription_plan_id, s0.updated_at, s0.user_id
FROM subscription_plans AS s
LEFT JOIN subscriptions AS s0 ON s.id = s0.subscription_plan_id
ORDER BY s.id
2025-08-01 00:18:27.931 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:18:27.931 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 2.9376ms
2025-08-01 00:18:27.931 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-08-01 00:18:27.931 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/subscription-plans - 200 null application/json; charset=utf-8 5.4053ms
2025-08-01 00:18:32.527 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:18:32.527 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:32.527 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.3629ms
2025-08-01 00:18:32.528 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:18:32.528 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:32.530 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:32.530 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:18:32.530 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:18:32.532 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-01 00:18:32.533 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-08-01 00:18:32.534 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-08-01 00:18:32.535 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-08-01 00:18:32.539 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-08-01 00:18:32.541 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-08-01 00:18:32.544 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-08-01 00:18:32.547 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-08-01 00:18:32.549 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-08-01 00:18:32.550 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-08-01 00:18:32.551 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:18:32.551 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 20.8256ms
2025-08-01 00:18:32.551 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:18:32.552 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 200 null application/json; charset=utf-8 23.595ms
2025-08-01 00:18:32.555 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/course-completions - null null
2025-08-01 00:18:32.555 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:32.555 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/course-completions - 204 null null 0.6848ms
2025-08-01 00:18:32.557 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/course-completions - application/json null
2025-08-01 00:18:32.557 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:32.559 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:32.559 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-08-01 00:18:32.559 +08:00 [INF] Route matched with {action = "GetCourseCompletions", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseCompletions(Int32) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:32.562 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e0.id, a."FullName", a."Avatar", a."Email", c.title, e0.course_id::text, e0.completed_at, COALESCE(e0.average_quiz_score, 0.0), e0.certificate_issued, e0.certificate_url
FROM (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.course_id, e.student_id
    FROM enrollments AS e
    WHERE e.completed_at IS NOT NULL
    ORDER BY e.completed_at DESC
    LIMIT @__p_0
) AS e0
INNER JOIN "AspNetUsers" AS a ON e0.student_id = a."Id"
INNER JOIN courses AS c ON e0.course_id = c.id
ORDER BY e0.completed_at DESC
2025-08-01 00:18:32.562 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`10[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:18:32.563 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api) in 3.2455ms
2025-08-01 00:18:32.563 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetCourseCompletions (CeceLearningPortal.Api)'
2025-08-01 00:18:32.563 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/course-completions - 200 null application/json; charset=utf-8 6.6081ms
2025-08-01 00:18:35.696 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users - null null
2025-08-01 00:18:35.696 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/subscription-plans - null null
2025-08-01 00:18:35.696 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.696 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.696 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users - 204 null null 0.569ms
2025-08-01 00:18:35.696 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/subscription-plans - 204 null null 0.6279ms
2025-08-01 00:18:35.698 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users - application/json null
2025-08-01 00:18:35.698 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/subscription-plans - application/json null
2025-08-01 00:18:35.698 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.698 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.700 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:35.700 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:35.700 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-08-01 00:18:35.700 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-08-01 00:18:35.701 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:35.701 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:35.702 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-01 00:18:35.702 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price, s0.id, s0.billing_cycle, s0.created_at, s0.end_date, s0.next_billing_date, s0.plan_name, s0.price, s0.start_date, s0.status, s0.stripe_subscription_id, s0.subscription_plan_id, s0.updated_at, s0.user_id
FROM subscription_plans AS s
LEFT JOIN subscriptions AS s0 ON s.id = s0.subscription_plan_id
ORDER BY s.id
2025-08-01 00:18:35.703 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:18:35.703 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-08-01 00:18:35.704 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 2.6808ms
2025-08-01 00:18:35.704 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-08-01 00:18:35.704 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:18:35.704 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/subscription-plans - 200 null application/json; charset=utf-8 6.2503ms
2025-08-01 00:18:35.704 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 3.5162ms
2025-08-01 00:18:35.705 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-08-01 00:18:35.705 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users - 200 null application/json; charset=utf-8 7.5822ms
2025-08-01 00:18:35.708 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - null null
2025-08-01 00:18:35.708 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.708 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - null null
2025-08-01 00:18:35.708 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - 204 null null 0.4351ms
2025-08-01 00:18:35.708 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - null null
2025-08-01 00:18:35.709 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.709 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.709 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - 204 null null 0.7666ms
2025-08-01 00:18:35.709 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - null null
2025-08-01 00:18:35.709 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - 204 null null 0.6105ms
2025-08-01 00:18:35.709 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - null null
2025-08-01 00:18:35.709 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.710 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.710 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - 204 null null 1.0843ms
2025-08-01 00:18:35.710 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - 204 null null 0.6244ms
2025-08-01 00:18:35.710 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - null null
2025-08-01 00:18:35.711 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.711 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - 204 null null 0.7381ms
2025-08-01 00:18:35.712 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - null null
2025-08-01 00:18:35.712 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.712 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - 204 null null 0.4212ms
2025-08-01 00:18:35.713 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - application/json null
2025-08-01 00:18:35.713 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - null null
2025-08-01 00:18:35.713 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.713 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.713 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - null null
2025-08-01 00:18:35.713 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - 204 null null 0.6027ms
2025-08-01 00:18:35.714 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.714 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - 204 null null 0.6935ms
2025-08-01 00:18:35.714 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - null null
2025-08-01 00:18:35.715 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.715 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - 204 null null 0.748ms
2025-08-01 00:18:35.715 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - null null
2025-08-01 00:18:35.715 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:35.716 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.716 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.716 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - 204 null null 0.7501ms
2025-08-01 00:18:35.716 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:35.717 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - application/json null
2025-08-01 00:18:35.717 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.717 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - application/json null
2025-08-01 00:18:35.718 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.718 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - application/json null
2025-08-01 00:18:35.718 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - application/json null
2025-08-01 00:18:35.718 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - application/json null
2025-08-01 00:18:35.718 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.719 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.719 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.719 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:35.719 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:35.719 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:18:35.719 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.719 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.720 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:18:35.721 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:35.721 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:35.721 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.4117ms
2025-08-01 00:18:35.722 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.723 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:35.723 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/76ea62e5-6edd-486d-9d56-88a15c6afe35/subscription - 200 null application/json; charset=utf-8 10.0312ms
2025-08-01 00:18:35.723 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.723 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:35.724 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:35.724 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:35.724 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - application/json null
2025-08-01 00:18:35.724 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.724 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.725 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.725 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:35.725 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:35.725 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:18:35.725 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:18:35.726 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:18:35.727 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:18:35.727 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.7257ms
2025-08-01 00:18:35.727 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 5.2198ms
2025-08-01 00:18:35.727 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.727 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:35.727 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:18:35.727 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:18:35.727 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:18:35.728 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.730 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:18:35.728 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/d36872cc-db57-4b86-bd3a-3909b0add07c/subscription - 200 null application/json; charset=utf-8 11.024ms
2025-08-01 00:18:35.729 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.729 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:18:35.731 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:35.730 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/a5dba4a2-d846-4a95-82f1-b9f091105e9c/subscription - 200 null application/json; charset=utf-8 13.0956ms
2025-08-01 00:18:35.730 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 5.8706ms
2025-08-01 00:18:35.731 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - application/json null
2025-08-01 00:18:35.730 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:18:35.732 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.731 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 5.9196ms
2025-08-01 00:18:35.732 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - application/json null
2025-08-01 00:18:35.732 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.732 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 7.3681ms
2025-08-01 00:18:35.733 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.733 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.734 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/487ad21a-a9df-4213-b283-02743691de26/subscription - 200 null application/json; charset=utf-8 15.2906ms
2025-08-01 00:18:35.734 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.735 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/bee889a2-efca-471d-807c-a7674a945612/subscription - 200 null application/json; charset=utf-8 16.4975ms
2025-08-01 00:18:35.735 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - application/json null
2025-08-01 00:18:35.734 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/718ad447-829b-4170-973a-87a1da659b51/subscription - 200 null application/json; charset=utf-8 15.6538ms
2025-08-01 00:18:35.735 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.736 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - application/json null
2025-08-01 00:18:35.736 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:18:35.737 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:18:35.736 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:35.738 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:35.738 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 6.3344ms
2025-08-01 00:18:35.736 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:35.738 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.739 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.739 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:35.738 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.739 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:35.739 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/344cd19a-f718-4633-97cc-d97c5abfbb59/subscription - 200 null application/json; charset=utf-8 15.4325ms
2025-08-01 00:18:35.740 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:35.740 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.740 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:35.741 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:35.741 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.742 +08:00 [INF] Route matched with {action = "GetUserSubscription", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUserSubscription(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:35.742 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:18:35.742 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:18:35.742 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:18:35.743 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:18:35.743 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:18:35.743 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 4.245ms
2025-08-01 00:18:35.743 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:18:35.743 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 3.8086ms
2025-08-01 00:18:35.743 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.743 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 3.0025ms
2025-08-01 00:18:35.744 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.744 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/8bf0f167-d003-46e4-9f15-936b4d1e9de3/subscription - 200 null application/json; charset=utf-8 12.0279ms
2025-08-01 00:18:35.744 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.744 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.billing_cycle, s.created_at, s.end_date, s.next_billing_date, s.plan_name, s.price, s.start_date, s.status, s.stripe_subscription_id, s.subscription_plan_id, s.updated_at, s.user_id, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM subscriptions AS s
INNER JOIN "AspNetUsers" AS a ON s.user_id = a."Id"
WHERE s.user_id = @__userId_0 AND s.status = 'Active'
ORDER BY s.created_at DESC
LIMIT 1
2025-08-01 00:18:35.744 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/a09e41e8-d894-484f-ba01-4b0eae749b75/subscription - 200 null application/json; charset=utf-8 13.3167ms
2025-08-01 00:18:35.744 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/cf22237a-5df9-40db-83ad-878d2ee157a0/subscription - 200 null application/json; charset=utf-8 9.5439ms
2025-08-01 00:18:35.745 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType93`1[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:18:35.745 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api) in 3.6256ms
2025-08-01 00:18:35.746 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUserSubscription (CeceLearningPortal.Api)'
2025-08-01 00:18:35.746 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users/7a5fc61f-d006-4ad3-b2c8-944101b5053f/subscription - 200 null application/json; charset=utf-8 10.4028ms
2025-08-01 00:18:36.737 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/subscription-plans - application/json null
2025-08-01 00:18:36.738 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:36.740 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:36.740 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-08-01 00:18:36.740 +08:00 [INF] Route matched with {action = "GetSubscriptionPlans", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSubscriptionPlans() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:36.742 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s.created_at, s.description, s.display_order, s.features, s.has_analytics, s.has_priority_support, s.has_unlimited_access, s.is_active, s.is_recommended, s.max_course_access, s.max_courses_can_create, s.max_students_per_course, s.monthly_price, s.name, s.plan_type, s.transaction_fee_percentage, s.updated_at, s.yearly_price, s0.id, s0.billing_cycle, s0.created_at, s0.end_date, s0.next_billing_date, s0.plan_name, s0.price, s0.start_date, s0.status, s0.stripe_subscription_id, s0.subscription_plan_id, s0.updated_at, s0.user_id
FROM subscription_plans AS s
LEFT JOIN subscriptions AS s0 ON s.id = s0.subscription_plan_id
ORDER BY s.id
2025-08-01 00:18:36.743 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.SubscriptionPlanDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:18:36.743 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api) in 2.5947ms
2025-08-01 00:18:36.743 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetSubscriptionPlans (CeceLearningPortal.Api)'
2025-08-01 00:18:36.744 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/subscription-plans - 200 null application/json; charset=utf-8 6.6129ms
2025-08-01 00:18:45.193 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/policies - null null
2025-08-01 00:18:45.193 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:45.193 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/policies - 204 null null 0.3533ms
2025-08-01 00:18:45.194 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/policies - application/json null
2025-08-01 00:18:45.195 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:45.196 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:45.196 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetPolicies (CeceLearningPortal.Api)'
2025-08-01 00:18:45.201 +08:00 [INF] Route matched with {action = "GetPolicies", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPolicies() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:45.203 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Object[]'.
2025-08-01 00:18:45.209 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetPolicies (CeceLearningPortal.Api) in 7.5968ms
2025-08-01 00:18:45.209 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetPolicies (CeceLearningPortal.Api)'
2025-08-01 00:18:45.209 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/policies - 200 null application/json; charset=utf-8 14.6931ms
2025-08-01 00:18:46.008 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/tasks - null null
2025-08-01 00:18:46.009 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:46.009 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/tasks - 204 null null 0.3613ms
2025-08-01 00:18:46.010 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/tasks - application/json null
2025-08-01 00:18:46.010 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:46.011 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:46.012 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetTasks (CeceLearningPortal.Api)'
2025-08-01 00:18:46.016 +08:00 [INF] Route matched with {action = "GetTasks", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTasks(System.String) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:46.020 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Object[]'.
2025-08-01 00:18:46.025 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetTasks (CeceLearningPortal.Api) in 8.5636ms
2025-08-01 00:18:46.026 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetTasks (CeceLearningPortal.Api)'
2025-08-01 00:18:46.026 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/tasks - 200 null application/json; charset=utf-8 16.0817ms
2025-08-01 00:18:48.268 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/onboarding-progress - null null
2025-08-01 00:18:48.268 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:48.268 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/onboarding-progress - 204 null null 0.3759ms
2025-08-01 00:18:48.269 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/onboarding-progress - application/json null
2025-08-01 00:18:48.270 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:48.271 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:48.272 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetOnboardingProgress (CeceLearningPortal.Api)'
2025-08-01 00:18:48.276 +08:00 [INF] Route matched with {action = "GetOnboardingProgress", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetOnboardingProgress() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:48.282 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-01 00:18:48.287 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
WHERE a."FullName" <> ''
2025-08-01 00:18:48.292 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
WHERE EXISTS (
    SELECT 1
    FROM enrollments AS e
    WHERE a."Id" = e.student_id)
2025-08-01 00:18:48.297 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
WHERE EXISTS (
    SELECT 1
    FROM enrollments AS e
    WHERE a."Id" = e.student_id AND e.certificate_issued)
2025-08-01 00:18:48.298 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`4[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]][]'.
2025-08-01 00:18:48.300 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetOnboardingProgress (CeceLearningPortal.Api) in 24.1449ms
2025-08-01 00:18:48.300 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetOnboardingProgress (CeceLearningPortal.Api)'
2025-08-01 00:18:48.300 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/onboarding-progress - 200 null application/json; charset=utf-8 31.1129ms
2025-08-01 00:18:49.029 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/team-members - null null
2025-08-01 00:18:49.029 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:49.029 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/team-members - 204 null null 0.3933ms
2025-08-01 00:18:49.030 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/team-members - application/json null
2025-08-01 00:18:49.030 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:18:49.032 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:18:49.033 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetTeamMembers (CeceLearningPortal.Api)'
2025-08-01 00:18:49.037 +08:00 [INF] Route matched with {action = "GetTeamMembers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetTeamMembers() on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:18:49.064 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."FullName", a."Email", CASE
    WHEN a."LastLoginAt" > now() + INTERVAL '-30 mins' THEN 'Online'
    WHEN a."LastLoginAt" > now() + INTERVAL '-1 hours' THEN 'Away'
    ELSE 'Offline'
END, COALESCE(a."LastLoginAt", a."CreatedAt"), a."Avatar"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Admin'
2025-08-01 00:18:49.066 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType17`10[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String[], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:18:49.069 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetTeamMembers (CeceLearningPortal.Api) in 31.9874ms
2025-08-01 00:18:49.069 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetTeamMembers (CeceLearningPortal.Api)'
2025-08-01 00:18:49.070 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/team-members - 200 null application/json; charset=utf-8 39.6375ms
2025-08-01 00:19:05.874 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users - null null
2025-08-01 00:19:05.875 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:05.875 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/admin/users - 204 null null 1.0616ms
2025-08-01 00:19:05.877 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/admin/users - application/json null
2025-08-01 00:19:05.877 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:05.879 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:05.880 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-08-01 00:19:05.880 +08:00 [INF] Route matched with {action = "GetUsers", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsers(CeceLearningPortal.Api.DTOs.UserManagementFilterDto) on controller CeceLearningPortal.Api.Controllers.AdminController (CeceLearningPortal.Api).
2025-08-01 00:19:05.883 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-01 00:19:05.884 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."UserName", a."Email", a."FullName", a."Role", a."Status", a."CreatedAt", a."LastLoginAt", a."EmailConfirmed"
FROM "AspNetUsers" AS a
ORDER BY a."CreatedAt" DESC
LIMIT @__p_1 OFFSET @__p_0
2025-08-01 00:19:05.885 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.UserManagementDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:05.886 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api) in 5.9467ms
2025-08-01 00:19:05.887 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AdminController.GetUsers (CeceLearningPortal.Api)'
2025-08-01 00:19:05.887 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/admin/users - 200 null application/json; charset=utf-8 10.1624ms
2025-08-01 00:19:05.889 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:19:05.890 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:05.890 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.4005ms
2025-08-01 00:19:05.892 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:19:05.893 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:05.895 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:05.895 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:05.895 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:19:05.901 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:19:05.903 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:05.904 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.9411ms
2025-08-01 00:19:05.904 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:05.904 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 11.6378ms
2025-08-01 00:19:05.908 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:19:05.908 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:05.908 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.5667ms
2025-08-01 00:19:05.910 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:19:05.910 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:05.913 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:05.914 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:19:05.914 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:19:05.916 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-01 00:19:05.918 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-08-01 00:19:05.919 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-08-01 00:19:05.921 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-08-01 00:19:05.924 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-08-01 00:19:05.929 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-08-01 00:19:05.933 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-08-01 00:19:05.934 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-08-01 00:19:05.935 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-08-01 00:19:05.936 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-08-01 00:19:05.936 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:19:05.937 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 22.3175ms
2025-08-01 00:19:05.937 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:19:05.937 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 200 null application/json; charset=utf-8 26.9576ms
2025-08-01 00:19:05.957 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:19:05.957 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:05.959 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:05.959 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:19:05.959 +08:00 [INF] Route matched with {action = "GetPlatformAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetPlatformAnalytics() on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:19:05.962 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "AspNetUsers" AS a
2025-08-01 00:19:05.964 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM courses AS c
2025-08-01 00:19:05.967 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.status = 'Completed'
2025-08-01 00:19:05.974 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
2025-08-01 00:19:06.005 +08:00 [INF] Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id" AS "instructorId", a."FullName" AS "instructorName", (
    SELECT count(*)::int
    FROM courses AS c0
    WHERE c0.instructor_id = a."Id") AS "totalCourses", (
    SELECT count(*)::int
    FROM enrollments AS e
    INNER JOIN courses AS c1 ON e.course_id = c1.id
    WHERE c1.instructor_id = a."Id") AS "totalStudents", (
    SELECT COALESCE(sum(t0.amount), 0.0)
    FROM transactions AS t0
    LEFT JOIN courses AS c2 ON t0.course_id = c2.id
    WHERE c2.instructor_id = a."Id" AND t0.status = 'Completed') AS "totalRevenue", COALESCE((
    SELECT avg(c3.rating::double precision)
    FROM course_reviews AS c3
    INNER JOIN courses AS c4 ON c3.course_id = c4.id
    WHERE c4.instructor_id = a."Id"), 0.0) AS "averageRating"
FROM "AspNetUsers" AS a
WHERE a."Role" = 'Instructor'
ORDER BY (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = a."Id" AND t.status = 'Completed') DESC
LIMIT @__p_0
2025-08-01 00:19:06.009 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.category, count(*)::int AS "courseCount", COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int AS "enrollmentCount", (
    SELECT COALESCE(sum(t.amount), 0.0)
    FROM transactions AS t
    LEFT JOIN courses AS c0 ON t.course_id = c0.id
    WHERE c0.category = c.category AND t.status = 'Completed') AS revenue
FROM courses AS c
GROUP BY c.category
ORDER BY COALESCE(sum((
    SELECT count(*)::int
    FROM enrollments AS e
    WHERE c.id = e.course_id)), 0)::int DESC
2025-08-01 00:19:06.020 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Year", t0."Month", COALESCE(sum(t0.amount), 0.0) AS "Revenue", count(*)::int AS "TransactionCount"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    WHERE t.status = 'Completed' AND t.created_at >= @__sixMonthsAgo_0
) AS t0
GROUP BY t0."Year", t0."Month"
2025-08-01 00:19:06.022 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sixMonthsAgo_0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Year", a0."Month", count(*)::int AS "NewUsers"
FROM (
    SELECT date_part('year', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Year", date_part('month', a."CreatedAt" AT TIME ZONE 'UTC')::int AS "Month"
    FROM "AspNetUsers" AS a
    WHERE a."CreatedAt" >= @__sixMonthsAgo_0
) AS a0
GROUP BY a0."Year", a0."Month"
2025-08-01 00:19:06.023 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM subscriptions AS s
WHERE s.status = 'Active'
2025-08-01 00:19:06.025 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT s.plan_name AS plan, count(*)::int AS count, COALESCE(sum(s.price), 0.0) AS "monthlyRevenue"
FROM subscriptions AS s
WHERE s.status = 'Active'
GROUP BY s.plan_name
2025-08-01 00:19:06.027 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType20`6[[<>f__AnonymousType21`5[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:19:06.028 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api) in 67.8215ms
2025-08-01 00:19:06.028 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetPlatformAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:19:06.028 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 200 null application/json; charset=utf-8 71.4698ms
2025-08-01 00:19:06.051 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - null null
2025-08-01 00:19:06.051 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:19:06.051 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:06.051 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:06.051 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 204 null null 0.8736ms
2025-08-01 00:19:06.052 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.5411ms
2025-08-01 00:19:06.052 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - null null
2025-08-01 00:19:06.052 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - null null
2025-08-01 00:19:06.052 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - null null
2025-08-01 00:19:06.053 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:06.053 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:06.053 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 204 null null 1.3738ms
2025-08-01 00:19:06.053 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:06.053 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 204 null null 1.1238ms
2025-08-01 00:19:06.054 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 204 null null 1.224ms
2025-08-01 00:19:06.058 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:19:06.059 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:06.060 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - application/json null
2025-08-01 00:19:06.060 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - application/json null
2025-08-01 00:19:06.060 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - application/json null
2025-08-01 00:19:06.060 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:06.061 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:06.061 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:06.060 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - application/json null
2025-08-01 00:19:06.061 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:06.061 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:06.062 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:06.062 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:19:06.062 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:06.062 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:06.062 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:06.063 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:06.063 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:06.063 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:19:06.063 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:06.063 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:06.063 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:19:06.064 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:06.064 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:19:06.064 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:19:06.069 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:19:06.069 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:19:06.069 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:19:06.069 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:19:06.071 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:19:06.073 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:06.073 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:06.073 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:06.073 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 11.2991ms
2025-08-01 00:19:06.074 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.7343ms
2025-08-01 00:19:06.074 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:06.074 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:06.074 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 10.4904ms
2025-08-01 00:19:06.074 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 16.247ms
2025-08-01 00:19:06.074 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:06.074 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:06.074 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.9851ms
2025-08-01 00:19:06.075 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=487ad21a-a9df-4213-b283-02743691de26 - 200 null application/json; charset=utf-8 14.6776ms
2025-08-01 00:19:06.075 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=a09e41e8-d894-484f-ba01-4b0eae749b75 - 200 null application/json; charset=utf-8 15.1016ms
2025-08-01 00:19:06.076 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:06.076 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:06.077 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=a5dba4a2-d846-4a95-82f1-b9f091105e9c - 200 null application/json; charset=utf-8 16.7821ms
2025-08-01 00:19:06.078 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 13.4757ms
2025-08-01 00:19:06.078 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:06.078 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=76ea62e5-6edd-486d-9d56-88a15c6afe35 - 200 null application/json; charset=utf-8 18.1967ms
2025-08-01 00:19:08.291 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/logout - null null
2025-08-01 00:19:08.291 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:08.292 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/logout - 204 null null 0.3848ms
2025-08-01 00:19:08.293 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/logout - application/json 0
2025-08-01 00:19:08.293 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:08.294 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:08.295 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-08-01 00:19:08.295 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-01 00:19:08.297 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-08-01 00:19:08.299 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET revoked_at = @p0
WHERE id = @p1;
2025-08-01 00:19:08.299 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:19:08.299 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 3.9019ms
2025-08-01 00:19:08.299 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-08-01 00:19:08.299 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/logout - 200 null application/json; charset=utf-8 6.6216ms
2025-08-01 00:19:08.345 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:19:08.345 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:08.345 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:08.345 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:19:08.349 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:19:08.351 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:08.351 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.0042ms
2025-08-01 00:19:08.352 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:08.352 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 6.9348ms
2025-08-01 00:19:08.408 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:19:08.409 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:08.409 +08:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:19:08.409 +08:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-08-01 00:19:08.409 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 401 0 null 1.198ms
2025-08-01 00:19:10.829 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - null null
2025-08-01 00:19:10.829 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:10.830 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - 204 null null 0.6438ms
2025-08-01 00:19:10.831 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/login - application/json 61
2025-08-01 00:19:10.832 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:10.832 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-01 00:19:10.832 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-01 00:19:10.835 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-08-01 00:19:10.949 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-08-01 00:19:10.950 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-08-01 00:19:10.950 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 117.9551ms
2025-08-01 00:19:10.950 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-01 00:19:10.951 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/login - 200 null application/json; charset=utf-8 119.5392ms
2025-08-01 00:19:10.986 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:19:10.986 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:19:10.986 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:10.986 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:10.987 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.8045ms
2025-08-01 00:19:10.987 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.7787ms
2025-08-01 00:19:10.988 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:19:10.988 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:19:10.989 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:10.989 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:10.991 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:10.991 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:10.992 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:10.992 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:19:10.992 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:19:10.992 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:19:10.993 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 4.2829ms
2025-08-01 00:19:10.999 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:19:11.001 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:11.002 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.3705ms
2025-08-01 00:19:11.002 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:11.002 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 13.6837ms
2025-08-01 00:19:11.008 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - null null
2025-08-01 00:19:11.009 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:11.009 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 204 null null 0.9583ms
2025-08-01 00:19:11.011 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - application/json null
2025-08-01 00:19:11.011 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:11.015 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:11.015 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 404 0 null 4.6747ms
2025-08-01 00:19:11.016 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats, Response status code: 404
2025-08-01 00:19:11.043 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:19:11.043 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:11.046 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:11.047 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:11.047 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:19:11.053 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:19:11.055 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:11.056 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.3685ms
2025-08-01 00:19:11.056 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:11.056 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 12.9225ms
2025-08-01 00:19:13.567 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:19:13.569 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:13.572 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:13.572 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:13.573 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:19:13.579 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:19:13.581 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:13.581 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.1175ms
2025-08-01 00:19:13.582 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:13.582 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 14.5051ms
2025-08-01 00:19:13.586 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:19:13.587 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:13.589 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:13.589 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:19:13.589 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:19:13.589 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.2689ms
2025-08-01 00:19:13.610 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:19:13.610 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:13.612 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:13.612 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:19:13.612 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:19:13.612 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 1.9704ms
2025-08-01 00:19:13.615 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:19:13.615 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:19:13.615 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:13.616 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:13.616 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.4771ms
2025-08-01 00:19:13.616 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.4896ms
2025-08-01 00:19:13.617 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:19:13.617 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:19:13.617 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:13.617 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:13.619 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:13.619 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:13.619 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:19:13.619 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:19:13.619 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:19:13.619 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:19:13.621 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:19:13.622 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:19:13.622 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:19:13.623 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:19:13.625 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:19:13.625 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:19:13.626 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:19:13.626 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:19:13.627 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:19:13.627 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:19:13.628 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:19:13.628 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:19:13.629 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:19:13.630 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:19:13.630 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:19:13.630 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:19:13.631 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:19:13.631 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:19:13.632 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:19:13.633 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:19:13.633 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:19:13.633 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:19:13.634 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:19:13.634 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:19:13.636 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:19:13.636 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:19:13.637 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:19:13.637 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:19:13.637 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.5824ms
2025-08-01 00:19:13.638 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:19:13.638 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 21.5051ms
2025-08-01 00:19:13.639 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:19:13.641 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:19:13.642 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:19:13.644 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:19:13.645 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:19:13.646 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:19:13.647 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:19:13.648 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:19:13.649 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:19:13.649 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 29.2031ms
2025-08-01 00:19:13.649 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:19:13.649 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 32.193ms
2025-08-01 00:19:16.696 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:19:16.696 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:16.697 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.7755ms
2025-08-01 00:19:16.698 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:19:16.698 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:16.700 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:16.701 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:19:16.704 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:19:16.710 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:19:16.712 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:19:16.712 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 8.2029ms
2025-08-01 00:19:16.712 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:19:16.713 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 14.8944ms
2025-08-01 00:19:16.717 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:19:16.717 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:16.717 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.4012ms
2025-08-01 00:19:16.719 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:19:16.720 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:16.725 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:16.725 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:19:16.725 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:19:16.727 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:19:16.728 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:16.728 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 2.5509ms
2025-08-01 00:19:16.728 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:19:16.728 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 9.0456ms
2025-08-01 00:19:22.408 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/logout - null null
2025-08-01 00:19:22.409 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:22.409 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/logout - 204 null null 0.4061ms
2025-08-01 00:19:22.410 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/logout - application/json 0
2025-08-01 00:19:22.410 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:22.411 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:22.412 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-08-01 00:19:22.412 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-01 00:19:22.413 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-08-01 00:19:22.416 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET revoked_at = @p0
WHERE id = @p1;
2025-08-01 00:19:22.416 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:19:22.416 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 4.2075ms
2025-08-01 00:19:22.416 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-08-01 00:19:22.416 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/logout - 200 null application/json; charset=utf-8 6.9045ms
2025-08-01 00:19:24.524 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - null null
2025-08-01 00:19:24.524 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:24.525 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - 204 null null 0.4623ms
2025-08-01 00:19:24.526 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/login - application/json 55
2025-08-01 00:19:24.527 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:24.527 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-01 00:19:24.527 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-01 00:19:24.529 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-08-01 00:19:24.640 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-08-01 00:19:24.641 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-08-01 00:19:24.641 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 113.8944ms
2025-08-01 00:19:24.642 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-01 00:19:24.642 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/login - 200 null application/json; charset=utf-8 116.0911ms
2025-08-01 00:19:24.669 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:19:24.669 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:19:24.669 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:24.670 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:24.670 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 1.7729ms
2025-08-01 00:19:24.670 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.7687ms
2025-08-01 00:19:24.673 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:19:24.674 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:24.674 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:19:24.675 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:24.677 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:24.677 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:24.677 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:24.677 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:19:24.677 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:19:24.678 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:19:24.678 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.5011ms
2025-08-01 00:19:24.683 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:19:24.687 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:24.687 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.6384ms
2025-08-01 00:19:24.688 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:24.688 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 14.893ms
2025-08-01 00:19:27.202 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:19:27.203 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:27.205 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:27.205 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:27.205 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:19:27.210 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:19:27.212 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:27.213 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.8726ms
2025-08-01 00:19:27.214 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:27.214 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 11.7113ms
2025-08-01 00:19:27.228 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:19:27.229 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:27.231 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:27.231 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:19:27.231 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:19:27.231 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.7087ms
2025-08-01 00:19:27.272 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:19:27.272 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:27.274 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:27.274 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:19:27.274 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:19:27.274 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.0208ms
2025-08-01 00:19:27.306 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - null null
2025-08-01 00:19:27.306 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:27.306 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - 204 null null 0.4654ms
2025-08-01 00:19:27.308 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/stats - application/json null
2025-08-01 00:19:27.308 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:27.311 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:27.311 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:19:27.312 +08:00 [INF] Route matched with {action = "GetStudentStats", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStudentStats() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:19:27.314 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
WHERE e.student_id = @__userId_0
2025-08-01 00:19:27.316 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t.amount, t.course_id, t.created_at, t.currency, t.payment_intent_id, t.payment_method, t.processed_at, t.status, t.subscription_id, t.transaction_id, t.user_id
FROM transactions AS t
WHERE t.user_id = @__userId_0 AND t.status = 'Completed'
2025-08-01 00:19:27.316 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType56`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:19:27.316 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api) in 4.45ms
2025-08-01 00:19:27.316 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:19:27.316 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/stats - 200 null application/json; charset=utf-8 8.6708ms
2025-08-01 00:19:27.336 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - null null
2025-08-01 00:19:27.336 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:27.336 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - 204 null null 0.3423ms
2025-08-01 00:19:27.337 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/courses - application/json null
2025-08-01 00:19:27.337 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:27.338 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:27.338 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:27.339 +08:00 [INF] Route matched with {action = "GetEnrolledCourses", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetEnrolledCourses() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:19:27.341 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s ON c.id = s.course_id
WHERE e.student_id = @__userId_0
ORDER BY COALESCE(e.last_accessed_date, e.enrolled_at) DESC, e.id, c.id, a."Id", s.id
2025-08-01 00:19:27.342 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType55`14[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:19:27.343 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api) in 4.3065ms
2025-08-01 00:19:27.344 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:19:27.344 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/courses - 200 null application/json; charset=utf-8 7.1955ms
2025-08-01 00:19:27.363 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - null null
2025-08-01 00:19:27.363 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:27.364 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - 204 null null 0.5685ms
2025-08-01 00:19:27.365 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - application/json null
2025-08-01 00:19:27.365 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:19:27.367 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:19:27.367 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - 404 0 null 2.1826ms
2025-08-01 00:19:27.368 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/subscriptions/current, Response status code: 404
2025-08-01 00:22:26.078 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/20 - null null
2025-08-01 00:22:26.079 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:26.079 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/20 - 204 null null 0.9907ms
2025-08-01 00:22:26.082 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/20 - application/json null
2025-08-01 00:22:26.082 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:26.106 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:22:26.107 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:22:26.107 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:22:26.126 +08:00 [INF] Executed DbCommand (17ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:22:26.127 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:22:26.127 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 19.6984ms
2025-08-01 00:22:26.127 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:22:26.127 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/20 - 200 null application/json; charset=utf-8 45.4626ms
2025-08-01 00:22:26.131 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:22:26.131 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:26.131 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.7471ms
2025-08-01 00:22:26.133 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:22:26.134 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:26.136 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:22:26.136 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:22:26.137 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:22:26.139 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:22:26.140 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:22:26.140 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 3.2059ms
2025-08-01 00:22:26.140 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:22:26.141 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 7.3016ms
2025-08-01 00:22:31.626 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:22:31.626 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:31.626 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.3788ms
2025-08-01 00:22:31.646 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:22:31.647 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:31.656 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:22:31.657 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:22:31.657 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:22:31.666 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:22:31.670 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:22:31.670 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 12.8261ms
2025-08-01 00:22:31.670 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:22:31.670 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 24.1115ms
2025-08-01 00:22:31.676 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:22:31.676 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:31.676 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.6612ms
2025-08-01 00:22:31.686 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:22:31.686 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:31.689 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:22:31.690 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:22:31.690 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:22:31.690 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 4.5674ms
2025-08-01 00:22:31.715 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:22:31.715 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:31.721 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:22:31.722 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:22:31.722 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:22:31.722 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 6.9661ms
2025-08-01 00:22:31.735 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - null null
2025-08-01 00:22:31.736 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:31.736 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - 204 null null 0.4943ms
2025-08-01 00:22:31.738 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/stats - application/json null
2025-08-01 00:22:31.738 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:31.740 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:22:31.741 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:22:31.741 +08:00 [INF] Route matched with {action = "GetStudentStats", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStudentStats() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:22:31.743 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
WHERE e.student_id = @__userId_0
2025-08-01 00:22:31.746 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t.amount, t.course_id, t.created_at, t.currency, t.payment_intent_id, t.payment_method, t.processed_at, t.status, t.subscription_id, t.transaction_id, t.user_id
FROM transactions AS t
WHERE t.user_id = @__userId_0 AND t.status = 'Completed'
2025-08-01 00:22:31.746 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType56`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:22:31.747 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api) in 5.9751ms
2025-08-01 00:22:31.747 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:22:31.747 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/stats - 200 null application/json; charset=utf-8 9.6514ms
2025-08-01 00:22:31.768 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - null null
2025-08-01 00:22:31.768 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:31.768 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - 204 null null 0.4257ms
2025-08-01 00:22:31.769 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/courses - application/json null
2025-08-01 00:22:31.769 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:31.771 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:22:31.771 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:22:31.771 +08:00 [INF] Route matched with {action = "GetEnrolledCourses", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetEnrolledCourses() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:22:31.821 +08:00 [INF] Executed DbCommand (49ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s ON c.id = s.course_id
WHERE e.student_id = @__userId_0
ORDER BY COALESCE(e.last_accessed_date, e.enrolled_at) DESC, e.id, c.id, a."Id", s.id
2025-08-01 00:22:31.824 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType55`14[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:22:31.824 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api) in 52.6076ms
2025-08-01 00:22:31.824 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:22:31.824 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/courses - 200 null application/json; charset=utf-8 55.2563ms
2025-08-01 00:22:31.827 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - null null
2025-08-01 00:22:31.827 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:31.827 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - 204 null null 0.4178ms
2025-08-01 00:22:31.829 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - application/json null
2025-08-01 00:22:31.829 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:31.830 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:22:31.831 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - 404 0 null 2.232ms
2025-08-01 00:22:31.831 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/subscriptions/current, Response status code: 404
2025-08-01 00:22:41.425 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:22:41.425 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:41.426 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.2197ms
2025-08-01 00:22:41.426 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:22:41.426 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:41.427 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.766ms
2025-08-01 00:22:41.427 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:22:41.428 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:41.429 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:22:41.430 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:22:41.431 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:22:41.431 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:22:41.431 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:22:41.432 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:22:41.433 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:22:41.433 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:22:41.433 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.6146ms
2025-08-01 00:22:41.460 +08:00 [INF] Executed DbCommand (13ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:22:41.462 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:22:41.463 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 31.2507ms
2025-08-01 00:22:41.463 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:22:41.463 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 36.0229ms
2025-08-01 00:24:00.175 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:24:00.176 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:00.176 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.4909ms
2025-08-01 00:24:00.177 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:24:00.178 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:00.179 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:00.180 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:00.180 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:24:00.186 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:24:00.190 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:24:00.190 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 10.4496ms
2025-08-01 00:24:00.191 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:00.191 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 13.3857ms
2025-08-01 00:24:00.194 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:24:00.195 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:00.195 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.7246ms
2025-08-01 00:24:00.196 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:24:00.197 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:00.199 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:00.200 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:24:00.200 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:24:00.200 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.9829ms
2025-08-01 00:24:00.233 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:24:00.234 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:00.241 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:00.242 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:24:00.242 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:24:00.242 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 8.6895ms
2025-08-01 00:24:00.260 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - null null
2025-08-01 00:24:00.261 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:00.262 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/stats - 204 null null 1.8039ms
2025-08-01 00:24:00.266 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/stats - application/json null
2025-08-01 00:24:00.267 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:00.270 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:00.271 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:24:00.271 +08:00 [INF] Route matched with {action = "GetStudentStats", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStudentStats() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:24:00.275 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
WHERE e.student_id = @__userId_0
2025-08-01 00:24:00.277 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t.id, t.amount, t.course_id, t.created_at, t.currency, t.payment_intent_id, t.payment_method, t.processed_at, t.status, t.subscription_id, t.transaction_id, t.user_id
FROM transactions AS t
WHERE t.user_id = @__userId_0 AND t.status = 'Completed'
2025-08-01 00:24:00.277 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType56`9[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:24:00.278 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api) in 5.8201ms
2025-08-01 00:24:00.279 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetStudentStats (CeceLearningPortal.Api)'
2025-08-01 00:24:00.279 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/stats - 200 null application/json; charset=utf-8 12.5577ms
2025-08-01 00:24:00.307 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - null null
2025-08-01 00:24:00.307 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:00.307 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/students/courses - 204 null null 0.8262ms
2025-08-01 00:24:00.308 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/students/courses - application/json null
2025-08-01 00:24:00.309 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:00.311 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:00.311 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:00.311 +08:00 [INF] Route matched with {action = "GetEnrolledCourses", controller = "Students"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetEnrolledCourses() on controller CeceLearningPortal.Api.Controllers.StudentsController (CeceLearningPortal.Api).
2025-08-01 00:24:00.314 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url
FROM enrollments AS e
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s ON c.id = s.course_id
WHERE e.student_id = @__userId_0
ORDER BY COALESCE(e.last_accessed_date, e.enrolled_at) DESC, e.id, c.id, a."Id", s.id
2025-08-01 00:24:00.315 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType55`14[[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:24:00.315 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api) in 3.7318ms
2025-08-01 00:24:00.315 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.StudentsController.GetEnrolledCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:00.315 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/students/courses - 200 null application/json; charset=utf-8 6.8829ms
2025-08-01 00:24:00.332 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - null null
2025-08-01 00:24:00.333 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:00.333 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/subscriptions/current - 204 null null 0.6836ms
2025-08-01 00:24:00.335 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - application/json null
2025-08-01 00:24:00.335 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:00.337 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:00.337 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/subscriptions/current - 404 0 null 2.4057ms
2025-08-01 00:24:00.338 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/subscriptions/current, Response status code: 404
2025-08-01 00:24:06.703 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/28 - null null
2025-08-01 00:24:06.703 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:06.703 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/28 - 204 null null 0.5233ms
2025-08-01 00:24:06.705 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/28 - application/json null
2025-08-01 00:24:06.705 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:06.707 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:06.707 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:24:06.708 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:24:06.713 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:24:06.715 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:24:06.715 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 6.9552ms
2025-08-01 00:24:06.715 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:24:06.715 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/28 - 200 null application/json; charset=utf-8 10.467ms
2025-08-01 00:24:06.717 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:24:06.718 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:06.718 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.923ms
2025-08-01 00:24:06.720 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:24:06.720 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:06.723 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:06.724 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:24:06.724 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:24:06.726 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:24:06.726 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:24:06.727 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 2.7925ms
2025-08-01 00:24:06.727 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:24:06.727 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 6.8967ms
2025-08-01 00:24:11.871 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/logout - null null
2025-08-01 00:24:11.871 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:11.871 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/logout - 204 null null 0.3838ms
2025-08-01 00:24:11.872 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/logout - application/json 0
2025-08-01 00:24:11.872 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:11.873 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:11.874 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-08-01 00:24:11.874 +08:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-01 00:24:11.876 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a0."Id", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status", a0."TwoFactorEnabled", a0."UserName", r.id, r.created_at, r.created_by_ip, r.expires_at, r.replaced_by_token, r.revoked_at, r.revoked_by_ip, r.token, r.user_id
FROM (
    SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM "AspNetUsers" AS a
    WHERE a."Id" = @__userId_0
    LIMIT 1
) AS a0
LEFT JOIN refresh_tokens AS r ON a0."Id" = r.user_id
ORDER BY a0."Id"
2025-08-01 00:24:11.878 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_tokens SET revoked_at = @p0
WHERE id = @p1;
2025-08-01 00:24:11.878 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:24:11.879 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api) in 4.4828ms
2025-08-01 00:24:11.879 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Logout (CeceLearningPortal.Api)'
2025-08-01 00:24:11.879 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/logout - 200 null application/json; charset=utf-8 6.9551ms
2025-08-01 00:24:14.490 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - null null
2025-08-01 00:24:14.490 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:14.490 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/auth/login - 204 null null 0.3982ms
2025-08-01 00:24:14.491 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5294/api/auth/login - application/json 61
2025-08-01 00:24:14.492 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:14.492 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-01 00:24:14.492 +08:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CeceLearningPortal.Api.DTOs.LoginDto) on controller CeceLearningPortal.Api.Controllers.AuthController (CeceLearningPortal.Api).
2025-08-01 00:24:14.495 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2
2025-08-01 00:24:14.605 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@p1='?', @p2='?', @p0='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?', @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = DateTime), @p8='?', @p9='?', @p10='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "LastLoginAt" = @p0
WHERE "Id" = @p1 AND "ConcurrencyStamp" = @p2;
INSERT INTO refresh_tokens (created_at, created_by_ip, expires_at, replaced_by_token, revoked_at, revoked_by_ip, token, user_id)
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10)
RETURNING id;
2025-08-01 00:24:14.606 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.AuthResponseDto'.
2025-08-01 00:24:14.606 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api) in 113.6685ms
2025-08-01 00:24:14.606 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AuthController.Login (CeceLearningPortal.Api)'
2025-08-01 00:24:14.606 +08:00 [INF] Request finished HTTP/1.1 POST http://localhost:5294/api/auth/login - 200 null application/json; charset=utf-8 114.997ms
2025-08-01 00:24:14.638 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:24:14.638 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:24:14.639 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:14.639 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:14.639 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.8587ms
2025-08-01 00:24:14.639 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.9357ms
2025-08-01 00:24:14.642 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:24:14.642 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:24:14.643 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:14.643 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:14.645 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:14.645 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:14.646 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:24:14.646 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:14.646 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:24:14.646 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 4.0483ms
2025-08-01 00:24:14.646 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:24:14.653 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:24:14.655 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:24:14.656 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.2264ms
2025-08-01 00:24:14.656 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:14.656 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 13.9963ms
2025-08-01 00:24:14.661 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - null null
2025-08-01 00:24:14.661 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:14.662 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 204 null null 0.6635ms
2025-08-01 00:24:14.663 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - application/json null
2025-08-01 00:24:14.663 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:14.665 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:14.666 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats - 404 0 null 2.883ms
2025-08-01 00:24:14.667 +08:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5294/api/users/bee889a2-efca-471d-807c-a7674a945612/instructor-stats, Response status code: 404
2025-08-01 00:24:14.683 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:24:14.683 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:14.683 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.3733ms
2025-08-01 00:24:14.685 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:24:14.686 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:14.688 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:14.688 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:14.688 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:24:14.692 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:24:14.694 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:24:14.694 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 6.0463ms
2025-08-01 00:24:14.694 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:14.695 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses?instructorId=bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 9.497ms
2025-08-01 00:24:18.070 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:24:18.070 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:18.072 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:18.072 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:18.072 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:24:18.078 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:24:18.081 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:24:18.081 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.8827ms
2025-08-01 00:24:18.082 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:18.082 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 12.3147ms
2025-08-01 00:24:18.087 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:24:18.087 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:18.089 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:18.089 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:24:18.089 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:24:18.089 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.4283ms
2025-08-01 00:24:18.110 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:24:18.110 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:18.112 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:18.112 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:24:18.112 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:24:18.112 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 1.9564ms
2025-08-01 00:24:18.121 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:24:18.121 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:24:18.121 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:18.121 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:18.122 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.5856ms
2025-08-01 00:24:18.122 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.6909ms
2025-08-01 00:24:18.124 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:24:18.125 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:18.125 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:24:18.126 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:18.127 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:18.128 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:24:18.128 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:24:18.129 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:18.129 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:24:18.130 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:24:18.130 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:24:18.132 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:24:18.134 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:24:18.135 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:18.137 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:18.138 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:24:18.155 +08:00 [INF] Executed DbCommand (15ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:18.156 +08:00 [INF] Executed DbCommand (13ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:24:18.156 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:18.158 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:18.162 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:18.163 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:18.165 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:18.165 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:18.166 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:18.166 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:18.168 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:18.168 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:18.169 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:18.169 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:18.170 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:18.170 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:18.171 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:18.171 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:24:18.171 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:18.172 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:24:18.172 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:18.172 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:24:18.173 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 42.5802ms
2025-08-01 00:24:18.173 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:24:18.173 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 47.4783ms
2025-08-01 00:24:18.173 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:18.175 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:18.176 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:18.176 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:18.177 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:18.178 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:18.179 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:18.179 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:18.180 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:24:18.180 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 51.3901ms
2025-08-01 00:24:18.180 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:24:18.180 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 56.2631ms
2025-08-01 00:24:20.477 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:24:20.478 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:20.478 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.4654ms
2025-08-01 00:24:20.479 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:24:20.479 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:20.481 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:20.482 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:24:20.482 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:24:20.487 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:24:20.490 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:24:20.490 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 8.061ms
2025-08-01 00:24:20.491 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:24:20.491 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 11.8047ms
2025-08-01 00:24:20.495 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:24:20.495 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:20.495 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.4809ms
2025-08-01 00:24:20.498 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:24:20.498 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:20.500 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:20.500 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:24:20.501 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:24:20.503 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:24:20.503 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:24:20.504 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 2.7248ms
2025-08-01 00:24:20.504 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:24:20.504 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 6.2211ms
2025-08-01 00:24:23.446 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:24:23.446 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:23.447 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.5167ms
2025-08-01 00:24:23.448 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:24:23.448 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:23.449 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:23.450 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:23.450 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:24:23.456 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:24:23.458 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:24:23.458 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.3383ms
2025-08-01 00:24:23.459 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:23.459 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 10.9553ms
2025-08-01 00:24:23.466 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:24:23.466 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:23.466 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.4092ms
2025-08-01 00:24:23.467 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:24:23.468 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:23.470 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:23.470 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:24:23.470 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:24:23.470 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.8121ms
2025-08-01 00:24:23.487 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:24:23.488 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:23.489 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:23.489 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:24:23.489 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:24:23.489 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 1.98ms
2025-08-01 00:24:23.510 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:24:23.510 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:23.512 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:24:23.513 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:23.513 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.7776ms
2025-08-01 00:24:23.513 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:24:23.515 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:23.516 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:24:23.517 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 3.7365ms
2025-08-01 00:24:23.517 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:23.519 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:23.519 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:24:23.519 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:24:23.519 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:24:23.520 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:23.521 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:23.521 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:24:23.521 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:24:23.525 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:24:23.525 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:24:23.526 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:24:23.526 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 6.6356ms
2025-08-01 00:24:23.526 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:24:23.526 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 16.6783ms
2025-08-01 00:24:23.527 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:24:23.531 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:24:23.532 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:23.534 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:23.537 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:23.539 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:23.540 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:23.541 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:23.542 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:23.543 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:23.544 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:24:23.544 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:24:23.544 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:24:23.546 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:24:23.546 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:24:23.547 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 24.928ms
2025-08-01 00:24:23.547 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:24:23.548 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 32.0197ms
2025-08-01 00:24:23.552 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:24:23.554 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:24:23.556 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:23.560 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:23.561 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:23.562 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:23.563 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:23.565 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:23.566 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:23.567 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:23.569 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:23.570 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:23.571 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:23.573 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:23.574 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:23.592 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:23.593 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:23.594 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:23.598 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:23.600 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:23.601 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:23.602 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:23.603 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:23.603 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:24:23.604 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 59.7767ms
2025-08-01 00:24:23.604 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:24:23.604 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 84.8425ms
2025-08-01 00:24:33.279 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:24:33.280 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:33.280 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.3994ms
2025-08-01 00:24:33.281 +08:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5294/api/courses/21 - application/json 1001
2025-08-01 00:24:33.281 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:33.283 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:33.283 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api)'
2025-08-01 00:24:33.283 +08:00 [INF] Route matched with {action = "UpdateCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCourse(Int32, CeceLearningPortal.Api.DTOs.UpdateCourseDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:24:33.284 +08:00 [INF] UpdateCourse called for ID: 21
2025-08-01 00:24:33.284 +08:00 [INF] Received data: {"Title":"Computer Vision Fundamentals","Description":"Learn the fundamentals of computer vision, image processing, and deep learning for visual recognition tasks.","ShortDescription":"","Price":150,"OriginalPrice":299.99,"Duration":"30 hours","Level":"Advanced","Category":"Business","Thumbnail":null,"ThumbnailUrl":"","PromoVideoUrl":"","Language":"en","Features":[],"PreviewUrl":"","EnrollmentType":null,"Status":null,"CourseFeatures":{"Certificate":true,"Community":false,"LiveSessions":true,"DownloadableResources":true,"Assignments":true,"Quizzes":false},"CourseType":"Custom","PricingModel":"OneTime","Currency":"PHP","AccessType":"Limited","AccessDuration":null,"Automations":{"WelcomeEmail":true,"CompletionCertificate":true,"ProgressReminders":true,"AbandonmentSequence":false},"Modules":[{"Title":"Getting Started","Description":"Introduction and fundamentals","Order":1,"Lessons":[{"Title":"Lessontest","Duration":"10:00","Type":"Video","Content":null,"VideoUrl":null,"Order":1}]}]}
2025-08-01 00:24:33.284 +08:00 [INF] CourseType: Custom
2025-08-01 00:24:33.284 +08:00 [INF] PricingModel: OneTime
2025-08-01 00:24:33.284 +08:00 [INF] Language: en
2025-08-01 00:24:33.284 +08:00 [INF] CourseFeatures: {"Certificate":true,"Community":false,"LiveSessions":true,"DownloadableResources":true,"Assignments":true,"Quizzes":false}
2025-08-01 00:24:33.287 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.id = @__id_0
LIMIT 1
2025-08-01 00:24:33.289 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__course_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.course_id, c.created_at, c.description, c."order", c.title, c.updated_at, c0.id, c0.content, c0.created_at, c0.duration, c0.module_id, c0."order", c0.title, c0.type, c0.updated_at, c0.video_url
FROM course_modules AS c
LEFT JOIN course_lessons AS c0 ON c.id = c0.module_id
WHERE c.course_id = @__course_Id_0
ORDER BY c.id
2025-08-01 00:24:33.295 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE course_modules SET updated_at = @p0
WHERE id = @p1;
UPDATE courses SET "HasDownloadableResources" = @p2, updated_at = @p3
WHERE id = @p4;
2025-08-01 00:24:33.296 +08:00 [INF] Update successful. Returned course: {"Id":21,"Title":"Computer Vision Fundamentals","Description":"Learn the fundamentals of computer vision, image processing, and deep learning for visual recognition tasks.","InstructorId":"bee889a2-efca-471d-807c-a7674a945612","InstructorName":"Unknown","Price":150,"OriginalPrice":299.99,"Discount":49,"Duration":"30 hours","Level":"Advanced","Category":"Business","Thumbnail":null,"Status":"Active","IsBestseller":false,"Features":[],"PreviewUrl":"","EnrollmentType":"OneTime","StudentsCount":0,"AverageRating":0,"LecturesCount":1,"CreatedAt":"2025-05-31T06:05:22.858366Z","UpdatedAt":"2025-07-31T16:24:33.288445Z","CourseType":"Custom"}
2025-08-01 00:24:33.297 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDto'.
2025-08-01 00:24:33.297 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api) in 13.8765ms
2025-08-01 00:24:33.297 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.UpdateCourse (CeceLearningPortal.Api)'
2025-08-01 00:24:33.297 +08:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 16.5059ms
2025-08-01 00:24:33.306 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:24:33.308 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:33.308 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.5361ms
2025-08-01 00:24:33.310 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:24:33.310 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:33.312 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:33.312 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:33.313 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:24:33.320 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:24:33.322 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:24:33.323 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 9.8765ms
2025-08-01 00:24:33.323 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:33.323 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 13.5843ms
2025-08-01 00:24:33.382 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:24:33.382 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:33.383 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.5635ms
2025-08-01 00:24:33.384 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:24:33.384 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:33.386 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:33.386 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:24:33.386 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:24:33.386 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.4332ms
2025-08-01 00:24:33.417 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:24:33.417 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:24:33.417 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:24:33.418 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:33.418 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:33.418 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 1.1577ms
2025-08-01 00:24:33.418 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:33.418 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 1.1805ms
2025-08-01 00:24:33.421 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:24:33.421 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:24:33.424 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:33.424 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:33.424 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:33.425 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:24:33.426 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:24:33.426 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 8.551ms
2025-08-01 00:24:33.427 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:33.427 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:33.428 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:24:33.428 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:24:33.428 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:24:33.428 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:24:33.430 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:24:33.433 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:24:33.507 +08:00 [INF] Executed DbCommand (75ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:24:33.511 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:33.512 +08:00 [INF] Executed DbCommand (21ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:24:33.514 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:33.535 +08:00 [INF] Executed DbCommand (21ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:24:33.546 +08:00 [INF] Executed DbCommand (30ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:33.563 +08:00 [INF] Executed DbCommand (27ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:33.563 +08:00 [INF] Executed DbCommand (17ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:33.565 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:33.565 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:33.566 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:33.566 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:33.568 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:33.569 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:33.570 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:33.570 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:33.572 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:33.572 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:33.573 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:33.573 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:33.574 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:33.574 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:24:33.576 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:33.577 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:33.578 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:24:33.578 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:33.578 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:24:33.579 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 150.1322ms
2025-08-01 00:24:33.579 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:24:33.579 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 158.1836ms
2025-08-01 00:24:33.595 +08:00 [INF] Executed DbCommand (16ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:33.596 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:33.597 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:33.598 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:33.599 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:33.600 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:33.601 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:33.601 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:24:33.602 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 173.277ms
2025-08-01 00:24:33.602 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:24:33.602 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 181.0787ms
2025-08-01 00:24:39.108 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:24:39.108 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:39.108 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.4883ms
2025-08-01 00:24:39.110 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:24:39.110 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:39.112 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:39.112 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:24:39.113 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:24:39.121 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:24:39.122 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:24:39.122 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 9.2168ms
2025-08-01 00:24:39.122 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:24:39.123 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 12.8221ms
2025-08-01 00:24:39.125 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:24:39.126 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:39.126 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.6992ms
2025-08-01 00:24:39.128 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:24:39.128 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:39.130 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:39.131 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:24:39.131 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:24:39.133 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:24:39.134 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:24:39.134 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 2.8717ms
2025-08-01 00:24:39.134 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:24:39.134 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 6.7949ms
2025-08-01 00:24:42.255 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:24:42.255 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:42.255 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.4871ms
2025-08-01 00:24:42.256 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:24:42.257 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:42.258 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:42.259 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:42.259 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:24:42.264 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:24:42.267 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:24:42.267 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.9131ms
2025-08-01 00:24:42.267 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:24:42.267 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 11.1464ms
2025-08-01 00:24:42.274 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:24:42.275 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:42.275 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.5326ms
2025-08-01 00:24:42.277 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:24:42.277 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:42.279 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:42.279 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:24:42.279 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:24:42.279 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.5468ms
2025-08-01 00:24:42.298 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:24:42.298 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:42.299 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:42.300 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:24:42.300 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:24:42.300 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 1.9699ms
2025-08-01 00:24:42.310 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:24:42.310 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:24:42.310 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:42.310 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:42.310 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.4821ms
2025-08-01 00:24:42.311 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.6641ms
2025-08-01 00:24:42.312 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:24:42.312 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:24:42.313 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:42.313 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:24:42.314 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:42.314 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:24:42.315 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:24:42.315 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:24:42.315 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:24:42.315 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:24:42.317 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:24:42.318 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:24:42.318 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:24:42.320 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:42.320 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:24:42.321 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:42.322 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:24:42.323 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:42.323 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:42.324 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:42.324 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:42.325 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:42.326 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:42.327 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:42.337 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:42.338 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:42.338 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:42.339 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:42.339 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:42.340 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:24:42.341 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:42.346 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:24:42.346 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:42.348 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:42.348 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:24:42.348 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:24:42.348 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 32.8735ms
2025-08-01 00:24:42.349 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:24:42.349 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 36.4522ms
2025-08-01 00:24:42.349 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:42.350 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:42.351 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:42.352 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:42.353 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:42.354 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:42.355 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:42.355 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:24:42.356 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:42.357 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:24:42.357 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:24:42.357 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 41.8576ms
2025-08-01 00:24:42.358 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:24:42.358 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 45.3437ms
2025-08-01 00:30:26.227 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - null null
2025-08-01 00:30:26.228 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:30:26.228 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses/21 - 204 null null 0.7585ms
2025-08-01 00:30:26.229 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses/21 - application/json null
2025-08-01 00:30:26.229 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:30:26.250 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:30:26.250 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:30:26.250 +08:00 [INF] Route matched with {action = "GetCourse", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourse(Int32) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:30:26.262 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s.id, s."AccessDuration", s."AccessType", s."AutomationAbandonmentSequence", s."AutomationCompletionCertificate", s."AutomationProgressReminders", s."AutomationWelcomeEmail", s.category, s."CourseType", s.created_at, s."Currency", s.description, s.discount, s."DripContent", s."DripScheduleJson", s.duration, s."EnrollmentLimit", s.enrollment_type, s.features, s."HasAssignments", s."HasCertificate", s."HasCommunity", s."HasDownloadableResources", s."HasLiveSessions", s."HasQuizzes", s.instructor_id, s.is_bestseller, s."IsPublished", s."Language", s.level, s.original_price, s."PaymentPlanDetailsJson", s.preview_url, s.price, s."PricingModel", s."PromoVideoUrl", s."PublishedAt", s."ShortDescription", s.status, s."SubscriptionPeriod", s.thumbnail, s.thumbnail_url, s.title, s.updated_at, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status0", s."TwoFactorEnabled", s."UserName", s0.id, s0.course_id, s0.created_at, s0.description, s0."order", s0.title, s0.updated_at, s0.id0, s0.content, s0.created_at0, s0.duration, s0.module_id, s0.order0, s0.title0, s0.type, s0.updated_at0, s0.video_url, s1.id, s1.approved_at, s1.approved_by, s1.comment, s1.course_id, s1.created_at, s1.is_flagged, s1.rating, s1.status, s1.student_id, s1."Id0", s1."AccessFailedCount", s1."Avatar", s1."ConcurrencyStamp", s1."CreatedAt", s1."Email", s1."EmailConfirmed", s1."FullName", s1."LastLoginAt", s1."LockoutEnabled", s1."LockoutEnd", s1."NormalizedEmail", s1."NormalizedUserName", s1."NotificationPreferences", s1."PasswordHash", s1."PhoneNumber", s1."PhoneNumberConfirmed", s1."RefreshToken", s1."RefreshTokenExpiryTime", s1."Role", s1."SecurityStamp", s1."Status0", s1."TwoFactorEnabled", s1."UserName", e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status" AS "Status0", a."TwoFactorEnabled", a."UserName"
    FROM courses AS c
    INNER JOIN "AspNetUsers" AS a ON c.instructor_id = a."Id"
    WHERE c.id = @__id_0
    LIMIT 1
) AS s
LEFT JOIN (
    SELECT c0.id, c0.course_id, c0.created_at, c0.description, c0."order", c0.title, c0.updated_at, c1.id AS id0, c1.content, c1.created_at AS created_at0, c1.duration, c1.module_id, c1."order" AS order0, c1.title AS title0, c1.type, c1.updated_at AS updated_at0, c1.video_url
    FROM course_modules AS c0
    LEFT JOIN course_lessons AS c1 ON c0.id = c1.module_id
) AS s0 ON s.id = s0.course_id
LEFT JOIN (
    SELECT c2.id, c2.approved_at, c2.approved_by, c2.comment, c2.course_id, c2.created_at, c2.is_flagged, c2.rating, c2.status, c2.student_id, a0."Id" AS "Id0", a0."AccessFailedCount", a0."Avatar", a0."ConcurrencyStamp", a0."CreatedAt", a0."Email", a0."EmailConfirmed", a0."FullName", a0."LastLoginAt", a0."LockoutEnabled", a0."LockoutEnd", a0."NormalizedEmail", a0."NormalizedUserName", a0."NotificationPreferences", a0."PasswordHash", a0."PhoneNumber", a0."PhoneNumberConfirmed", a0."RefreshToken", a0."RefreshTokenExpiryTime", a0."Role", a0."SecurityStamp", a0."Status" AS "Status0", a0."TwoFactorEnabled", a0."UserName"
    FROM course_reviews AS c2
    INNER JOIN "AspNetUsers" AS a0 ON c2.student_id = a0."Id"
) AS s1 ON s.id = s1.course_id
LEFT JOIN enrollments AS e ON s.id = e.course_id
ORDER BY s.id, s."Id0", s0.id, s0.id0, s1.id, s1."Id0"
2025-08-01 00:30:26.263 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.CourseDetailDto'.
2025-08-01 00:30:26.263 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api) in 12.8113ms
2025-08-01 00:30:26.263 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourse (CeceLearningPortal.Api)'
2025-08-01 00:30:26.264 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses/21 - 200 null application/json; charset=utf-8 34.8685ms
2025-08-01 00:30:26.266 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - null null
2025-08-01 00:30:26.266 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:30:26.266 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/enrollments - 204 null null 0.3833ms
2025-08-01 00:30:26.267 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/enrollments - application/json null
2025-08-01 00:30:26.267 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:30:26.270 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:30:26.270 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:30:26.270 +08:00 [INF] Route matched with {action = "GetMyEnrollments", controller = "Enrollments"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyEnrollments() on controller CeceLearningPortal.Api.Controllers.EnrollmentsController (CeceLearningPortal.Api).
2025-08-01 00:30:26.273 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__studentId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.id AS "Id", e.student_id AS "StudentId", a."FullName" AS "StudentName", e.course_id AS "CourseId", c.title AS "CourseTitle", c.thumbnail AS "CourseThumbnail", a0."FullName" AS "InstructorName", e.enrolled_at AS "EnrolledAt", e.completed_at AS "CompletedAt", e.progress_percentage AS "ProgressPercentage", e.certificate_url AS "CertificateUrl"
FROM enrollments AS e
INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
INNER JOIN courses AS c ON e.course_id = c.id
INNER JOIN "AspNetUsers" AS a0 ON c.instructor_id = a0."Id"
WHERE e.student_id = @__studentId_0
2025-08-01 00:30:26.274 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CeceLearningPortal.Api.DTOs.EnrollmentDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:30:26.274 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api) in 3.2432ms
2025-08-01 00:30:26.274 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.EnrollmentsController.GetMyEnrollments (CeceLearningPortal.Api)'
2025-08-01 00:30:26.274 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/enrollments - 200 null application/json; charset=utf-8 7.2547ms
2025-08-01 00:30:29.267 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:30:29.267 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:30:29.267 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 0.4819ms
2025-08-01 00:30:29.269 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:30:29.270 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:30:29.273 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:30:29.273 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:30:29.273 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:30:29.279 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:30:29.281 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:30:29.282 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 8.1882ms
2025-08-01 00:30:29.282 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:30:29.282 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 12.5313ms
2025-08-01 00:30:29.285 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:30:29.285 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:30:29.286 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 0.6139ms
2025-08-01 00:30:29.287 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:30:29.287 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:30:29.289 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:30:29.289 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:30:29.289 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:30:29.289 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.0934ms
2025-08-01 00:30:29.312 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:30:29.313 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:30:29.314 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:30:29.314 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:30:29.314 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:30:29.314 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 1.9805ms
2025-08-01 00:30:29.318 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:30:29.318 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:30:29.318 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:30:29.318 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:30:29.318 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.7649ms
2025-08-01 00:30:29.318 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.6192ms
2025-08-01 00:30:29.320 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:30:29.320 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:30:29.321 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:30:29.321 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:30:29.322 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:30:29.323 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:30:29.323 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:30:29.326 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:30:29.329 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:30:29.331 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:30:29.331 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:30:29.332 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:30:29.333 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:30:29.334 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:30:29.335 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:30:29.336 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:30:29.337 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:30:29.338 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:30:29.338 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:30:29.338 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:30:29.339 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:30:29.340 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:30:29.340 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:30:29.340 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:30:29.341 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 17.7915ms
2025-08-01 00:30:29.341 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:30:29.341 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 20.835ms
2025-08-01 00:30:29.342 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:30:29.345 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:30:29.347 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:30:29.350 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:30:29.351 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:30:29.354 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:30:29.355 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:30:29.357 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:30:29.358 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:30:29.359 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:30:29.361 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:30:29.362 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:30:29.365 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:30:29.367 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:30:29.369 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:30:29.371 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:30:29.372 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:30:29.373 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:30:29.374 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:30:29.375 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:30:29.377 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:30:29.378 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:30:29.378 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:30:29.379 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 40.7432ms
2025-08-01 00:30:29.379 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:30:29.379 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 58.6568ms
2025-08-01 00:31:31.146 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/courses - null null
2025-08-01 00:31:31.146 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:31:31.147 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/courses - 204 null null 1.243ms
2025-08-01 00:31:31.148 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:31:31.148 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:31:31.150 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:31:31.150 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:31:31.151 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:31:31.163 +08:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:31:31.168 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:31:31.168 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 17.3792ms
2025-08-01 00:31:31.168 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:31:31.169 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 20.5412ms
2025-08-01 00:31:31.224 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/courses - application/json null
2025-08-01 00:31:31.224 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:31:31.225 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:31:31.226 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:31:31.226 +08:00 [INF] Route matched with {action = "GetCourses", controller = "Courses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses(CeceLearningPortal.Api.DTOs.CourseFilterDto) on controller CeceLearningPortal.Api.Controllers.CoursesController (CeceLearningPortal.Api).
2025-08-01 00:31:31.229 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c0.id, c0."AccessDuration", c0."AccessType", c0."AutomationAbandonmentSequence", c0."AutomationCompletionCertificate", c0."AutomationProgressReminders", c0."AutomationWelcomeEmail", c0.category, c0."CourseType", c0.created_at, c0."Currency", c0.description, c0.discount, c0."DripContent", c0."DripScheduleJson", c0.duration, c0."EnrollmentLimit", c0.enrollment_type, c0.features, c0."HasAssignments", c0."HasCertificate", c0."HasCommunity", c0."HasDownloadableResources", c0."HasLiveSessions", c0."HasQuizzes", c0.instructor_id, c0.is_bestseller, c0."IsPublished", c0."Language", c0.level, c0.original_price, c0."PaymentPlanDetailsJson", c0.preview_url, c0.price, c0."PricingModel", c0."PromoVideoUrl", c0."PublishedAt", c0."ShortDescription", c0.status, c0."SubscriptionPeriod", c0.thumbnail, c0.thumbnail_url, c0.title, c0.updated_at, a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName", s.id, s.course_id, s.created_at, s.description, s."order", s.title, s.updated_at, s.id0, s.content, s.created_at0, s.duration, s.module_id, s.order0, s.title0, s.type, s.updated_at0, s.video_url, c3.id, c3.approved_at, c3.approved_by, c3.comment, c3.course_id, c3.created_at, c3.is_flagged, c3.rating, c3.status, c3.student_id, e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent
FROM (
    SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
    FROM courses AS c
    ORDER BY c.created_at DESC
    LIMIT @__p_1 OFFSET @__p_0
) AS c0
INNER JOIN "AspNetUsers" AS a ON c0.instructor_id = a."Id"
LEFT JOIN (
    SELECT c1.id, c1.course_id, c1.created_at, c1.description, c1."order", c1.title, c1.updated_at, c2.id AS id0, c2.content, c2.created_at AS created_at0, c2.duration, c2.module_id, c2."order" AS order0, c2.title AS title0, c2.type, c2.updated_at AS updated_at0, c2.video_url
    FROM course_modules AS c1
    LEFT JOIN course_lessons AS c2 ON c1.id = c2.module_id
) AS s ON c0.id = s.course_id
LEFT JOIN course_reviews AS c3 ON c0.id = c3.course_id
LEFT JOIN enrollments AS e ON c0.id = e.course_id
ORDER BY c0.created_at DESC, c0.id, a."Id", s.id, s.id0, c3.id
2025-08-01 00:31:31.233 +08:00 [INF] Executing OkObjectResult, writing value of type 'System.Linq.Enumerable+ListSelectIterator`2[[CeceLearningPortal.Api.Models.Course, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[CeceLearningPortal.Api.DTOs.CourseDto, CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-01 00:31:31.233 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api) in 7.1364ms
2025-08-01 00:31:31.234 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.CoursesController.GetCourses (CeceLearningPortal.Api)'
2025-08-01 00:31:31.234 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/courses - 200 null application/json; charset=utf-8 10.2941ms
2025-08-01 00:31:31.266 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - null null
2025-08-01 00:31:31.266 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:31:31.267 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/platform - 204 null null 1.6421ms
2025-08-01 00:31:31.268 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:31:31.269 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:31:31.270 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:31:31.270 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:31:31.271 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:31:31.271 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.4728ms
2025-08-01 00:31:31.312 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:31:31.313 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:31:31.314 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:31:31.314 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:31:31.314 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:31:31.314 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.1011ms
2025-08-01 00:31:31.323 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:31:31.323 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:31:31.325 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:31:31.325 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:31:31.325 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:31:31.325 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 2.1888ms
2025-08-01 00:31:31.350 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/platform - application/json null
2025-08-01 00:31:31.351 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:31:31.353 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:31:31.353 +08:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-08-01 00:31:31.354 +08:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-08-01 00:31:31.354 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/platform - 403 0 null 3.2759ms
2025-08-01 00:31:31.398 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:31:31.398 +08:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - null null
2025-08-01 00:31:31.399 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:31:31.399 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 0.6814ms
2025-08-01 00:31:31.398 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:31:31.402 +08:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 204 null null 4.2471ms
2025-08-01 00:31:31.412 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:31:31.412 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - application/json null
2025-08-01 00:31:31.413 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:31:31.413 +08:00 [INF] CORS policy execution successful.
2025-08-01 00:31:31.422 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:31:31.422 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:31:31.422 +08:00 [INF] Route matched with {action = "GetInstructorAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorAnalytics(System.String) on controller CeceLearningPortal.Api.Controllers.AnalyticsController (CeceLearningPortal.Api).
2025-08-01 00:31:31.424 +08:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM refresh_tokens AS r
    WHERE r.user_id = @__userId_0 AND r.revoked_at IS NULL AND now() < r.expires_at)
2025-08-01 00:31:31.427 +08:00 [INF] Executing endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:31:31.427 +08:00 [INF] Route matched with {action = "GetInstructorRevenue", controller = "Revenue"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInstructorRevenue(System.String) on controller CeceLearningPortal.Api.Controllers.RevenueController (CeceLearningPortal.Api).
2025-08-01 00:31:31.430 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
FROM "AspNetUsers" AS a
WHERE a."Id" = @__p_0
LIMIT 1
2025-08-01 00:31:31.431 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at, s.id, s.average_quiz_score, s.certificate_issued, s.certificate_url, s.completed_at, s.completed_lessons, s.course_id, s.enrolled_at, s.last_accessed_date, s.progress_percentage, s.quiz_count, s.student_id, s.total_time_spent, s."Id0", s."AccessFailedCount", s."Avatar", s."ConcurrencyStamp", s."CreatedAt", s."Email", s."EmailConfirmed", s."FullName", s."LastLoginAt", s."LockoutEnabled", s."LockoutEnd", s."NormalizedEmail", s."NormalizedUserName", s."NotificationPreferences", s."PasswordHash", s."PhoneNumber", s."PhoneNumberConfirmed", s."RefreshToken", s."RefreshTokenExpiryTime", s."Role", s."SecurityStamp", s."Status", s."TwoFactorEnabled", s."UserName", c0.id, c0.approved_at, c0.approved_by, c0.comment, c0.course_id, c0.created_at, c0.is_flagged, c0.rating, c0.status, c0.student_id
FROM courses AS c
LEFT JOIN (
    SELECT e.id, e.average_quiz_score, e.certificate_issued, e.certificate_url, e.completed_at, e.completed_lessons, e.course_id, e.enrolled_at, e.last_accessed_date, e.progress_percentage, e.quiz_count, e.student_id, e.total_time_spent, a."Id" AS "Id0", a."AccessFailedCount", a."Avatar", a."ConcurrencyStamp", a."CreatedAt", a."Email", a."EmailConfirmed", a."FullName", a."LastLoginAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."NotificationPreferences", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."RefreshToken", a."RefreshTokenExpiryTime", a."Role", a."SecurityStamp", a."Status", a."TwoFactorEnabled", a."UserName"
    FROM enrollments AS e
    INNER JOIN "AspNetUsers" AS a ON e.student_id = a."Id"
) AS s ON c.id = s.course_id
LEFT JOIN course_reviews AS c0 ON c.id = c0.course_id
WHERE c.instructor_id = @__instructorId_0
ORDER BY c.id, s.id, s."Id0"
2025-08-01 00:31:31.476 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c."AccessDuration", c."AccessType", c."AutomationAbandonmentSequence", c."AutomationCompletionCertificate", c."AutomationProgressReminders", c."AutomationWelcomeEmail", c.category, c."CourseType", c.created_at, c."Currency", c.description, c.discount, c."DripContent", c."DripScheduleJson", c.duration, c."EnrollmentLimit", c.enrollment_type, c.features, c."HasAssignments", c."HasCertificate", c."HasCommunity", c."HasDownloadableResources", c."HasLiveSessions", c."HasQuizzes", c.instructor_id, c.is_bestseller, c."IsPublished", c."Language", c.level, c.original_price, c."PaymentPlanDetailsJson", c.preview_url, c.price, c."PricingModel", c."PromoVideoUrl", c."PublishedAt", c."ShortDescription", c.status, c."SubscriptionPeriod", c.thumbnail, c.thumbnail_url, c.title, c.updated_at
FROM courses AS c
WHERE c.instructor_id = @__instructorId_0
2025-08-01 00:31:31.507 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:31:31.507 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__instructorId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
LEFT JOIN courses AS c ON t.course_id = c.id
WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed'
2025-08-01 00:31:31.508 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:31:31.509 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__twelveMonthsAgo_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Year", s."Month", COALESCE(sum(s.amount), 0.0) AS "Revenue"
FROM (
    SELECT t.amount, date_part('year', t.created_at AT TIME ZONE 'UTC')::int AS "Year", date_part('month', t.created_at AT TIME ZONE 'UTC')::int AS "Month"
    FROM transactions AS t
    LEFT JOIN courses AS c ON t.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0 AND t.status = 'Completed' AND t.created_at >= @__twelveMonthsAgo_1
) AS s
GROUP BY s."Year", s."Month"
ORDER BY s."Year", s."Month"
2025-08-01 00:31:31.510 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:31:31.510 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:31:31.510 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:31:31.511 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:31:31.512 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:31:31.513 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:31:31.513 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:31:31.514 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:31:31.514 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:31:31.515 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:31:31.516 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:31:31.516 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:31:31.518 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__c_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(sum(t.amount), 0.0)
FROM transactions AS t
WHERE t.course_id = @__c_Id_0 AND t.status = 'Completed'
2025-08-01 00:31:31.518 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:31:31.519 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:31:31.519 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.enrolled_at
FROM (
    SELECT e.enrolled_at, e.student_id, c.title
    FROM enrollments AS e
    INNER JOIN courses AS c ON e.course_id = c.id
    WHERE c.instructor_id = @__instructorId_0
    ORDER BY e.enrolled_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.enrolled_at DESC
2025-08-01 00:31:31.520 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:31:31.521 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__instructorId_0='?', @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a."FullName", s.title, s.created_at, s.rating
FROM (
    SELECT c.created_at, c.rating, c.student_id, c0.title
    FROM course_reviews AS c
    INNER JOIN courses AS c0 ON c.course_id = c0.id
    WHERE c0.instructor_id = @__instructorId_0
    ORDER BY c.created_at DESC
    LIMIT @__p_1
) AS s
INNER JOIN "AspNetUsers" AS a ON s.student_id = a."Id"
ORDER BY s.created_at DESC
2025-08-01 00:31:31.522 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:31:31.522 +08:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType18`5[[<>f__AnonymousType19`6[[System.Decimal, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Double, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], CeceLearningPortal.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-08-01 00:31:31.523 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api) in 100.1414ms
2025-08-01 00:31:31.523 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.AnalyticsController.GetInstructorAnalytics (CeceLearningPortal.Api)'
2025-08-01 00:31:31.523 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:31:31.524 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/analytics/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 111.2339ms
2025-08-01 00:31:31.525 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:31:31.527 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:31:31.529 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:31:31.531 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:31:31.532 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:31:31.533 +08:00 [INF] Executed DbCommand (0ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0
2025-08-01 00:31:31.534 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND NOT EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:31:31.536 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__courseId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM enrollments AS e
WHERE e.course_id = @__courseId_0 AND EXISTS (
    SELECT 1
    FROM subscriptions AS s
    WHERE s.user_id = e.student_id AND s.status = 'Active' AND s.start_date <= e.enrolled_at)
2025-08-01 00:31:31.536 +08:00 [INF] Executing OkObjectResult, writing value of type 'CeceLearningPortal.Api.DTOs.InstructorRevenueDto'.
2025-08-01 00:31:31.536 +08:00 [INF] Executed action CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api) in 108.5887ms
2025-08-01 00:31:31.536 +08:00 [INF] Executed endpoint 'CeceLearningPortal.Api.Controllers.RevenueController.GetInstructorRevenue (CeceLearningPortal.Api)'
2025-08-01 00:31:31.536 +08:00 [INF] Request finished HTTP/1.1 GET http://localhost:5294/api/revenue/instructor/bee889a2-efca-471d-807c-a7674a945612 - 200 null application/json; charset=utf-8 123.9202ms
